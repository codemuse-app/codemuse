"use strict";exports.id=194,exports.ids=[194],exports.modules={691:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isAnnotationEvaluationPostponed=void 0;const s=n(6886);t.isAnnotationEvaluationPostponed=function(e){return!!e.isStubFile||!!e.futureImports.has("annotations")||e.executionEnvironment.pythonVersion>=s.PythonVersion.V3_12}},563:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isCodeUnreachable=t.setTypeParameterSymbol=t.getTypeParameterSymbol=t.setDunderAllInfo=t.getDunderAllInfo=t.setCodeFlowComplexity=t.getCodeFlowComplexity=t.setCodeFlowExpressions=t.getCodeFlowExpressions=t.setFileInfo=t.getFileInfo=t.setAfterFlowNode=t.getAfterFlowNode=t.setFlowNode=t.getFlowNode=t.setDeclaration=t.getDeclaration=t.setScope=t.getScope=t.setImportInfo=t.getImportInfo=t.cleanNodeAnalysisInfo=void 0;const s=n(4972);function i(e){return e.flowNode}t.cleanNodeAnalysisInfo=function(e){const t=e;delete t.scope,delete t.declaration,delete t.flowNode,delete t.afterFlowNode,delete t.fileInfo,delete t.codeFlowExpressions,delete t.codeFlowComplexity,delete t.dunderAllInfo,delete t.typeParameterSymbol},t.getImportInfo=function(e){return e.importInfo},t.setImportInfo=function(e,t){e.importInfo=t},t.getScope=function(e){return e.scope},t.setScope=function(e,t){e.scope=t},t.getDeclaration=function(e){return e.declaration},t.setDeclaration=function(e,t){e.declaration=t},t.getFlowNode=i,t.setFlowNode=function(e,t){e.flowNode=t},t.getAfterFlowNode=function(e){return e.afterFlowNode},t.setAfterFlowNode=function(e,t){e.afterFlowNode=t},t.getFileInfo=function(e){for(;36!==e.nodeType;)e=e.parent;return e.fileInfo},t.setFileInfo=function(e,t){e.fileInfo=t},t.getCodeFlowExpressions=function(e){return e.codeFlowExpressions},t.setCodeFlowExpressions=function(e,t){e.codeFlowExpressions=t},t.getCodeFlowComplexity=function(e){var t;return null!==(t=e.codeFlowComplexity)&&void 0!==t?t:0},t.setCodeFlowComplexity=function(e,t){e.codeFlowComplexity=t},t.getDunderAllInfo=function(e){return e.dunderAllInfo},t.setDunderAllInfo=function(e,t){e.dunderAllInfo=t},t.getTypeParameterSymbol=function(e){return e.typeParameterSymbol},t.setTypeParameterSymbol=function(e,t){e.typeParameterSymbol=t},t.isCodeUnreachable=function(e){let t=e;for(;t;){const e=i(t);if(e)return!!(e.flags&s.FlowFlags.Unreachable);t=t.parent}return!1}},6052:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ReturnFinder=t.YieldFinder=t.Binder=void 0;const r=n(9489),o=n(5839),l=n(9744),c=n(6657),p=n(1464),d=n(3550),u=n(9866),y=a(n(563)),m=n(4972),g=n(8905),h=n(5678),f=a(n(8494)),T=n(427),v=n(1561),_=a(n(8235)),I=n(817),b=n(1766);class C extends T.ParseTreeWalker{constructor(e,t=!1){super(),this._moduleSymbolOnly=t,this._deferredBindingTasks=[],this._activeTypeParams=new Map,this._currentExceptTargets=[],this._finallyTargets=[],this._typingImportAliases=[],this._sysImportAliases=[],this._dataclassesImportAliases=[],this._typingSymbolAliases=new Map,this._dataclassesSymbolAliases=new Map,this._dunderAllStringNodes=[],this._usesUnsupportedDunderAllForm=!1,this._isInExceptSuite=!1,this._potentialHiddenSymbols=new Map,this._potentialPrivateSymbols=new Map,this._codeFlowComplexity=0,this._fileInfo=e}bindModule(e){var t;const n=void 0===this._fileInfo.builtinsScope;this._createNewScope(n?4:3,this._fileInfo.builtinsScope,(()=>{y.setScope(e,this._currentScope),y.setFlowNode(e,this._currentFlowNode),this._addImplicitSymbolToCurrentScope("__name__",e,"str"),this._addImplicitSymbolToCurrentScope("__qualname__",e,"str"),this._addImplicitSymbolToCurrentScope("__loader__",e,"Any"),this._addImplicitSymbolToCurrentScope("__package__",e,"str"),this._addImplicitSymbolToCurrentScope("__spec__",e,"Any"),this._addImplicitSymbolToCurrentScope("__path__",e,"Iterable[str]"),this._addImplicitSymbolToCurrentScope("__file__",e,"str"),this._addImplicitSymbolToCurrentScope("__cached__",e,"str"),this._addImplicitSymbolToCurrentScope("__dict__",e,"Dict[str, Any]"),this._addImplicitSymbolToCurrentScope("__annotations__",e,"Dict[str, Any]"),this._addImplicitSymbolToCurrentScope("__builtins__",e,"Any");const t=f.getDocString(e.statements);this._addImplicitSymbolToCurrentScope("__doc__",e,t?"str":"str | None"),this._currentFlowNode=this._createStartFlowNode(),this._walkStatementsAndReportUnreachable(e.statements),y.setAfterFlowNode(e,this._currentFlowNode),y.setCodeFlowExpressions(e,this._currentScopeCodeFlowExpressions),y.setCodeFlowComplexity(e,this._codeFlowComplexity)})),this._bindDeferred(),this._potentialHiddenSymbols.forEach(((e,t)=>{var n;(null===(n=this._dunderAllNames)||void 0===n?void 0:n.some((e=>e===t)))||(this._fileInfo.isStubFile?e.setIsExternallyHidden():e.setPrivatePyTypedImport())})),this._potentialPrivateSymbols.forEach(((e,t)=>{var n;(null===(n=this._dunderAllNames)||void 0===n?void 0:n.some((e=>e===t)))||e.setIsPrivateMember()})),this._dunderAllNames?y.setDunderAllInfo(e,{names:this._dunderAllNames,stringNodes:this._dunderAllStringNodes,usesUnsupportedDunderAllForm:this._usesUnsupportedDunderAllForm}):y.setDunderAllInfo(e,void 0);const s=y.getScope(e);if(s&&this._dunderAllNames)for(const e of this._dunderAllNames)null===(t=s.symbolTable.get(e))||void 0===t||t.setIsInDunderAll()}visitModule(e){return(0,o.fail)("We should never get here"),!1}visitSuite(e){return this._walkStatementsAndReportUnreachable(e.statements),!1}visitModuleName(e){const t=y.getImportInfo(e);if((0,o.assert)(void 0!==t),t.isNativeLib)return!0;if(!t.isImportFound)return this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingImports,l.DiagnosticRule.reportMissingImports,u.Localizer.Diagnostic.importResolveFailure().format({importName:t.importName}),e),!0;if(!t.isStubFile&&1===t.importType&&!t.pyTypedInfo){const n=this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingTypeStubs,l.DiagnosticRule.reportMissingTypeStubs,u.Localizer.Diagnostic.stubFileMissing().format({importName:t.importName}),e);if(n){const e={action:"pyright.createtypestub",moduleName:t.importName};n.addAction(e)}}return!0}visitClass(e){this.walkMultiple(e.decorators);const t={type:6,node:e,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(e.name,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite},n=this._bindNameToScope(this._currentScope,e.name);return n&&n.addDeclaration(t),y.setDeclaration(e,t),e.typeParameters&&this.walk(e.typeParameters),this.walkMultiple(e.arguments),this._createNewScope(2,this._getNonClassParentScope(),(()=>{y.setScope(e,this._currentScope),this._addImplicitSymbolToCurrentScope("__doc__",e,"str | None"),this._addImplicitSymbolToCurrentScope("__module__",e,"str"),this._dunderSlotsEntries=void 0,this._moduleSymbolOnly||this.walk(e.suite),this._dunderSlotsEntries&&this._addSlotsToCurrentScope(this._dunderSlotsEntries),this._dunderSlotsEntries=void 0})),this._createAssignmentTargetFlowNodes(e.name,!1,!1),e.typeParameters&&this._removeActiveTypeParameters(e.typeParameters),!1}visitFunction(e){this._createVariableAnnotationFlowNode(),y.setFlowNode(e,this._currentFlowNode);const t=this._bindNameToScope(this._currentScope,e.name),n=f.getEnclosingClass(e,!0),s={type:5,node:e,isMethod:!!n,isGenerator:!1,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(e.name,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};return t&&t.addDeclaration(s),y.setDeclaration(e,s),e.parameters.forEach((e=>{e.defaultValue&&this.walk(e.defaultValue)})),e.typeParameters&&this.walk(e.typeParameters),this.walkMultiple(e.decorators),e.parameters.forEach((e=>{e.typeAnnotation&&this.walk(e.typeAnnotation),e.typeAnnotationComment&&this.walk(e.typeAnnotationComment)})),e.returnTypeAnnotation&&this.walk(e.returnTypeAnnotation),e.functionAnnotationComment&&this.walk(e.functionAnnotationComment),this._createNewScope(1,this._getNonClassParentScope(),(()=>{y.setScope(e,this._currentScope),f.getEnclosingClass(e)&&this._addImplicitSymbolToCurrentScope("__class__",e,"class"),this._deferBinding((()=>{this._currentFlowNode=this._createStartFlowNode(),this._codeFlowComplexity=0,e.parameters.forEach((t=>{var n,s;if(t.name){const i=this._bindNameToScope(this._currentScope,t.name);let a=f.getDocString(null!==(s=null===(n=null==e?void 0:e.suite)||void 0===n?void 0:n.statements)&&void 0!==s?s:[]);if(void 0!==a&&(a=(0,h.extractParameterDocumentation)(a,t.name.value)),i){const e={type:2,node:t,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(t,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite,docString:a};i.addDeclaration(e),y.setDeclaration(t.name,e)}this._createFlowAssignment(t.name)}})),this._targetFunctionDeclaration=s,this._currentReturnTarget=this._createBranchLabel(),this.walk(e.suite),y.setAfterFlowNode(e.suite,this._currentFlowNode),this._addAntecedent(this._currentReturnTarget,this._currentFlowNode);const t=this._finishFlowLabel(this._currentReturnTarget);y.setAfterFlowNode(e,t),y.setCodeFlowExpressions(e,this._currentScopeCodeFlowExpressions),y.setCodeFlowComplexity(e,this._codeFlowComplexity)}))})),this._createAssignmentTargetFlowNodes(e.name,!1,!1),e.typeParameters&&this._removeActiveTypeParameters(e.typeParameters),!1}visitLambda(e){return this._createVariableAnnotationFlowNode(),y.setFlowNode(e,this._currentFlowNode),e.parameters.forEach((e=>{e.defaultValue&&this.walk(e.defaultValue)})),this._createNewScope(1,this._getNonClassParentScope(),(()=>{y.setScope(e,this._currentScope),this._deferBinding((()=>{this._currentFlowNode=this._createStartFlowNode(),e.parameters.forEach((e=>{if(e.name){const t=this._bindNameToScope(this._currentScope,e.name);if(t){const n={type:2,node:e,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(e,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};t.addDeclaration(n),y.setDeclaration(e.name,n)}this._createFlowAssignment(e.name),this.walk(e.name),y.setFlowNode(e,this._currentFlowNode)}})),this.walk(e.expression),y.setCodeFlowExpressions(e,this._currentScopeCodeFlowExpressions)}))})),!1}visitCall(e){var t,n;if(this._disableTrueFalseTargets((()=>{this.walk(e.leftExpression),e.arguments.forEach((e=>{this._currentFlowNode&&y.setFlowNode(e,this._currentFlowNode),this.walk(e)}))})),f.isNodeContainedWithinNodeType(e,13)||this._createCallFlowNode(e),3===this._currentScope.type&&35===e.leftExpression.nodeType&&38===e.leftExpression.leftExpression.nodeType&&"__all__"===e.leftExpression.leftExpression.value){let s=!0;if("extend"===e.leftExpression.memberName.value&&1===e.arguments.length){const t=e.arguments[0].valueExpression;if(31===t.nodeType)t.entries.forEach((e=>{var t,n;48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType&&(null===(t=this._dunderAllNames)||void 0===t||t.push(e.strings[0].value),null===(n=this._dunderAllStringNodes)||void 0===n||n.push(e.strings[0]),s=!1)}));else if(35===t.nodeType&&38===t.leftExpression.nodeType&&"__all__"===t.memberName.value){const e=this._getDunderAllNamesFromImport(t.leftExpression.value);e&&e.length>0&&(e.forEach((e=>{var t;null===(t=this._dunderAllNames)||void 0===t||t.push(e)})),s=!1)}}else if("remove"===e.leftExpression.memberName.value&&1===e.arguments.length){const t=e.arguments[0].valueExpression;48===t.nodeType&&1===t.strings.length&&49===t.strings[0].nodeType&&this._dunderAllNames&&(this._dunderAllNames=this._dunderAllNames.filter((e=>e!==t.strings[0].value)),this._dunderAllStringNodes=this._dunderAllStringNodes.filter((e=>e.value!==t.strings[0].value)),s=!1)}else if("append"===e.leftExpression.memberName.value&&1===e.arguments.length){const i=e.arguments[0].valueExpression;48===i.nodeType&&1===i.strings.length&&49===i.strings[0].nodeType&&(null===(t=this._dunderAllNames)||void 0===t||t.push(i.strings[0].value),null===(n=this._dunderAllStringNodes)||void 0===n||n.push(i.strings[0]),s=!1)}s&&(this._usesUnsupportedDunderAllForm=!0,this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnsupportedDunderAll,l.DiagnosticRule.reportUnsupportedDunderAll,u.Localizer.Diagnostic.unsupportedDunderAllOperation(),e))}return!1}visitTypeParameterList(e){return e.parameters.forEach((e=>{e.boundExpression&&this.walk(e.boundExpression)})),e.parameters.forEach((t=>{const n=t.name,s=new I.Symbol(0),i={type:3,node:t,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(e,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};s.addDeclaration(i),y.setDeclaration(n,i),y.setTypeParameterSymbol(n,s),this._activeTypeParams.has(n.value)?this._addError(u.Localizer.Diagnostic.typeParameterExistingTypeParameter().format({name:n.value}),n):this._activeTypeParams.set(n.value,s)})),e.parameters.forEach((e=>{e.defaultExpression&&this.walk(e.defaultExpression)})),!1}visitTypeAlias(e){this._bindNameToScope(this._currentScope,e.name),this.walk(e.name),e.typeParameters&&this.walk(e.typeParameters);const t={type:4,node:e,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(e.name,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite},n=this._bindNameToScope(this._currentScope,e.name);return n&&n.addDeclaration(t),y.setDeclaration(e,t),this._createAssignmentTargetFlowNodes(e.name,!0,!1),this.walk(e.expression),e.typeParameters&&this._removeActiveTypeParameters(e.typeParameters),!1}visitAssignment(e){if(this._handleTypingStubAssignmentOrAnnotation(e))return!1;if(this._bindPossibleTupleNamedTarget(e.leftExpression),e.typeAnnotationComment&&(this.walk(e.typeAnnotationComment),this._addTypeDeclarationForVariable(e.leftExpression,e.typeAnnotationComment)),e.chainedTypeAnnotationComment&&this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,u.Localizer.Diagnostic.annotationNotSupported(),e.chainedTypeAnnotationComment),24===e.leftExpression.nodeType){const t=e.leftExpression;if(1===t.items.length&&!t.trailingComma&&48===t.items[0].valueExpression.nodeType&&(0,m.isCodeFlowSupportedForReference)(t.baseExpression)){const e=(0,m.createKeyForReference)(t.baseExpression);this._currentScopeCodeFlowExpressions.add(e)}}this.walk(e.rightExpression);let t=!0;if((f.getEnclosingFunction(e)||9===e.rightExpression.nodeType&&this._fileInfo.isTypingStubFile||f.isWithinLoop(e))&&(t=!1),this._addInferredTypeAssignmentForVariable(e.leftExpression,e.rightExpression,t),this._createAssignmentTargetFlowNodes(e.leftExpression,!0,!1),3===this._currentScope.type&&(38===e.leftExpression.nodeType&&"__all__"===e.leftExpression.value||54===e.leftExpression.nodeType&&38===e.leftExpression.valueExpression.nodeType&&"__all__"===e.leftExpression.valueExpression.value)){const t=e.rightExpression;this._dunderAllNames=[];let n=!1;31===t.nodeType?t.entries.forEach((e=>{48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType?(this._dunderAllNames.push(e.strings[0].value),this._dunderAllStringNodes.push(e.strings[0])):n=!0})):52===t.nodeType?t.expressions.forEach((e=>{48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType?(this._dunderAllNames.push(e.strings[0].value),this._dunderAllStringNodes.push(e.strings[0])):n=!0})):n=!0,n&&(this._usesUnsupportedDunderAllForm=!0,this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnsupportedDunderAll,l.DiagnosticRule.reportUnsupportedDunderAll,u.Localizer.Diagnostic.unsupportedDunderAllOperation(),e))}if(2===this._currentScope.type&&(38===e.leftExpression.nodeType&&"__slots__"===e.leftExpression.value||54===e.leftExpression.nodeType&&38===e.leftExpression.valueExpression.nodeType&&"__slots__"===e.leftExpression.valueExpression.value)){const t=e.rightExpression;this._dunderSlotsEntries=[];let n=!0;48===t.nodeType?this._dunderSlotsEntries.push(t):31===t.nodeType?t.entries.forEach((e=>{48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType?this._dunderSlotsEntries.push(e):n=!1})):52===t.nodeType?t.expressions.forEach((e=>{48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType?this._dunderSlotsEntries.push(e):n=!1})):n=!1,n||(this._dunderSlotsEntries=void 0)}return!1}visitAssignmentExpression(e){this._disableTrueFalseTargets((()=>{this.walk(e.rightExpression)}));const t=f.getEvaluationNodeForAssignmentExpression(e);if(t){const n=y.getScope(t);let s=this._currentScope;for(;s&&s!==n;){if(s.lookUpSymbol(e.name.value)){this._addError(u.Localizer.Diagnostic.assignmentExprComprehension().format({name:e.name.value}),e.name);break}s=s.parent}this._bindNameToScope(n,e.name),this._addInferredTypeAssignmentForVariable(e.name,e.rightExpression),this._createAssignmentTargetFlowNodes(e.name,!0,!1)}else this._addError(u.Localizer.Diagnostic.assignmentExprContext(),e),this.walk(e.name);return!1}visitAugmentedAssignment(e){if(this.walk(e.leftExpression),this.walk(e.rightExpression),this._bindPossibleTupleNamedTarget(e.destExpression),this._createAssignmentTargetFlowNodes(e.destExpression,!1,!1),1===e.operator&&3===this._currentScope.type&&38===e.leftExpression.nodeType&&"__all__"===e.leftExpression.value){const t=e.rightExpression;let n=!0;if(31===t.nodeType)t.entries.forEach((e=>{var t;48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType&&(null===(t=this._dunderAllNames)||void 0===t||t.push(e.strings[0].value),this._dunderAllStringNodes.push(e.strings[0]))})),n=!1;else if(35===t.nodeType&&38===t.leftExpression.nodeType&&"__all__"===t.memberName.value){const e=this._getDunderAllNamesFromImport(t.leftExpression.value);e&&(e.forEach((e=>{var t;null===(t=this._dunderAllNames)||void 0===t||t.push(e)})),n=!1)}n&&(this._usesUnsupportedDunderAllForm=!0,this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnsupportedDunderAll,l.DiagnosticRule.reportUnsupportedDunderAll,u.Localizer.Diagnostic.unsupportedDunderAllOperation(),e))}return!1}visitDel(e){return e.expressions.forEach((e=>{this._bindPossibleTupleNamedTarget(e),this.walk(e),this._createAssignmentTargetFlowNodes(e,!1,!0)})),!1}visitTypeAnnotation(e){var t;if(this._handleTypingStubAssignmentOrAnnotation(e))return!1;const n=3===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&void 0!==f.getEnclosingClass(e,!0);n||this.walk(e.typeAnnotation),this._createVariableAnnotationFlowNode(),this._bindPossibleTupleNamedTarget(e.valueExpression),this._addTypeDeclarationForVariable(e.valueExpression,e.typeAnnotation),n&&this.walk(e.typeAnnotation);const s=[];return this._isNarrowingExpression(e.valueExpression,s)&&s.forEach((e=>{const t=(0,m.createKeyForReference)(e);this._currentScopeCodeFlowExpressions.add(t)})),this.walk(e.valueExpression),!1}visitFor(e){this._bindPossibleTupleNamedTarget(e.targetExpression),this._addInferredTypeAssignmentForVariable(e.targetExpression,e),this.walk(e.iterableExpression);const t=this._createLoopLabel(),n=this._createBranchLabel(),s=this._createBranchLabel();this._addAntecedent(t,this._currentFlowNode),this._currentFlowNode=t,this._addAntecedent(n,this._currentFlowNode);const i=this._trackCodeFlowExpressions((()=>{this._createAssignmentTargetFlowNodes(e.targetExpression,!0,!1)}));if(this._bindLoopStatement(t,s,(()=>{this.walk(e.forSuite),this._addAntecedent(t,this._currentFlowNode),i.forEach((e=>{var t;null===(t=this._currentScopeCodeFlowExpressions)||void 0===t||t.add(e)}))})),this._currentFlowNode=this._finishFlowLabel(n),e.elseSuite&&this.walk(e.elseSuite),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(s),e.asyncToken&&!this._fileInfo.ipythonMode){const t=f.getEnclosingFunction(e);t&&t.isAsync||this._addError(u.Localizer.Diagnostic.asyncNotInAsyncFunction(),e.asyncToken)}return!1}visitContinue(e){return this._currentContinueTarget&&this._addAntecedent(this._currentContinueTarget,this._currentFlowNode),this._currentFlowNode=C._unreachableFlowNode,!1}visitBreak(e){return this._currentBreakTarget&&this._addAntecedent(this._currentBreakTarget,this._currentFlowNode),this._currentFlowNode=C._unreachableFlowNode,!1}visitReturn(e){return this._targetFunctionDeclaration&&(this._targetFunctionDeclaration.returnStatements||(this._targetFunctionDeclaration.returnStatements=[]),this._targetFunctionDeclaration.returnStatements.push(e)),e.returnExpression&&this.walk(e.returnExpression),y.setFlowNode(e,this._currentFlowNode),this._currentReturnTarget&&this._addAntecedent(this._currentReturnTarget,this._currentFlowNode),this._finallyTargets.forEach((e=>{this._addAntecedent(e,this._currentFlowNode)})),this._currentFlowNode=C._unreachableFlowNode,!1}visitYield(e){return this._isInListComprehension(e,!0)&&this._addError(u.Localizer.Diagnostic.yieldWithinListCompr(),e),this._bindYield(e),!1}visitYieldFrom(e){return this._isInListComprehension(e,!0)&&this._addError(u.Localizer.Diagnostic.yieldWithinListCompr(),e),this._bindYield(e),!1}visitMemberAccess(e){return this.walk(e.leftExpression),y.setFlowNode(e,this._currentFlowNode),!1}visitName(e){y.setFlowNode(e,this._currentFlowNode);const t=this._activeTypeParams.get(e.value);return t&&y.setTypeParameterSymbol(e,t),!1}visitIndex(e){return y.setFlowNode(e,this._currentFlowNode),!0}visitIf(e){const t=this._currentFlowNode,n=this._createBranchLabel(),s=this._createBranchLabel(),i=this._createBranchLabel(t);return i.affectedExpressions=this._trackCodeFlowExpressions((()=>{const t=_.evaluateStaticBoolLikeExpression(e.testExpression,this._fileInfo.executionEnvironment,this._fileInfo.definedConstants,this._typingImportAliases,this._sysImportAliases);this._bindConditional(e.testExpression,n,s),this._currentFlowNode=!1===t?C._unreachableFlowNode:this._finishFlowLabel(n),this.walk(e.ifSuite),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=!0===t?C._unreachableFlowNode:this._finishFlowLabel(s),e.elseSuite?this.walk(e.elseSuite):this._bindNeverCondition(e.testExpression,i,!1),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(i)})),!1}visitWhile(e){const t=this._createBranchLabel(),n=this._createBranchLabel(),s=this._createBranchLabel(),i=_.evaluateStaticBoolLikeExpression(e.testExpression,this._fileInfo.executionEnvironment,this._fileInfo.definedConstants,this._typingImportAliases,this._sysImportAliases),a=this._createLoopLabel();return this._addAntecedent(a,this._currentFlowNode),this._currentFlowNode=a,this._bindConditional(e.testExpression,t,n),this._currentFlowNode=!1===i?C._unreachableFlowNode:this._finishFlowLabel(t),this._bindLoopStatement(a,s,(()=>{this.walk(e.whileSuite)})),this._addAntecedent(a,this._currentFlowNode),this._currentFlowNode=!0===i?C._unreachableFlowNode:this._finishFlowLabel(n),e.elseSuite&&this.walk(e.elseSuite),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(s),!1}visitAssert(e){const t=this._createBranchLabel(),n=this._createBranchLabel();return this._bindConditional(e.testExpression,t,n),e.exceptionExpression&&(this._currentFlowNode=this._finishFlowLabel(n),this.walk(e.exceptionExpression)),this._currentFlowNode=this._finishFlowLabel(t),!1}visitExcept(e){if(e.typeExpression&&this.walk(e.typeExpression),e.name){this.walk(e.name);const t=this._bindNameToScope(this._currentScope,e.name);if(this._createAssignmentTargetFlowNodes(e.name,!0,!1),t){const n={type:1,node:e.name,isConstant:(0,b.isConstantName)(e.name.value),inferredTypeSource:e,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(e.name,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};t.addDeclaration(n)}}const t=this._isInExceptSuite;return this._isInExceptSuite=!0,this.walk(e.exceptSuite),this._isInExceptSuite=t,e.name&&this._createFlowAssignment(e.name,!0),!1}visitRaise(e){return this._targetFunctionDeclaration&&(this._targetFunctionDeclaration.raiseStatements||(this._targetFunctionDeclaration.raiseStatements=[]),this._targetFunctionDeclaration.raiseStatements.push(e)),e.typeExpression&&this.walk(e.typeExpression),e.valueExpression&&this.walk(e.valueExpression),e.tracebackExpression&&this.walk(e.tracebackExpression),this._finallyTargets.forEach((e=>{this._addAntecedent(e,this._currentFlowNode)})),this._currentFlowNode=C._unreachableFlowNode,!1}visitTry(e){const t=this._currentFlowNode,n=e.exceptClauses.map((()=>this._createBranchLabel())),s=this._createBranchLabel(t);let i=!1;const a=this._createBranchLabel(t),r={flags:m.FlowFlags.PreFinallyGate,id:this._getUniqueFlowNodeId(),antecedent:a,isGateClosed:!1};if(s.affectedExpressions=this._trackCodeFlowExpressions((()=>{e.finallySuite&&this._addAntecedent(s,r),e.exceptClauses.some((e=>!e.typeExpression))||n.push(a),n.forEach((e=>{this._addAntecedent(e,this._currentFlowNode)})),e.finallySuite&&this._finallyTargets.push(a),this._useExceptTargets(n,(()=>{this.walk(e.trySuite)})),e.elseSuite&&this.walk(e.elseSuite),this._addAntecedent(s,this._currentFlowNode),this._isCodeUnreachable()||(i=!0),e.exceptClauses.forEach(((e,t)=>{this._currentFlowNode=this._finishFlowLabel(n[t]),this.walk(e),this._addAntecedent(s,this._currentFlowNode),this._isCodeUnreachable()||(i=!0)})),e.finallySuite&&this._finallyTargets.pop(),this._currentFlowNode=this._finishFlowLabel(s)})),e.finallySuite){this.walk(e.finallySuite);const t={flags:m.FlowFlags.PostFinally,id:this._getUniqueFlowNodeId(),finallyNode:e.finallySuite,antecedent:this._currentFlowNode,preFinallyGate:r};this._currentFlowNode=i?t:C._unreachableFlowNode}return!1}visitAwait(e){var t;const n=f.getEnclosingFunction(e);if(void 0===n||!n.isAsync){if(this._fileInfo.ipythonMode&&void 0===n)return!0;32!==(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&this._addError(u.Localizer.Diagnostic.awaitNotInAsync(),e)}return!0}visitGlobal(e){const t=this._currentScope.getGlobalScope().scope;return e.nameList.forEach((e=>{const n=e.value;0===this._currentScope.getBindingType(n)&&this._addError(u.Localizer.Diagnostic.nonLocalRedefinition().format({name:n}),e);const s=this._currentScope.lookUpSymbolRecursive(n);s&&s.scope===this._currentScope&&this._addError(u.Localizer.Diagnostic.globalReassignment().format({name:n}),e),this._bindNameToScope(t,e),this._currentScope!==t&&this._currentScope.setBindingType(n,1)})),!0}visitNonlocal(e){const t=this._currentScope.getGlobalScope().scope;return this._currentScope===t?this._addError(u.Localizer.Diagnostic.nonLocalInModule(),e):e.nameList.forEach((e=>{const n=e.value;1===this._currentScope.getBindingType(n)&&this._addError(u.Localizer.Diagnostic.globalRedefinition().format({name:n}),e);const s=this._currentScope.lookUpSymbolRecursive(n);s&&s.scope===this._currentScope?this._addError(u.Localizer.Diagnostic.nonLocalReassignment().format({name:n}),e):s&&s.scope!==t||this._addError(u.Localizer.Diagnostic.nonLocalNoBinding().format({name:n}),e),s&&this._currentScope.setBindingType(n,0)})),!0}visitImportAs(e){var t,n,s,i,a,r;if(e.module.nameParts.length>0){const l=e.module.nameParts[0].value;let c,p;e.alias?(c=e.alias.value,p=e.alias):(c=l,p=e.module.nameParts[0]);const d=this._bindNameToScope(this._currentScope,p);!d||3!==this._currentScope.type&&4!==this._currentScope.type||e.alias&&1===e.module.nameParts.length&&e.module.nameParts[0].value===e.alias.value||(this._fileInfo.isStubFile||this._fileInfo.isInPyTypedPackage)&&this._potentialHiddenSymbols.set(c,d);const u=y.getImportInfo(e.module);(0,o.assert)(void 0!==u),d&&this._createAliasDeclarationForMultipartImportName(e,e.alias,u,d),this._createFlowAssignment(e.alias?e.alias:e.module.nameParts[0]),1===e.module.nameParts.length&&("typing"===l||"typing_extensions"===l?this._typingImportAliases.push(null!==(n=null===(t=e.alias)||void 0===t?void 0:t.value)&&void 0!==n?n:l):"sys"===l?this._sysImportAliases.push(null!==(i=null===(s=e.alias)||void 0===s?void 0:s.value)&&void 0!==i?i:l):"dataclasses"===l&&this._dataclassesImportAliases.push(null!==(r=null===(a=e.alias)||void 0===a?void 0:a.value)&&void 0!==r?r:l))}return!0}visitImportFrom(e){var t;const n=["Final","ClassVar","Annotated"],s=["InitVar"],i=y.getImportInfo(e.module);let a="";i&&i.isImportFound&&!i.isNativeLib&&(a=i.resolvedPaths[i.resolvedPaths.length-1]);const r=(0,c.stripFileExtension)((0,c.getFileName)(this._fileInfo.filePath)),o="__init__"===r&&1===e.module.leadingDots&&1===e.module.nameParts.length;let l=!1,g=!1;if(1===e.module.nameParts.length){const t=e.module.nameParts[0].value;"typing"!==t&&"typing_extensions"!==t||(l=!0),"dataclasses"===t&&(g=!0)}if(e.isWildcardImport){if((f.getEnclosingClass(e)||f.getEnclosingFunction(e))&&this._addError(u.Localizer.Diagnostic.wildcardInFunction(),e),i){const r=[];null===(t=this._currentScopeCodeFlowExpressions)||void 0===t||t.add(m.wildcardImportReferenceKey);const c=this._fileInfo.importLookup(a);if(c){const t=this._getWildcardImportNames(c);o&&(t.some((t=>t===e.module.nameParts[0].value))||this._addImplicitFromImport(e,i)),t.forEach((t=>{const n=this._bindNameValueToScope(this._currentScope,t);if(n)if(c.symbolTable.get(t)){const s={type:8,node:e,path:a,loadSymbolsFromPath:!0,range:(0,d.getEmptyRange)(),usesLocalName:!1,symbolName:t,moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};n.addDeclaration(s),r.push(t)}else if(i&&i.filteredImplicitImports){const s=i.filteredImplicitImports.find((e=>e.name===t));if(s){const i={type:8,node:e,path:s.path,loadSymbolsFromPath:!0,range:(0,d.getEmptyRange)(),usesLocalName:!1,moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite},o={type:8,node:e,path:a,loadSymbolsFromPath:!0,usesLocalName:!1,symbolName:t,submoduleFallback:i,range:(0,d.getEmptyRange)(),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};n.addDeclaration(o),r.push(t)}}}))}this._createFlowWildcardImport(e,r),l&&n.forEach((e=>{this._typingSymbolAliases.set(e,e)})),g&&s.forEach((e=>{this._dataclassesSymbolAliases.set(e,e)}))}}else o&&this._addImplicitFromImport(e,i),e.imports.forEach((t=>{const o=t.name.value,c=t.alias||t.name,u=this._bindNameToScope(this._currentScope,c);if(u){let y,m;e.module.nameParts.length>0&&(3!==this._currentScope.type&&4!==this._currentScope.type||t.alias&&t.alias.value===t.name.value||(this._fileInfo.isStubFile||this._fileInfo.isInPyTypedPackage)&&this._potentialHiddenSymbols.set(c.value,u)),i&&i.filteredImplicitImports&&(y=i.filteredImplicitImports.find((e=>e.name===o)));let h=!0;y&&(m={type:8,node:t,path:y.path,loadSymbolsFromPath:!0,range:(0,d.getEmptyRange)(),usesLocalName:!1,moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite},"__init__"===r&&1===e.module.leadingDots&&0===e.module.nameParts.length&&(h=!1));const f={type:8,node:t,path:a,loadSymbolsFromPath:h,usesLocalName:!!t.alias,symbolName:o,submoduleFallback:m,range:(0,p.convertTextRangeToRange)(c,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite,isNativeLib:null==i?void 0:i.isNativeLib};u.addDeclaration(f),this._createFlowAssignment(t.alias||t.name),l&&n.some((e=>e===t.name.value))&&this._typingSymbolAliases.set(c.value,t.name.value),g&&s.some((e=>e===t.name.value))&&this._dataclassesSymbolAliases.set(c.value,t.name.value)}}));return!0}visitWith(e){e.withItems.forEach((e=>{this.walk(e.expression),e.target&&(this._bindPossibleTupleNamedTarget(e.target),this._addInferredTypeAssignmentForVariable(e.target,e),this._createAssignmentTargetFlowNodes(e.target,!0,!1))}));const t=this._createContextManagerLabel(e.withItems.map((e=>e.expression)),!!e.isAsync,!1);this._addAntecedent(t,this._currentFlowNode);const n=this._createContextManagerLabel(e.withItems.map((e=>e.expression)),!!e.isAsync,!0);this._currentExceptTargets.forEach((e=>{this._addAntecedent(e,n)}));const s=this._currentFlowNode,i=this._createBranchLabel(s);return this._addAntecedent(i,t),i.affectedExpressions=this._trackCodeFlowExpressions((()=>{if(this._useExceptTargets([t,n],(()=>{this.walk(e.suite)})),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=i,this._isCodeUnreachable()||this._addExceptTargets(this._currentFlowNode),e.asyncToken&&!this._fileInfo.ipythonMode){const t=f.getEnclosingFunction(e);t&&t.isAsync||this._addError(u.Localizer.Diagnostic.asyncNotInAsyncFunction(),e.asyncToken)}})),!1}visitTernary(e){const t=this._currentFlowNode,n=this._createBranchLabel(),s=this._createBranchLabel(),i=this._createBranchLabel(t);return i.affectedExpressions=this._trackCodeFlowExpressions((()=>{this._bindConditional(e.testExpression,n,s),this._currentFlowNode=this._finishFlowLabel(n),this.walk(e.ifExpression),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(s),this.walk(e.elseExpression),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(i)})),!1}visitUnaryOperation(e){return 38===e.operator&&this._currentFalseTarget&&this._currentTrueTarget?this._bindConditional(e.expression,this._currentFalseTarget,this._currentTrueTarget):this._disableTrueFalseTargets((()=>{this.walk(e.expression)})),!1}visitBinaryOperation(e){if(36===e.operator||37===e.operator){let t,n=this._currentTrueTarget,s=this._currentFalseTarget;n&&s||(t=this._createBranchLabel(),n=s=t);const i=this._createBranchLabel();36===e.operator?this._bindConditional(e.leftExpression,i,s):this._bindConditional(e.leftExpression,n,i),this._currentFlowNode=this._finishFlowLabel(i),this._bindConditional(e.rightExpression,n,s),t&&(this._currentFlowNode=this._finishFlowLabel(t))}else this._disableTrueFalseTargets((()=>{this.walk(e.leftExpression),this.walk(e.rightExpression)}));return!1}visitListComprehension(e){const t=f.getEnclosingFunction(e);return this._createNewScope(0,this._getNonClassParentScope(),(()=>{var n;y.setScope(e,this._currentScope);const s=this._createBranchLabel();for(let s=0;s<e.forIfNodes.length;s++){const i=e.forIfNodes[s],a=new Map;33===i.nodeType&&(this._bindPossibleTupleNamedTarget(i.targetExpression,a),this._addInferredTypeAssignmentForVariable(i.targetExpression,i),i.asyncToken&&!this._fileInfo.ipythonMode&&(t&&t.isAsync||31===(null===(n=e.parent)||void 0===n?void 0:n.nodeType)&&this._addError(u.Localizer.Diagnostic.asyncNotInAsyncFunction(),i.asyncToken)))}for(let t=0;t<e.forIfNodes.length;t++){const n=e.forIfNodes[t];if(33===n.nodeType)this.walk(n.iterableExpression),this._createAssignmentTargetFlowNodes(n.targetExpression,!0,!1);else{const e=this._createBranchLabel();this._bindConditional(n.testExpression,e,s),this._currentFlowNode=this._finishFlowLabel(e)}}this.walk(e.expression),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(s)})),!1}visitMatch(e){this.walk(e.subjectExpression);const t=[],n=this._isNarrowingExpression(e.subjectExpression,t);n&&t.forEach((e=>{const t=(0,m.createKeyForReference)(e);this._currentScopeCodeFlowExpressions.add(t)}));const s=this._createBranchLabel();let i=!1;return e.cases.forEach((t=>{const a=this._createBranchLabel(),r=this._createBranchLabel(),o=this._createBranchLabel();this._addAntecedent(r,this._currentFlowNode),t.isIrrefutable?t.guardExpression||(i=!0):this._addAntecedent(a,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(r),this.walk(t.pattern),n&&this._createFlowNarrowForPattern(e.subjectExpression,t),t.guardExpression?this._bindConditional(t.guardExpression,o,a):this._addAntecedent(o,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(o),this.walk(t.suite),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(a)})),n&&this._createFlowNarrowForPattern(e.subjectExpression,e),i||this._createFlowExhaustedMatch(e),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(s),!1}visitPatternAs(e){const t=this._createBranchLabel();if(e.orPatterns.forEach((e=>{this.walk(e),this._addAntecedent(t,this._currentFlowNode)})),this._currentFlowNode=this._finishFlowLabel(t),e.target){this.walk(e.target);const t=this._bindNameToScope(this._currentScope,e.target);if(this._createAssignmentTargetFlowNodes(e.target,!1,!1),t){const n={type:1,node:e.target,isConstant:(0,b.isConstantName)(e.target.value),inferredTypeSource:e,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(e.target,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};t.addDeclaration(n)}}return!1}visitPatternCapture(e){return e.isWildcard||this._addPatternCaptureTarget(e.target),!0}visitPatternMappingExpandEntry(e){return"_"!==e.target.value&&this._addPatternCaptureTarget(e.target),!0}_removeActiveTypeParameters(e){e.parameters.forEach((e=>{const t=this._activeTypeParams.get(e.name.value);if(t){const n=t.getDeclarations();(0,o.assert)(n&&1===n.length&&3===n[0].type),n[0].node===e&&this._activeTypeParams.delete(e.name.value)}}))}_getNonClassParentScope(){let e=this._currentScope;for(;2===e.type;)e=e.parent;return e}_addSlotsToCurrentScope(e){(0,o.assert)(2===this._currentScope.type);let t=!1;for(const n of e){const e=n.strings[0].value;if("__dict__"===e){t=!0;continue}let s=this._currentScope.lookUpSymbol(e);if(!s){s=this._currentScope.addSymbol(e,5);const t="none"!==this._fileInfo.diagnosticRuleSet.reportPrivateUsage;(0,b.isPrivateOrProtectedName)(e)&&t&&s.setIsPrivateMember()}const i={type:1,node:n,isConstant:(0,b.isConstantName)(e),isDefinedBySlots:!0,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(n,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};s.addDeclaration(i)}t||this._currentScope.setSlotsNames(e.map((e=>e.strings[0].value)))}_isInListComprehension(e,t=!1){let n,s,i=e;for(;i;){if(32===i.nodeType){if(t&&i.forIfNodes.length>0){const e=i.forIfNodes[0];if(n===e&&33===e.nodeType&&s===e.iterableExpression)return!1}return!0}s=n,n=i,i=i.parent}return!1}_addPatternCaptureTarget(e){const t=this._bindNameToScope(this._currentScope,e);if(this._createAssignmentTargetFlowNodes(e,!1,!1),t){const n={type:1,node:e,isConstant:(0,b.isConstantName)(e.value),inferredTypeSource:e.parent,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(e,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};t.addDeclaration(n)}}_useExceptTargets(e,t){const n=this._currentExceptTargets;this._currentExceptTargets=e,t(),this._currentExceptTargets=n}_getDunderAllNamesFromImport(e){var t,n;const s=this._currentScope.lookUpSymbol(e);if(!s)return;const i=s.getDeclarations().find((e=>8===e.type)),a=(null==i?void 0:i.path)&&i.loadSymbolsFromPath?i.path:(null===(t=null==i?void 0:i.submoduleFallback)||void 0===t?void 0:t.path)&&i.submoduleFallback.loadSymbolsFromPath?i.submoduleFallback.path:void 0;if(!a)return;let r=this._fileInfo.importLookup(a);return(null==r?void 0:r.dunderAllNames)?r.dunderAllNames:(null===(n=null==i?void 0:i.submoduleFallback)||void 0===n?void 0:n.path)?(r=this._fileInfo.importLookup(i.submoduleFallback.path),null==r?void 0:r.dunderAllNames):void 0}_addImplicitFromImport(e,t){const n=e.module.nameParts[0].value,s=this._bindNameValueToScope(this._currentScope,n);s&&this._createAliasDeclarationForMultipartImportName(e,void 0,t,s),this._createFlowAssignment(e.module.nameParts[0])}_createAliasDeclarationForMultipartImportName(e,t,n,s){var i;const a=e.module.nameParts[0].value,r=s.getDeclarations().find((e=>8===e.type&&e.firstNamePart===a));let o,l;l=n&&n.isImportFound&&!n.isNativeLib&&n.resolvedPaths.length>0?n.resolvedPaths[n.resolvedPaths.length-1]:g.UnresolvedModuleMarker;const c=n&&n.isImportFound&&!n.isNativeLib&&n.resolvedPaths.length>0;o=r||(c?{type:8,node:e,path:l,loadSymbolsFromPath:!1,range:(0,d.getEmptyRange)(),usesLocalName:!!t,moduleName:a,firstNamePart:a,isInExceptSuite:this._isInExceptSuite}:{type:8,node:e,path:l,loadSymbolsFromPath:!0,range:(0,d.getEmptyRange)(),usesLocalName:!!t,moduleName:null!==(i=null==n?void 0:n.importName)&&void 0!==i?i:"",firstNamePart:a,isUnresolved:!0,isInExceptSuite:this._isInExceptSuite});const p=y.getImportInfo(e.module.nameParts[0]);if(p&&p.resolvedPaths.length&&(o.path=p.resolvedPaths[0],o.loadSymbolsFromPath=!0,this._addImplicitImportsToLoaderActions(p,o)),t||1===e.module.nameParts.length)o.path=l,o.loadSymbolsFromPath=!0,o.isUnresolved=!1,n&&this._addImplicitImportsToLoaderActions(n,o);else{let t=o;for(let s=1;s<e.module.nameParts.length;s++){const i=e.module.nameParts[s].value;let a=t.implicitImports?t.implicitImports.get(i):void 0;if(a||(a={path:n&&s<n.resolvedPaths.length?n.resolvedPaths[s]:g.UnresolvedModuleMarker,loadSymbolsFromPath:!1,implicitImports:new Map,isUnresolved:!c},t.implicitImports||(t.implicitImports=new Map),t.implicitImports.set(i,a)),s===e.module.nameParts.length-1)n&&s<n.resolvedPaths.length&&(a.path=n.resolvedPaths[s],a.loadSymbolsFromPath=!0,this._addImplicitImportsToLoaderActions(n,a));else{const t=y.getImportInfo(e.module.nameParts[s]);t&&t.resolvedPaths.length&&(a.path=t.resolvedPaths[s],a.loadSymbolsFromPath=!0,this._addImplicitImportsToLoaderActions(t,a))}t=a}}r||s.addDeclaration(o)}_getWildcardImportNames(e){const t=[];if(e.dunderAllNames){if(!e.usesUnsupportedDunderAllForm)return e.dunderAllNames;(0,r.appendArray)(t,e.dunderAllNames)}return e.symbolTable.forEach(((e,n)=>{e.isExternallyHidden()||(0,b.isPrivateOrProtectedName)(n)||t.push(n)})),t}_walkStatementsAndReportUnreachable(e){let t=!1;for(const n of e)y.setFlowNode(n,this._currentFlowNode),t||(t=this._isCodeUnreachable()),t?this._targetFunctionDeclaration&&!this._targetFunctionDeclaration.isGenerator&&(new S).checkContainsYield(n)&&(this._targetFunctionDeclaration.isGenerator=!0):this.walk(n);return!1}_createStartFlowNode(){return{flags:m.FlowFlags.Start,id:this._getUniqueFlowNodeId()}}_createBranchLabel(e){return{flags:m.FlowFlags.BranchLabel,id:this._getUniqueFlowNodeId(),antecedents:[],preBranchAntecedent:e,affectedExpressions:void 0}}_createFlowNarrowForPattern(e,t){const n={flags:m.FlowFlags.NarrowForPattern,id:this._getUniqueFlowNodeId(),subjectExpression:e,statement:t,antecedent:this._currentFlowNode};this._currentFlowNode=n}_createContextManagerLabel(e,t,n){return{flags:m.FlowFlags.PostContextManager|m.FlowFlags.BranchLabel,id:this._getUniqueFlowNodeId(),antecedents:[],expressions:e,affectedExpressions:void 0,isAsync:t,blockIfSwallowsExceptions:n}}_createLoopLabel(){return{flags:m.FlowFlags.LoopLabel,id:this._getUniqueFlowNodeId(),antecedents:[],affectedExpressions:void 0}}_finishFlowLabel(e){return 0===e.antecedents.length?C._unreachableFlowNode:1===e.antecedents.length&&e.flags===m.FlowFlags.BranchLabel?e.antecedents[0]:(this._codeFlowComplexity+=e.antecedents.length-1,e)}_bindNeverCondition(e,t,n){const s=[];if(55===e.nodeType&&38===e.operator)this._bindNeverCondition(e.expression,t,!n);else if(7!==e.nodeType||36!==e.operator&&37!==e.operator)this._isNarrowingExpression(e,s,!0)&&s.filter((e=>38===e.nodeType)).length>0&&(this._currentFlowNode=this._createFlowConditional(n?m.FlowFlags.TrueNeverCondition:m.FlowFlags.FalseNeverCondition,this._currentFlowNode,e)),this._addAntecedent(t,this._currentFlowNode);else{let s=36===e.operator;if(n&&(s=!s),s){const s=this._currentFlowNode;this._bindNeverCondition(e.leftExpression,t,n),this._currentFlowNode=s,this._bindNeverCondition(e.rightExpression,t,n)}else{const s=this._currentFlowNode,i=this._createBranchLabel();if(this._bindNeverCondition(e.leftExpression,i,n),s!==this._currentFlowNode){this._currentFlowNode=this._finishFlowLabel(i);const a=this._currentFlowNode;this._bindNeverCondition(e.rightExpression,t,n),a===this._currentFlowNode&&(this._currentFlowNode=s)}}}}_bindConditional(e,t,n){this._setTrueFalseTargets(t,n,(()=>{this.walk(e)})),this._isLogicalExpression(e)||(this._addAntecedent(t,this._createFlowConditional(m.FlowFlags.TrueCondition,this._currentFlowNode,e)),this._addAntecedent(n,this._createFlowConditional(m.FlowFlags.FalseCondition,this._currentFlowNode,e)))}_disableTrueFalseTargets(e){this._setTrueFalseTargets(void 0,void 0,e)}_setTrueFalseTargets(e,t,n){const s=this._currentTrueTarget,i=this._currentFalseTarget;this._currentTrueTarget=e,this._currentFalseTarget=t,n(),this._currentTrueTarget=s,this._currentFalseTarget=i}_createFlowConditional(e,t,n){if(t.flags&m.FlowFlags.Unreachable)return t;const s=_.evaluateStaticBoolLikeExpression(n,this._fileInfo.executionEnvironment,this._fileInfo.definedConstants,this._typingImportAliases,this._sysImportAliases);if(!0===s&&e&m.FlowFlags.FalseCondition||!1===s&&e&m.FlowFlags.TrueCondition)return C._unreachableFlowNode;const i=[];if(!this._isNarrowingExpression(n,i,0!=(e&(m.FlowFlags.TrueNeverCondition|m.FlowFlags.FalseNeverCondition))))return t;i.forEach((e=>{const t=(0,m.createKeyForReference)(e);this._currentScopeCodeFlowExpressions.add(t)}));const a=i.filter((e=>38===e.nodeType)),r={flags:e,id:this._getUniqueFlowNodeId(),reference:a.length>0?a[0]:void 0,expression:n,antecedent:t};return this._addExceptTargets(r),r}_isLogicalExpression(e){switch(e.nodeType){case 55:return 38===e.operator;case 7:return 36===e.operator||37===e.operator}return!1}_isNarrowingExpression(e,t,n=!1,s=!1){switch(e.nodeType){case 38:case 35:case 24:if(n){if(38!==e.nodeType)return!1;if(!s)return!1}return!!(0,m.isCodeFlowSupportedForReference)(e)&&(t.push(e),n||(35===e.nodeType&&(0,m.isCodeFlowSupportedForReference)(e.leftExpression)&&t.push(e.leftExpression),24!==e.nodeType||1!==e.items.length||e.trailingComma||0!==e.items[0].argumentCategory||(0,m.isCodeFlowSupportedForReference)(e.baseExpression)&&t.push(e.baseExpression)),!0);case 4:return t.push(e.name),this._isNarrowingExpression(e.rightExpression,t,n,!0),!0;case 7:{const s=39===e.operator||40===e.operator,i=12===e.operator||28===e.operator;return s||i?11===e.rightExpression.nodeType&&26===e.rightExpression.constType?this._isNarrowingExpression(e.leftExpression,t,n,!0):s&&9===e.leftExpression.nodeType&&38===e.leftExpression.leftExpression.nodeType&&"type"===e.leftExpression.leftExpression.value&&1===e.leftExpression.arguments.length&&0===e.leftExpression.arguments[0].argumentCategory?this._isNarrowingExpression(e.leftExpression.arguments[0].valueExpression,t,n,!0):this._isNarrowingExpression(e.leftExpression,t,n,!0):!(41!==e.operator&&42!==e.operator||48!==e.leftExpression.nodeType||!this._isNarrowingExpression(e.rightExpression,t,n,!0))||(41===e.operator||42===e.operator)&&this._isNarrowingExpression(e.leftExpression,t,n,!0)}case 55:return 38===e.operator&&this._isNarrowingExpression(e.expression,t,n,!1);case 5:return this._isNarrowingExpression(e.rightExpression,t,n,!0);case 9:if(38===e.leftExpression.nodeType&&("isinstance"===e.leftExpression.value||"issubclass"===e.leftExpression.value)&&2===e.arguments.length)return this._isNarrowingExpression(e.arguments[0].valueExpression,t,n,!0);if(38===e.leftExpression.nodeType&&"callable"===e.leftExpression.value&&1===e.arguments.length)return this._isNarrowingExpression(e.arguments[0].valueExpression,t,n,!0);if(e.arguments.length>=1)return!n&&this._isNarrowingExpression(e.arguments[0].valueExpression,t,n,!0)}return!1}_createAssignmentTargetFlowNodes(e,t,n){switch(e.nodeType){case 38:case 35:case 24:this._createFlowAssignment(e,n),t&&this.walk(e);break;case 52:e.expressions.forEach((e=>{this._createAssignmentTargetFlowNodes(e,t,n)}));break;case 54:this._createAssignmentTargetFlowNodes(e.valueExpression,!1,n),t&&this.walk(e);break;case 56:this._createAssignmentTargetFlowNodes(e.expression,!1,n),t&&this.walk(e);break;case 31:e.entries.forEach((e=>{this._createAssignmentTargetFlowNodes(e,t,n)}));break;default:t&&this.walk(e)}}_createCallFlowNode(e){if(!this._isCodeUnreachable()){const t={flags:m.FlowFlags.Call,id:this._getUniqueFlowNodeId(),node:e,antecedent:this._currentFlowNode};this._currentFlowNode=t}this._isCodeUnreachable()||this._addExceptTargets(this._currentFlowNode)}_createVariableAnnotationFlowNode(){if(!this._isCodeUnreachable()){const e={flags:m.FlowFlags.VariableAnnotation,id:this._getUniqueFlowNodeId(),antecedent:this._currentFlowNode};this._currentFlowNode=e}}_createFlowAssignment(e,t=!1){let n=I.indeterminateSymbolId;if(38===e.nodeType){const t=this._currentScope.lookUpSymbolRecursive(e.value);(0,o.assert)(void 0!==t),n=t.symbol.id}const s=this._currentFlowNode;if(!this._isCodeUnreachable()&&(0,m.isCodeFlowSupportedForReference)(e)){const s={flags:m.FlowFlags.Assignment,id:this._getUniqueFlowNodeId(),node:e,antecedent:this._currentFlowNode,targetSymbolId:n},i=(0,m.createKeyForReference)(e);this._currentScopeCodeFlowExpressions.add(i),t&&(s.flags|=m.FlowFlags.Unbind),35===e.nodeType&&this._addExceptTargets(s),this._currentFlowNode=s}t&&void 0!==y.getFlowNode(e)||y.setFlowNode(e,t?s:this._currentFlowNode)}_createFlowWildcardImport(e,t){if(!this._isCodeUnreachable()){const n={flags:m.FlowFlags.WildcardImport,id:this._getUniqueFlowNodeId(),node:e,names:t,antecedent:this._currentFlowNode};this._addExceptTargets(n),this._currentFlowNode=n}y.setFlowNode(e,this._currentFlowNode)}_createFlowExhaustedMatch(e){if(!this._isCodeUnreachable()){const t={flags:m.FlowFlags.ExhaustedMatch,id:this._getUniqueFlowNodeId(),node:e,antecedent:this._currentFlowNode};this._currentFlowNode=t}y.setAfterFlowNode(e,this._currentFlowNode)}_isCodeUnreachable(){return!!(this._currentFlowNode.flags&m.FlowFlags.Unreachable)}_addExceptTargets(e){this._currentExceptTargets&&this._currentExceptTargets.forEach((t=>{this._addAntecedent(t,e)}))}_trackCodeFlowExpressions(e){const t=this._currentScopeCodeFlowExpressions;this._currentScopeCodeFlowExpressions=new Set,e();const n=this._currentScopeCodeFlowExpressions;return t&&this._currentScopeCodeFlowExpressions.forEach((e=>{t.add(e)})),this._currentScopeCodeFlowExpressions=t,n}_bindLoopStatement(e,t,n){const s=this._currentContinueTarget,i=this._currentBreakTarget;this._currentContinueTarget=e,this._currentBreakTarget=t,e.affectedExpressions=this._trackCodeFlowExpressions(n),this._currentContinueTarget=s,this._currentBreakTarget=i}_addAntecedent(e,t){this._currentFlowNode.flags&m.FlowFlags.Unreachable||e.antecedents.some((e=>e.id===t.id))||e.antecedents.push(t)}_bindNameToScope(e,t,n){return this._bindNameValueToScope(e,t.value,n)}_bindNameValueToScope(e,t,n){const s=this._currentScope.getBindingType(t);if(void 0===s){let s=e.lookUpSymbol(t);return s||(s=e.addSymbol(t,5),3!==this._currentScope.type&&4!==this._currentScope.type||(0,b.isPrivateOrProtectedName)(t)&&((0,b.isPrivateName)(t)?s.setIsExternallyHidden():this._fileInfo.isStubFile||this._fileInfo.isInPyTypedPackage?4===this._currentScope.type?s.setIsExternallyHidden():this._potentialPrivateSymbols.set(t,s):s.setIsPrivateMember()),n&&n.set(t,s)),s}{const e=(0===s?this._currentScope.parent:this._currentScope.getGlobalScope().scope).lookUpSymbolRecursive(t);if(e)return e.symbol}}_bindPossibleTupleNamedTarget(e,t){switch(e.nodeType){case 38:this._bindNameToScope(this._currentScope,e,t);break;case 52:e.expressions.forEach((e=>{this._bindPossibleTupleNamedTarget(e,t)}));break;case 31:e.entries.forEach((e=>{this._bindPossibleTupleNamedTarget(e,t)}));break;case 54:this._bindPossibleTupleNamedTarget(e.valueExpression,t);break;case 56:this._bindPossibleTupleNamedTarget(e.expression,t)}}_addImplicitSymbolToCurrentScope(e,t,n){const s=this._addSymbolToCurrentScope(e,!1);s&&(s.addDeclaration({type:0,node:t,intrinsicType:n,path:this._fileInfo.filePath,range:(0,d.getEmptyRange)(),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite}),s.setIsIgnoredForProtocolMatch())}_addSymbolToCurrentScope(e,t){let n=this._currentScope.lookUpSymbol(e);if(!n){let s=0;t&&(s|=1),2===this._currentScope.type&&(s|=4),this._fileInfo.isStubFile&&(0,b.isPrivateOrProtectedName)(e)&&(s|=2),n=this._currentScope.addSymbol(e,s)}return n}_createNewScope(e,t,n){const s=this._currentScope,i=new v.Scope(e,t);this._currentScope=i;const a=4===e||3===e||1===e,r=this._currentScopeCodeFlowExpressions;return a&&(this._currentScopeCodeFlowExpressions=new Set),n(),this._currentScopeCodeFlowExpressions=r,this._currentScope=s,i}_addInferredTypeAssignmentForVariable(e,t,n=!1){switch(e.nodeType){case 38:{const s=e,i=this._currentScope.lookUpSymbolRecursive(s.value);if(i&&i.symbol){const a={type:1,node:e,isConstant:(0,b.isConstantName)(e.value),inferredTypeSource:t,isInferenceAllowedInPyTyped:this._isInferenceAllowedInPyTyped(s.value),typeAliasName:n?e:void 0,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(s,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite,docString:this._getVariableDocString(e)};i.symbol.addDeclaration(a)}break}case 35:{const n=this._getMemberAccessInfo(e);if(n){const s=e.memberName;let i=n.classScope.lookUpSymbol(s.value);if(!i){i=n.classScope.addSymbol(s.value,1);const e="none"!==this._fileInfo.diagnosticRuleSet.reportPrivateUsage;(0,b.isPrivateOrProtectedName)(s.value)&&e&&i.setIsPrivateMember()}n.isInstanceMember?i.isClassMember()&&i.getDeclarations().some((e=>5===e.type&&e.isMethod))||i.setIsInstanceMember():i.setIsClassMember();const a={type:1,node:e.memberName,isConstant:(0,b.isConstantName)(s.value),inferredTypeSource:t,isDefinedByMemberAccess:!0,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(e.memberName,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite,docString:this._getVariableDocString(e)};i.addDeclaration(a)}break}case 52:e.expressions.forEach((e=>{this._addInferredTypeAssignmentForVariable(e,t)}));break;case 54:this._addInferredTypeAssignmentForVariable(e.valueExpression,t);break;case 56:this._addInferredTypeAssignmentForVariable(e.expression,t);break;case 31:e.entries.forEach((e=>{this._addInferredTypeAssignmentForVariable(e,t)}))}}_isInferenceAllowedInPyTyped(e){return["__match_args__","__slots__","__all__"].some((t=>t===e))}_addTypeDeclarationForVariable(e,t){var n,s,i;let a=!1;switch(e.nodeType){case 38:{const r=e,o=this._currentScope.lookUpSymbolRecursive(r.value);if(o&&o.symbol){const a=this._isAnnotationFinal(t);let l=t;a.isFinal&&(a.finalTypeNode||(l=void 0));let c=this._isAnnotationClassVar(t);if(c.isClassVar&&(c.classVarTypeNode||(l=void 0)),a.isFinal){const t=f.getEnclosingClassOrFunction(e);t&&10===t.nodeType&&(3!==(null===(n=e.parent)||void 0===n?void 0:n.nodeType)&&3!==(null===(i=null===(s=e.parent)||void 0===s?void 0:s.parent)||void 0===i?void 0:i.nodeType)||(c={isClassVar:!0,classVarTypeNode:void 0}))}const d={type:1,node:e,isConstant:(0,b.isConstantName)(r.value),isFinal:a.isFinal,typeAliasName:e,path:this._fileInfo.filePath,typeAnnotationNode:l,range:(0,p.convertTextRangeToRange)(r,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite,docString:this._getVariableDocString(e)};if(o.symbol.addDeclaration(d),c.isClassVar?o.symbol.setIsClassVar():o.symbol.setIsInstanceMember(),24===t.nodeType)if(this._isDataclassesAnnotation(t.baseExpression,"InitVar"))o.symbol.setIsInitVar();else if(this._isTypingAnnotation(t.baseExpression,"Annotated")&&t.items.length>0){const e=t.items[0].valueExpression;24===e.nodeType&&this._isDataclassesAnnotation(e.baseExpression,"InitVar")&&o.symbol.setIsInitVar()}}a=!0;break}case 35:{const n=this._getMemberAccessInfo(e);if(n){const s=e.memberName;let i=n.classScope.lookUpSymbol(s.value);if(!i){i=n.classScope.addSymbol(s.value,1);const e="none"!==this._fileInfo.diagnosticRuleSet.reportPrivateUsage;(0,b.isPrivateOrProtectedName)(s.value)&&e&&i.setIsPrivateMember()}n.isInstanceMember?i.setIsInstanceMember():i.setIsClassMember();const r=this._isAnnotationFinal(t),o={type:1,node:e.memberName,isConstant:(0,b.isConstantName)(s.value),isDefinedByMemberAccess:!0,isFinal:r.isFinal,path:this._fileInfo.filePath,typeAnnotationNode:r.isFinal&&!r.finalTypeNode?void 0:t,range:(0,p.convertTextRangeToRange)(e.memberName,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite,docString:this._getVariableDocString(e)};i.addDeclaration(o),a=!0}break}}a||this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,u.Localizer.Diagnostic.annotationNotSupported(),t)}_isTypingAnnotation(e,t){return this._isKnownAnnotation(e,t,this._typingImportAliases,this._typingSymbolAliases)}_isDataclassesAnnotation(e,t){return this._isKnownAnnotation(e,t,this._dataclassesImportAliases,this._dataclassesSymbolAliases)}_isKnownAnnotation(e,t,n,s){let i=e;if(48===i.nodeType&&i.typeAnnotation&&(i=i.typeAnnotation),38===i.nodeType){if(s.get(i.value)===t)return!0}else if(35===i.nodeType&&38===i.leftExpression.nodeType&&i.memberName.value===t){const e=i.leftExpression.value;return n.some((t=>t===e))}return!1}_getVariableDocString(e){const t=f.getVariableDocStringNode(e);if(!t)return;const n=t.strings;return 1===n.length?n[0].value:n.map((e=>e.value)).join("")}_isAnnotationFinal(e){let t,n=!1;return e&&(this._isTypingAnnotation(e,"Final")?n=!0:24===e.nodeType&&1===e.items.length&&(!this._isAnnotationFinal(e.baseExpression).isFinal||0!==e.items[0].argumentCategory||e.items[0].name||e.trailingComma||(n=!0,t=e.items[0].valueExpression))),{isFinal:n,finalTypeNode:t}}_isAnnotationClassVar(e){let t,n=!1;for(;e;){if(48===e.nodeType&&e.typeAnnotation&&(e=e.typeAnnotation),!(24===e.nodeType&&e.items.length>0&&this._isTypingAnnotation(e.baseExpression,"Annotated"))){if(this._isTypingAnnotation(e,"ClassVar")){n=!0;break}if(24===e.nodeType&&1===e.items.length){!this._isAnnotationClassVar(e.baseExpression).isClassVar||0!==e.items[0].argumentCategory||e.items[0].name||e.trailingComma||(n=!0,t=e.items[0].valueExpression);break}break}e=e.items[0].valueExpression}return{isClassVar:n,classVarTypeNode:t}}_isRequiredAnnotation(e){return!(!e||24!==e.nodeType||1!==e.items.length||!this._isTypingAnnotation(e.baseExpression,"Required"))}_isNotRequiredAnnotation(e){return!(!e||24!==e.nodeType||1!==e.items.length||!this._isTypingAnnotation(e.baseExpression,"NotRequired"))}_getMemberAccessInfo(e){if(38!==e.leftExpression.nodeType)return;const t=e.leftExpression.value,n=f.getEnclosingFunction(e);if(!n)return;const s=f.getEnclosingClass(n,!0);if(!s)return;let i=!1;if(n.parameters.length<1||!n.parameters[0].name)return;const a=s.name.value,r=n.parameters[0].name.value;if(t===a)i=!1;else{if(t!==r)return;if("__new__"===n.name.value)i=!1;else{i=!0;for(const e of n.decorators)if(38===e.expression.nodeType){const t=e.expression.value;if("staticmethod"===t)return;if("classmethod"===t){i=!1;break}}}}const l=y.getScope(s);return(0,o.assert)(void 0!==l),{classNode:s,methodNode:n,classScope:l,isInstanceMember:i}}_addImplicitImportsToLoaderActions(e,t){e.filteredImplicitImports.forEach((e=>{const n=t.implicitImports?t.implicitImports.get(e.name):void 0;n?(n.path=e.path,n.loadSymbolsFromPath=!0):(t.implicitImports||(t.implicitImports=new Map),t.implicitImports.set(e.name,{path:e.path,loadSymbolsFromPath:!0,implicitImports:new Map}))}))}_handleTypingStubAssignmentOrAnnotation(e){if(!this._fileInfo.isTypingStubFile)return!1;let t;if(54===e.nodeType)t=e;else{if(54!==e.leftExpression.nodeType)return!1;t=e.leftExpression}if(38!==t.valueExpression.nodeType)return!1;const n=t.valueExpression,s=new Set(["Tuple","Generic","Protocol","Callable","Type","ClassVar","Final","Literal","TypedDict","Union","Optional","Annotated","TypeAlias","OrderedDict","Concatenate","TypeGuard","StrictTypeGuard","Unpack","Self","NoReturn","Never","LiteralString"]),i=n.value;if(!s.has(i))return!1;const a=this._bindNameToScope(this._currentScope,t.valueExpression);return a&&a.addDeclaration({type:7,node:t,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(t,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite}),!0}_deferBinding(e){this._moduleSymbolOnly||this._deferredBindingTasks.push({scope:this._currentScope,codeFlowExpressions:this._currentScopeCodeFlowExpressions,activeTypeParams:new Map(this._activeTypeParams),callback:e})}_bindDeferred(){for(;this._deferredBindingTasks.length>0;){const e=this._deferredBindingTasks.shift();this._currentScope=e.scope,this._currentScopeCodeFlowExpressions=e.codeFlowExpressions,this._activeTypeParams=e.activeTypeParams,e.callback()}}_bindYield(e){const t=f.getEnclosingFunction(e);t?t.isAsync&&61===e.nodeType&&this._addError(u.Localizer.Diagnostic.yieldFromOutsideAsync(),e):f.getEnclosingLambda(e)||this._addError(u.Localizer.Diagnostic.yieldOutsideFunction(),e),this._targetFunctionDeclaration&&(this._targetFunctionDeclaration.yieldStatements||(this._targetFunctionDeclaration.yieldStatements=[]),this._targetFunctionDeclaration.yieldStatements.push(e),this._targetFunctionDeclaration.isGenerator=!0),e.expression&&this.walk(e.expression),y.setFlowNode(e,this._currentFlowNode)}_getUniqueFlowNodeId(){return this._codeFlowComplexity+=.05,(0,m.getUniqueFlowNodeId)()}_addDiagnostic(e,t,n,s){let i;switch(e){case"error":i=this._addError(n,s);break;case"warning":i=this._addWarning(n,s);break;case"information":i=this._addInformation(n,s);break;case"none":break;default:return(0,o.assertNever)(e,`${e} is not expected`)}return i&&i.setRule(t),i}_addError(e,t){return this._fileInfo.diagnosticSink.addDiagnosticWithTextRange("error",e,t)}_addWarning(e,t){return this._fileInfo.diagnosticSink.addDiagnosticWithTextRange("warning",e,t)}_addInformation(e,t){return this._fileInfo.diagnosticSink.addDiagnosticWithTextRange("information",e,t)}}t.Binder=C,C._unreachableFlowNode={flags:m.FlowFlags.Unreachable,id:(0,m.getUniqueFlowNodeId)()};class S extends T.ParseTreeWalker{constructor(){super(...arguments),this._containsYield=!1}checkContainsYield(e){return this.walk(e),this._containsYield}visitYield(e){return this._containsYield=!0,!1}visitYieldFrom(e){return this._containsYield=!0,!1}}t.YieldFinder=S;class x extends T.ParseTreeWalker{constructor(){super(...arguments),this._containsReturn=!1}checkContainsReturn(e){return this.walk(e),this._containsReturn}visitReturn(e){return this._containsReturn=!0,!1}}t.ReturnFinder=x},7116:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CacheManager=void 0;const s=n(5839),i=n(720);t.CacheManager=class{constructor(){this._pausedCount=0,this._cacheOwners=[]}registerCacheOwner(e){this._cacheOwners.push(e)}unregisterCacheOwner(e){const t=this._cacheOwners.findIndex((t=>t===e));t<0?(0,s.fail)("Specified cache provider not found"):this._cacheOwners.splice(t,1)}pauseTracking(){const e=this;return e._pausedCount++,{dispose(){e._pausedCount--}}}getCacheUsage(){if(this._pausedCount>0)return-1;let e=0;return this._cacheOwners.forEach((t=>{e+=t.getCacheUsage()})),e}emptyCache(e){if(e){const t=(0,i.getHeapStatistics)();e.info(`Emptying type cache to avoid heap overflow. Used ${this._convertToMB(t.used_heap_size)} out of ${this._convertToMB(t.heap_size_limit)}.`)}this._cacheOwners.forEach((e=>{e.emptyCache()}))}getUsedHeapRatio(e){const t=(0,i.getHeapStatistics)();return e&&e.info(`Heap stats: total_heap_size=${this._convertToMB(t.total_heap_size)}, used_heap_size=${this._convertToMB(t.used_heap_size)}, total_physical_size=${this._convertToMB(t.total_physical_size)}, total_available_size=${this._convertToMB(t.total_available_size)}, heap_size_limit=${this._convertToMB(t.heap_size_limit)}`),t.used_heap_size/t.heap_size_limit}_convertToMB(e){return`${Math.round(e/1048576)}MB`}}},6329:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Checker=void 0;const r=n(4494),o=n(5839),l=n(1290),c=n(9744),p=n(6657),d=n(6886),u=n(3550),y=n(3778),m=n(9866),g=n(5275),h=n(5136),f=a(n(563)),T=n(8905),v=n(2374),_=n(7012),I=n(7848),b=a(n(8494)),C=n(427),S=n(6061),x=n(8752),D=n(5083),F=n(4221),E=n(8816),P=n(8235),A=a(n(1766)),N=n(2917),k=n(7887),w=n(4610),M=n(1133),R=n(5168),O=n(4447);new Map([["Tuple",{version:d.PythonVersion.V3_9,fullName:"builtins.tuple",replacementText:"tuple"}],["List",{version:d.PythonVersion.V3_9,fullName:"builtins.list",replacementText:"list"}],["Dict",{version:d.PythonVersion.V3_9,fullName:"builtins.dict",replacementText:"dict"}],["Set",{version:d.PythonVersion.V3_9,fullName:"builtins.set",replacementText:"set"}],["FrozenSet",{version:d.PythonVersion.V3_9,fullName:"builtins.frozenset",replacementText:"frozenset"}],["Type",{version:d.PythonVersion.V3_9,fullName:"builtins.type",replacementText:"type"}],["Deque",{version:d.PythonVersion.V3_9,fullName:"collections.deque",replacementText:"collections.deque"}],["DefaultDict",{version:d.PythonVersion.V3_9,fullName:"collections.defaultdict",replacementText:"collections.defaultdict"}],["OrderedDict",{version:d.PythonVersion.V3_9,fullName:"collections.OrderedDict",replacementText:"collections.OrderedDict"}],["Counter",{version:d.PythonVersion.V3_9,fullName:"collections.Counter",replacementText:"collections.Counter"}],["ChainMap",{version:d.PythonVersion.V3_9,fullName:"collections.ChainMap",replacementText:"collections.ChainMap"}]]),new Map([["Optional",{version:d.PythonVersion.V3_10,fullName:"typing.Optional",replacementText:"| None"}],["Union",{version:d.PythonVersion.V3_10,fullName:"typing.Union",replacementText:"|"}]]);class L extends C.ParseTreeWalker{constructor(e,t,n,s,i){super(),this._importResolver=e,this._evaluator=t,this._parseResults=n,this._sourceMapper=s,this._dependentFiles=i,this._isUnboundCheckSuppressed=!1,this._scopedNodes=[],this._typeParameterLists=[],this._moduleNode=n.parseTree,this._fileInfo=f.getFileInfo(this._moduleNode)}check(){this._scopedNodes.push(this._moduleNode),this._conditionallyReportShadowedModule();f.getCodeFlowComplexity(this._moduleNode)>k.maxCodeComplexity&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.codeTooComplexToAnalyze(),{start:0,length:0}),this._walkStatementsAndReportUnreachable(this._moduleNode.statements);const e=f.getDunderAllInfo(this._moduleNode);e&&(this._evaluator.markNamesAccessed(this._moduleNode,e.names),this._reportUnusedDunderAllSymbols(e.stringNodes)),this._validateSymbolTables(),this._reportDuplicateImports(),this._checkRegions()}walk(e){f.isCodeUnreachable(e)?this._evaluator.suppressDiagnostics(e,(()=>{super.walk(e)})):super.walk(e)}visitSuite(e){return this._walkStatementsAndReportUnreachable(e.statements),!1}visitStatementList(e){return e.statements.forEach((e=>{(0,g.isExpressionNode)(e)&&(this._evaluator.getType(e),this._reportUnusedExpression(e))})),!0}visitClass(e){const t=this._evaluator.getTypeOfClass(e);return e.typeParameters&&this.walk(e.typeParameters),this.walk(e.suite),this.walkMultiple(e.decorators),this.walkMultiple(e.arguments),t&&(M.ClassType.isProtocolClass(t.classType)&&(e.arguments.forEach((e=>{if(!e.name){const n=this._evaluator.getType(e.valueExpression);n&&(0,M.isInstantiableClass)(n)&&!M.ClassType.isBuiltIn(n,"Protocol")&&!M.ClassType.isBuiltIn(n,"Generic")&&(M.ClassType.isProtocolClass(n)||this._evaluator.addError(m.Localizer.Diagnostic.protocolBaseClass().format({classType:this._evaluator.printType(t.classType),baseType:this._evaluator.printType(n)}),e.valueExpression))}})),this._validateProtocolTypeParamVariance(e,t.classType)),this._fileInfo.isStubFile||(this._validateBaseClassOverrides(t.classType),this._validateSlotsClassVarConflict(t.classType)),this._validateMultipleInheritanceCompatibility(t.classType,e.name),this._validateConstructorConsistency(t.classType),this._validateFinalMemberOverrides(t.classType),this._validateInstanceVariableInitialization(t.classType),this._validateFinalClassNotAbstract(t.classType,e),this._validateDataClassPostInit(t.classType,e),this._validateProtocolCompatibility(t.classType,e),this._reportDuplicateEnumMembers(t.classType),M.ClassType.isTypedDictClass(t.classType)&&this._validateTypedDictClassSuite(e.suite),M.ClassType.isEnumClass(t.classType)&&this._validateEnumClassOverride(e,t.classType)),this._scopedNodes.push(e),!1}visitFunction(e){var t;e.typeParameters&&this.walk(e.typeParameters),this._fileInfo.diagnosticRuleSet.analyzeUnannotatedFunctions||this._fileInfo.isStubFile||b.isUnannotatedFunction(e)&&this._evaluator.addInformation(m.Localizer.Diagnostic.unannotatedFunctionSkipped().format({name:e.name.value}),e.name);const n=this._evaluator.getTypeOfFunction(e),s=b.getEnclosingClass(e,!0);if(n){let i=!1;e.parameters.forEach(((e,t)=>{if(e.name)if(1===e.category){const t=e.typeAnnotation||e.typeAnnotationComment;if(t&&35===t.nodeType&&"args"===t.memberName.value){const e=this._evaluator.getType(t.leftExpression);e&&(0,M.isTypeVar)(e)&&e.details.isParamSpec&&(i=!0)}}else 2===e.category&&(i=!1);if(e.name&&0===e.category&&i&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.namedParamAfterParamSpecArgs().format({name:e.name.value}),e.name),e.name&&"_"!==e.name.value){const t=n.functionType.details.parameters.find((t=>{var n;return t.name===(null===(n=e.name)||void 0===n?void 0:n.value)}));if(t){const n=t.type;if("none"!==this._fileInfo.diagnosticRuleSet.reportUnknownParameterType)if((0,M.isUnknown)(n)||(0,M.isTypeVar)(n)&&n.details.isSynthesized&&!n.details.isSynthesizedSelf)this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,c.DiagnosticRule.reportUnknownParameterType,m.Localizer.Diagnostic.paramTypeUnknown().format({paramName:e.name.value}),e.name);else if((0,R.isPartlyUnknown)(n)){const t=new l.DiagnosticAddendum;t.addMessage(m.Localizer.DiagnosticAddendum.paramType().format({paramType:this._evaluator.printType(n,{expandTypeAlias:!0})})),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,c.DiagnosticRule.reportUnknownParameterType,m.Localizer.Diagnostic.paramTypePartiallyUnknown().format({paramName:e.name.value})+t.getString(),e.name)}let s=!1;(t.typeAnnotation||(0,M.isTypeVar)(n)&&n.details.isSynthesizedSelf)&&(s=!0),s||"none"===this._fileInfo.diagnosticRuleSet.reportMissingParameterType||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingParameterType,c.DiagnosticRule.reportMissingParameterType,m.Localizer.Diagnostic.paramAnnotationMissing().format({name:e.name.value}),e.name)}}}));const a=n.functionType.details.parameters.filter((e=>!!(e.typeAnnotation&&(0,M.isTypeVar)(e.type)&&(0,M.isParamSpec)(e.type)&&0!==e.category&&e.name&&e.type.paramSpecAccess)));1===a.length&&a[0].typeAnnotation&&this._evaluator.addError(m.Localizer.Diagnostic.paramSpecArgsKwargsUsage(),a[0].typeAnnotation),this._fileInfo.isStubFile&&(e.returnTypeAnnotation||(null===(t=e.functionAnnotationComment)||void 0===t?void 0:t.returnTypeAnnotation)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,c.DiagnosticRule.reportUnknownParameterType,m.Localizer.Diagnostic.returnTypeUnknown(),e.name)),s&&this._validateMethod(e,n.functionType,s)}e.parameters.forEach(((e,t)=>{if(e.defaultValue&&this.walk(e.defaultValue),e.typeAnnotation&&this.walk(e.typeAnnotation),e.typeAnnotationComment&&this.walk(e.typeAnnotationComment),n){const s=e.typeAnnotation||e.typeAnnotationComment;if(s&&t<n.functionType.details.parameters.length){const e=n.functionType.details.parameters[t].type,i=["__init__","__new__"];!(0,M.isTypeVar)(e)||3!==e.details.declaredVariance||e.details.isSynthesized||i.some((e=>e===n.functionType.details.name))||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.paramTypeCovariant(),s)}}})),e.returnTypeAnnotation&&this.walk(e.returnTypeAnnotation),e.functionAnnotationComment&&(this.walk(e.functionAnnotationComment),"none"!==this._fileInfo.diagnosticRuleSet.reportTypeCommentUsage&&this._fileInfo.executionEnvironment.pythonVersion>=d.PythonVersion.V3_5&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportTypeCommentUsage,c.DiagnosticRule.reportTypeCommentUsage,m.Localizer.Diagnostic.typeCommentDeprecated(),e.functionAnnotationComment)),this.walkMultiple(e.decorators),e.parameters.forEach((e=>{e.name&&this.walk(e.name)}));const i=f.getCodeFlowComplexity(e)>k.maxCodeComplexity;if(i?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.codeTooComplexToAnalyze(),e.name):this.walk(e.suite),n&&(i||this._validateFunctionReturn(e,n.functionType),this._validateDunderSignatures(e,n.functionType,void 0!==s),this._validateTypeGuardFunction(e,n.functionType,void 0!==s),this._validateFunctionTypeVarUsage(e,n)),this._fileInfo.isStubFile&&"__getattr__"===e.name.value){const t=(0,D.getScopeForNode)(e);3===(null==t?void 0:t.type)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompleteStub,c.DiagnosticRule.reportIncompleteStub,m.Localizer.Diagnostic.stubUsesGetAttr(),e.name)}if(this._scopedNodes.push(e),n&&(0,M.isOverloadedFunction)(n.decoratedType)&&M.OverloadedFunctionType.getImplementation(n.decoratedType)!==n.functionType){const t=M.OverloadedFunctionType.getOverloads(n.decoratedType);if(t.length>1){const n=100;t.length<n&&this._validateOverloadConsistency(e,t[t.length-1],t.slice(0,t.length-1))}}return!1}visitLambda(e){this._evaluator.getType(e),this.walkMultiple([...e.parameters,e.expression]),e.parameters.forEach((e=>{if(e.name){const t=this._evaluator.getType(e.name);t&&((0,M.isUnknown)(t)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,c.DiagnosticRule.reportUnknownLambdaType,m.Localizer.Diagnostic.paramTypeUnknown().format({paramName:e.name.value}),e.name):(0,R.isPartlyUnknown)(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,c.DiagnosticRule.reportUnknownLambdaType,m.Localizer.Diagnostic.paramTypePartiallyUnknown().format({paramName:e.name.value}),e.name))}}));const t=this._evaluator.getType(e.expression);return t&&((0,M.isUnknown)(t)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,c.DiagnosticRule.reportUnknownLambdaType,m.Localizer.Diagnostic.lambdaReturnTypeUnknown(),e.expression):(0,R.isPartlyUnknown)(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,c.DiagnosticRule.reportUnknownLambdaType,m.Localizer.Diagnostic.lambdaReturnTypePartiallyUnknown().format({returnType:this._evaluator.printType(t,{expandTypeAlias:!0})}),e.expression)),this._scopedNodes.push(e),!1}visitCall(e){var t;if(this._validateIsInstanceCall(e),this._validateIllegalDefaultParamInitializer(e),this._validateStandardCollectionInstantiation(e),("none"!==this._fileInfo.diagnosticRuleSet.reportUnusedCallResult||"none"!==this._fileInfo.diagnosticRuleSet.reportUnusedCoroutine)&&47===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)){const t=38===e.leftExpression.nodeType&&"reveal_type"===e.leftExpression.value,n=this._evaluator.getType(e);!t&&n&&this._isTypeValidForUnusedValueTest(n)&&(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnusedCallResult,c.DiagnosticRule.reportUnusedCallResult,m.Localizer.Diagnostic.unusedCallResult().format({type:this._evaluator.printType(n)}),e),(0,M.isClassInstance)(n)&&M.ClassType.isBuiltIn(n,"Coroutine")&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnusedCoroutine,c.DiagnosticRule.reportUnusedCoroutine,m.Localizer.Diagnostic.unusedCoroutine(),e))}return!0}visitAwait(e){var t;if("none"!==this._fileInfo.diagnosticRuleSet.reportUnusedCallResult&&47===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&9===e.expression.nodeType){const t=this._evaluator.getType(e);t&&this._isTypeValidForUnusedValueTest(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnusedCallResult,c.DiagnosticRule.reportUnusedCallResult,m.Localizer.Diagnostic.unusedCallResult().format({type:this._evaluator.printType(t)}),e)}return!0}visitFor(e){return this._evaluator.evaluateTypesForStatement(e),e.typeComment&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.annotationNotSupported(),e.typeComment),!0}visitList(e){return this._validateIllegalDefaultParamInitializer(e),!0}visitSet(e){return this._validateIllegalDefaultParamInitializer(e),!0}visitDictionary(e){return this._validateIllegalDefaultParamInitializer(e),!0}visitListComprehension(e){return this._scopedNodes.push(e),!0}visitListComprehensionIf(e){return this._reportUnnecessaryConditionExpression(e.testExpression),!0}visitIf(e){return this._evaluator.getType(e.testExpression),this._reportUnnecessaryConditionExpression(e.testExpression),!0}visitWhile(e){return this._evaluator.getType(e.testExpression),this._reportUnnecessaryConditionExpression(e.testExpression),!0}visitWith(e){return e.withItems.forEach((e=>{this._evaluator.evaluateTypesForStatement(e)})),e.typeComment&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.annotationNotSupported(),e.typeComment),!0}visitReturn(e){var t,n;let s;const i=b.getEnclosingFunction(e),a=i?this._evaluator.getFunctionDeclaredReturnType(i):void 0;if(s=e.returnExpression?null!==(t=this._evaluator.getTypeResult(e.returnExpression))&&void 0!==t?t:{type:M.UnknownType.create()}:{type:M.NoneType.createInstance()},(null==i?void 0:i.isAsync)&&e.returnExpression){const t=f.getDeclaration(i);5===(null==t?void 0:t.type)&&t.isGenerator&&this._evaluator.addError(m.Localizer.Diagnostic.returnInAsyncGenerator(),e.returnExpression)}if(this._evaluator.isNodeReachable(e,void 0)&&i){if(a)if((0,M.isNever)(a))this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.noReturnContainsReturn(),e);else{let t=new l.DiagnosticAddendum,i=!1;if(this._evaluator.assignType(a,s.type,t,new O.TypeVarContext,void 0,64))i=!0;else{const n=(0,R.getTypeVarArgumentsRecursive)(a);if(n&&n.some((e=>e.details.constraints.length>0))){const r=new O.TypeVarContext;for(const t of n)if(t.details.constraints.length>0){const n=this._evaluator.narrowConstrainedTypeVar(e,t);n&&(r.setTypeVarType(t,n),r.addSolveForScope((0,R.getTypeVarScopeId)(t)))}if(!r.isEmpty()){const e=(0,R.applySolvedTypeVars)(a,r);this._evaluator.assignType(e,s.type,t,void 0,void 0,64)&&(i=!0)}}}i||(s.expectedTypeDiagAddendum&&(t=s.expectedTypeDiagAddendum),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.returnTypeMismatch().format({exprType:this._evaluator.printType(s.type),returnType:this._evaluator.printType(a)})+t.getString(),e.returnExpression?e.returnExpression:e,null===(n=s.expectedTypeDiagAddendum)||void 0===n?void 0:n.getEffectiveTextRange()))}(0,M.isUnknown)(s.type)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,c.DiagnosticRule.reportUnknownVariableType,m.Localizer.Diagnostic.returnTypeUnknown(),e.returnExpression):(0,R.isPartlyUnknown)(s.type)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,c.DiagnosticRule.reportUnknownVariableType,m.Localizer.Diagnostic.returnTypePartiallyUnknown().format({returnType:this._evaluator.printType(s.type,{expandTypeAlias:!0})}),e.returnExpression)}return!0}visitYield(e){const t=e.expression?this._evaluator.getType(e.expression):M.NoneType.createInstance();return this._validateYieldType(e,t||M.UnknownType.create()),!0}visitYieldFrom(e){var t,n,s,i;const a=this._evaluator.getType(e.expression)||M.UnknownType.create();let r;if((0,M.isClassInstance)(a)&&M.ClassType.isBuiltIn(a,"Coroutine"))r=M.UnknownType.create();else{r=null!==(n=null===(t=this._evaluator.getTypeOfIterable({type:a},!1,e))||void 0===t?void 0:t.type)&&void 0!==n?n:M.UnknownType.create();const o=(0,R.getGeneratorTypeArgs)(r);r=o?o.length>=1?o[0]:M.UnknownType.create():null!==(i=null===(s=this._evaluator.getTypeOfIterator({type:a},!1,e))||void 0===s?void 0:s.type)&&void 0!==i?i:M.UnknownType.create()}return this._validateYieldType(e,r),!0}visitRaise(e){if(this._evaluator.verifyRaiseExceptionType(e),e.valueExpression){const t=this._evaluator.getBuiltInType(e,"BaseException"),n=this._evaluator.getType(e.valueExpression);if(n&&t&&(0,M.isInstantiableClass)(t)){const s=new l.DiagnosticAddendum;(0,R.doForEachSubtype)(n,(e=>{e=this._evaluator.makeTopLevelTypeVarsConcrete(e),(0,M.isAnyOrUnknown)(e)||(0,M.isNoneInstance)(e)||(0,M.isClass)(e)&&(0,R.derivesFromClassRecursive)(e,t,!1)||s.addMessage(m.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:this._evaluator.printType(e)}))})),s.isEmpty()||this._evaluator.addError(m.Localizer.Diagnostic.expectedExceptionObj()+s.getString(),e.valueExpression)}}return!0}visitExcept(e){if(e.typeExpression){this._evaluator.evaluateTypesForStatement(e);const t=this._evaluator.getType(e.typeExpression);t&&this._validateExceptionType(t,e.typeExpression)}return!0}visitAssert(e){e.exceptionExpression&&this._evaluator.getType(e.exceptionExpression);const t=this._evaluator.getType(e.testExpression);return t&&(0,M.isClassInstance)(t)&&(0,R.isTupleClass)(t)&&t.tupleTypeArguments&&t.tupleTypeArguments.length>0&&((0,R.isUnboundedTupleClass)(t)||this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportAssertAlwaysTrue,c.DiagnosticRule.reportAssertAlwaysTrue,m.Localizer.Diagnostic.assertAlwaysTrue(),e.testExpression)),!0}visitAssignment(e){if(this._evaluator.evaluateTypesForStatement(e),e.typeAnnotationComment&&(this._evaluator.getType(e.typeAnnotationComment),"none"!==this._fileInfo.diagnosticRuleSet.reportTypeCommentUsage&&this._fileInfo.executionEnvironment.pythonVersion>=d.PythonVersion.V3_6&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportTypeCommentUsage,c.DiagnosticRule.reportTypeCommentUsage,m.Localizer.Diagnostic.typeCommentDeprecated(),e.typeAnnotationComment)),54===e.leftExpression.nodeType){const t=this._evaluator.getTypeOfAnnotation(e.leftExpression.typeAnnotation);if((0,M.isClassInstance)(t)&&M.ClassType.isBuiltIn(t,"TypeAlias")){const t=(0,D.getScopeForNode)(e);t&&2!==t.type&&3!==t.type&&4!==t.type&&this._evaluator.addError(m.Localizer.Diagnostic.typeAliasNotInModuleOrClass(),e.leftExpression.typeAnnotation)}}return!0}visitAssignmentExpression(e){return this._evaluator.getType(e),!0}visitAugmentedAssignment(e){return this._evaluator.evaluateTypesForStatement(e),!0}visitIndex(e){this._evaluator.getType(e);const t=this._evaluator.getType(e.baseExpression);return t&&(0,R.doForEachSubtype)(t,(t=>{if((0,M.isClassInstance)(t)&&t.tupleTypeArguments&&!(0,R.isUnboundedTupleClass)(t)){const n=t.tupleTypeArguments.length;if(1===e.items.length&&!e.trailingComma&&0===e.items[0].argumentCategory&&!e.items[0].name){const s=this._evaluator.getType(e.items[0].valueExpression);s&&(0,M.isClassInstance)(s)&&M.ClassType.isBuiltIn(s,"int")&&(0,R.isLiteralType)(s)&&"number"==typeof s.literalValue&&(s.literalValue>=0&&s.literalValue>=n||s.literalValue<0&&s.literalValue+n<0)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.tupleIndexOutOfRange().format({index:s.literalValue,type:this._evaluator.printType(t)}),e)}}})),!0}visitBinaryOperation(e){return 12===e.operator||28===e.operator?b.isWithinAssertExpression(e)||this._validateComparisonTypes(e):39===e.operator||40===e.operator?b.isWithinAssertExpression(e)||this._validateComparisonTypesForIsOperator(e):41!==e.operator&&42!==e.operator||b.isWithinAssertExpression(e)||this._validateContainmentTypes(e),this._evaluator.getType(e),!0}visitSlice(e){return this._evaluator.getType(e),!0}visitUnpack(e){return this._evaluator.getType(e),!0}visitTuple(e){return this._evaluator.getType(e),!0}visitUnaryOperation(e){return this._evaluator.getType(e),!0}visitTernary(e){return this._evaluator.getType(e),this._reportUnnecessaryConditionExpression(e.testExpression),!0}visitStringList(e){for(const t of e.strings)t.hasUnescapeErrors&&(0,h.getUnescapedString)(t.token).unescapeErrors.forEach((e=>{const n={start:t.token.start+t.token.prefixLength+t.token.quoteMarkLength+e.offset,length:e.length};0===e.errorType?this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportInvalidStringEscapeSequence,c.DiagnosticRule.reportInvalidStringEscapeSequence,m.Localizer.Diagnostic.stringUnsupportedEscape(),n):1===e.errorType?this._evaluator.addDiagnosticForTextRange(this._fileInfo,"error","",m.Localizer.Diagnostic.formatStringEscape(),n):2===e.errorType?this._evaluator.addDiagnosticForTextRange(this._fileInfo,"error","",m.Localizer.Diagnostic.formatStringBrace(),n):3===e.errorType&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,"error","",m.Localizer.Diagnostic.formatStringUnterminated(),n)}));return e.typeAnnotation&&this._evaluator.getType(e),e.strings.length>1&&!e.isParenthesized&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportImplicitStringConcatenation,c.DiagnosticRule.reportImplicitStringConcatenation,m.Localizer.Diagnostic.implicitStringConcat(),e),!0}visitFormatString(e){return e.expressions.forEach((e=>{this._evaluator.getType(e)})),!0}visitGlobal(e){return this._suppressUnboundCheck((()=>{e.nameList.forEach((e=>{this._evaluator.getType(e),this.walk(e)}))})),!1}visitNonlocal(e){return this._suppressUnboundCheck((()=>{e.nameList.forEach((e=>{this._evaluator.getType(e),this.walk(e)}))})),!1}visitName(e){this._conditionallyReportPrivateUsage(e),this._isUnboundCheckSuppressed||this._reportUnboundName(e);const t=this._evaluator.getType(e);return this._reportDeprecatedUse(e,t),!0}visitDel(e){return e.expressions.forEach((e=>{this._evaluator.verifyDeleteExpression(e),this.walk(e)})),!1}visitMemberAccess(e){const t=this._evaluator.getType(e);return this._reportDeprecatedUse(e.memberName,t),this._conditionallyReportPrivateUsage(e.memberName),this.walk(e.leftExpression),!1}visitImportAs(e){return this._conditionallyReportShadowedImport(e),this._evaluator.evaluateTypesForStatement(e),!0}visitImportFrom(e){if(0===e.module.leadingDots&&1===e.module.nameParts.length&&"__future__"===e.module.nameParts[0].value&&(b.isValidLocationForFutureImport(e)||this._evaluator.addError(m.Localizer.Diagnostic.futureImportLocationNotAllowed(),e)),this._conditionallyReportShadowedImport(e),e.isWildcardImport){const t=f.getImportInfo(e.module);t&&t.isImportFound&&2!==t.importType&&!this._fileInfo.isStubFile&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportWildcardImportFromLibrary,c.DiagnosticRule.reportWildcardImportFromLibrary,m.Localizer.Diagnostic.wildcardLibraryImport(),e.wildcardToken||e)}else e.imports.forEach((e=>{this._evaluator.evaluateTypesForStatement(e)}));return!0}visitImportFromAs(e){var t;if(this._fileInfo.isStubFile)return!1;const n=this._evaluator.getDeclarationsForNameNode(e.name);if(!n)return!1;for(const t of n){if(!(0,T.isAliasDeclaration)(t)||!t.submoduleFallback||t.node!==e)continue;const n=this._evaluator.resolveAliasDeclaration(t,!0);if(!(null==n?void 0:n.path)||!(0,E.isStubFile)(n.path))continue;const s=this._getImportResult(e,n.path);if(s){this._addMissingModuleSourceDiagnosticIfNeeded(s,e.name);break}}const s=this._evaluator.getType(null!==(t=e.alias)&&void 0!==t?t:e.name);return this._reportDeprecatedUse(e.name,s),!1}visitModuleName(e){if(this._fileInfo.isStubFile)return!1;const t=f.getImportInfo(e);return(0,o.assert)(void 0!==t),this._addMissingModuleSourceDiagnosticIfNeeded(t,e),!1}visitTypeParameterList(e){return this._typeParameterLists.push(e),!0}visitTypeParameter(e){return!1}visitTypeAnnotation(e){return this._evaluator.getType(e.typeAnnotation),!0}visitMatch(e){return this._evaluator.getType(e.subjectExpression),this._validateExhaustiveMatch(e),!0}visitCase(e){return e.guardExpression&&this._evaluator.getType(e.guardExpression),this._evaluator.evaluateTypesForStatement(e.pattern),!0}visitPatternClass(e){return(0,S.validateClassPattern)(this._evaluator,e),!0}visitTry(e){return this._reportUnusedExceptStatements(e),!0}visitError(e){return e.child&&this._evaluator.getType(e.child),!1}_getImportResult(e,t){const n=this._importResolver.getConfigOptions().findExecEnvironment(t),s=0===e.parent.module.leadingDots?this._importResolver.getModuleNameForImport(t,n).moduleName:(0,_.getRelativeModuleName)(this._importResolver.fileSystem,this._fileInfo.filePath,t);if(s)return this._importResolver.resolveImport(this._fileInfo.filePath,n,(0,v.createImportedModuleDescriptor)(s))}_addMissingModuleSourceDiagnosticIfNeeded(e,t){!e.isNativeLib&&e.isStubFile&&0!==e.importType&&e.nonStubImportResult&&!e.nonStubImportResult.isImportFound&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingModuleSource,c.DiagnosticRule.reportMissingModuleSource,m.Localizer.Diagnostic.importSourceResolveFailure().format({importName:e.importName}),t)}_reportUnnecessaryConditionExpression(e){if(7===e.nodeType)return void(36!==e.operator&&37!==e.operator||(this._reportUnnecessaryConditionExpression(e.leftExpression),this._reportUnnecessaryConditionExpression(e.rightExpression)));if(55===e.nodeType)return void(38===e.operator&&this._reportUnnecessaryConditionExpression(e.expression));const t=this._evaluator.getTypeOfExpression(e);let n=!0;(0,R.doForEachSubtype)(t.type,(e=>{e=this._evaluator.makeTopLevelTypeVarsConcrete(e),(0,M.isFunction)(e)||(0,M.isOverloadedFunction)(e)||(n=!1)})),n&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryComparison,c.DiagnosticRule.reportUnnecessaryComparison,m.Localizer.Diagnostic.functionInConditionalExpression(),e)}_reportUnusedExpression(e){var t,n;if("none"===this._fileInfo.diagnosticRuleSet.reportUnusedExpression)return;let s=!1;[55,7,40,11,38,52].some((t=>t===e.nodeType))?s=!0:31!==e.nodeType&&45!==e.nodeType&&15!==e.nodeType||e.entries.some((e=>32===e.nodeType))||(s=!0),s&&this._fileInfo.ipythonMode===F.IPythonMode.CellDocs&&47===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&e.parent.statements[e.parent.statements.length-1]===e&&36===(null===(n=e.parent.parent)||void 0===n?void 0:n.nodeType)&&e.parent.parent.statements[e.parent.parent.statements.length-1]===e.parent&&(s=!1),s&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnusedExpression,c.DiagnosticRule.reportUnusedExpression,m.Localizer.Diagnostic.unusedExpression(),e)}_validateExhaustiveMatch(e){if("none"===this._fileInfo.diagnosticRuleSet.reportMatchNotExhaustive)return;const t=this._evaluator.evaluateTypeForSubnode(e,(()=>{this._evaluator.evaluateTypesForMatchStatement(e)}));if(t&&!(0,M.isNever)(t.type)){const n=new l.DiagnosticAddendum;n.addMessage(m.Localizer.DiagnosticAddendum.matchIsNotExhaustiveType().format({type:this._evaluator.printType(t.type)})),n.addMessage(m.Localizer.DiagnosticAddendum.matchIsNotExhaustiveHint()),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMatchNotExhaustive,c.DiagnosticRule.reportMatchNotExhaustive,m.Localizer.Diagnostic.matchIsNotExhaustive()+n.getString(),e.subjectExpression)}}_suppressUnboundCheck(e){const t=this._isUnboundCheckSuppressed;this._isUnboundCheckSuppressed=!0;try{e()}finally{this._isUnboundCheckSuppressed=t}}_validateIllegalDefaultParamInitializer(e){"none"!==this._fileInfo.diagnosticRuleSet.reportCallInDefaultInitializer&&b.isWithinDefaultParamInitializer(e)&&!this._fileInfo.isStubFile&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportCallInDefaultInitializer,c.DiagnosticRule.reportCallInDefaultInitializer,m.Localizer.Diagnostic.defaultValueContainsCall(),e)}_validateStandardCollectionInstantiation(e){const t=this._evaluator.getType(e.leftExpression);t&&(0,M.isInstantiableClass)(t)&&M.ClassType.isBuiltIn(t)&&!t.includeSubclasses&&t.aliasName&&["List","Set","Dict","Tuple"].some((e=>e===t.aliasName))&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.collectionAliasInstantiation().format({type:t.aliasName,alias:t.details.name}),e.leftExpression)}_validateContainmentTypes(e){const t=this._evaluator.getType(e.leftExpression),n=this._evaluator.getType(e.rightExpression);if(!t||!n)return;if((0,M.isNever)(t)||(0,M.isNever)(n))return;const s=(0,w.getElementTypeForContainerNarrowing)(n);if(!s)return;const i=(0,w.narrowTypeForContainerElementType)(this._evaluator,t,this._evaluator.makeTopLevelTypeVarsConcrete(s));if((0,M.isNever)(i)){const n=()=>41===e.operator?m.Localizer.Diagnostic.containmentAlwaysFalse():m.Localizer.Diagnostic.containmentAlwaysTrue();this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryContains,c.DiagnosticRule.reportUnnecessaryContains,n().format({leftType:this._evaluator.printType(t,{expandTypeAlias:!0}),rightType:this._evaluator.printType(s,{expandTypeAlias:!0})}),e)}}_validateComparisonTypesForIsOperator(e){const t=this._evaluator.getType(e.rightExpression);if(!t||!(0,M.isNoneInstance)(t))return;const n=this._evaluator.getType(e.leftExpression);if(!n)return;let s=!1;(0,R.doForEachSubtype)(n,(e=>{e=this._evaluator.makeTopLevelTypeVarsConcrete(e),this._evaluator.assignType(e,M.NoneType.createInstance())&&(s=!0)})),s||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryComparison,c.DiagnosticRule.reportUnnecessaryComparison,(39===e.operator?m.Localizer.Diagnostic.comparisonAlwaysFalse():m.Localizer.Diagnostic.comparisonAlwaysTrue()).format({leftType:this._evaluator.printType(n,{expandTypeAlias:!0}),rightType:this._evaluator.printType(t)}),e)}_validateComparisonTypes(e){let t=e.rightExpression;7===t.nodeType&&!t.parenthesized&&b.operatorSupportsChaining(t.operator)&&(t=t.leftExpression);const n=this._evaluator.getType(e.leftExpression),s=this._evaluator.getType(t);if(!n||!s)return;if((0,M.isNever)(n)||(0,M.isNever)(s))return;const i=()=>12===e.operator?m.Localizer.Diagnostic.comparisonAlwaysFalse():m.Localizer.Diagnostic.comparisonAlwaysTrue();if((0,R.isLiteralTypeOrUnion)(s)&&(0,R.isLiteralTypeOrUnion)(n)){if(void 0===(0,P.evaluateStaticBoolExpression)(e,this._fileInfo.executionEnvironment,this._fileInfo.definedConstants)){let t=!1;(0,R.doForEachSubtype)(n,(e=>{this._evaluator.assignType(s,e)&&(t=!0)})),t||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryComparison,c.DiagnosticRule.reportUnnecessaryComparison,i().format({leftType:this._evaluator.printType(n,{expandTypeAlias:!0}),rightType:this._evaluator.printType(s,{expandTypeAlias:!0})}),e)}}else{let t=!1;if((0,R.doForEachSubtype)(n,(e=>{t||(e=this._evaluator.makeTopLevelTypeVarsConcrete(e),(0,R.doForEachSubtype)(s,(n=>{t||(n=this._evaluator.makeTopLevelTypeVarsConcrete(n),this._isTypeComparable(e,n)&&(t=!0))})))})),!t){const t=this._evaluator.printType(n,{expandTypeAlias:!0}),a=this._evaluator.printType(s,{expandTypeAlias:!0});this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryComparison,c.DiagnosticRule.reportUnnecessaryComparison,i().format({leftType:t,rightType:a}),e)}}}_isTypeComparable(e,t){if((0,M.isAnyOrUnknown)(e)||(0,M.isAnyOrUnknown)(t))return!0;if((0,M.isNever)(e)||(0,M.isNever)(t))return!1;if((0,M.isModule)(e)||(0,M.isModule)(t))return(0,M.isTypeSame)(e,t);if((0,M.isNoneInstance)(e)||(0,M.isNoneInstance)(t))return(0,M.isTypeSame)(e,t);if(((0,M.isFunction)(e)||(0,M.isOverloadedFunction)(e))!==((0,M.isFunction)(t)||(0,M.isOverloadedFunction)(t)))return!1;if((0,M.isInstantiableClass)(e)||(0,M.isClassInstance)(e)&&M.ClassType.isBuiltIn(e,"type")){if((0,M.isInstantiableClass)(t)||(0,M.isClassInstance)(t)&&M.ClassType.isBuiltIn(t,"type")){const n=M.ClassType.cloneForSpecialization(e,void 0,!1),s=M.ClassType.cloneForSpecialization(t,void 0,!1);if(this._evaluator.assignType(n,s)||this._evaluator.assignType(s,n))return!0}const n=e.details.effectiveMetaclass;return!!(n&&(0,M.isClass)(n)&&(0,R.lookUpClassMember)(n,"__eq__",4))}if((0,M.isClassInstance)(e)){if((0,M.isClassInstance)(t)){const n=M.ClassType.cloneForSpecialization(e,void 0,!1),s=M.ClassType.cloneForSpecialization(t,void 0,!1);if(this._evaluator.assignType(n,s)||this._evaluator.assignType(s,n))return!0;if(M.ClassType.isBuiltIn(e)&&M.ClassType.isBuiltIn(t))return!1}const n=(0,R.lookUpClassMember)(M.ClassType.cloneAsInstantiable(e),"__eq__",4);return!(!n||M.ClassType.isDataClass(e)&&n.symbol.getSynthesizedType())}return!0}_isTypeValidForUnusedValueTest(e){return!(0,M.isNoneInstance)(e)&&!(0,M.isNever)(e)&&!(0,M.isAnyOrUnknown)(e)}_validateFunctionTypeVarUsage(e,t){if("none"===this._fileInfo.diagnosticRuleSet.reportInvalidTypeVarUse)return;const n=t.functionType,s=new Map,i=new Map;let a,r,o=!0;if(M.FunctionType.isInstanceMethod(n)&&"__init__"===e.name.value){const t=b.getEnclosingClassOrFunction(e);if(t&&10===t.nodeType){const e=this._evaluator.getTypeOfClass(t);e&&(0,M.isClass)(e.classType)&&(r=e.classType)}}const p=new b.NameNodeWalker(((t,n,l)=>{var c,p,d,u,y,m;const g=this._evaluator.getType(t);if(g&&(0,M.isTypeVar)(g)&&!g.details.isSynthesizedSelf){if(g.scopeId===this._evaluator.getScopeIdForNode(e)){let e=g.details.constraints.length>0||!!g.details.defaultType||o&&void 0!==g.details.boundType&&void 0!==n||(0,M.isParamSpec)(g);if(!e&&l&&void 0!==n){const t=this._evaluator.getType(l);(null==t?void 0:t.typeAliasInfo)&&t.typeAliasInfo.typeParameters&&n<t.typeAliasInfo.typeParameters.length&&(e=!0)}const i=s.get(g.details.name),r=18===(null===(c=null==a?void 0:a.defaultValue)||void 0===c?void 0:c.nodeType);i?(i.nodes.push(t),void 0!==a?(i.paramTypeUsageCount+=1,r&&(i.paramTypeWithEllipsisUsageCount+=1,i.paramWithEllipsis||(i.paramWithEllipsis=null===(d=null==a?void 0:a.name)||void 0===d?void 0:d.value))):i.returnTypeUsageCount+=1):s.set(g.details.name,{nodes:[t],paramTypeUsageCount:void 0!==a?1:0,paramTypeWithEllipsisUsageCount:r?1:0,returnTypeUsageCount:void 0===a?1:0,paramWithEllipsis:r?null===(p=null==a?void 0:a.name)||void 0===p?void 0:p.value:void 0,isExempt:e})}if(r&&g.scopeId===r.details.typeVarScopeId){const e=i.get(g.details.name),n=18===(null===(u=null==a?void 0:a.defaultValue)||void 0===u?void 0:u.nodeType),s=!!g.details.defaultType;e?(e.nodes.push(t),void 0!==a&&(e.paramTypeUsageCount+=1,n&&(e.paramTypeWithEllipsisUsageCount+=1,e.paramWithEllipsis||(e.paramWithEllipsis=null===(m=null==a?void 0:a.name)||void 0===m?void 0:m.value)))):i.set(g.details.name,{nodes:[t],paramTypeUsageCount:void 0!==a?1:0,paramTypeWithEllipsisUsageCount:n?1:0,returnTypeUsageCount:0,paramWithEllipsis:n?null===(y=null==a?void 0:a.name)||void 0===y?void 0:y.value:void 0,isExempt:s})}}}));e.parameters.forEach((e=>{const t=e.typeAnnotation||e.typeAnnotationComment;t&&(a=e,p.walk(t))})),a=void 0,e.returnTypeAnnotation&&(o=!1,p.walk(e.returnTypeAnnotation)),s.forEach((e=>{var s;1!==e.nodes.length||e.isExempt||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidTypeVarUse,c.DiagnosticRule.reportInvalidTypeVarUse,m.Localizer.Diagnostic.typeVarUsedOnlyOnce().format({name:e.nodes[0].value}),e.nodes[0]);let i=e.returnTypeUsageCount>0;if(1===e.returnTypeUsageCount&&n.details.declaredReturnType){const t=n.details.declaredReturnType;(0,M.isUnion)(t)&&t.subtypes.some((t=>(0,M.isTypeVar)(t)&&t.details.name===e.nodes[0].value))&&(i=!1)}const a=(0,M.isOverloadedFunction)(t.decoratedType)&&!M.FunctionType.isOverloaded(t.functionType);if(i&&e.paramTypeWithEllipsisUsageCount>0&&e.paramTypeUsageCount===e.paramTypeWithEllipsisUsageCount&&!a){const t=new l.DiagnosticAddendum;t.addMessage(m.Localizer.DiagnosticAddendum.typeVarUnsolvableRemedy()),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidTypeVarUse,c.DiagnosticRule.reportInvalidTypeVarUse,m.Localizer.Diagnostic.typeVarPossiblyUnsolvable().format({name:e.nodes[0].value,param:null!==(s=e.paramWithEllipsis)&&void 0!==s?s:""})+t.getString(),e.nodes[0])}})),i.forEach((e=>{var t;if(e.paramTypeWithEllipsisUsageCount>0&&e.paramTypeUsageCount===e.paramTypeWithEllipsisUsageCount&&!e.isExempt){const n=new l.DiagnosticAddendum;n.addMessage(m.Localizer.DiagnosticAddendum.typeVarUnsolvableRemedy()),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidTypeVarUse,c.DiagnosticRule.reportInvalidTypeVarUse,m.Localizer.Diagnostic.typeVarPossiblyUnsolvable().format({name:e.nodes[0].value,param:null!==(t=e.paramWithEllipsis)&&void 0!==t?t:""})+n.getString(),e.nodes[0])}}))}_validateOverloadConsistency(e,t,n){for(let s=0;s<n.length;s++){const i=n[s];if(this._isOverlappingOverload(t,i)){this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportOverlappingOverload,c.DiagnosticRule.reportOverlappingOverload,m.Localizer.Diagnostic.overlappingOverload().format({name:e.name.value,obscured:n.length+1,obscuredBy:s+1}),e.name);break}}for(let s=0;s<n.length;s++){const i=n[s];if(this._isOverlappingOverload(i,t)){const a=M.FunctionType.getSpecializedReturnType(i),r=M.FunctionType.getSpecializedReturnType(t);if(a&&r&&!this._evaluator.assignType(r,a,void 0,new O.TypeVarContext,void 0,520)){const t=this._findNodeForOverload(e,i);this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportOverlappingOverload,c.DiagnosticRule.reportOverlappingOverload,m.Localizer.Diagnostic.overloadReturnTypeMismatch().format({name:e.name.value,newIndex:n.length+1,prevIndex:s+1}),(t||e).name);break}}}}_findNodeForOverload(e,t){const n=this._evaluator.getDeclarationsForNameNode(e.name);if(n)for(const e of n)if(5===e.type){const n=this._evaluator.getTypeOfFunction(e.node);if((null==n?void 0:n.functionType)===t)return e.node}}_isOverlappingOverload(e,t){return(!M.FunctionType.isInstanceMethod(e)||"__get__"!==e.details.name)&&this._evaluator.assignType(e,t,void 0,new O.TypeVarContext((0,R.getTypeVarScopeId)(e)),void 0,56)}_isLegalOverloadImplementation(e,t,n){var s;const i=new O.TypeVarContext((0,R.getTypeVarScopeId)(t)),a=new O.TypeVarContext((0,R.getTypeVarScopeId)(e));let r=this._evaluator.assignType(e,t,n,a,i,290);const o=null!==(s=e.details.declaredReturnType)&&void 0!==s?s:this._evaluator.getFunctionInferredReturnType(e),c=(0,R.applySolvedTypeVars)(t.details.declaredReturnType||this._evaluator.getFunctionInferredReturnType(t),i),p=new l.DiagnosticAddendum;return(0,M.isNever)(o)||this._evaluator.assignType(c,o,p.createAddendum(),i,a,8)||(p.addMessage(m.Localizer.DiagnosticAddendum.functionReturnTypeMismatch().format({sourceType:this._evaluator.printType(o),destType:this._evaluator.printType(c)})),null==n||n.addAddendum(p),r=!1),r}_walkStatementsAndReportUnreachable(e){let t,n=!1;for(const s of e){if(!n&&!this._evaluator.isNodeReachable(s,t)){const t=s.start,i=e[e.length-1],a=u.TextRange.getEnd(i);this._evaluator.addUnreachableCode(s,{start:t,length:a-t}),n=!0}!n&&this._fileInfo.isStubFile&&this._validateStubStatement(s),this.walk(s),t=s}}_validateStubStatement(e){switch(e.nodeType){case 19:case 28:case 10:case 0:break;case 57:case 26:case 53:case 58:this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidStubStatement,c.DiagnosticRule.reportInvalidStubStatement,m.Localizer.Diagnostic.invalidStubStatement(),e);break;case 47:for(const t of e.statements){let e=!0;switch(t.nodeType){case 2:case 4:case 6:case 7:case 11:case 14:case 15:case 24:case 26:case 27:case 29:case 30:case 31:case 35:case 38:case 39:case 40:case 43:case 44:case 45:case 46:case 51:case 52:case 53:case 55:case 56:case 57:case 58:case 59:case 60:case 61:e=!1;break;case 5:e=1===t.operator&&38===t.leftExpression.nodeType&&"__all__"===t.leftExpression.value;break;case 9:e=35===t.leftExpression.nodeType&&38===t.leftExpression.leftExpression.nodeType&&"__all__"===t.leftExpression.leftExpression.value}e||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidStubStatement,c.DiagnosticRule.reportInvalidStubStatement,m.Localizer.Diagnostic.invalidStubStatement(),t)}}}_validateExceptionType(e,t){var n,s;const i=this._evaluator.getBuiltInType(t,"BaseException"),a=e=>!i||!(0,M.isInstantiableClass)(i)||(0,R.derivesFromClassRecursive)(e,i,!1),r=new l.DiagnosticAddendum;let o;if((0,M.isAnyOrUnknown)(e))o=e;else if((0,M.isInstantiableClass)(e))a(e)||r.addMessage(m.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:this._evaluator.printType(e)})),o=M.ClassType.cloneAsInstance(e);else if((0,M.isClassInstance)(e)){const i=null!==(s=null===(n=this._evaluator.getTypeOfIterator({type:e},!1,t))||void 0===n?void 0:n.type)&&void 0!==s?s:M.UnknownType.create();o=(0,R.mapSubtypes)(i,(t=>(0,M.isAnyOrUnknown)(t)?t:(0,M.isInstantiableClass)(t)?(a(t)||r.addMessage(m.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:this._evaluator.printType(e)})),M.ClassType.cloneAsInstance(t)):(r.addMessage(m.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:this._evaluator.printType(e)})),M.UnknownType.create())))}return r.isEmpty()||this._evaluator.addError(m.Localizer.Diagnostic.exceptionTypeNotClass().format({type:this._evaluator.printType(e)}),t),o||M.UnknownType.create()}_reportUnusedDunderAllSymbols(e){if("none"===this._fileInfo.diagnosticRuleSet.reportUnsupportedDunderAll)return;const t=f.getScope(this._moduleNode);t&&e.forEach((e=>{t.symbolTable.has(e.value)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnsupportedDunderAll,c.DiagnosticRule.reportUnsupportedDunderAll,m.Localizer.Diagnostic.dunderAllSymbolNotPresent().format({name:e.value}),e)}))}_validateSymbolTables(){var e;const t=null===(e=this._dependentFiles)||void 0===e?void 0:e.map((e=>f.getFileInfo(e.parseTree)));for(const e of this._scopedNodes){const n=f.getScope(e);n&&n.symbolTable.forEach(((e,s)=>{this._conditionallyReportUnusedSymbol(s,e,n.type,t),this._reportIncompatibleDeclarations(s,e),this._reportMultipleFinalDeclarations(s,e,n.type),this._reportMultipleTypeAliasDeclarations(s,e),this._reportInvalidOverload(s,e)}))}const n=this._fileInfo.accessedSymbolSet;for(const e of this._typeParameterLists)for(const t of e.parameters){const e=f.getTypeParameterSymbol(t.name);(0,o.assert)(e),n.has(e.id)||e.getDeclarations().forEach((e=>{this._conditionallyReportUnusedDeclaration(e,!1)}))}}_reportInvalidOverload(e,t){const n=t.getTypedDeclarations();if(n.length>=1){const s=n[0];if(5===s.type){const n=this._evaluator.getEffectiveTypeOfSymbol(t),i=(0,M.isOverloadedFunction)(n)?M.OverloadedFunctionType.getOverloads(n):(0,M.isFunction)(n)&&M.FunctionType.isOverloaded(n)?[n]:[];if(1===i.length&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.singleOverload().format({name:e}),s.node.name),i.forEach((t=>{if(t.details.declaration&&!b.isFunctionSuiteEmpty(t.details.declaration.node)){const n=new l.DiagnosticAddendum;n.addMessage(m.Localizer.DiagnosticAddendum.overloadWithImplementation()),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.overloadWithImplementation().format({name:e})+n.getString(),t.details.declaration.node.name)}})),!this._fileInfo.isStubFile&&i.length>0){let t;if((0,M.isOverloadedFunction)(n)&&M.OverloadedFunctionType.getImplementation(n)?t=M.OverloadedFunctionType.getImplementation(n):(0,M.isFunction)(n)&&!M.FunctionType.isOverloaded(n)&&(t=n),t)(0,M.isOverloadedFunction)(n)&&M.OverloadedFunctionType.getOverloads(n).forEach(((n,i)=>{var a,r,o,p;const d=new l.DiagnosticAddendum;if(!this._isLegalOverloadImplementation(n,t,d)&&t.details.declaration){const l=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.overloadImplementationMismatch().format({name:e,index:i+1})+d.getString(),t.details.declaration.node.name);l&&n.details.declaration&&l.addRelatedInfo(m.Localizer.DiagnosticAddendum.overloadSignature(),null!==(r=null===(a=n.details.declaration)||void 0===a?void 0:a.path)&&void 0!==r?r:s.path,null!==(p=null===(o=n.details.declaration)||void 0===o?void 0:o.range)&&void 0!==p?p:s.range)}}));else{let e=!1;const t=b.getEnclosingClassOrFunction(s.node);if(t&&10===t.nodeType){const n=this._evaluator.getTypeOfClass(t);n&&M.ClassType.isProtocolClass(n.classType)&&(e=!0)}e||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.overloadWithoutImplementation().format({name:s.node.name.value}),s.node.name)}}}}}_reportMultipleFinalDeclarations(e,t,n){if(!this._evaluator.isFinalVariable(t))return;const s=t.getDeclarations();let i=!1,a=!1;if(s.forEach((t=>{this._evaluator.isFinalVariableDeclaration(t)&&(i&&this._evaluator.addError(m.Localizer.Diagnostic.finalRedeclaration().format({name:e}),t.node),i=!0),1===t.type&&t.inferredTypeSource&&(a&&2!==n&&this._evaluator.addError(m.Localizer.Diagnostic.finalReassigned().format({name:e}),t.node),a=!0)})),!a&&!this._fileInfo.isStubFile){const n=s.find((e=>1===e.type&&e.isFinal));if(n){let s=!1;if(t.isClassMember()&&!t.isClassVar()){const e=b.getEnclosingClass(n.node,!0);if(e){const t=this._evaluator.getTypeOfClass(e);t&&(0,M.isClass)(t.decoratedType)&&M.ClassType.isDataClass(t.decoratedType)&&(s=!0)}}s||this._evaluator.addError(m.Localizer.Diagnostic.finalUnassigned().format({name:e}),n.node)}}}_reportMultipleTypeAliasDeclarations(e,t){const n=t.getDeclarations(),s=n.find((e=>this._evaluator.isExplicitTypeAliasDeclaration(e)));s&&n.length>1&&n.forEach((t=>{t!==s&&this._evaluator.addError(m.Localizer.Diagnostic.typeAliasRedeclared().format({name:e}),t.node)}))}_reportIncompatibleDeclarations(e,t){var n,s,i,a;const r=(0,N.getLastTypedDeclaredForSymbol)(t);if(!r)return;if("_"===e)return;let o,l=t.getDeclarations().filter((e=>e!==r));if(5===r.type){const e=this._evaluator.getTypeOfFunction(r.node);l=l.filter((t=>{if(5!==t.type)return!0;const n=this._evaluator.getTypeOfFunction(t.node);if(!n)return!0;const s=e?this._evaluator.makeTopLevelTypeVarsConcrete(e.decoratedType):void 0;return s&&(0,M.isClassInstance)(s)&&M.ClassType.isPropertyClass(s)&&(0,M.isClassInstance)(n.decoratedType)&&M.ClassType.isPropertyClass(n.decoratedType)?n.decoratedType.details.typeSourceId!==s.details.typeSourceId:!M.FunctionType.isOverloaded(n.functionType)}))}if(0===l.length)return;o=5===r.type?r.isMethod?m.Localizer.DiagnosticAddendum.seeMethodDeclaration():m.Localizer.DiagnosticAddendum.seeFunctionDeclaration():6===r.type?m.Localizer.DiagnosticAddendum.seeClassDeclaration():2===r.type?m.Localizer.DiagnosticAddendum.seeParameterDeclaration():1===r.type?m.Localizer.DiagnosticAddendum.seeVariableDeclaration():4===r.type?m.Localizer.DiagnosticAddendum.seeTypeAliasDeclaration():m.Localizer.DiagnosticAddendum.seeDeclaration();const p=e=>{if(e){let t;5===r.type||6===r.type?t=r.node.name:1===r.type?38===r.node.nodeType&&(t=r.node):2!==r.type&&3!==r.type||r.node.name&&(t=r.node.name),t&&e.addRelatedInfo(o,r.path,r.range)}};for(const t of l)if(6===t.type){let n=!1;3===r.type&&(n=!0),n||p(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.obscuredClassDeclaration().format({name:e}),t.node.name))}else if(5===t.type){const i=null===(n=this._evaluator.getTypeForDeclaration(r))||void 0===n?void 0:n.type;let a=!1;i&&(0,M.isFunction)(i)&&this._evaluator.getFunctionInferredReturnType(i);const o=null===(s=this._evaluator.getTypeForDeclaration(t))||void 0===s?void 0:s.type,l=b.getEnclosingSuite(r.node)===b.getEnclosingSuite(t.node);o&&(0,M.isFunction)(o)&&this._evaluator.getFunctionInferredReturnType(o),!l&&i&&o&&(0,M.isTypeSame)(i,o)&&(a=!0),3===r.type&&(a=!0),a||p(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,t.isMethod?m.Localizer.Diagnostic.obscuredMethodDeclaration().format({name:e}):m.Localizer.Diagnostic.obscuredFunctionDeclaration().format({name:e}),t.node.name))}else if(2===t.type){if(t.node.name){let n=!1;if(3===r.type&&(n=!0),!n){const n=m.Localizer.Diagnostic.obscuredParameterDeclaration();p(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,n.format({name:e}),t.node.name))}}}else if(1===t.type){const n=null===(i=this._evaluator.getTypeForDeclaration(r))||void 0===i?void 0:i.type;if(t.typeAnnotationNode&&38===t.node.nodeType){let s=!1;const i=null===(a=this._evaluator.getTypeForDeclaration(t))||void 0===a?void 0:a.type;n&&i&&(0,M.isTypeSame)(n,i)&&(s=!0),3===r.type&&(s=!0),s||p(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.obscuredVariableDeclaration().format({name:e}),t.node))}}else 4===t.type&&p(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.obscuredTypeAliasDeclaration().format({name:e}),t.node.name))}_conditionallyReportUnusedSymbol(e,t,n,s){const i=this._fileInfo.accessedSymbolSet;t.isIgnoredForProtocolMatch()||i.has(t.id)||s&&s.some((e=>e.accessedSymbolSet.has(t.id)))||"_"!==e&&(A.isDunderName(e)||t.getDeclarations().forEach((t=>{this._conditionallyReportUnusedDeclaration(t,this._isSymbolPrivate(e,n))})))}_conditionallyReportUnusedDeclaration(e,t){var n;let s,i,a,r;switch(e.type){case 8:if(s=this._fileInfo.diagnosticRuleSet.reportUnusedImport,r=c.DiagnosticRule.reportUnusedImport,21===e.node.nodeType)if(e.node.alias)e.node.alias.value!==e.moduleName&&(i=e.node.alias);else{const t=e.node.module.nameParts;if(t.length>0){const e=t.map((e=>e.value)).join("."),n={start:t[0].start,length:t[0].length};return u.TextRange.extend(n,t[t.length-1]),this._fileInfo.diagnosticSink.addUnusedCodeWithTextRange(m.Localizer.Diagnostic.unaccessedSymbol().format({name:e}),n,{action:"pyright.unusedImport"}),void this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportUnusedImport,c.DiagnosticRule.reportUnusedImport,m.Localizer.Diagnostic.unaccessedImport().format({name:e}),n)}}else if(23===e.node.nodeType){const t=e.node.parent,s=(null===(n=e.node.alias)||void 0===n?void 0:n.value)===e.node.name.value,a=1===t.module.nameParts.length&&"__future__"===t.module.nameParts[0].value;s||a||(i=e.node.alias||e.node.name)}i&&(a=m.Localizer.Diagnostic.unaccessedImport().format({name:i.value}));break;case 4:case 1:case 2:if(!t)return;if(this._fileInfo.isStubFile)return;s=this._fileInfo.diagnosticRuleSet.reportUnusedVariable,38===e.node.nodeType?(i=e.node,i.value.startsWith("_")&&(s="none")):41===e.node.nodeType&&(i=e.node.name,s="none"),i&&(r=c.DiagnosticRule.reportUnusedVariable,a=m.Localizer.Diagnostic.unaccessedVariable().format({name:i.value}));break;case 6:if(!t)return;if(this._fileInfo.isStubFile)return;s=this._fileInfo.diagnosticRuleSet.reportUnusedClass,i=e.node.name,r=c.DiagnosticRule.reportUnusedClass,a=m.Localizer.Diagnostic.unaccessedClass().format({name:i.value});break;case 5:if(!t)return;if(this._fileInfo.isStubFile)return;s=this._fileInfo.diagnosticRuleSet.reportUnusedFunction,i=e.node.name,r=c.DiagnosticRule.reportUnusedFunction,a=m.Localizer.Diagnostic.unaccessedFunction().format({name:i.value});break;case 3:s="none",i=e.node.name;break;case 0:case 7:return;default:(0,o.assertNever)(e)}const l=r===c.DiagnosticRule.reportUnusedImport?{action:"pyright.unusedImport"}:void 0;i&&(this._fileInfo.diagnosticSink.addUnusedCodeWithTextRange(m.Localizer.Diagnostic.unaccessedSymbol().format({name:i.value}),i,l),void 0!==r&&a&&this._evaluator.addDiagnostic(s,r,a,i))}_validateIsInstanceCall(e){if(38!==e.leftExpression.nodeType||"isinstance"!==e.leftExpression.value&&"issubclass"!==e.leftExpression.value||2!==e.arguments.length)return;const t=e.leftExpression.value,n="isinstance"===t;let s=this._evaluator.getType(e.arguments[0].valueExpression);if(!s)return;s=(0,R.mapSubtypes)(s,(e=>(0,R.transformPossibleRecursiveTypeAlias)(e)));const i=this._evaluator.getType(e.arguments[1].valueExpression);if(!i)return;let a=!0;if((0,R.doForEachSubtype)(i,(e=>{(0,M.isClassInstance)(e)&&M.ClassType.isTupleClass(e)&&e.tupleTypeArguments?e.tupleTypeArguments.some((e=>!this._isTypeSupportedTypeForIsInstance(e.type,n)))&&(a=!1):this._isTypeSupportedTypeForIsInstance(e,n)||(a=!1)})),!a){const t=new l.DiagnosticAddendum;t.addMessage(m.Localizer.DiagnosticAddendum.typeVarNotAllowed()),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,n?m.Localizer.Diagnostic.isInstanceInvalidType().format({type:this._evaluator.printType(i)})+t.getString():m.Localizer.Diagnostic.isSubclassInvalidType().format({type:this._evaluator.printType(i)})+t.getString(),e.arguments[1])}let r=e;for(;r;){if(2===r.nodeType)return;r=r.parent}const o=["FunctionType","LambdaType","BuiltinFunctionType","BuiltinMethodType","type","Type"],p=[];let d=!1;if((0,R.doForEachSubtype)(i,(e=>{(0,M.isClass)(e)?M.TypeBase.isInstantiable(e)?void 0===e.literalValue&&(p.push(e),M.ClassType.isBuiltIn(e)&&o.some((t=>t===e.details.name))&&(a=!1),e.includeSubclasses&&(d=!0)):((0,R.isTupleClass)(e)?e.tupleTypeArguments&&e.tupleTypeArguments.forEach((e=>{(0,M.isInstantiableClass)(e.type)?(p.push(e.type),e.type.includeSubclasses&&(d=!0)):a=!1})):e.includeSubclasses&&(d=!0),M.ClassType.isBuiltIn(e)&&o.some((t=>t===e.details.name))&&(a=!1)):a=!1})),!a)return;if(p.some((e=>M.ClassType.isProtocolClass(e)&&!M.ClassType.isRuntimeCheckable(e)))&&this._evaluator.addError(m.Localizer.Diagnostic.protocolUsedInCall().format({name:t}),e.arguments[1].valueExpression),(0,R.derivesFromAnyOrUnknown)(s))return;const u=e=>(0,M.combineTypes)(e),y=e=>{const t=[];for(const s of p){const i=(0,w.isIsinstanceFilterSuperclass)(this._evaluator,e,s,s,n),a=(0,w.isIsinstanceFilterSubclass)(this._evaluator,e,s,s,n);a&&a&&!M.ClassType.isSameGenericClass(e,s)?t.push(M.UnknownType.create()):i?t.push(e):a&&t.push(s)}return n?t.map((e=>(0,M.isInstantiableClass)(e)?M.ClassType.cloneAsInstance(e):e)):t};let g;if(n&&(0,M.isClassInstance)(s))g=u(y(M.ClassType.cloneAsInstantiable(s)));else if(!n&&(0,M.isInstantiableClass)(s))g=u(y(s));else{if(!(0,M.isUnion)(s))return;{let e=[],t=!1;if((0,R.doForEachSubtype)(s,(s=>{(0,M.isAnyOrUnknown)(s)&&(t=!0),n&&(0,M.isClassInstance)(s)?e=e.concat(y(M.ClassType.cloneAsInstantiable(s))):!n&&(0,M.isInstantiableClass)(s)&&(e=e.concat(y(s)))})),g=u(e),t)return}}const h=()=>{const e=p.map((e=>M.ClassType.cloneAsInstance(e)));return(0,M.combineTypes)(e)};!d&&(0,M.isTypeSame)(g,s,{ignorePseudoGeneric:!0})&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryIsInstance,c.DiagnosticRule.reportUnnecessaryIsInstance,n?m.Localizer.Diagnostic.unnecessaryIsInstanceAlways().format({testType:this._evaluator.printType(s),classType:this._evaluator.printType(h())}):m.Localizer.Diagnostic.unnecessaryIsSubclassAlways().format({testType:this._evaluator.printType(s),classType:this._evaluator.printType(h())}),e)}_isTypeSupportedTypeForIsInstance(e,t){let n=!0;return(0,R.doForEachSubtype)(e,(e=>{switch((e=this._evaluator.makeTopLevelTypeVarsConcrete(e)).category){case 2:case 1:case 0:break;case 7:e.isTypeArgumentExplicit&&!e.includeSubclasses&&(n=!1);break;case 3:n=!!t&&M.TypeBase.isInstantiable(e);break;case 5:n=M.TypeBase.isInstantiable(e);break;case 9:n=this._isTypeSupportedTypeForIsInstance(e,t);break;default:n=!1}})),n}_isSymbolPrivate(e,t){return 1===t||0===t||(!!A.isPrivateName(e)||!!A.isProtectedName(e)&&!(2===t))}_reportDeprecatedUse(e,t){if(!t)return;let n,s;function i(t,i){const a=b.getCallForName(e);if(a){const r=t.getTypeResult(a);r&&r.overloadsUsedForCall&&r.overloadsUsedForCall.length>0&&r.overloadsUsedForCall.forEach((t=>{void 0!==t.details.deprecatedMessage&&(e.value===t.details.name?(s=t.details.deprecatedMessage,n=m.Localizer.Diagnostic.deprecatedFunction().format({name:t.details.name})):(0,M.isInstantiableClass)(i)&&"__init__"===t.details.name&&(s=t.details.deprecatedMessage,n=m.Localizer.Diagnostic.deprecatedConstructor().format({name:i.details.name})))}))}}if((0,R.doForEachSubtype)(t,(t=>{(0,M.isClass)(t)?t.includeSubclasses||void 0===t.details.deprecatedMessage||e.value!==t.details.name?i(this._evaluator,t):(s=t.details.deprecatedMessage,n=m.Localizer.Diagnostic.deprecatedClass().format({name:t.details.name})):(0,M.isFunction)(t)?void 0!==t.details.deprecatedMessage&&e.value===t.details.name&&(s=t.details.deprecatedMessage,n=m.Localizer.Diagnostic.deprecatedFunction().format({name:t.details.name||"<anonymous>"})):(0,M.isOverloadedFunction)(t)&&i(this._evaluator,t)})),n){const t=new l.DiagnosticAddendum;s&&t.addMessage(s),"none"===this._fileInfo.diagnosticRuleSet.reportDeprecated?this._evaluator.addDeprecated(n+t.getString(),e):this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportDeprecated,c.DiagnosticRule.reportDeprecated,n+t.getString(),e)}}_reportUnboundName(e){if("none"!==this._fileInfo.diagnosticRuleSet.reportUnboundVariable&&!f.isCodeUnreachable(e)){const t=this._evaluator.getType(e);t&&((0,M.isUnbound)(t)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnboundVariable,c.DiagnosticRule.reportUnboundVariable,m.Localizer.Diagnostic.symbolIsUnbound().format({name:e.value}),e):(0,M.isPossiblyUnbound)(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnboundVariable,c.DiagnosticRule.reportUnboundVariable,m.Localizer.Diagnostic.symbolIsPossiblyUnbound().format({name:e.value}),e))}}_conditionallyReportShadowedModule(){if("none"===this._fileInfo.diagnosticRuleSet.reportShadowedImports)return;const e=this._fileInfo.moduleName,t={nameParts:e.split("."),leadingDots:0,importedSymbols:[]};if(this._importResolver.getTypeshedStdLibPath(this._fileInfo.executionEnvironment)&&this._importResolver.isStdlibModule(t,this._fileInfo.executionEnvironment)&&this._sourceMapper.isUserCode(this._fileInfo.filePath)){const t=this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportShadowedImports,c.DiagnosticRule.reportShadowedImports,m.Localizer.Diagnostic.stdlibModuleOverridden().format({name:e,path:this._fileInfo.filePath}),this._moduleNode);if(t){const e={action:"renameShadowedFile",oldFile:this._fileInfo.filePath,newFile:this._sourceMapper.getNextFileName(this._fileInfo.filePath)};t.addAction(e)}}}_conditionallyReportShadowedImport(e){var t,n;if("none"===this._fileInfo.diagnosticRuleSet.reportShadowedImports)return;const s=23===e.nodeType?22===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)?null===(n=e.parent)||void 0===n?void 0:n.module:void 0:e.module;if(null==s?void 0:s.leadingDots)return;const i=21===e.nodeType?e.module.nameParts:23===e.nodeType?[e.name]:e.module.nameParts,a=i.map((e=>e.value)),o={nameParts:a,leadingDots:0,importedSymbols:[]},l=this._importResolver.getTypeshedStdLibPath(this._fileInfo.executionEnvironment);if(l&&this._importResolver.isStdlibModule(o,this._fileInfo.executionEnvironment)){const t=y.DefinitionProvider.getDefinitionsForNode(this._sourceMapper,i[i.length-1],y.DefinitionFilter.All,this._evaluator,r.CancellationToken.None);(t?t.map((e=>e.path)):[]).forEach((t=>{if(!t.startsWith(l)&&!(0,E.isStubFile)(t)&&this._sourceMapper.isUserCode(t)){const n=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportShadowedImports,c.DiagnosticRule.reportShadowedImports,m.Localizer.Diagnostic.stdlibModuleOverridden().format({name:a.join("."),path:t}),e);if(n){const e={action:"renameShadowedFile",oldFile:t,newFile:this._sourceMapper.getNextFileName(t)};n.addAction(e)}}}))}}_conditionallyReportPrivateUsage(e){var t;if("none"===this._fileInfo.diagnosticRuleSet.reportPrivateUsage)return;if(this._fileInfo.isStubFile)return;if(1===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&e.parent.name===e)return;const n=e.value,s=A.isPrivateName(n),i=A.isProtectedName(n);if(!s&&!i)return;const a=this._evaluator.getDeclarationsForNameNode(e);let r,o=a&&a.length>0?a[a.length-1]:void 0;if(!o||o.node===e)return;if(8===o.type){if(o.usesLocalName)return;const e=this._evaluator.resolveAliasDeclarationWithInfo(o,!0);if(!e)return;if(o=e.declaration,!e.isPrivate)return}if(!o||o.node===e)return;o.node&&(r=b.getEnclosingClass(o.node)),o.node&&o.node.parent&&o.node.parent===r&&(r=b.getEnclosingClass(r));let l=!1;if(r&&i){const t=this._evaluator.getTypeOfClass(r);if(t&&(0,M.isInstantiableClass)(t.decoratedType)){if(M.ClassType.isDefinedInStub(t.decoratedType))return;l=!0;const n=b.getEnclosingClass(e);if(n){const e=this._evaluator.getTypeOfClass(n);if(e&&(0,M.isInstantiableClass)(e.decoratedType)&&(0,R.derivesFromClassRecursive)(e.decoratedType,t.decoratedType,!0))return}}}r&&!b.isNodeContainedWithin(e,r)&&(l?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportPrivateUsage,c.DiagnosticRule.reportPrivateUsage,m.Localizer.Diagnostic.protectedUsedOutsideOfClass().format({name:n}),e):this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportPrivateUsage,c.DiagnosticRule.reportPrivateUsage,m.Localizer.Diagnostic.privateUsedOutsideOfClass().format({name:n}),e))}_validateEnumClassOverride(e,t){t.details.baseClasses.forEach(((t,n)=>{if((0,M.isClass)(t)&&M.ClassType.isEnumClass(t)){let s=!1;t.details.fields.forEach((e=>{const n=this._evaluator.getEffectiveTypeOfSymbol(e);(0,M.isClassInstance)(n)&&M.ClassType.isSameGenericClass(n,t)&&(s=!0)})),s&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.enumClassOverride().format({name:t.details.name}),e.arguments[n])}}))}_validateTypedDictClassSuite(e){const t=e=>{this._evaluator.addError(m.Localizer.Diagnostic.typedDictBadVar(),e)};e.statements.forEach((e=>{if(!f.isCodeUnreachable(e))if(47===e.nodeType)for(const n of e.statements)54!==n.nodeType&&18!==n.nodeType&&48!==n.nodeType&&42!==n.nodeType&&t(n);else t(e)}))}_validateTypeGuardFunction(e,t,n){var s;const i=t.details.declaredReturnType;if(!i)return;if(!(0,M.isClassInstance)(i)||!i.typeArguments||i.typeArguments.length<1)return;const a=M.ClassType.isBuiltIn(i,"TypeGuard"),r=M.ClassType.isBuiltIn(i,"StrictTypeGuard");if(!a&&!r)return;let o=t.details.parameters.length;if(n&&(M.FunctionType.isInstanceMethod(t)||M.FunctionType.isConstructorMethod(t)||M.FunctionType.isClassMethod(t))&&o--,o<1&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeGuardParamCount(),e.name),r){const a=i.typeArguments[0],r=n&&!M.FunctionType.isStaticMethod(t)?1:0;if(r>=t.details.parameters.length)return;const o=M.FunctionType.getEffectiveParameterType(t,r);if(!this._evaluator.assignType(o,a)){const t=e.returnTypeAnnotation||(null===(s=e.functionAnnotationComment)||void 0===s?void 0:s.returnTypeAnnotation);t&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.strictTypeGuardReturnType().format({type:this._evaluator.printType(o),returnType:this._evaluator.printType(a)}),t)}}}_validateDunderSignatures(e,t,n){var s;const i=t.details.name;if(n&&"__init__"===i){const n=e.returnTypeAnnotation||(null===(s=e.functionAnnotationComment)||void 0===s?void 0:s.returnTypeAnnotation),i=t.details.declaredReturnType;if(n&&i)(0,M.isNoneInstance)(i)||(0,M.isNever)(i)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.initMustReturnNone(),n);else{const n=this._evaluator.getFunctionInferredReturnType(t);(0,M.isNever)(n)||(0,M.isNoneInstance)(n)||(0,M.isAnyOrUnknown)(n)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.initMustReturnNone(),e.name)}}}_validateFunctionReturn(e,t){var n;if(this._fileInfo.isStubFile)return;const s=e.returnTypeAnnotation||(null===(n=e.functionAnnotationComment)||void 0===n?void 0:n.returnTypeAnnotation);if(s){const n=!this._evaluator.isAfterNodeReachable(e),i=this._evaluator.isAfterNodeReachable(e.suite);let a=t.details.declaredReturnType;if(a){(0,M.isUnknown)(a)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,c.DiagnosticRule.reportUnknownVariableType,m.Localizer.Diagnostic.declaredReturnTypeUnknown(),s):(0,R.isPartlyUnknown)(a)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,c.DiagnosticRule.reportUnknownVariableType,m.Localizer.Diagnostic.declaredReturnTypePartiallyUnknown().format({returnType:this._evaluator.printType(a,{expandTypeAlias:!0})}),s);const e=new l.DiagnosticAddendum;(0,M.isTypeVar)(a)&&4===a.details.declaredVariance&&(e.addMessage(m.Localizer.DiagnosticAddendum.typeVarIsContravariant().format({name:M.TypeVarType.getReadableName(a)})),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.returnTypeContravariant()+e.getString(),s))}if(M.FunctionType.isGenerator(t)&&(a=(0,R.getDeclaredGeneratorReturnType)(t)),a&&!n&&i)if((0,M.isNever)(a))b.isSuiteEmpty(e.suite)||M.FunctionType.isOverloaded(t)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.noReturnReturnsNone(),s);else if(!M.FunctionType.isAbstractMethod(t)){const n=new l.DiagnosticAddendum;this._evaluator.assignType(a,M.NoneType.createInstance(),n)||b.isSuiteEmpty(e.suite)||M.FunctionType.isOverloaded(t)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.returnMissing().format({returnType:this._evaluator.printType(a)})+n.getString(),s)}}else{const n=this._evaluator.getFunctionInferredReturnType(t);(0,M.isUnknown)(n)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,c.DiagnosticRule.reportUnknownParameterType,m.Localizer.Diagnostic.returnTypeUnknown(),e.name):(0,R.isPartlyUnknown)(n)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,c.DiagnosticRule.reportUnknownParameterType,m.Localizer.Diagnostic.returnTypePartiallyUnknown().format({returnType:this._evaluator.printType(n,{expandTypeAlias:!0})}),e.name)}}_validateFinalMemberOverrides(e){e.details.fields.forEach(((t,n)=>{const s=(0,R.lookUpClassMember)(e,n,1);if(s&&(0,M.isInstantiableClass)(s.classType)&&this._evaluator.isFinalVariable(s.symbol)&&!A.isPrivateName(n)){const e=t.getDeclarations()[0];this._evaluator.addError(m.Localizer.Diagnostic.finalRedeclarationBySubclass().format({name:n,className:s.classType.details.name}),e.node)}}))}_reportDuplicateEnumMembers(e){M.ClassType.isEnumClass(e)&&!M.ClassType.isBuiltIn(e)&&e.details.fields.forEach(((t,n)=>{if(t.getTypedDeclarations().length>0)return;const s=t.getDeclarations();if(s.length>=2&&1===s[0].type){const i=this._evaluator.getEffectiveTypeOfSymbol(t);(0,M.isClassInstance)(i)&&M.ClassType.isSameGenericClass(i,e)&&void 0!==i.literalValue&&this._evaluator.addError(m.Localizer.Diagnostic.duplicateEnumMember().format({name:n}),s[1].node)}}))}_validateProtocolCompatibility(e,t){if(M.ClassType.isProtocolClass(e))return;const n=new l.DiagnosticAddendum,s=t=>e.details.mro.some((e=>(0,M.isClass)(e)&&!M.ClassType.isProtocolClass(e)&&e.details.fields.has(t)));e.details.baseClasses.forEach((e=>{(0,M.isClass)(e)&&M.ClassType.isProtocolClass(e)&&(0,R.getProtocolSymbols)(e).forEach(((e,t)=>{const i=e.symbol.getDeclarations();0!==i.length&&(0,M.isClass)(e.classType)&&(1===i[0].type?i.some((e=>1===e.type&&!!e.inferredTypeSource))||s(t)||n.addMessage(m.Localizer.DiagnosticAddendum.missingProtocolMember().format({name:t,classType:e.classType.details.name})):5===i[0].type&&i.every((e=>5!==e.type||b.isSuiteEmpty(e.node.suite)))&&".pyi"!==(0,p.getFileExtension)(i[0].path).toLowerCase()&&(s(t)||n.addMessage(m.Localizer.DiagnosticAddendum.missingProtocolMember().format({name:t,classType:e.classType.details.name}))))}))})),n.isEmpty()||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.missingProtocolMembers()+n.getString(),t.name)}_validateDataClassPostInit(e,t){if(!M.ClassType.isDataClass(e))return;const n=(0,R.lookUpClassMember)(e,"__post_init__",18);if(!n)return;if(M.ClassType.derivesFromAnyOrUnknown(e))return;const s=new Map;M.ClassType.getReverseMro(e).forEach((e=>{(0,M.isClass)(e)&&M.ClassType.isDataClass(e)&&e.details.fields.forEach(((e,t)=>{e.isInitVar()&&s.set(t,e)}))}));const i=this._evaluator.getTypeOfMember(n);if(!(0,M.isFunction)(i)||!M.FunctionType.isInstanceMethod(i)||!i.details.declaration)return;const a=(0,I.getParameterListDetails)(i);if(void 0!==a.argsIndex||void 0!==a.kwargsIndex||void 0!==a.firstKeywordOnlyIndex)return;const r=a.params.filter((e=>!e.param.hasDefault)),o=s.size+1;(o<r.length||o>a.params.length)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.dataClassPostInitParamCount().format({expected:s.size}),i.details.declaration.node.name);let p=1;s.forEach(((e,t)=>{var n;if(p>=a.params.length)return;const s=a.params[p].param;if(s.hasDeclaredType&&s.typeAnnotation){const r=null===(n=this._evaluator.getDeclaredTypeOfSymbol(e))||void 0===n?void 0:n.type,o=M.FunctionType.getEffectiveParameterType(i,a.params[p].index),d=new l.DiagnosticAddendum;if(r&&!this._evaluator.assignType(o,r,d)){const n=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.dataClassPostInitType().format({fieldName:t})+d.getString(),s.typeAnnotation);if(n){const t=e.getTypedDeclarations();t.length>0&&n.addRelatedInfo(m.Localizer.DiagnosticAddendum.dataClassFieldLocation(),t[0].path,t[0].range)}}}p++}))}_validateFinalClassNotAbstract(e,t){if(!M.ClassType.isFinal(e))return;if(!M.ClassType.supportsAbstractMethods(e))return;const n=this._evaluator.getAbstractMethods(e);if(0===n.length)return;const s=new l.DiagnosticAddendum;n.forEach(((e,t)=>{if(2===t)s.addMessage(m.Localizer.DiagnosticAddendum.memberIsAbstractMore().format({count:n.length-2}));else if(t<2&&(0,M.isInstantiableClass)(e.classType)){const t=e.classType.details.name;s.addMessage(m.Localizer.DiagnosticAddendum.memberIsAbstract().format({type:t,name:e.symbolName}))}})),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.finalClassIsAbstract().format({type:e.details.name})+s.getString(),t.name)}_validateInstanceVariableInitialization(e){this._fileInfo.isStubFile||"none"!==this._fileInfo.diagnosticRuleSet.reportUninitializedInstanceVariable&&(M.ClassType.isProtocolClass(e)||e.details.fields.forEach(((t,n)=>{if(!t.isInstanceMember())return;const s=t.getDeclarations();s.find((t=>{var n,s,i;const a=b.getEnclosingClassOrFunction(t.node);if(!a)return!0;if(10===a.nodeType){if(3===(null===(n=t.node.parent)||void 0===n?void 0:n.nodeType))return!0;if(54===(null===(s=t.node.parent)||void 0===s?void 0:s.nodeType)&&3===(null===(i=t.node.parent.parent)||void 0===i?void 0:i.nodeType))return!0;if(M.ClassType.isDataClass(e))return!0;if(M.ClassType.isTypedDictClass(e))return!0}return"__init__"===a.name.value}))||(0,R.lookUpClassMember)(e,n,1)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUninitializedInstanceVariable,c.DiagnosticRule.reportUninitializedInstanceVariable,m.Localizer.Diagnostic.uninitializedInstanceVariable().format({name:n}),s[0].node)})))}_validateProtocolTypeParamVariance(e,t){if(0===t.details.typeParameters.length)return;const n=this._evaluator.getBuiltInType(e,"object");if(!(0,M.isInstantiableClass)(n))return;const s=t.details.typeParameters.map((e=>M.TypeVarType.cloneAsInvariant(e))),i=M.ClassType.cloneWithNewTypeParameters(t,s),a=M.ClassType.cloneAsInstance(n),r=M.ClassType.createInstantiable("__varianceDummy","","","",0,0,void 0,void 0);s.forEach(((n,o)=>{if(n.details.isVariadic||n.details.isParamSpec)return;if(0===n.details.declaredVariance)return;const l=s.map(((e,t)=>e.details.isVariadic?e:t===o?a:r)),p=s.map(((e,t)=>t===o||e.details.isVariadic?e:r)),d=M.ClassType.cloneForSpecialization(i,l,!0),u=M.ClassType.cloneForSpecialization(i,p,!0);let y;if(y=this._evaluator.assignClassToSelf(d,u)?3:this._evaluator.assignClassToSelf(u,d)?4:2,y!==t.details.typeParameters[o].details.declaredVariance){let s;s=3===y?m.Localizer.Diagnostic.protocolVarianceCovariant().format({variable:n.details.name,class:t.details.name}):4===y?m.Localizer.Diagnostic.protocolVarianceContravariant().format({variable:n.details.name,class:t.details.name}):m.Localizer.Diagnostic.protocolVarianceInvariant().format({variable:n.details.name,class:t.details.name}),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidTypeVarUse,c.DiagnosticRule.reportInvalidTypeVarUse,s,e.name)}}))}_validateSlotsClassVarConflict(e){e.details.localSlotsNames&&(M.ClassType.isDataClass(e)||e.details.fields.forEach(((e,t)=>{const n=e.getDeclarations();n.some((e=>1===e.type&&e.isDefinedBySlots))&&n.forEach((e=>{1!==e.type||e.isDefinedBySlots||e.isDefinedByMemberAccess||38===e.node.nodeType&&b.isWriteAccess(e.node)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.slotsClassVarConflict().format({name:t}),e.node)}))})))}_validateConstructorConsistency(e){const t=(0,R.lookUpClassMember)(e,"__init__",12),n=(0,R.lookUpClassMember)(e,"__new__",12);if(!(t&&n&&(0,M.isClass)(t.classType)&&(0,M.isClass)(n.classType)))return;if(!M.ClassType.isSameGenericClass(n.classType,e)&&!M.ClassType.isSameGenericClass(t.classType,e))return;const s=n.classType.details.effectiveMetaclass;if(s&&(0,M.isClass)(s)&&!M.ClassType.isBuiltIn(s,"type")&&(0,R.lookUpClassMember)(s,"__call__",40))return;let i=this._evaluator.getTypeOfMember(n);if(!(0,M.isFunction)(i)&&!(0,M.isOverloadedFunction)(i))return;if(i=this._evaluator.bindFunctionToClassOrObject(e,i,void 0,void 0,void 0,!0),!i)return;if((0,M.isOverloadedFunction)(i)&&(i=M.OverloadedFunctionType.getImplementation(i),!i))return;let a=this._evaluator.getTypeOfMember(t);if(((0,M.isFunction)(a)||(0,M.isOverloadedFunction)(a))&&(a=this._evaluator.bindFunctionToClassOrObject(M.ClassType.cloneAsInstance(e),a),a&&(!(0,M.isOverloadedFunction)(a)||(a=M.OverloadedFunctionType.getImplementation(a),a))&&(0,M.isFunction)(a)&&(0,M.isFunction)(i)&&!(M.FunctionType.hasDefaultParameters(a)||M.FunctionType.hasDefaultParameters(i)||(a=M.FunctionType.cloneWithNewFlags(a,98304|a.details.flags),i=M.FunctionType.cloneWithNewFlags(i,98304|a.details.flags),this._evaluator.assignType(i,a,void 0,void 0,void 0,32)&&this._evaluator.assignType(a,i,void 0,void 0,void 0,32))))){const s=M.ClassType.isSameGenericClass(t.classType,e),r=(0,N.getLastTypedDeclaredForSymbol)(t.symbol),o=(0,N.getLastTypedDeclaredForSymbol)(n.symbol);if(r&&o){const e=s?r:o,p=28===e.node.nodeType?e.node.name:e.node,d=new l.DiagnosticAddendum,u=this._evaluator.printType(a),y=this._evaluator.printType(i);d.addMessage(m.Localizer.DiagnosticAddendum.initMethodSignature().format({type:u})),d.addMessage(m.Localizer.DiagnosticAddendum.newMethodSignature().format({type:y}));const g=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInconsistentConstructor,c.DiagnosticRule.reportInconsistentConstructor,m.Localizer.Diagnostic.constructorParametersMismatch().format({classType:this._evaluator.printType(M.ClassType.cloneAsInstance(s?t.classType:n.classType))})+d.getString(),p);if(g){const e=s?o:r;g.addRelatedInfo((s?m.Localizer.DiagnosticAddendum.newMethodLocation():m.Localizer.DiagnosticAddendum.initMethodLocation()).format({type:this._evaluator.printType(M.ClassType.cloneAsInstance(s?n.classType:t.classType))}),e.path,e.range)}}}}_validateMultipleInheritanceCompatibility(e,t){if("none"===this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride&&"none"===this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride)return;const n=[];if(e.details.baseClasses.forEach((e=>{!(0,M.isClass)(e)||M.ClassType.isBuiltIn(e,"Generic")||M.ClassType.isBuiltIn(e,"Protocol")||n.push(e)})),n.length<2)return;const s=n.map((t=>{const n=e.details.mro.find((e=>(0,M.isClass)(e)&&M.ClassType.isSameGenericClass(e,t)));return n&&(0,M.isClass)(n)?(0,R.getClassFieldsRecursive)(n):new Map})),i=(0,R.getClassFieldsRecursive)(e);for(let n=1;n<s.length;n++){const a=s[n];for(const[n,s]of a){if(A.isDunderName(n)||A.isPrivateName(n))continue;const a=s.classType;if(!(0,M.isClass)(a))continue;const r=i.get(n);if(r){const i=r.classType;if(!(0,M.isClass)(i)||M.ClassType.isSameGenericClass(i,a)||M.ClassType.isSameGenericClass(i,e))continue;this._validateMultipleInheritanceOverride(s,r,e,n,t)}}}}_validateMultipleInheritanceOverride(e,t,n,s,i){if(!(0,M.isClass)(e.classType)||!(0,M.isClass)(t.classType))return;if("_"===s)return;let a=this._evaluator.getEffectiveTypeOfSymbol(e.symbol);a=(0,R.partiallySpecializeType)(a,e.classType);const r=t.symbol;let o=this._evaluator.getEffectiveTypeOfSymbol(r);o=(0,R.partiallySpecializeType)(o,t.classType);const p=n.details.fields.get(s),d=p?this._evaluator.getEffectiveTypeOfSymbol(p):void 0;let u;const y=(0,N.getLastTypedDeclaredForSymbol)(t.symbol),g=(0,N.getLastTypedDeclaredForSymbol)(e.symbol);if((0,M.isFunction)(a)||(0,M.isOverloadedFunction)(a)){const e=new l.DiagnosticAddendum;let t;if((0,M.isFunction)(o))t=o;else if((0,M.isOverloadedFunction)(o)&&(t=M.OverloadedFunctionType.getImplementation(o),!t))return;if(t&&!this._evaluator.validateOverrideMethod(a,t,e,!0)){const a=t.details.declaration;a&&5===a.type&&(u=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,c.DiagnosticRule.reportIncompatibleMethodOverride,m.Localizer.Diagnostic.baseClassMethodTypeIncompatible().format({classType:n.details.name,name:s})+e.getString(),i))}}else(0,R.isProperty)(a)?(0,R.isProperty)(o)||(0,M.isAnyOrUnknown)(o)||r.getDeclarations().length>0&&(u=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride,c.DiagnosticRule.reportIncompatibleVariableOverride,m.Localizer.Diagnostic.baseClassVariableTypeIncompatible().format({classType:n.details.name,name:s}),i)):"none"!==this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride&&((0,M.isAnyOrUnknown)(a)||(0,M.isAnyOrUnknown)(o)||this._evaluator.assignType(a,null!=d?d:o)||(u=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride,c.DiagnosticRule.reportIncompatibleVariableOverride,m.Localizer.Diagnostic.baseClassVariableTypeIncompatible().format({classType:n.details.name,name:s}),i)));u&&y&&g&&(u.addRelatedInfo(m.Localizer.DiagnosticAddendum.baseClassOverriddenType().format({baseClass:this._evaluator.printType((0,R.convertToInstance)(e.classType)),type:this._evaluator.printType(a)}),g.path,g.range),u.addRelatedInfo(m.Localizer.DiagnosticAddendum.baseClassOverridesType().format({baseClass:this._evaluator.printType((0,R.convertToInstance)(t.classType)),type:this._evaluator.printType(o)}),y.path,y.range))}_validateBaseClassOverrides(e){e.details.fields.forEach(((t,n)=>{if(A.isPrivateName(n))return;if(!t.hasTypedDeclarations()&&!this._evaluator.isFinalVariable(t))return;const s=this._evaluator.getEffectiveTypeOfSymbol(t);if((0,M.isAnyOrUnknown)(s))return;let i;for(const a of e.details.baseClasses){if(!(0,M.isClass)(a))continue;const r=e.details.mro.find((e=>(0,M.isClass)(e)&&M.ClassType.isSameGenericClass(e,a)));if(!r)continue;const o=(0,R.lookUpClassMember)(r,n,0);o&&(i=null!=i?i:o,this._validateBaseClassOverride(o,t,s,e,n))}i?this._validateOverrideDecoratorPresent(s,i):this._validateOverrideDecoratorNotPresent(s)}))}_validateOverrideDecoratorPresent(e,t){var n;if("none"===this._fileInfo.diagnosticRuleSet.reportImplicitOverride)return;let s;if((0,M.isFunction)(e))s=e;else if((0,M.isOverloadedFunction)(e))s=M.OverloadedFunctionType.getImplementation(e);else if((0,M.isClassInstance)(e)&&M.ClassType.isPropertyClass(e)){const t=e.details.fields.get("fget");if(t){const e=null===(n=this._evaluator.getDeclaredTypeOfSymbol(t))||void 0===n?void 0:n.type;e&&(0,M.isFunction)(e)&&(s=e)}}if(!(null==s?void 0:s.details.declaration)||M.FunctionType.isOverridden(s))return;if("__init__"===s.details.name||"__new__"===s.details.name)return;const i=s.details.declaration.node;this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportImplicitOverride,c.DiagnosticRule.reportImplicitOverride,m.Localizer.Diagnostic.overrideDecoratorMissing().format({name:i.name.value,className:this._evaluator.printType((0,R.convertToInstance)(t.classType))}),i.name)}_validateOverrideDecoratorNotPresent(e){var t;let n;if((0,M.isFunction)(e))n=e;else if((0,M.isOverloadedFunction)(e))n=M.OverloadedFunctionType.getImplementation(e);else if((0,M.isClassInstance)(e)&&M.ClassType.isPropertyClass(e)){const s=e.details.fields.get("fget");if(s){const e=null===(t=this._evaluator.getDeclaredTypeOfSymbol(s))||void 0===t?void 0:t.type;e&&(0,M.isFunction)(e)&&(n=e)}}if(!(null==n?void 0:n.details.declaration)||!M.FunctionType.isOverridden(n))return;const s=n.details.declaration.node;this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.overriddenMethodNotFound().format({name:s.name.value}),s.name)}_validateBaseClassOverride(e,t,n,s,i){if(!(0,M.isInstantiableClass)(e.classType))return;if(!e.symbol.hasTypedDeclarations())return;if("_"===i)return;const a=(0,R.partiallySpecializeType)(this._evaluator.getEffectiveTypeOfSymbol(e.symbol),e.classType);if((0,M.isFunction)(a)||(0,M.isOverloadedFunction)(a)){const s=new l.DiagnosticAddendum;if((0,M.isFunction)(n)||(0,M.isOverloadedFunction)(n)){const r=["__init__","__new__","__init_subclass__"],o=!A.isDunderName(i);if(!r.some((e=>e===i))&&!A.isPrivateName(i)&&!this._evaluator.validateOverrideMethod(a,n,s,o)){const a=(0,M.isFunction)(n)&&n.details.declaration?n.details.declaration:(0,N.getLastTypedDeclaredForSymbol)(t);if(a){const t=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,c.DiagnosticRule.reportIncompatibleMethodOverride,m.Localizer.Diagnostic.incompatibleMethodOverride().format({name:i,className:e.classType.details.name})+s.getString(),5===a.type?a.node.name:a.node),n=(0,N.getLastTypedDeclaredForSymbol)(e.symbol);t&&n&&t.addRelatedInfo(m.Localizer.DiagnosticAddendum.overriddenMethod(),n.path,n.range)}}if((0,M.isFunction)(a)&&!A.isPrivateName(i)&&M.FunctionType.isFinal(a)){const n=(0,N.getLastTypedDeclaredForSymbol)(t);if(n&&5===n.type){const t=this._evaluator.addError(m.Localizer.Diagnostic.finalMethodOverride().format({name:i,className:e.classType.details.name}),n.node.name),s=(0,N.getLastTypedDeclaredForSymbol)(e.symbol);t&&s&&t.addRelatedInfo(m.Localizer.DiagnosticAddendum.finalMethod(),s.path,s.range)}}}else if(!(0,M.isAnyOrUnknown)(n)&&!M.ClassType.isBuiltIn(e.classType,"_TypedDict")){const s=t.getDeclarations();if(s.length>0){const t=s[s.length-1],a=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,c.DiagnosticRule.reportIncompatibleMethodOverride,m.Localizer.Diagnostic.methodOverridden().format({name:i,className:e.classType.details.name,type:this._evaluator.printType(n)}),t.node),r=(0,N.getLastTypedDeclaredForSymbol)(e.symbol);a&&r&&a.addRelatedInfo(m.Localizer.DiagnosticAddendum.overriddenMethod(),r.path,r.range)}}}else if((0,R.isProperty)(a))if((0,R.isProperty)(n)){const r=a.details.fields,o=n.details.fields,p=e.classType;["fget","fset","fdel"].forEach((e=>{const n=new l.DiagnosticAddendum,a=r.get(e),d=o.get(e);if(a){const r=(0,R.partiallySpecializeType)(this._evaluator.getEffectiveTypeOfSymbol(a),p);if((0,M.isFunction)(r))if(d){const t=(0,R.partiallySpecializeType)(this._evaluator.getEffectiveTypeOfSymbol(d),s);if((0,M.isFunction)(t)&&!this._evaluator.validateOverrideMethod(r,t,n.createAddendum())){n.addMessage(m.Localizer.DiagnosticAddendum.propertyMethodIncompatible().format({name:e}));const s=t.details.declaration;if(s&&5===s.type){const e=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,c.DiagnosticRule.reportIncompatibleMethodOverride,m.Localizer.Diagnostic.propertyOverridden().format({name:i,className:p.details.name})+n.getString(),s.node.name),t=r.details.declaration;e&&t&&e.addRelatedInfo(m.Localizer.DiagnosticAddendum.overriddenMethod(),t.path,t.range)}}}else{n.addMessage(m.Localizer.DiagnosticAddendum.propertyMethodMissing().format({name:e}));const s=t.getDeclarations();if(s.length>0){const e=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,c.DiagnosticRule.reportIncompatibleMethodOverride,m.Localizer.Diagnostic.propertyOverridden().format({name:i,className:p.details.name})+n.getString(),s[s.length-1].node),t=r.details.declaration;e&&t&&e.addRelatedInfo(m.Localizer.DiagnosticAddendum.overriddenMethod(),t.path,t.range)}}}}))}else{const n=t.getDeclarations();n.length>0&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,c.DiagnosticRule.reportIncompatibleMethodOverride,m.Localizer.Diagnostic.propertyOverridden().format({name:i,className:e.classType.details.name}),n[n.length-1].node)}else if("none"!==this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride){const s=t.getDeclarations();if(s.length>0){const r=s[s.length-1],o=new l.DiagnosticAddendum;if(!this._evaluator.assignType(a,n,o)){const t=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride,c.DiagnosticRule.reportIncompatibleVariableOverride,m.Localizer.Diagnostic.symbolOverridden().format({name:i,className:e.classType.details.name})+o.getString(),r.node),n=(0,N.getLastTypedDeclaredForSymbol)(e.symbol);t&&n&&t.addRelatedInfo(m.Localizer.DiagnosticAddendum.overriddenSymbol(),n.path,n.range)}const p=this._evaluator.isFinalVariable(e.symbol),d=s.find((e=>this._evaluator.isFinalVariableDeclaration(e)));if(!p&&d){const t=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride,c.DiagnosticRule.reportIncompatibleVariableOverride,m.Localizer.Diagnostic.variableFinalOverride().format({name:i,className:e.classType.details.name}),r.node);t&&t.addRelatedInfo(m.Localizer.DiagnosticAddendum.overriddenSymbol(),d.path,d.range)}const u=e.symbol.isClassVar();let y=t.isClassVar();if(u&&!y&&(t.hasTypedDeclarations()||(y=!0),t.getTypedDeclarations().every((e=>6===e.type))&&(y=!0)),u!==y){const n=t.isClassVar()?m.Localizer.Diagnostic.classVarOverridesInstanceVar():m.Localizer.Diagnostic.instanceVarOverridesClassVar(),s=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride,c.DiagnosticRule.reportIncompatibleVariableOverride,n.format({name:i,className:e.classType.details.name}),r.node),a=(0,N.getLastTypedDeclaredForSymbol)(e.symbol);s&&a&&s.addRelatedInfo(m.Localizer.DiagnosticAddendum.overriddenSymbol(),a.path,a.range)}}}}_validateMethod(e,t,n){var s,i,a,r;const o=this._evaluator.getTypeOfClass(n),l=null==o?void 0:o.classType;if(e.name&&l&&["__init__","__init_subclass__","__enter__","__exit__"].some((t=>t===e.name.value))&&(M.FunctionType.isAbstractMethod(t)||M.FunctionType.isOverloaded(t)||this._fileInfo.isStubFile||this._validateSuperCallForMethod(e,t,l)),"__new__"===(null===(s=e.name)||void 0===s?void 0:s.value))0!==e.parameters.length&&e.parameters[0].name&&["cls","_cls","__cls","__mcls","mcls","mcs"].some((t=>e.parameters[0].name.value===t))||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,c.DiagnosticRule.reportSelfClsParameterName,m.Localizer.Diagnostic.newClsParam(),e.parameters.length>0?e.parameters[0]:e.name),l&&this._validateClsSelfParameterType(t,l,!0);else if("__init_subclass__"===(null===(i=e.name)||void 0===i?void 0:i.value))0!==e.parameters.length&&e.parameters[0].name&&"cls"===e.parameters[0].name.value||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,c.DiagnosticRule.reportSelfClsParameterName,m.Localizer.Diagnostic.initSubclassClsParam(),e.parameters.length>0?e.parameters[0]:e.name),l&&this._validateClsSelfParameterType(t,l,!0);else if("__class_getitem__"===(null===(a=e.name)||void 0===a?void 0:a.value))0!==e.parameters.length&&e.parameters[0].name&&"cls"===e.parameters[0].name.value||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,c.DiagnosticRule.reportSelfClsParameterName,m.Localizer.Diagnostic.classGetItemClsParam(),e.parameters.length>0?e.parameters[0]:e.name),l&&this._validateClsSelfParameterType(t,l,!0);else if("_generate_next_value_"===(null===(r=e.name)||void 0===r?void 0:r.value));else if(M.FunctionType.isStaticMethod(t)){if(e.parameters.length>0&&e.parameters[0].name){const t=e.parameters[0].name.value;"self"!==t&&"cls"!==t||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,c.DiagnosticRule.reportSelfClsParameterName,m.Localizer.Diagnostic.staticClsSelfParam(),e.parameters[0].name)}}else if(M.FunctionType.isClassMethod(t)){let n="";e.parameters.length>0&&e.parameters[0].name&&(n=e.parameters[0].name.value),"cls"!==n&&(this._fileInfo.isStubFile&&(n.startsWith("_")||"metacls"===n)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,c.DiagnosticRule.reportSelfClsParameterName,m.Localizer.Diagnostic.classMethodClsParam(),e.parameters.length>0?e.parameters[0]:e.name)),l&&this._validateClsSelfParameterType(t,l,!0)}else{const s=e.decorators.length>0;if(M.FunctionType.isOverloaded(t)||!s){let t="",s=!0;if(e.parameters.length>0&&(e.parameters[0].name&&(t=e.parameters[0].name.value),0!==e.parameters[0].category&&(s=!1)),s&&"self"!==t){let s=!1;if(["cls","mcls","mcs"].some((e=>e===t))){const e=this._evaluator.getTypeOfClass(n),t=this._evaluator.getBuiltInType(n,"type");t&&(0,M.isInstantiableClass)(t)&&e&&(0,M.isInstantiableClass)(e.classType)&&(0,R.derivesFromClassRecursive)(e.classType,t,!0)&&(s=!0)}const i=A.isPrivateOrProtectedName(t);s||i||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,c.DiagnosticRule.reportSelfClsParameterName,m.Localizer.Diagnostic.instanceMethodSelfParam(),e.parameters.length>0?e.parameters[0]:e.name)}}l&&this._validateClsSelfParameterType(t,l,!1)}}_validateSuperCallForMethod(e,t,n){if("none"===this._fileInfo.diagnosticRuleSet.reportMissingSuperCall)return;let s=9;if(M.ClassType.isFinal(n)&&(s|=4),!(0,R.lookUpClassMember)(n,t.details.name,s))return;let i=!1;const a=new b.CallNodeWalker((e=>{if(35===e.leftExpression.nodeType&&e.leftExpression.memberName.value===t.details.name){const t=e.leftExpression.leftExpression;if(9===t.nodeType&&38===t.leftExpression.nodeType&&"super"===t.leftExpression.value)i=!0;else{const e=this._evaluator.getType(t);e&&(0,M.isInstantiableClass)(e)&&(i=!0)}}}));a.walk(e.suite),i||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingSuperCall,c.DiagnosticRule.reportMissingSuperCall,m.Localizer.Diagnostic.missingSuperCall().format({methodName:t.details.name}),e.name)}_validateClsSelfParameterType(e,t,n){if(e.details.parameters.length<1)return;const s=e.details.parameters[0];if(!s.typeAnnotation||!s.name)return;if(M.ClassType.isProtocolClass(t))return;const i=this._evaluator.makeTopLevelTypeVarsConcrete(s.type),a=n?t:(0,R.convertToInstance)(t);if((0,M.isInstantiableClass)(i)&&M.ClassType.isProtocolClass(i))return;if((0,M.isClassInstance)(i)&&M.ClassType.isProtocolClass(i))return;const r=new O.TypeVarContext((0,R.getTypeVarScopeId)(e));this._evaluator.assignType(i,a,void 0,r)||(0,M.isNever)(i)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.clsSelfParamTypeMismatch().format({name:s.name,classType:this._evaluator.printType(a)}),s.typeAnnotation)}_validateYieldType(e,t){let n,s;const i=b.getEnclosingFunction(e);if(i){const e=this._evaluator.getTypeOfFunction(i);e&&((0,o.assert)((0,M.isFunction)(e.functionType)),n=M.FunctionType.getSpecializedReturnType(e.functionType),n&&(s=(0,R.getGeneratorYieldType)(n,!!i.isAsync)),n&&!s&&i.returnTypeAnnotation&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,i.isAsync?m.Localizer.Diagnostic.generatorAsyncReturnType():m.Localizer.Diagnostic.generatorSyncReturnType(),i.returnTypeAnnotation))}if(this._evaluator.isNodeReachable(e,void 0))if(n&&(0,M.isNever)(n))this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.noReturnContainsYield(),e);else if(s){const n=new l.DiagnosticAddendum;this._evaluator.assignType(s,t,n)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.yieldTypeMismatch().format({exprType:this._evaluator.printType(t),yieldType:this._evaluator.printType(s)})+n.getString(),e.expression||e)}}_reportUnusedExceptStatements(e){let t=!1;const n=[];e.exceptClauses.forEach((e=>{var s,i;if(t||e.isExceptGroup||!e.typeExpression)return;const a=this._evaluator.getType(e.typeExpression);if(!a||(0,M.isAnyOrUnknown)(a))return void(t=!0);const r=[];if((0,M.isInstantiableClass)(a))a.includeSubclasses&&(t=!0),r.push(a);else if((0,M.isClassInstance)(a)){const e=null!==(i=null===(s=this._evaluator.getTypeOfIterator({type:a},!1,void 0))||void 0===s?void 0:s.type)&&void 0!==i?i:M.UnknownType.create();(0,R.doForEachSubtype)(e,(e=>{(0,M.isAnyOrUnknown)(e)&&(t=!0),(0,M.isInstantiableClass)(e)&&(e.includeSubclasses&&(t=!0),r.push(e))}))}else t=!0;if(n.length>0&&!t){const t=new l.DiagnosticAddendum;let s=0;r.forEach((e=>{const i=n.find((t=>(0,R.derivesFromClassRecursive)(e,t,!0)));i&&(t.addMessage(m.Localizer.DiagnosticAddendum.unreachableExcept().format({exceptionType:this._evaluator.printType((0,R.convertToInstance)(e)),parentType:this._evaluator.printType((0,R.convertToInstance)(i))})),s++)})),r.length===s&&(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.unreachableExcept()+t.getString(),e.typeExpression),this._evaluator.addUnreachableCode(e,e.exceptSuite))}n.push(...r)}))}_reportDuplicateImports(){const e=(0,_.getTopLevelImports)(this._moduleNode),t=new Map;e.orderedImports.forEach((e=>{if(22===e.node.nodeType){const t=new Map;e.node.imports.forEach((e=>{e.alias||(t.get(e.name.value)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportDuplicateImport,c.DiagnosticRule.reportDuplicateImport,m.Localizer.Diagnostic.duplicateImport().format({importName:e.name.value}),e.name):t.set(e.name.value,e))}))}else e.subnode&&!e.subnode.alias&&(t.get(e.moduleName)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportDuplicateImport,c.DiagnosticRule.reportDuplicateImport,m.Localizer.Diagnostic.duplicateImport().format({importName:e.moduleName}),e.subnode):t.set(e.moduleName,e.subnode))}))}_checkRegions(){const e=(0,x.getRegionComments)(this._parseResults),t=[];e.forEach((e=>{0===e.type?t.push(e):t.length>0?t.pop():this._addDiagnosticForRegionComment(e,m.Localizer.Diagnostic.unmatchedEndregionComment())})),t.forEach((e=>{this._addDiagnosticForRegionComment(e,m.Localizer.Diagnostic.unmatchedRegionComment())}))}_addDiagnosticForRegionComment(e,t){return this._evaluator.addDiagnosticForTextRange(this._fileInfo,"error","",t,{start:e.comment.start-1,length:e.comment.length+1})}}t.Checker=L},2835:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CircularDependency=void 0,t.CircularDependency=class{constructor(){this._paths=[]}appendPath(e){this._paths.push(e)}getPaths(){return this._paths}normalizeOrder(){let e=0;this._paths.forEach(((t,n)=>{t<this._paths[e]&&(e=n)})),0!==e&&(this._paths=this._paths.slice(e).concat(this._paths.slice(0,e)))}isEqual(e){if(e._paths.length!==this._paths.length)return!1;for(let t=0;t<this._paths.length;t++)if(this._paths[t]!==e._paths[t])return!1;return!0}}},4184:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCodeFlowEngine=t.isIncompleteType=void 0;const s=n(5839),i=n(1464),a=n(563),r=n(4972),o=n(7280),l=n(8494),c=n(9453),p=n(4610),d=n(1133),u=n(5168);function y(e){return!!e.isIncompleteType}t.isIncompleteType=y,t.getCodeFlowEngine=function(e,t){const n=new Map,m=new Map,g=new Map;let h=1,f=0,T=0;function v(t,i,a=!1){const o=new Set;if(n.has(t.id))return!0;n.set(t.id,!0);try{return function t(n,i,l=0){if(l>64)return!0;l++;let c=n;for(;;){if(o.has(c.id))return!1;if(o.add(c.id),c.flags&r.FlowFlags.Unreachable)return!1;if(c===i)return!0;if(c.flags&(r.FlowFlags.VariableAnnotation|r.FlowFlags.Assignment|r.FlowFlags.TrueCondition|r.FlowFlags.FalseCondition|r.FlowFlags.WildcardImport|r.FlowFlags.TrueNeverCondition|r.FlowFlags.FalseNeverCondition|r.FlowFlags.NarrowForPattern|r.FlowFlags.ExhaustedMatch))c=c.antecedent;else if(c.flags&r.FlowFlags.Call){const t=c;if(!a&&I(e,t))return!1;c=t.antecedent}else{if(c.flags&(r.FlowFlags.BranchLabel|r.FlowFlags.LoopLabel)){if(c.flags&r.FlowFlags.PostContextManager){const t=c;if(!t.expressions.some((n=>C(e,n,t.isAsync))))return!1}const n=c;for(const e of n.antecedents)if(t(e,i,l))return!0;return!1}if(c.flags&r.FlowFlags.Start)return!i;if(!(c.flags&r.FlowFlags.PreFinallyGate)){if(c.flags&r.FlowFlags.PostFinally){const e=c,n=e.preFinallyGate.isGateClosed;try{return e.preFinallyGate.isGateClosed=!0,t(e.antecedent,i,l)}finally{e.preFinallyGate.isGateClosed=n}}return(0,s.fail)("Unexpected flow node flags"),!1}{const e=c;if(e.isGateClosed)return!1;c=e.antecedent}}}}(t,i)}finally{n.delete(t.id)}}function _(e,t){let n=!0;return(0,u.doForEachSubtype)(e,(e=>{(0,d.isTypeVar)(e)?(0,d.isTypeSame)(e,t)||(n=!1):e.condition&&e.condition.some((e=>e.isConstrainedTypeVar&&e.typeVarName===t.nameWithScope))||(n=!1)})),n}function I(e,t){const n=t.node;if(m.has(n.id)){return m.get(n.id)}if(f>d.maxTypeRecursionCount)return!1;m.set(n.id,!1),f++;try{let t=0,s=0;const i=e.getTypeOfExpression(n.leftExpression,2),a=i.type;(0,u.doForEachSubtype)(a,(a=>{var r;if(s++,(0,d.isInstantiableClass)(a)){if(a.details.effectiveMetaclass&&(0,d.isClass)(a.details.effectiveMetaclass)&&!d.ClassType.isBuiltIn(a.details.effectiveMetaclass,"type")&&(0,u.lookUpClassMember)(a.details.effectiveMetaclass,"__call__",12))return;let t=(0,u.lookUpClassMember)(a,"__init__",12);if(void 0===t&&(t=(0,u.lookUpClassMember)(a,"__new__",12)),t){const n=e.getTypeOfMember(t);if(n&&((0,d.isFunction)(n)||(0,d.isOverloadedFunction)(n))){const t=e.bindFunctionToClassOrObject(void 0,n);t&&(a=t)}}}else if((0,d.isClassInstance)(a)){const t=(0,u.lookUpClassMember)(a,"__call__",8);if(t){const n=e.getTypeOfMember(t);if(n&&((0,d.isFunction)(n)||(0,d.isOverloadedFunction)(n))){const t=e.bindFunctionToClassOrObject(void 0,n);t&&(a=t)}}}const o=6===(null===(r=n.parent)||void 0===r?void 0:r.nodeType);if((0,d.isFunction)(a))b(a,o)&&t++;else if((0,d.isOverloadedFunction)(a)){let s=0,r=0;if(d.OverloadedFunctionType.getOverloads(a).forEach((e=>{s++,b(e,o)&&r++})),r>0)if(r===s)t++;else{const s=e.validateOverloadedFunctionArguments(n,n.arguments,{type:a,isIncomplete:i.isIncomplete},void 0,!1,void 0);s.returnType&&(0,d.isNever)(s.returnType)&&t++}}}));const r=s>0&&t===s;return m.set(n.id,r),r}finally{f--}}function b(e,t){const n=e.details.declaredReturnType;return!!n&&(!!(d.FunctionType.isAsync(e)&&(0,d.isClassInstance)(n)&&d.ClassType.isBuiltIn(n,"Coroutine")&&n.typeArguments&&n.typeArguments.length>=3&&(0,d.isNever)(n.typeArguments[2])&&t)||(0,d.isNever)(n))}function C(e,t,n){var s;if(g.has(t.id))return g.get(t.id);if(g.set(t.id,!1),T>d.maxTypeRecursionCount)return!1;T++;let i=!1;try{const a=e.getTypeOfExpression(t).type;if(a&&(0,d.isClassInstance)(a)){const r=n?"__aexit__":"__exit__",o=null===(s=e.getTypeOfObjectMember(t,a,r))||void 0===s?void 0:s.type;if(o&&(0,d.isFunction)(o)&&o.details.declaredReturnType){const e=o.details.declaredReturnType;i=!1,(0,d.isClassInstance)(e)&&d.ClassType.isBuiltIn(e,"bool")&&(void 0!==e.literalValue&&!0!==e.literalValue||(i=!0))}}}finally{T--}return g.set(t.id,i),i}function S(t,n){const i=(0,a.getImportInfo)(t.node.module);(0,s.assert)(void 0!==i&&i.isImportFound),(0,s.assert)(t.node.isWildcardImport);const r=e.lookUpSymbolRecursive(t.node,n,!1);(0,s.assert)(void 0!==r);const o=r.symbol.getDeclarations().find((e=>e.node===t.node));return o&&e.getInferredTypeOfDeclaration(r.symbol,o)||d.UnknownType.create()}return{createCodeFlowAnalyzer:function(){const n=new Map;return{getTypeFromCodeFlow:function(i,a,o,m,g){const f=void 0!==a?(0,r.createKeyForReference)(a):void 0;let T;const _=function(e){let t=n.get(e);return t||(t={cache:new Map,pendingNodes:new Set},n.set(e,t)),t}(void 0!==f&&void 0!==o?f+`.${o.toString()}`:".");function b(e,n,s){if(s){if(n){const t=_.cache.get(e.id);if(t){const e=t;e.isIncompleteType&&e.type&&!(0,d.isTypeSame)(e.type,n)&&h++}}}else h++;const i=s?{isIncompleteType:!0,type:n,incompleteSubtypes:[],generationCount:h}:n;return _.cache.set(e.id,i),t.trackEntry(_.cache,e.id),{type:n,isIncomplete:s,generationCount:h,incompleteSubtypes:s?[]:void 0}}function x(e,t,n,i,a,r){const o=_.cache.get(e.id);void 0!==o&&y(o)||(0,s.fail)("setIncompleteSubtype can be called only on a valid incomplete cache entry");const l=o.incompleteSubtypes;if(t<l.length){const e=l[t];e.isIncomplete===i&&(0,d.isTypeSame)(e.type,n)?e.isPending!==a&&(l[t]={type:n,isIncomplete:i,isPending:a,evaluationCount:r}):(l[t]={type:n,isIncomplete:i,isPending:a,evaluationCount:r},h++)}else(0,s.assert)(l.length===t),l.push({type:n,isIncomplete:i,isPending:a,evaluationCount:r}),h++;let c;if(o.incompleteSubtypes.length>0){const e=[];o.incompleteSubtypes.forEach((t=>{t.type&&e.push(t.type)})),c=e.length>0?(0,d.combineTypes)(e):void 0}return o.type=c,o.generationCount=h,D(e)}function D(e){if(!_.cache.has(e.id))return;const t=_.cache.get(e.id);return void 0===t?{type:void 0,isIncomplete:!1}:y(t)?{type:t.type,isIncomplete:!0,incompleteSubtypes:t.incompleteSubtypes,generationCount:t.generationCount}:{type:t,isIncomplete:!1}}function F(t){let n=t.node;const s=t.node.parent;return s&&(28!==s.nodeType&&10!==s.nodeType||(n=s)),e.evaluateTypeForSubnode(n,(()=>{e.evaluateTypesForStatement(t.node)}))}function E(e,t){_.pendingNodes.add(e.id);try{const n=t();return _.pendingNodes.delete(e.id),n}catch(t){throw _.pendingNodes.delete(e.id),t}}function P(t){var n,i;let y=t;for(e.checkForCancellation();;){const t=D(y);if(t){if(!t.isIncomplete)return t;if(t.generationCount===h)return{type:t.type?(0,d.cleanIncompleteUnknown)(t.type):void 0,isIncomplete:!0}}if(_.pendingNodes.has(y.id))return{type:null!==(n=null==t?void 0:t.type)&&void 0!==n?n:d.UnknownType.create(!0),isIncomplete:!0};if(y.flags&r.FlowFlags.Unreachable)return b(y,d.NeverType.createNever(),!1);if(y.flags&r.FlowFlags.VariableAnnotation)y=y.antecedent;else if(y.flags&r.FlowFlags.Call){const t=y;if(!(null==g?void 0:g.skipNoReturnCallAnalysis)&&I(e,t))return b(y,void 0,!1);y=t.antecedent}else if(y.flags&r.FlowFlags.Assignment){const t=y,n=t.node;if(a){if(o===t.targetSymbolId&&(0,l.isMatchingExpression)(a,n)){if(y.flags&r.FlowFlags.Unbind)return b(y,d.UnboundType.create(),!1);let s=E(y,(()=>F(t)));return s&&((0,u.isTypeAliasPlaceholder)(s.type)||35===a.nodeType&&e.isAsymmetricDescriptorAssignment(n))&&(s=void 0),b(y,null==s?void 0:s.type,!!(null==s?void 0:s.isIncomplete))}if(24===n.nodeType&&(0,l.isMatchingExpression)(a,n.baseExpression)&&3===(null===(i=n.parent)||void 0===i?void 0:i.nodeType)&&1===n.items.length&&!n.trailingComma&&!n.items[0].name&&0===n.items[0].argumentCategory&&48===n.items[0].valueExpression.nodeType&&1===n.items[0].valueExpression.strings.length&&49===n.items[0].valueExpression.strings[0].nodeType){const e=n.items[0].valueExpression.strings[0].value,s=E(t,(()=>{const n=P(t.antecedent);return n.type&&(n.type=(0,u.mapSubtypes)(n.type,(t=>(0,d.isClass)(t)&&d.ClassType.isTypedDictClass(t)?(0,c.narrowForKeyAssignment)(t,e):t))),n}));return b(y,null==s?void 0:s.type,!!(null==s?void 0:s.isIncomplete))}if((0,l.isPartialMatchingExpression)(a,n))return{type:m,isIncomplete:!!(null==g?void 0:g.isTypeAtStartIncomplete)}}y=t.antecedent}else{if(y.flags&r.FlowFlags.BranchLabel){const t=y;if(y.flags&r.FlowFlags.PostContextManager){const t=y;if(t.expressions.some((n=>C(e,n,t.isAsync)))===t.blockIfSwallowsExceptions)return b(y,void 0,!1)}if(a&&t.preBranchAntecedent&&t.affectedExpressions&&(T||(T=(0,r.createKeysForReferenceSubexpressions)(a)),!T.some((e=>t.affectedExpressions.has(e)))&&v(y,t.preBranchAntecedent))){y=t.preBranchAntecedent;continue}return A(y)}if(y.flags&r.FlowFlags.LoopLabel){const e=y;if(a&&(T||(T=(0,r.createKeysForReferenceSubexpressions)(a)),!T.some((t=>e.affectedExpressions.has(t))))){y=e.antecedents[0];continue}return N(e,t)}if(y.flags&(r.FlowFlags.TrueCondition|r.FlowFlags.FalseCondition)){const t=y;if(!(null==g?void 0:g.skipConditionalNarrowing)&&a){const n=E(y,(()=>{const n=(0,p.getTypeNarrowingCallback)(e,a,t.expression,!!(t.flags&(r.FlowFlags.TrueCondition|r.FlowFlags.TrueNeverCondition)));if(n){const e=P(t.antecedent);let s=e.type,i=e.isIncomplete;if(s){const e=n(s);e&&(s=e.type,e.isIncomplete&&(i=!0))}return b(y,s,i)}}));if(n)return n}y=t.antecedent}else if(y.flags&(r.FlowFlags.TrueNeverCondition|r.FlowFlags.FalseNeverCondition)){const t=y;if(!(null==g?void 0:g.skipConditionalNarrowing)&&t.reference&&(0,r.createKeyForReference)(t.reference)!==f){const n=e.lookUpSymbolRecursive(t.reference,t.reference.value,!1);if(n&&n.symbol.getTypedDeclarations().length>0){const n=E(y,(()=>{const n=(0,p.getTypeNarrowingCallback)(e,t.reference,t.expression,!!(t.flags&(r.FlowFlags.TrueCondition|r.FlowFlags.TrueNeverCondition)));if(n){const s=e.getTypeOfExpression(t.reference);let i=s.type,a=!!s.isIncomplete;const r=n(s.type);if(r&&(i=r.type,r.isIncomplete&&(a=!0)),(0,d.isNever)(i))return b(y,void 0,a)}}));if(n)return n}}y=t.antecedent}else if(y.flags&r.FlowFlags.ExhaustedMatch){const t=y,n=e.evaluateTypeForSubnode(t.node,(()=>{e.evaluateTypesForMatchStatement(t.node)}));if(n&&(0,d.isNever)(n.type))return b(y,n.type,!!n.isIncomplete);y=t.antecedent}else if(y.flags&r.FlowFlags.NarrowForPattern){const t=y;if(!a||(0,l.isMatchingExpression)(a,t.subjectExpression)){const n=e.evaluateTypeForSubnode(t.statement,(()=>{64===t.statement.nodeType?e.evaluateTypesForCaseStatement(t.statement):e.evaluateTypesForMatchStatement(t.statement)}));if(n){if(a)return b(y,n.type,!!n.isIncomplete);if((0,d.isNever)(n.type))return b(y,void 0,!!n.isIncomplete)}}y=t.antecedent}else{if(y.flags&r.FlowFlags.PreFinallyGate)return k(y);if(y.flags&r.FlowFlags.PostFinally)return w(y);if(y.flags&r.FlowFlags.Start)return b(y,m,!!(null==g?void 0:g.isTypeAtStartIncomplete));if(y.flags&r.FlowFlags.WildcardImport){const e=y;if(a&&38===a.nodeType){const t=a.value;if(e.names.some((e=>e===t)))return E(y,(()=>{const n=S(e,t);return b(y,n,!1)}))}y=e.antecedent}else(0,s.fail)("Unexpected flow node flags")}}}}function A(e){const t=[];let n=!1;return E(e,(()=>{for(const s of e.antecedents){const i=P(s);if(void 0===a&&i.type&&!(0,d.isNever)(i.type))return b(e,m,!1);i.isIncomplete&&(n=!0),i.type&&t.push(i.type)}const s=t.length>0?(0,d.combineTypes)(t):void 0;return b(e,s,n)}))}function N(e,t){var n;const s=e.antecedents.length;if(void 0===t)t=b(e,a?void 0:m,!0);else if(t.incompleteSubtypes&&t.incompleteSubtypes.length===e.antecedents.length&&t.incompleteSubtypes.some((e=>e.isPending)))return{type:t.type,isIncomplete:!0};let i=0;for(;;){let r=!1,o=!1,l=void 0===a&&(null===(n=t.incompleteSubtypes)||void 0===n?void 0:n.some((e=>void 0!==e.type))),c=!1;if(e.antecedents.forEach(((n,s)=>{var i,p;if(void 0===a&&l)return;if((t=D(e)).incompleteSubtypes&&s<t.incompleteSubtypes.length&&t.incompleteSubtypes[s].isPending)return r=!0,void(o=!0);const u=void 0!==t.incompleteSubtypes&&s<t.incompleteSubtypes.length?t.incompleteSubtypes[s]:void 0;if(void 0===u||!(null==u?void 0:u.isPending)&&(null==u?void 0:u.isIncomplete)){const a=void 0===u?0:u.evaluationCount;t=x(e,s,null!==(i=null==u?void 0:u.type)&&void 0!==i?i:d.UnknownType.create(!0),!0,!0,a);try{const i=P(n);i.isIncomplete&&(r=!0,0===s&&(c=!0)),t=x(e,s,null!==(p=i.type)&&void 0!==p?p:i.isIncomplete?d.UnknownType.create(!0):d.NeverType.createNever(),i.isIncomplete,!1,a+1)}catch(t){throw x(e,s,d.UnknownType.create(!0),!0,!1,a+1),t}}void 0===a&&void 0!==(null==t?void 0:t.type)&&(l=!0)})),l)return o?{type:m,isIncomplete:!1}:b(e,m,!1);let p=t.type;if(r&&p&&(p=(0,d.cleanIncompleteUnknown)(p)),!r||i>=s){let t=r;return o||!p||(0,u.isIncompleteUnknown)(p)||c||(h++,t=!1),o||r?{type:p,isIncomplete:t}:b(e,p,!1)}i++}}function k(e){return e.isGateClosed?{type:void 0,isIncomplete:!1}:E(e,(()=>{const t=P(e.antecedent);return function(e){_.cache.delete(e.id)}(e),{type:t.type,isIncomplete:t.isIncomplete}}))}function w(t){const n=t.preFinallyGate.isGateClosed;try{let s;return t.preFinallyGate.isGateClosed=!0,e.useSpeculativeMode(t.finallyNode,(()=>{s=P(t.antecedent)})),s.isIncomplete?s:b(t,s.type,!1)}finally{t.preFinallyGate.isGateClosed=n}}return i?P(i):{type:m,isIncomplete:!!(null==g?void 0:g.isTypeAtStartIncomplete)}}}},isFlowNodeReachable:v,narrowConstrainedTypeVar:function(t,n){(0,s.assert)(!n.details.isParamSpec),(0,s.assert)(!n.details.isVariadic),(0,s.assert)(!n.details.boundType),(0,s.assert)(n.details.constraints.length>0);const i=new Set,a=[];for(const e of n.details.constraints){if(!(0,d.isClassInstance)(e))return;a.push(e)}const o=function t(n,o){let l=n;for(;;){if(i.has(l.id))return a;if(l.flags&(r.FlowFlags.Unreachable|r.FlowFlags.Start))return a;if(l.flags&(r.FlowFlags.VariableAnnotation|r.FlowFlags.Assignment|r.FlowFlags.WildcardImport|r.FlowFlags.TrueNeverCondition|r.FlowFlags.FalseNeverCondition|r.FlowFlags.NarrowForPattern|r.FlowFlags.ExhaustedMatch|r.FlowFlags.PostFinally|r.FlowFlags.PreFinallyGate|r.FlowFlags.Call))l=l.antecedent;else{if(!(l.flags&(r.FlowFlags.TrueCondition|r.FlowFlags.FalseCondition))){if(l.flags&(r.FlowFlags.BranchLabel|r.FlowFlags.LoopLabel)){const e=l,n=[];i.add(l.id);for(const s of e.antecedents){const e=t(s,o);for(const t of e)n.some((e=>(0,d.isTypeSame)(e,t)))||n.push(t)}return i.delete(l.id),n}return(0,s.fail)("Unexpected flow node flags"),a}{const n=l,s=n.expression,a=0!=(l.flags&r.FlowFlags.TrueCondition);if(9===s.nodeType&&38===s.leftExpression.nodeType&&"isinstance"===s.leftExpression.value&&2===s.arguments.length){const r=s.arguments[0].valueExpression;if(_(e.getTypeOfExpression(r).type,o)){i.add(l.id);const r=t(n.antecedent,o);i.delete(l.id);const c=s.arguments[1].valueExpression,p=e.getTypeOfExpression(c,104).type;if((0,d.isInstantiableClass)(p))return r.filter((e=>d.ClassType.isSameGenericClass(e,p)?a:!a))}}l=n.antecedent}}}}(t,n);return 1===o.length?o[0]:void 0},printControlFlowGraph:function(e,t,n,s=console){let r="";if(t){const e=(0,a.getFileInfo)(t),n=(0,i.convertOffsetToPosition)(t.start,e.lines);r=`${(0,l.printExpression)(t)}[${n.line+1}:${n.character+1}]`}s.log(`${n}@${e.id}: ${r||"(none)"}`),s.log((0,o.formatControlFlowGraph)(e))}}}},4972:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wildcardImportReferenceKey=t.createKeysForReferenceSubexpressions=t.createKeyForReference=t.isCodeFlowSupportedForReference=t.getUniqueFlowNodeId=t.FlowFlags=void 0;const s=n(5839);var i;(i=t.FlowFlags||(t.FlowFlags={}))[i.Unreachable=1]="Unreachable",i[i.Start=2]="Start",i[i.BranchLabel=4]="BranchLabel",i[i.LoopLabel=8]="LoopLabel",i[i.Assignment=16]="Assignment",i[i.Unbind=32]="Unbind",i[i.WildcardImport=64]="WildcardImport",i[i.TrueCondition=128]="TrueCondition",i[i.FalseCondition=512]="FalseCondition",i[i.Call=1024]="Call",i[i.PreFinallyGate=2048]="PreFinallyGate",i[i.PostFinally=4096]="PostFinally",i[i.VariableAnnotation=16384]="VariableAnnotation",i[i.PostContextManager=32768]="PostContextManager",i[i.TrueNeverCondition=65536]="TrueNeverCondition",i[i.FalseNeverCondition=131072]="FalseNeverCondition",i[i.NarrowForPattern=262144]="NarrowForPattern",i[i.ExhaustedMatch=524288]="ExhaustedMatch";let a=1;function r(e){let t;if(38===e.nodeType)t=e.value;else if(35===e.nodeType)t=`${r(e.leftExpression)}.${e.memberName.value}`;else if(24===e.nodeType){const n=r(e.baseExpression);(0,s.assert)(1===e.items.length);const i=e.items[0].valueExpression;if(40===i.nodeType)t=`${n}[${i.value.toString()}]`;else if(48===i.nodeType){const e=i;(0,s.assert)(1===e.strings.length&&49===e.strings[0].nodeType),t=`${n}["${e.strings[0].value}"]`}else 55===i.nodeType&&33===i.operator&&40===i.expression.nodeType?t=`${n}[-${i.expression.value.toString()}]`:(0,s.fail)("createKeyForReference received unexpected index type")}else(0,s.fail)("createKeyForReference received unexpected expression type");return t}t.getUniqueFlowNodeId=function(){return a++},t.isCodeFlowSupportedForReference=function e(t){if(38===t.nodeType)return!0;if(35===t.nodeType)return e(t.leftExpression);if(24===t.nodeType){if(1!==t.items.length||t.trailingComma||void 0!==t.items[0].name||0!==t.items[0].argumentCategory)return!1;const n=t.items[0].valueExpression,s=40===n.nodeType&&!n.isImaginary&&n.isInteger,i=55===n.nodeType&&33===n.operator&&40===n.expression.nodeType&&!n.expression.isImaginary&&n.expression.isInteger,a=48===n.nodeType&&1===n.strings.length&&49===n.strings[0].nodeType;return!!(s||i||a)&&e(t.baseExpression)}return!1},t.createKeyForReference=r,t.createKeysForReferenceSubexpressions=function e(t){return 38===t.nodeType?[r(t)]:35===t.nodeType?[...e(t.leftExpression),r(t)]:24===t.nodeType?[...e(t.baseExpression),r(t)]:void(0,s.fail)("createKeyForReference received unexpected expression type")},t.wildcardImportReferenceKey="*"},7280:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatControlFlowGraph=void 0;const s=n(1464),i=n(563),a=n(4972);t.formatControlFlowGraph=function(e){const t=Object.create(null),n=[],r=[],o=d(e,new Set);for(const e of n)e.text=m(e.flowNode,e.circular),y(e);const l=function(e){const t=h(Array(e),0);for(const e of n)t[e.level]=Math.max(t[e.level],e.text.length);return t}(function e(t){let n=0;for(const s of c(t))n=Math.max(n,e(s));return n+1}(o));return function e(t,n){if(-1===t.lane){t.lane=n,t.endLane=n;const s=c(t);for(let i=0;i<s.length;i++){i>0&&n++;const a=s[i];e(a,n),a.endLane>t.endLane&&(n=a.endLane)}t.endLane=n}}(o,0),function(){const e=l.length,t=n.reduce(((e,t)=>Math.max(e,t.lane)),0)+1,s=h(Array(t),""),i=l.map((()=>Array(t))),a=l.map((()=>h(Array(t),0)));for(const e of n){i[e.level][e.lane]=e;const t=c(e);for(let n=0;n<t.length;n++){const s=t[n];let i=8;s.lane===e.lane&&(i|=4),n>0&&(i|=1),n<t.length-1&&(i|=2),a[e.level][s.lane]|=i}0===t.length&&(a[e.level][e.lane]|=16);const n=p(e);for(let t=0;t<n.length;t++){const s=n[t];let i=4;t>0&&(i|=1),t<n.length-1&&(i|=2),a[e.level-1][s.lane]|=i}}for(let n=0;n<e;n++)for(let e=0;e<t;e++){const t=n>0?a[n-1][e]:0,s=e>0?a[n][e-1]:0;let i=a[n][e];i||(8&t&&(i|=12),2&s&&(i|=3),a[n][e]=i)}for(let t=0;t<e;t++)for(let n=0;n<s.length;n++){const s=a[t][n],o=4&s?"":" ",c=i[t][n];c?(r(n,c.text),t<e-1&&(r(n," "),r(n,f(o,l[t]-c.text.length)))):t<e-1&&r(n,f(o,l[t]+1)),r(n,g(s)),r(n,8&s&&t<e-1&&!i[t+1][n]?"":" ")}return`${s.join("\n")}\n`;function r(e,t){s[e]+=t}}();function c(e){const t=[];for(const n of e.edges)n.source===e&&t.push(n.target);return t}function p(e){const t=[];for(const n of e.edges)n.target===e&&t.push(n.source);return t}function d(e,s){const i=e.id;let r=t[i];if(r&&s.has(e))return r={id:-1,flowNode:e,edges:[],text:"",lane:-1,endLane:-1,level:-1,circular:!0},n.push(r),r;if(s.add(e),!r){t[i]=r={id:i,flowNode:e,edges:[],text:"",lane:-1,endLane:-1,level:-1,circular:!1},n.push(r);const l=(o=e).flags&(a.FlowFlags.LoopLabel|a.FlowFlags.BranchLabel)?o.antecedents:o.flags&(a.FlowFlags.Assignment|a.FlowFlags.VariableAnnotation|a.FlowFlags.WildcardImport|a.FlowFlags.TrueCondition|a.FlowFlags.FalseCondition|a.FlowFlags.NarrowForPattern|a.FlowFlags.ExhaustedMatch|a.FlowFlags.Call|a.FlowFlags.PreFinallyGate|a.FlowFlags.PostFinally)?[o.antecedent]:[];for(const e of l)u(r,e,s)}var o;return s.delete(e),r}function u(e,t,n){const s=d(t,n),i={source:e,target:s};r.push(i),e.edges.push(i),s.edges.push(i)}function y(e){if(-1!==e.level)return e.level;let t=0;for(const n of p(e))t=Math.max(t,y(n)+1);return e.level=t}function m(e,t){const n=`${function(e){if(e&a.FlowFlags.Start)return"Start";if(e&a.FlowFlags.BranchLabel)return"Branch";if(e&a.FlowFlags.LoopLabel)return"Loop";if(e&a.FlowFlags.Unbind)return"Unbind";if(e&a.FlowFlags.Assignment)return"Assign";if(e&a.FlowFlags.TrueCondition)return"True";if(e&a.FlowFlags.FalseCondition)return"False";if(e&a.FlowFlags.Call)return"Call";if(e&a.FlowFlags.Unreachable)return"Unreachable";if(e&a.FlowFlags.WildcardImport)return"Wildcard";if(e&a.FlowFlags.PreFinallyGate)return"PreFinal";if(e&a.FlowFlags.PostFinally)return"PostFinal";if(e&a.FlowFlags.VariableAnnotation)return"Annotate";if(e&a.FlowFlags.TrueNeverCondition)return"TrueNever";if(e&a.FlowFlags.FalseNeverCondition)return"FalseNever";if(e&a.FlowFlags.NarrowForPattern)return"Pattern";if(e&a.FlowFlags.ExhaustedMatch)return"Exhaust";throw new Error}(e.flags)}@${e.id}${function(e){const t=function(e){return e.flags&a.FlowFlags.Assignment||e.flags&a.FlowFlags.WildcardImport?e.node:e.flags&(a.FlowFlags.TrueCondition|a.FlowFlags.FalseCondition)?e.expression:e.flags&a.FlowFlags.NarrowForPattern?e.statement:e.flags&a.FlowFlags.Call?e.node:void 0}(e);if(!t)return;const n=(0,i.getFileInfo)(t),r=(0,s.convertOffsetToPosition)(t.start,n.lines);return`[${r.line+1}:${r.character+1}]`}(e)||""}`;return t?`Circular(${n})`:n}function g(e){switch(e){case 3:return"";case 12:return"";case 5:return"";case 9:return"";case 6:return"";case 10:return"";case 7:return"";case 11:return"";case 13:return"";case 14:return"";case 15:return""}return" "}function h(e,t){if(e.fill)e.fill(t);else for(let n=0;n<e.length;n++)e[n]=t;return e}function f(e,t){if(e.repeat)return t>0?e.repeat(t):"";let n="";for(;n.length<t;)n+=e;return n}}},2272:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFileLevelDirectives=void 0;const s=n(2930),i=n(5839),a=n(9866),r="strict",o="basic";function l(e){!function(e,t,n){const i=(0,s.getBooleanDiagnosticRules)(),a=(0,s.getDiagLevelDiagnosticRules)();for(const s of i)n.find((e=>e===s))||t[s]&&(e[s]=!0);for(const s of a){if(n.find((e=>e===s)))continue;const i=t[s],a=e[s];("error"===i||"warning"===i&&"error"!==a||"information"===i&&"error"!==a&&"warning"!==a)&&(e[s]=i)}}(e,(0,s.getStrictDiagnosticRuleSet)(),(0,s.getStrictModeNotOverriddenRules)())}function c(e,t,n,i){const a="pyright:";if(e.startsWith(a)){const c=e.substring(a.length);if(c.trim().startsWith("ignore"))return n;const u=c.split(",");u.some((e=>e.trim()===r))?l(n):u.some((e=>e.trim()===o))&&function(e){!function(e,t){const n=(0,s.getBooleanDiagnosticRules)(),i=(0,s.getDiagLevelDiagnosticRules)();for(const s of n)e[s]=t[s];for(const n of i)e[n]=t[n]}(e,(0,s.getBasicDiagnosticRuleSet)())}(n);let y=0;for(const e of u){const s={start:t.start+a.length+y,length:e.length};n=p(d(e,s),s,n,i),y+=e.length+1}}return n}function p(e,t,n,i){const l=e.split("="),c={start:t.start,length:l[0].length},p=d(l[0],c);if(1===l.length&&p&&[r,o].some((e=>p===e)))return n;const u=(0,s.getDiagLevelDiagnosticRules)(),y=(0,s.getBooleanDiagnosticRules)(),m=l.length>0?l.slice(1).join("="):"",g={start:t.start+l[0].length+1,length:m.length},h=d(m,g);if(u.find((e=>e===p))){const e=function(e){switch(e){case"false":case"none":return"none";case"true":case"error":return"error";case"warning":return"warning";case"information":return"information";default:return}}(h);if(void 0!==e)n[p]=e;else{const e={message:a.Localizer.Diagnostic.pyrightCommentInvalidDiagnosticSeverityValue(),range:h?g:c};i.push(e)}}else if(y.find((e=>e===p))){const e="false"!==(f=h)&&("true"===f||void 0);if(void 0!==e)n[p]=e;else{const e={message:a.Localizer.Diagnostic.pyrightCommentInvalidDiagnosticBoolValue(),range:h?g:c};i.push(e)}}else if(p){const e={message:h?a.Localizer.Diagnostic.pyrightCommentUnknownDiagnosticRule().format({rule:p}):a.Localizer.Diagnostic.pyrightCommentUnknownDirective().format({directive:p}),range:c};i.push(e)}else{const e={message:a.Localizer.Diagnostic.pyrightCommentMissingDirective(),range:c};i.push(e)}var f;return n}function d(e,t){(0,i.assert)(e.length===t.length);const n=e.trimStart();if(n!==e){const s=e.length-n.length;t.start+=s,t.length-=s}const s=n.trimEnd();return s!==n&&(t.length-=n.length-s.length),(0,i.assert)(s.length===t.length),s}t.getFileLevelDirectives=function(e,t,n,i){let a=(0,s.cloneDiagnosticRuleSet)(t);n&&l(a);for(let t=0;t<e.count;t++){const n=e.getItemAt(t);if(n.comments)for(const e of n.comments){const t={start:e.start,length:e.length};a=c(d(e.value,t),t,a,i)}}return a}},2044:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.populateTypeVarContextBasedOnExpectedType=t.assignTypeToTypeVar=void 0;const s=n(1290),i=n(9866),a=n(503),r=n(1133),o=n(5168),l=n(4447);t.assignTypeToTypeVar=function(e,t,n,c,p,d=0,u=0){let y=!0;const m=0!=(2&d);if(!t.scopeId)return!0;if(!p.hasSolveForScope(t.scopeId)){if((0,r.isAnyOrUnknown)(n)||(0,r.isClass)(n)&&r.ClassType.derivesFromAnyOrUnknown(n))return!0;if(t.details.isParamSpec&&(0,r.isFunction)(n)&&r.FunctionType.isParamSpecValue(n)&&r.FunctionType.shouldSkipArgsKwargsCompatibilityCheck(n))return!0;if((0,r.isNever)(n)&&0==(1&d))return!0;if(0!=(512&d))return!0;if(y=!1,!t.details.isSynthesized)return null==c||c.addMessage(i.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:e.printType(n),destType:e.printType(t)})),!1}if(0!=(8&d))return e.assignType(e.makeTopLevelTypeVarsConcrete(t),e.makeTopLevelTypeVarsConcrete(n),c,void 0,void 0,d,u);if(t.details.isParamSpec)return function(e,t,n,s,a,l=0){let c=!0;return a.doForEachSignature((p=>{if((0,r.isTypeVar)(n)&&n.details.isParamSpec){const e=p.getParamSpecType(t);if(!e)return void(!a.isLocked()&&a.hasSolveForScope(t.scopeId)&&a.setTypeVarType(t,(0,o.convertTypeToParamSpecValue)(n)));if(0===e.details.parameters.length&&e.details.paramSpec&&(0,r.isTypeSame)(e.details.paramSpec,n,{},l))return}else if((0,r.isFunction)(n)){const s=n,i=n.details.parameters.map(((e,t)=>({category:e.category,name:e.name,isNameSynthesized:e.isNameSynthesized,hasDefault:!!e.hasDefault,defaultValueExpression:e.defaultValueExpression,type:r.FunctionType.getEffectiveParameterType(s,t)}))),c=p.getParamSpecType(t);if(!c){if(!a.isLocked()&&a.hasSolveForScope(t.scopeId)){const e=r.FunctionType.createInstance("","","",n.details.flags);i.forEach((t=>{r.FunctionType.addParameter(e,t)})),e.details.typeVarScopeId=n.details.typeVarScopeId,e.details.docString=n.details.docString,e.details.paramSpec=n.details.paramSpec,a.setTypeVarType(t,e)}return}if(c.details.paramSpec===n.details.paramSpec){const t=(0,o.convertParamSpecValueToType)(c,!0),s=r.FunctionType.createInstance("","","",n.details.flags);if(i.forEach((e=>{r.FunctionType.addParameter(s,e)})),s.details.typeVarScopeId=n.details.typeVarScopeId,e.assignType(t,s,void 0,void 0,void 0,32,l))return}}else if((0,r.isAnyOrUnknown)(n))return;null==s||s.addMessage(i.Localizer.DiagnosticAddendum.typeParamSpec().format({type:e.printType(n),name:t.details.name})),c=!1})),c}(e,t,n,c,p,u);if(t.details.isVariadic&&!t.isVariadicInUnion&&!(0,r.isUnpacked)(n)){const t=e.getTupleClassType();n=t&&(0,r.isInstantiableClass)(t)?(0,o.convertToInstance)((0,o.specializeTupleClass)(t,[{type:n,isUnbounded:!1}],!0,!0)):r.UnknownType.create()}(0,r.isTypeVar)(n)&&n.details.isVariadic&&n.isVariadicUnpacked&&!n.isVariadicInUnion&&!t.details.isVariadic&&(n=r.TypeVarType.cloneForUnpacked(n,!0)),r.TypeBase.isInstantiable(t)&&(0,r.isClassInstance)(n)&&r.ClassType.isBuiltIn(n,"type")&&!n.typeArguments&&(n=r.AnyType.create());const g=p.getPrimarySignature().getTypeVar(t),h=null==g?void 0:g.narrowBound;let f=null==g?void 0:g.wideBound;if(f||t.details.isSynthesizedSelf||(f=t.details.boundType),t.details.constraints.length>0){let s;const a=e.makeTopLevelTypeVarsConcrete(n);if((0,r.isTypeVar)(n))e.assignType(t,a,void 0,new l.TypeVarContext(t.scopeId),void 0,0,u)&&(s=n,r.TypeBase.isInstantiable(n)&&(s=(0,o.convertToInstance)(n,!1)));else{let n,i=!0;s=(0,o.mapSubtypes)(a,(s=>{let a,l;return(0,r.isAnyOrUnknown)(s)?s:(t.details.constraints.forEach(((n,i)=>{const c=r.TypeBase.isInstantiable(t)?(0,o.convertToInstantiable)(n):n;e.assignType(c,s,void 0,void 0,void 0,0,u)&&(a&&!e.assignType(r.TypeBase.isInstantiable(t)?(0,o.convertToInstantiable)(a):a,c,void 0,void 0,void 0,0,u)||(a=(0,o.addConditionToType)(n,(0,o.getTypeCondition)(s)),l=i))})),a||m||(i=!1),void 0===l||(0,o.getTypeCondition)(s)||(void 0!==n&&n!==l&&(i=!1),n=l),a)})),!(0,r.isNever)(s)&&i||(s=void 0),!s&&(0,r.isUnion)(a)&&(s=t.details.constraints.find((n=>{const s=r.TypeBase.isInstantiable(t)?(0,o.convertToInstantiable)(n):n;return e.assignType(s,a,void 0,void 0,void 0,0,u)})))}if(!s)return null==c||c.addMessage(i.Localizer.DiagnosticAddendum.typeConstrainedTypeVar().format({type:e.printType(n),name:t.details.name})),!1;if(h&&!(0,r.isAnyOrUnknown)(h)){if(!e.assignType(h,s,void 0,void 0,void 0,0,u)){if(!e.assignType(s,h,void 0,void 0,void 0,0,u))return null==c||c.addMessage(i.Localizer.DiagnosticAddendum.typeConstrainedTypeVar().format({type:e.printType(s),name:e.printType(h)})),!1;!p.isLocked()&&y&&p.setTypeVarType(t,s)}}else!p.isLocked()&&y&&p.setTypeVarType(t,s);return!0}let T=h,v=f;const _=c?new s.DiagnosticAddendum:void 0;let I=n;if(r.TypeBase.isInstantiable(t)){if(!(0,o.isEffectivelyInstantiable)(I))return null==c||c.addMessage(i.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:e.printType(I),destType:e.printType(t)})),!1;I=(0,o.convertToInstance)(I,!1)}else if((0,r.isTypeVar)(n)&&r.TypeBase.isInstantiable(n)&&(0,r.isTypeSame)((0,o.convertToInstance)(n),t))return null==c||c.addMessage(i.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:e.printType(I),destType:e.printType(t)})),!1;if(0!=(1024&d))0!=(1&d)?(T=I,v=I):m?T=I:v=I;else if(m){if(f){if(!(0,r.isTypeSame)(f,I,{},u))if(e.assignType(f,e.makeTopLevelTypeVarsConcrete(I),_,void 0,void 0,512&d,u))v=I;else if(!e.assignType(I,f,_,void 0,void 0,512&d,u))return c&&_&&(c.addMessage(i.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:e.printType(I),destType:e.printType(f)})),c.addAddendum(_)),!1}else v=I;if(h&&!e.assignType(v,h,void 0,void 0,void 0,512&d,u))return c&&_&&(c.addMessage(i.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:e.printType(I),destType:e.printType(h)})),c.addAddendum(_)),!1}else{if(h){if(!(0,r.isTypeSame)(h,I,{},u))if(e.assignType(h,I,_,new l.TypeVarContext(t.scopeId),void 0,d,u))T=(0,o.isPartlyUnknown)(h)&&!(0,r.isUnknown)(I)&&e.assignType(I,h,void 0,new l.TypeVarContext(t.scopeId),void 0,512&d,u)?I:(0,o.applySolvedTypeVars)(h,p);else{if(p.isLocked())return null==c||c.addMessage(i.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:e.printType(h),destType:e.printType(I)})),!1;if(e.assignType(I,h,void 0,new l.TypeVarContext(t.scopeId),void 0,512&d,u))T=I;else if((0,r.isVariadicTypeVar)(t)){const t=function(e,t){if(!(0,r.isUnpackedClass)(e)||!(0,r.isUnpackedClass)(t))return;if(!e.tupleTypeArguments||!t.tupleTypeArguments||e.tupleTypeArguments.length!==t.tupleTypeArguments.length)return;let n=!0;const s=e.tupleTypeArguments.map(((e,s)=>{const i=t.tupleTypeArguments[s];return e.isUnbounded!==i.isUnbounded&&(n=!1),{isUnbounded:e.isUnbounded,type:(0,r.combineTypes)([e.type,i.type])}}));return n?(0,o.specializeTupleClass)(e,s,!0,!0):void 0}(h,I);if(!t)return null==c||c.addMessage(i.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:e.printType(h),destType:e.printType(I)})),!1;T=t}else{const n=e.getObjectType(),s=(0,o.applySolvedTypeVars)(h,p);T=(0,r.isUnion)(s)&&s.subtypes.length>a.maxSubtypesForInferredType&&void 0!==t.details.boundType&&n&&(0,r.isClassInstance)(n)?(0,r.combineTypes)([s,n]):(0,r.combineTypes)([s,I])}}}else T=I;if(f&&T&&!(0,r.isTypeSame)(f,T,{},u)){let t=!0;(0,r.isTypeVar)(f)&&((0,r.isTypeSame)(T,f)||(0,r.isUnion)(T)&&T.subtypes.some((e=>(0,r.isTypeSame)(e,f))))&&(t=!1);const n=t?e.makeTopLevelTypeVarsConcrete(f,!0):f;if(!e.assignType(n,T,null==c?void 0:c.createAddendum(),void 0,void 0,512,u))return c&&_&&c.addMessage(i.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:e.printType(I),destType:e.printType(f)})),!1}}if(t.details.boundType){const s=T||v;if(r.TypeBase.isInstantiable(t)&&!r.TypeBase.isInstantiable(n))return!1;const a=t.details.isSynthesizedSelf?p:new l.TypeVarContext(t.scopeId);if(!e.assignType(t.details.boundType,e.makeTopLevelTypeVarsConcrete(s),null==c?void 0:c.createAddendum(),a,void 0,512&d,u))return t.details.isSynthesized||null==c||c.addMessage(i.Localizer.DiagnosticAddendum.typeBound().format({sourceType:e.printType(s),destType:e.printType(t.details.boundType),name:r.TypeVarType.getReadableName(t)})),!1}if(!p.isLocked()&&y){let n;if(T&&0==(1152&d)){const s=(0,r.isVariadicTypeVar)(t)?function(e,t){if(!(0,r.isUnpackedClass)(t)||!t.tupleTypeArguments)return t;let n=!1;const s=t.tupleTypeArguments.map((t=>{const s=e.stripLiteralValue(t.type);return s!==t.type&&(n=!0),{isUnbounded:t.isUnbounded,type:s}}));return n?(0,o.specializeTupleClass)(t,s,!0,!0):t}(e,T):e.stripLiteralValue(T);s!==T&&(v&&!e.assignType(v,s)||(n=s))}p.setTypeVarType(t,T,n,v)}return!0},t.populateTypeVarContextBasedOnExpectedType=function(e,t,n,s,i){if((0,r.isAny)(n))return t.details.typeParameters.forEach((e=>{s.setTypeVarType(e,n)})),!0;if((0,r.isTypeVar)(n)&&n.details.isSynthesizedSelf&&n.details.boundType&&(n=n.details.boundType),!(0,r.isClass)(n))return!1;const a=n.typeArguments;if(!a)return e.assignType(t,n,void 0,s,void 0,1024);if(e.inferTypeParameterVarianceForClass(t),r.ClassType.isSameGenericClass(n,t)){const e=(0,o.buildTypeVarContextFromSpecializedClass)(n);return e.getPrimarySignature().getTypeVars().forEach((n=>{const i=e.getPrimarySignature().getTypeVarType(n.typeVar);i&&((0,r.isTypeVar)(i)&&i.scopeId===t.details.typeVarScopeId||s.setTypeVarType(n.typeVar,3===r.TypeVarType.getVariance(n.typeVar)?void 0:i,void 0,4===r.TypeVarType.getVariance(n.typeVar)?void 0:i))})),!0}const c=(0,o.getTypeVarScopeId)(n),p=r.ClassType.getTypeParameters(n).map(((e,t)=>{const n=r.TypeVarType.createInstance(`__dest${t}`);return n.details.isSynthesized=!0,n.details.declaredVariance=2,n.scopeId=c,n})),d=r.ClassType.cloneForSpecialization(n,p,!0),u=r.ClassType.getTypeParameters(t).map(((e,t)=>{const n=r.TypeVarType.createInstance(`__source${t}`);return n.details.isSynthesized=!0,n.details.synthesizedIndex=t,n.details.isExemptFromBoundCheck=!0,n})),y=r.ClassType.cloneForSpecialization(t,u,!0),m=new l.TypeVarContext(c);if(e.assignType(d,y,void 0,m,void 0,1024)){let e=!0;return p.forEach(((t,n)=>{const l=m.getPrimarySignature().getTypeVarType(t);if(l&&(0,r.isTypeVar)(l)&&l.details.isSynthesized&&void 0!==l.details.synthesizedIndex){const c=r.ClassType.getTypeParameters(y)[l.details.synthesizedIndex];if(n<a.length){let l=(0,o.transformPossibleRecursiveTypeAlias)(a[n]);i&&(l=(0,o.transformExpectedTypeForConstructor)(l,i)),l?s.setTypeVarType(c,3===r.TypeVarType.getVariance(t)?void 0:l,void 0,4===r.TypeVarType.getVariance(t)?void 0:l):e=!1}}})),e}return!1}},1901:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyConstructorTransform=t.hasConstructorTransform=void 0;const s=n(1290),i=n(9744),a=n(9866),r=n(563),o=n(7848),l=n(817),c=n(1133),p=n(5168),d=n(4447);t.hasConstructorTransform=function(e){return"functools.partial"===e.details.fullName},t.applyConstructorTransform=function(e,t,n,u,y){return"functools.partial"===u.details.fullName?function(e,t,n,u){if(!(0,c.isClassInstance)(u.returnType)||"functools.partial"!==u.returnType.details.fullName)return u;const y=(0,p.lookUpObjectMember)(u.returnType,"__call__");if(!y||!(0,c.isTypeSame)((0,p.convertToInstance)(y.classType),u.returnType))return u;const m=e.getTypeOfMember(y);if(!(0,c.isFunction)(m)||m.details.parameters.length<1)return u;if(n.length<1)return u;const g=e.getTypeOfArgument(n[0]).type;if(e.inferReturnTypeIfNecessary(g),!(0,c.isFunction)(g))return u;if(n.some((e=>0!==e.argumentCategory)))return u;const h=new Map,f=(0,o.getParameterListDetails)(g);let T=!1,v=!1;const _=new d.TypeVarContext((0,p.getTypeVarScopeId)(g));n.slice(1).forEach(((n,l)=>{var d,u,y,m,I,b,C,S;if(n.valueExpression)if(n.name){const l=f.params.find((e=>{var t;return e.param.name===(null===(t=n.name)||void 0===t?void 0:t.value)&&e.source!==o.ParameterSource.PositionOnly}));if(l){const o=l.param.name,d=c.FunctionType.getEffectiveParameterType(g,l.index);if(h.has(o))e.addDiagnostic((0,r.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,i.DiagnosticRule.reportGeneralTypeIssues,a.Localizer.Diagnostic.paramAlreadyAssigned().format({name:n.name.value}),n.name),T=!0;else{const l=new s.DiagnosticAddendum,c=e.getTypeOfExpression(n.valueExpression,void 0,(0,p.makeInferenceContext)(d));e.assignType(d,c.type,l,_)||(e.addDiagnostic((0,r.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,i.DiagnosticRule.reportGeneralTypeIssues,a.Localizer.Diagnostic.argAssignmentParamFunction().format({argType:e.printType(c.type),paramType:e.printType(d),functionName:g.details.name,paramName:o}),null!==(S=n.valueExpression)&&void 0!==S?S:t),T=!0),h.set(o,!0)}}else if(void 0===f.kwargsIndex)e.addDiagnostic((0,r.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,i.DiagnosticRule.reportGeneralTypeIssues,a.Localizer.Diagnostic.paramNameMissing().format({name:n.name.value}),n.name),T=!0;else{const o=c.FunctionType.getEffectiveParameterType(g,f.params[f.kwargsIndex].index),l=new s.DiagnosticAddendum,d=e.getTypeOfExpression(n.valueExpression,void 0,(0,p.makeInferenceContext)(o));e.assignType(o,d.type,l,_)||(e.addDiagnostic((0,r.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,i.DiagnosticRule.reportGeneralTypeIssues,a.Localizer.Diagnostic.argAssignmentParamFunction().format({argType:e.printType(d.type),paramType:e.printType(o),functionName:g.details.name,paramName:null!==(b=f.params[f.kwargsIndex].param.name)&&void 0!==b?b:""}),null!==(C=n.valueExpression)&&void 0!==C?C:t),T=!0)}}else if(l>=f.params.length||f.params[l].source===o.ParameterSource.KeywordOnly)if(void 0!==f.argsIndex){const o=c.FunctionType.getEffectiveParameterType(g,f.params[f.argsIndex].index),l=new s.DiagnosticAddendum,y=e.getTypeOfExpression(n.valueExpression,void 0,(0,p.makeInferenceContext)(o));e.assignType(o,y.type,l,_)||(e.addDiagnostic((0,r.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,i.DiagnosticRule.reportGeneralTypeIssues,a.Localizer.Diagnostic.argAssignmentParamFunction().format({argType:e.printType(y.type),paramType:e.printType(o),functionName:g.details.name,paramName:null!==(d=f.params[f.argsIndex].param.name)&&void 0!==d?d:""}),null!==(u=n.valueExpression)&&void 0!==u?u:t),T=!0)}else v||e.addDiagnostic((0,r.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,i.DiagnosticRule.reportGeneralTypeIssues,1===f.positionParamCount?a.Localizer.Diagnostic.argPositionalExpectedOne():a.Localizer.Diagnostic.argPositionalExpectedCount().format({expected:f.positionParamCount}),null!==(y=n.valueExpression)&&void 0!==y?y:t),v=!0,T=!0;else{const o=c.FunctionType.getEffectiveParameterType(g,l),d=new s.DiagnosticAddendum,u=null!==(m=f.params[l].param.name)&&void 0!==m?m:"",y=e.getTypeOfExpression(n.valueExpression,void 0,(0,p.makeInferenceContext)(o));e.assignType(o,y.type,d,_)||(e.addDiagnostic((0,r.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,i.DiagnosticRule.reportGeneralTypeIssues,a.Localizer.Diagnostic.argAssignmentParamFunction().format({argType:e.printType(y.type),paramType:e.printType(o),functionName:g.details.name,paramName:u}),null!==(I=n.valueExpression)&&void 0!==I?I:t),T=!0),h.set(u,!1)}}));const I=(0,p.applySolvedTypeVars)(g,_);if(!(0,c.isFunction)(I))return u;const b=I.details.parameters.map(((e,t)=>{const n={...e};return n.type=c.FunctionType.getEffectiveParameterType(I,t),e.name&&h.get(e.name)&&(n.hasDefault=!0),n})),C=[...b.filter((e=>!(2===e.category||1!==e.category&&e.name&&h.has(e.name)))),...b.filter((e=>e.name&&h.get(e.name))),...b.filter((e=>2===e.category))],S=c.FunctionType.createInstance(m.details.name,m.details.fullName,m.details.moduleName,m.details.flags,I.details.docString);m.details.parameters.length>0&&c.FunctionType.addParameter(S,m.details.parameters[0]),C.forEach((e=>{c.FunctionType.addParameter(S,e)})),S.details.declaredReturnType=I.details.declaredReturnType?c.FunctionType.getSpecializedReturnType(I):I.inferredReturnType,S.details.declaration=m.details.declaration,S.details.typeVarScopeId=I.details.typeVarScopeId;const x=c.ClassType.cloneForSymbolTableUpdate(u.returnType);return x.details.fields.set("__call__",l.Symbol.createWithType(4,S)),{returnType:x,isTypeIncomplete:!1,argumentErrors:T}}(e,t,n,y):y}},6168:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.applyDataClassDecorator=t.applyDataClassDefaultBehaviors=t.applyDataClassClassBehaviorOverrides=t.getDataclassDecoratorBehaviors=t.validateDataClassTransformDecorator=t.synthesizeDataClassMethods=void 0;const r=n(5839),o=n(9744),l=n(9866),c=a(n(563)),p=n(118),d=n(8494),u=n(8235),y=n(817),m=n(1766),g=n(1133),h=n(5168),f=n(4447);function T(e,t){let n;return(0,g.isFunction)(e)?n=e.details.fullName:(0,g.isOverloadedFunction)(e)?n=e.overloads[0].details.fullName:(0,g.isInstantiableClass)(e)&&(n=e.details.fullName),!!n&&t.some((e=>e===n))}function v(e,t,n,s,i){switch(s){case"order":!0===i?n.details.flags|=64:!1===i&&(n.details.flags&=-65);break;case"kw_only":!1===i?n.details.flags&=-2097153:!0===i&&(n.details.flags|=2097152);break;case"frozen":{let s=!1,a=!1;!1===i?n.details.flags&=-9:!0===i&&(n.details.flags|=8),n.details.baseClasses.forEach((e=>{(0,g.isInstantiableClass)(e)&&g.ClassType.isDataClass(e)&&(g.ClassType.isFrozenDataClass(e)?a=!0:e.details.classDataClassTransform||e.details.declaredMetaclass&&(0,g.isInstantiableClass)(e.details.declaredMetaclass)&&e.details.declaredMetaclass.details.classDataClassTransform||(s=!0))})),i?s&&e.addDiagnostic(c.getFileInfo(t).diagnosticRuleSet.reportGeneralTypeIssues,o.DiagnosticRule.reportGeneralTypeIssues,l.Localizer.Diagnostic.dataClassBaseClassNotFrozen(),t):a&&e.addDiagnostic(c.getFileInfo(t).diagnosticRuleSet.reportGeneralTypeIssues,o.DiagnosticRule.reportGeneralTypeIssues,l.Localizer.Diagnostic.dataClassBaseClassFrozen(),t);break}case"init":!1===i?n.details.flags|=16:!0===i&&(n.details.flags&=-17);break;case"eq":!1===i?n.details.flags|=32:!0===i&&(n.details.flags&=-33);break;case"slots":!0===i?(n.details.flags|=33554432,n.details.localSlotsNames&&e.addDiagnostic(c.getFileInfo(t).diagnosticRuleSet.reportGeneralTypeIssues,o.DiagnosticRule.reportGeneralTypeIssues,l.Localizer.Diagnostic.dataClassSlotsOverwrite(),t)):!1===i&&(n.details.flags&=-33554433);break;case"hash":case"unsafe_hash":!0===i&&(n.details.flags|=67108864)}}function _(e,t,n,s,i){let a=!1;s.forEach((t=>{t.valueExpression&&t.name&&(function(e,t,n,s,i){const a=c.getFileInfo(t);v(e,t,n,s,(0,u.evaluateStaticBoolExpression)(i,a.executionEnvironment,a.definedConstants))}(e,t.name,n,t.name.value,t.valueExpression),"frozen"===t.name.value&&(a=!0))})),a||v(e,t,n,"frozen",i.frozen)}function I(e,t){e.details.dataClassBehaviors=t,e.details.flags|=4,t.keywordOnlyParams&&(e.details.flags|=2097152),t.generateEq||(e.details.flags|=32),t.generateOrder&&(e.details.flags|=64),t.frozen&&(e.details.flags|=8)}t.synthesizeDataClassMethods=function(e,t,n,s,i,a){var v;(0,r.assert)(g.ClassType.isDataClass(n));const _=(0,h.synthesizeTypeVarForSelfCls)(n,!0),I=g.FunctionType.createSynthesizedInstance("__new__",1),b=g.FunctionType.createSynthesizedInstance("__init__");g.FunctionType.addParameter(I,{category:0,name:"cls",type:_,hasDeclaredType:!0}),g.FunctionType.addDefaultParameters(I),I.details.declaredReturnType=(0,h.convertToInstance)(_);const C={category:0,name:"self",type:(0,h.synthesizeTypeVarForSelfCls)(n,!1),hasDeclaredType:!0};g.FunctionType.addParameter(b,C),b.details.declaredReturnType=g.NoneType.createInstance();const S=[],x=[],D=function(e,t){let n=!0;return g.ClassType.getReverseMro(e).forEach((e=>{if((0,g.isInstantiableClass)(e)){const n=(0,h.buildTypeVarContextFromSpecializedClass)(e,!1);g.ClassType.getDataClassEntries(e).forEach((e=>{const s=t.findIndex((t=>t.name===e.name)),i={...e};i.type=(0,h.applySolvedTypeVars)(i.type,n),e.isClassVar?s>=0&&t.splice(s,1):s>=0?t[s]=i:t.push(i)}))}else n=!1})),n}(n,x);D||g.FunctionType.addDefaultParameters(b);const F=[];let E=!1;n.details.fields.forEach((i=>{var a,r,p;if(!i.isIgnoredForProtocolMatch()){const y=i.getTypedDeclarations().find((e=>{if(1!==e.type)return!1;const t=(0,d.getEnclosingClassOrFunction)(e.node);return!(!t||10!==t.nodeType)}));if(y){let i,p,d,m=y.node;for(;m&&3!==m.nodeType;){if(54===m.nodeType){3===(null===(a=m.parent)||void 0===a?void 0:a.nodeType)&&(m=m.parent);break}m=m.parent}if(!m)return;let f,v=!1,_=g.ClassType.isDataClassKeywordOnlyParams(n)||E,I=!0;if(3===m.nodeType){if(54===m.leftExpression.nodeType&&38===m.leftExpression.valueExpression.nodeType){i=m.leftExpression.valueExpression;const t=m;d=()=>e.getTypeOfAnnotation(t.leftExpression.typeAnnotation,{isVariableAnnotation:!0,allowFinal:!0,allowClassVar:!0})}if(v=!0,f=m.rightExpression,9===m.rightExpression.nodeType){const s=e.getTypeOfExpression(m.rightExpression.leftExpression,2),i=s.type;if(T(i,(null===(r=n.details.dataClassBehaviors)||void 0===r?void 0:r.fieldDescriptorNames)||[])){const n=m.rightExpression.arguments.find((e=>{var t;return"init"===(null===(t=e.name)||void 0===t?void 0:t.value)}));if(n&&n.valueExpression){const e=c.getFileInfo(t);!1===(0,u.evaluateStaticBoolExpression)(n.valueExpression,e.executionEnvironment,e.definedConstants)&&(I=!1)}else{let t;if((0,g.isFunction)(i))t=i;else if((0,g.isOverloadedFunction)(i))t=e.getBestOverloadForArguments(m.rightExpression,{type:i,isIncomplete:s.isIncomplete},m.rightExpression.arguments);else if((0,g.isInstantiableClass)(i)){const n=e.getBoundMethod(i,"__init__");n&&((0,g.isFunction)(n)?t=n:(0,g.isOverloadedFunction)(n)&&(t=e.getBestOverloadForArguments(m.rightExpression,{type:n},m.rightExpression.arguments)))}if(t){const e=t.details.parameters.find((e=>"init"===e.name));e&&e.defaultValueExpression&&e.hasDeclaredType&&(0,g.isClass)(e.type)&&g.ClassType.isBuiltIn(e.type,"bool")&&(0,h.isLiteralType)(e.type)&&!1===e.type.literalValue&&(I=!1)}}const a=m.rightExpression.arguments.find((e=>{var t;return"kw_only"===(null===(t=e.name)||void 0===t?void 0:t.value)}));if(a&&a.valueExpression){const e=c.getFileInfo(t),n=(0,u.evaluateStaticBoolExpression)(a.valueExpression,e.executionEnvironment,e.definedConstants);!1===n?_=!1:!0===n&&(_=!0)}const r=m.rightExpression.arguments.find((e=>{var t,n,s;return"default"===(null===(t=e.name)||void 0===t?void 0:t.value)||"default_factory"===(null===(n=e.name)||void 0===n?void 0:n.value)||"factory"===(null===(s=e.name)||void 0===s?void 0:s.value)}));v=!!r,(null==r?void 0:r.valueExpression)&&(f=r.valueExpression);const o=m.rightExpression.arguments.find((e=>{var t;return"alias"===(null===(t=e.name)||void 0===t?void 0:t.value)}));if(o){const t=e.getTypeOfExpression(o.valueExpression).type;(0,g.isClassInstance)(t)&&g.ClassType.isBuiltIn(t,"str")&&(0,h.isLiteralType)(t)&&(p=t.literalValue)}}}}else if(54===m.nodeType&&38===m.valueExpression.nodeType){i=m.valueExpression;const t=m;if(d=()=>e.getTypeOfAnnotation(t.typeAnnotation,{isVariableAnnotation:!0,allowFinal:!0,allowClassVar:!0}),"_"===m.valueExpression.value){const e=d();(0,g.isClassInstance)(e)&&g.ClassType.isBuiltIn(e,"KW_ONLY")&&(E=!0,i=void 0,d=void 0)}}if(i&&d){const a=i.value,r=n.details.fields.get(a),u=null==r?void 0:r.getDeclarations().some((e=>1===e.type&&e.isFinal));if((null==r?void 0:r.isClassVar())&&!u){const e=x.findIndex((e=>e.name===a));e>=0&&x.splice(e,1);const t={name:a,classType:n,alias:p,isKeywordOnly:!1,hasDefault:v,defaultValueExpression:f,includeInInit:I,nameNode:i,type:g.UnknownType.create(),isClassVar:!0};S.push(t)}else{const r={name:a,classType:n,alias:p,isKeywordOnly:_,hasDefault:v,defaultValueExpression:f,includeInInit:I,nameNode:i,type:g.UnknownType.create(),isClassVar:!1};F.push({entry:r,evaluator:d});let u=S.findIndex((e=>e.name===a));if(u>=0?S[u]=r:S.push(r),u=x.findIndex((e=>e.name===a)),u>=0){const e=x[u];!r.hasDefault&&e.hasDefault&&e.includeInInit&&(r.hasDefault=!0,r.defaultValueExpression=e.defaultValueExpression,v=!0),x[u]=r}else x.push(r),u=x.length-1;if(!_&&I&&!s&&!v){const n=x.findIndex((e=>e.hasDefault&&e.includeInInit&&!e.isKeywordOnly));n>=0&&n<u&&e.addDiagnostic(c.getFileInfo(t).diagnosticRuleSet.reportGeneralTypeIssues,o.DiagnosticRule.reportGeneralTypeIssues,l.Localizer.Diagnostic.dataClassFieldWithDefault(),i)}}}}else{const s=i.getDeclarations();if(0===s.length)return;const a=s[s.length-1];if(1!==a.type)return;const r=a.node.parent;if(!r||3!==r.nodeType)return;9===r.rightExpression.nodeType&&T(e.getTypeOfExpression(r.rightExpression.leftExpression,2).type,(null===(p=n.details.dataClassBehaviors)||void 0===p?void 0:p.fieldDescriptorNames)||[])&&e.addDiagnostic(c.getFileInfo(t).diagnosticRuleSet.reportGeneralTypeIssues,o.DiagnosticRule.reportGeneralTypeIssues,l.Localizer.Diagnostic.dataClassFieldWithoutAnnotation(),r.rightExpression)}}})),n.details.dataClassEntries=S,F.forEach((e=>{e.entry.type=e.evaluator()}));const P=n.details.fields,A=[];s||i||(D&&(x.forEach((t=>{if(t.includeInInit){let s=t.type;if(t.classType!==n&&(0,h.requiresSpecialization)(s)){const e=new f.TypeVarContext((0,h.getTypeVarScopeId)(t.classType));(0,h.populateTypeVarContextForSelfType)(e,t.classType,n),s=(0,h.applySolvedTypeVars)(s,e)}s=function(e,t){if(!(0,g.isClassInstance)(t))return t;const n=(0,h.lookUpObjectMember)(t,"__set__");if(!n)return t;const s=e.getTypeOfMember(n);if(!(0,g.isFunction)(s))return t;const i=e.bindFunctionToClassOrObject(t,s);return!i||!(0,g.isFunction)(i)||i.details.parameters.length<2?t:g.FunctionType.getEffectiveParameterType(i,1)}(e,s);const i=t.alias||t.name;!t.alias&&t.nameNode&&(0,m.isPrivateName)(t.nameNode.value)&&e.addError(l.Localizer.Diagnostic.dataClassFieldWithPrivateName(),t.nameNode);const a={category:0,name:i,hasDefault:t.hasDefault,defaultValueExpression:t.defaultValueExpression,type:s,hasDeclaredType:!0};t.isKeywordOnly?A.push(a):g.FunctionType.addParameter(b,a)}})),A.length>0&&(g.FunctionType.addParameter(b,{category:1,type:g.AnyType.create()}),A.forEach((e=>{g.FunctionType.addParameter(b,e)})))),P.set("__init__",y.Symbol.createWithType(4,b)),P.set("__new__",y.Symbol.createWithType(4,I)));const N=e.getBuiltInType(t,"str"),k=e.getBuiltInType(t,"tuple");if(k&&(0,g.isInstantiableClass)(k)&&N&&(0,g.isInstantiableClass)(N)&&!P.has("__match_args__")){const e=[];x.forEach((t=>{t.includeInInit&&!t.isKeywordOnly&&e.push(t.name)}));const t=e.map((e=>({type:g.ClassType.cloneAsInstance(g.ClassType.cloneWithLiteral(N,e)),isUnbounded:!1}))),n=g.ClassType.cloneAsInstance((0,h.specializeTupleClass)(k,t));P.set("__match_args__",y.Symbol.createWithType(4,n))}const w=(n,s)=>{const i=g.FunctionType.createSynthesizedInstance(n);g.FunctionType.addParameter(i,C),g.FunctionType.addParameter(i,{category:0,name:"other",type:s,hasDeclaredType:!0}),i.details.declaredReturnType=e.getBuiltInObject(t,"bool"),P.get(n)||P.set(n,y.Symbol.createWithType(4,i))};if(g.ClassType.isSkipSynthesizedDataClassEq(n)||w("__eq__",e.getBuiltInObject(t,"object")),g.ClassType.isSynthesizedDataclassOrder(n)){const e=g.ClassType.cloneAsInstance(n);["__lt__","__le__","__gt__","__ge__"].forEach((t=>{w(t,e)}))}let M=!g.ClassType.isSkipSynthesizedDataClassEq(n)&&g.ClassType.isFrozenDataClass(n);const R=!g.ClassType.isSkipSynthesizedDataClassEq(n)&&!g.ClassType.isFrozenDataClass(n);if(a&&(M=!1),g.ClassType.isSynthesizeDataClassUnsafeHash(n)&&(M=!0),M){const n=g.FunctionType.createSynthesizedInstance("__hash__");g.FunctionType.addParameter(n,C),n.details.declaredReturnType=e.getBuiltInObject(t,"int"),P.set("__hash__",y.Symbol.createWithType(4,n))}else R&&!a&&P.set("__hash__",y.Symbol.createWithType(4,g.NoneType.createInstance()));let O=e.getBuiltInType(t,"dict");if((0,g.isInstantiableClass)(O)&&(O=g.ClassType.cloneAsInstance(g.ClassType.cloneForSpecialization(O,[e.getBuiltInObject(t,"str"),g.AnyType.create()],!0))),P.set("__dataclass_fields__",y.Symbol.createWithType(132,O)),g.ClassType.isGeneratedDataClassSlots(n)&&void 0===n.details.localSlotsNames&&(n.details.localSlotsNames=S.map((e=>e.name))),g.ClassType.isGeneratedDataClassSlots(n)){let n=null!==(v=e.getTypingType(t,"Iterable"))&&void 0!==v?v:g.UnknownType.create();(0,g.isInstantiableClass)(n)&&(n=g.ClassType.cloneAsInstance(g.ClassType.cloneForSpecialization(n,[e.getBuiltInObject(t,"str")],!0))),P.set("__slots__",y.Symbol.createWithType(132,n))}(0,p.updateNamedTupleBaseClass)(n,x.map((e=>e.type)),!0)},t.validateDataClassTransformDecorator=function(e,t){const n={keywordOnlyParams:!1,generateEq:!0,generateOrder:!1,frozen:!1,fieldDescriptorNames:[]},s=c.getFileInfo(t);return t.arguments.forEach((t=>{if(t.name&&0===t.argumentCategory)switch(t.name.value){case"kw_only_default":{const i=(0,u.evaluateStaticBoolExpression)(t.valueExpression,s.executionEnvironment,s.definedConstants);if(void 0===i)return void e.addError(l.Localizer.Diagnostic.dataClassTransformExpectedBoolLiteral(),t.valueExpression);n.keywordOnlyParams=i;break}case"eq_default":{const i=(0,u.evaluateStaticBoolExpression)(t.valueExpression,s.executionEnvironment,s.definedConstants);if(void 0===i)return void e.addError(l.Localizer.Diagnostic.dataClassTransformExpectedBoolLiteral(),t.valueExpression);n.generateEq=i;break}case"order_default":{const i=(0,u.evaluateStaticBoolExpression)(t.valueExpression,s.executionEnvironment,s.definedConstants);if(void 0===i)return void e.addError(l.Localizer.Diagnostic.dataClassTransformExpectedBoolLiteral(),t.valueExpression);n.generateOrder=i;break}case"frozen_default":{const i=(0,u.evaluateStaticBoolExpression)(t.valueExpression,s.executionEnvironment,s.definedConstants);if(void 0===i)return void e.addError(l.Localizer.Diagnostic.dataClassTransformExpectedBoolLiteral(),t.valueExpression);n.frozen=i;break}case"field_descriptors":case"field_specifiers":{const s=e.getTypeOfExpression(t.valueExpression).type;if(!(0,g.isClassInstance)(s)||!g.ClassType.isBuiltIn(s,"tuple")||!s.tupleTypeArguments||s.tupleTypeArguments.some((e=>!(0,g.isInstantiableClass)(e.type)&&!(0,g.isFunction)(e.type)&&!(0,g.isOverloadedFunction)(e.type))))return void e.addError(l.Localizer.Diagnostic.dataClassTransformFieldSpecifier().format({type:e.printType(s)}),t.valueExpression);n.fieldDescriptorNames||(n.fieldDescriptorNames=[]),s.tupleTypeArguments.forEach((e=>{(0,g.isInstantiableClass)(e.type)||(0,g.isFunction)(e.type)?n.fieldDescriptorNames.push(e.type.details.fullName):(0,g.isOverloadedFunction)(e.type)&&n.fieldDescriptorNames.push(e.type.overloads[0].details.fullName)}));break}default:e.addError(l.Localizer.Diagnostic.dataClassTransformUnknownArgument().format({name:t.name.value}),t.valueExpression)}else e.addError(l.Localizer.Diagnostic.dataClassTransformPositionalParam(),t)})),n},t.getDataclassDecoratorBehaviors=function(e){var t;let n;if((0,g.isFunction)(e)?n=e:(0,g.isOverloadedFunction)(e)&&(n=null!==(t=e.overloads.find((e=>!!e.details.decoratorDataClassBehaviors)))&&void 0!==t?t:e.overloads[0]),n)return n.details.decoratorDataClassBehaviors?n.details.decoratorDataClassBehaviors:"dataclasses.dataclass"===n.details.fullName?{keywordOnlyParams:!1,generateEq:!0,generateOrder:!1,frozen:!1,fieldDescriptorNames:["dataclasses.field","dataclasses.Field"]}:void 0},t.applyDataClassClassBehaviorOverrides=_,t.applyDataClassDefaultBehaviors=I,t.applyDataClassDecorator=function(e,t,n,s,i){var a;I(n,s),_(e,t,n,null!==(a=null==i?void 0:i.arguments)&&void 0!==a?a:[],s)}},8905:(e,t)=>{function n(e){return 8===e.type}Object.defineProperty(t,"__esModule",{value:!0}),t.isUnresolvedAliasDeclaration=t.isIntrinsicDeclaration=t.isSpecialBuiltInClassDeclaration=t.isAliasDeclaration=t.isVariableDeclaration=t.isTypeAliasDeclaration=t.isTypeParameterDeclaration=t.isParameterDeclaration=t.isClassDeclaration=t.isFunctionDeclaration=t.UnresolvedModuleMarker=void 0,t.UnresolvedModuleMarker="*** unresolved ***",t.isFunctionDeclaration=function(e){return 5===e.type},t.isClassDeclaration=function(e){return 6===e.type},t.isParameterDeclaration=function(e){return 2===e.type},t.isTypeParameterDeclaration=function(e){return 3===e.type},t.isTypeAliasDeclaration=function(e){return 4===e.type},t.isVariableDeclaration=function(e){return 1===e.type},t.isAliasDeclaration=n,t.isSpecialBuiltInClassDeclaration=function(e){return 7===e.type},t.isIntrinsicDeclaration=function(e){return 0===e.type},t.isUnresolvedAliasDeclaration=function(e){return n(e)&&e.path===t.UnresolvedModuleMarker}},5523:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resolveAliasDeclaration=t.createSynthesizedAliasDeclaration=t.getDeclarationsWithUsesLocalNameRemoved=t.isDefinedInFile=t.getNameNodeForDeclaration=t.getNameFromDeclaration=t.areDeclarationsSame=t.hasTypeForDeclaration=void 0;const s=n(3550),i=n(8905),a=n(8494);t.hasTypeForDeclaration=function(e){switch(e.type){case 0:case 6:case 7:case 5:case 3:case 4:return!0;case 2:{if(e.node.typeAnnotation||e.node.typeAnnotationComment)return!0;const t=e.node.parent;if(28===(null==t?void 0:t.nodeType)&&t.functionAnnotationComment&&!t.functionAnnotationComment.isParamListEllipsis){const n=t.functionAnnotationComment.paramTypeAnnotations;return!(t.parameters.length>n.length&&e.node===t.parameters[0])}return!1}case 1:return!!e.typeAnnotationNode;case 8:return!1}},t.areDeclarationsSame=function(e,t,n=!1,s=!1){if(e.type!==t.type)return!1;if(e.path!==t.path)return!1;if(!(s&&8===e.type||e.range.start.line===t.range.start.line&&e.range.start.character===t.range.start.character))return!1;if(8===e.type&&8===t.type){if(e.symbolName!==t.symbolName||e.usesLocalName!==t.usesLocalName)return!1;if(n)return!0;if(e.firstNamePart!==t.firstNamePart)return!1}return!0},t.getNameFromDeclaration=function(e){var t;switch(e.type){case 8:return e.symbolName;case 6:case 5:case 3:return e.node.name.value;case 2:return null===(t=e.node.name)||void 0===t?void 0:t.value;case 1:return 38===e.node.nodeType?e.node.value:void 0;case 0:case 7:return}throw new Error("Shouldn't reach here")},t.getNameNodeForDeclaration=function(e){var t,n;switch(e.type){case 8:return 21===e.node.nodeType?null!==(t=e.node.alias)&&void 0!==t?t:e.node.module.nameParts[0]:23===e.node.nodeType?null!==(n=e.node.alias)&&void 0!==n?n:e.node.name:e.node.module.nameParts[0];case 6:case 5:case 3:case 2:return e.node.name;case 1:return 38===e.node.nodeType?e.node:void 0;case 0:case 7:return}throw new Error("Shouldn't reach here")},t.isDefinedInFile=function(e,t){var n;return(0,i.isAliasDeclaration)(e)?(null===(n=(0,a.getFileInfoFromNode)(e.node))||void 0===n?void 0:n.filePath)===t:e.path===t},t.getDeclarationsWithUsesLocalNameRemoved=function(e){return e.map((e=>{if(8!==e.type)return e;const t={...e};return t.usesLocalName=!1,t}))},t.createSynthesizedAliasDeclaration=function(e){return{type:8,node:void 0,path:e,loadSymbolsFromPath:!1,range:(0,s.getEmptyRange)(),implicitImports:new Map,usesLocalName:!1,moduleName:"",isInExceptSuite:!1}},t.resolveAliasDeclaration=function e(t,n,s,i){let a=n;const r=[];let o,l,c=!1,p=!1;for(;;){if(8!==a.type||!a.symbolName)return{declaration:a,isPrivate:c,privatePyTypedImported:o,privatePyTypedImporter:l};if(!s&&a.usesLocalName)return{declaration:a,isPrivate:c,privatePyTypedImported:o,privatePyTypedImporter:l};let d;a.path&&a.loadSymbolsFromPath&&(d=t(a.path));const u=d?d.symbolTable.get(a.symbolName):void 0;if(!u){if(a.submoduleFallback){if(a.symbolName&&8===a.submoduleFallback.type&&a.submoduleFallback.path&&!t(a.submoduleFallback.path))return;return e(t,a.submoduleFallback,s,i)}return a.isNativeLib?{declaration:void 0,isPrivate:c}:void 0}if(u.isPrivateMember()&&(c=!0),u.isExternallyHidden()&&!i)return;let y=u.getTypedDeclarations();if(y=y.filter((e=>!e.isInExceptSuite)),0===y.length&&(y=u.getDeclarations(),y=y.filter((e=>!e.isInExceptSuite))),0===y.length&&(y=u.getDeclarations()),0===y.length)return;const m=y.filter((e=>!r.includes(e)));if(a=m.length>0?m[m.length-1]:y[y.length-1],(null==d?void 0:d.isInPyTypedPackage)&&(p?u.isPrivatePyTypedImport()||(o=null!=o?o:null==a?void 0:a.moduleName):(u.isPrivatePyTypedImport()&&(l=null==a?void 0:a.moduleName),p=!0)),r.find((e=>e===a)))return a.path===n.path&&8===a.type&&a.submoduleFallback?e(t,a.submoduleFallback,s,i):{declaration:n,isPrivate:c,privatePyTypedImported:o,privatePyTypedImporter:l};r.push(a)}}},1272:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertDocStringToPlainText=t.convertDocStringToMarkdown=void 0;const s=n(5678);t.convertDocStringToMarkdown=function(e){return new w(e).convert()},t.convertDocStringToPlainText=function(e){const t=(0,s.cleanAndSplitDocString)(e),n=[];for(const e of t){const t=n.length>0?n[n.length-1]:void 0;R(e)&&R(t)||n.push(e)}return n.join("\n").trimEnd()};const i=/\S|$/,a=/\S/,r=/^\s*~~~+$/,o=/^\s*\+\+\++$/,l=/^\s*===+\s+===+$/,c=/^\s*---+\s+---+$/,p=/^(\s*)-\s/,d=/^(\s*)\*\s/,u=/^(\s*)\d+\.\s/,y=/^(\s+\* )(.*)$/,m=/^\s*\.\. /,g=/^\s*\.\.\s+(\w+)::\s*(.*)$/,h=/ *>>> /,f=/^\s*:(param|arg|type|return|rtype|raise|except|var|ivar|cvar|copyright|license)/,T=/^\.[\s\t]+(@\w)/gm,v=/^(\.\s{3})|^(\.)/,_=[{exp:/^\s*=+(\s+=+)+$/,replacement:"="},{exp:/^\s*-+(\s+-+)+$/,replacement:"-"},{exp:/^\s*~+(\s+-+)+$/,replacement:"~"},{exp:/^\s*\++(\s+\++)+$/,replacement:"+"}],I=/\s/g,b=/``/g,C=/~/g,S=/\+/g,x=/(?<!\\)([_*~[\]])/g,D=/(\[.*\]\(.*\))/g,F=/^\s*```(\w*)/,E=/^\s*```/,P=[{exp:/</g,replacement:"&lt;"},{exp:/>/g,replacement:"&gt;"}],A="  \n",N=/^\s*::$/,k=[{exp:/\s+::$/g,replacement:""},{exp:/(\S)\s*::$/g,replacement:"$1:"},{exp:/:[\w_\-+:.]+:`/g,replacement:"`"},{exp:/`:[\w_\-+:.]+:/g,replacement:"`"}];class w{constructor(e){this._builder="",this._skipAppendEmptyLine=!0,this._insideInlineCode=!1,this._appendDirectiveBlock=!1,this._stateStack=[],this._lineNum=0,this._blockIndent=0,this._state=this._parseText,this._input=e,this._lines=(0,s.cleanAndSplitDocString)(e)}convert(){for(T.test(this._input)&&(this._lines=this._lines.map((e=>e.replace(v,""))));void 0!==this._currentLineOrUndefined();){const e=this._state,t=this._lineNum;if(this._state(),this._state===e&&this._lineNum===t)break}return this._state===this._parseBacktickBlock||this._state===this._parseDocTest||this._state===this._parseLiteralBlock?this._trimOutputAndAppendLine("```"):this._insideInlineCode&&this._trimOutputAndAppendLine("`",!0),this._builder.trim()}_eatLine(){this._lineNum++}_currentLineOrUndefined(){return this._lineNum<this._lines.length?this._lines[this._lineNum]:void 0}_currentLine(){return this._currentLineOrUndefined()||""}_currentIndent(){return M(this._currentLine())}_prevIndent(){var e;return M(null!==(e=this._lineAt(this._lineNum-1))&&void 0!==e?e:"")}_lineAt(e){return e<this._lines.length?this._lines[e]:void 0}_nextBlockIndent(){return M(this._lines.slice(this._lineNum+1).find((e=>!R(e)))||"")}_currentLineIsOutsideBlock(){return this._currentIndent()<this._blockIndent}_currentLineWithinBlock(){return this._currentLine().substr(this._blockIndent)}_pushAndSetState(e){this._state===this._parseText&&(this._insideInlineCode=!1),this._stateStack.push(this._state),this._state=e}_popState(){this._state=this._stateStack.splice(0,1)[0],this._state===this._parseText&&(this._insideInlineCode=!1)}_parseText(){if(R(this._currentLineOrUndefined()))return void(this._state=this._parseEmpty);if(this._beginBacktickBlock())return;if(this._beginLiteralBlock())return;if(this._beginDocTest())return;if(this._beginDirective())return;if(this._beginList())return;if(this._beginFieldList())return;if(this._beginTableBlock())return;const e=this._formatPlainTextIndent(this._currentLine());this._appendTextLine(e),this._eatLine()}_formatPlainTextIndent(e){const t=this._lineAt(this._lineNum-1),n=this._prevIndent(),s=this._currentIndent();return!(s>n)||R(t)||this._builder.endsWith(A)||this._builder.endsWith("\n\n")||O(t)||(this._builder=this._builder.slice(0,-1)+A),n>s&&!R(t)&&!this._builder.endsWith(A)&&!this._builder.endsWith("\n\n")&&(this._builder=this._builder.slice(0,-1)+A),0===n||this._builder.endsWith(A)||this._builder.endsWith("\n\n")?this._convertIndent(e):e.trimStart()}_convertIndent(e){return e.replace(/^([ \t]+)(.+)$/g,((e,t,n)=>"&nbsp;".repeat(t.length)+n))}_escapeHtml(e){return P.forEach((t=>{e=e.replace(t.exp,t.replacement)})),e}_appendTextLine(e){const t=(e=this._preprocessTextLine(e)).split("`");for(let e=0;e<t.length;e++){let n=t[e];if(e>0&&(this._insideInlineCode=!this._insideInlineCode,this._append("`")),this._insideInlineCode)this._append(n);else{if(n=this._escapeHtml(n),0===e){if(1===t.length){for(const e of _)if(e.exp.test(n)){n=n.replace(I,e.replacement);break}if(r.test(n)){this._append(n.replace(C,"-"));continue}if(o.test(n)){this._append(n.replace(S,"-"));continue}}const e=y.exec(n);null!==e&&3===e.length&&(this._append(e[1]),n=e[2])}n.split(D).forEach((e=>{D.test(e)?this._append(e):this._append(e.replace(x,"\\$1"))}))}}this._builder+="\n"}_preprocessTextLine(e){return N.test(e)?"":(k.forEach((t=>e=e.replace(t.exp,t.replacement))),e=e.replace(b,"`"))}_parseEmpty(){if(R(this._currentLineOrUndefined()))return this._appendLine(),void this._eatLine();this._state=this._parseText}_beginMinIndentCodeBlock(e){this._appendLine("```"),this._pushAndSetState(e),this._blockIndent=this._currentIndent()}_beginBacktickBlock(){const e=this._currentLine().match(F);return null!==e&&(this._blockIndent=this._currentIndent(),this._appendLine("```"+e[1]),this._pushAndSetState(this._parseBacktickBlock),this._eatLine(),!0)}_parseBacktickBlock(){E.test(this._currentLine())&&this._currentIndent()===this._blockIndent?(this._appendLine("```"),this._appendLine(),this._popState()):this._appendLine(this._currentLine()),this._eatLine()}_beginDocTest(){return!!h.test(this._currentLine())&&(this._beginMinIndentCodeBlock(this._parseDocTest),this._appendLine(this._currentLineWithinBlock()),this._eatLine(),!0)}_parseDocTest(){if(this._currentLineIsOutsideBlock()||R(this._currentLine()))return this._trimOutputAndAppendLine("```"),this._appendLine(),void this._popState();this._appendLine(this._currentLineWithinBlock()),this._eatLine()}_beginLiteralBlock(){const e=this._lineAt(this._lineNum-1);if(void 0===e)return!1;if(!R(e))return!1;let t=this._lineNum-2;for(;t>=0;t--){const e=this._lineAt(t);if(!R(e)){if(e.endsWith("::"))break;return!1}}return!(t<0||(0===this._currentIndent()?(this._appendLine("```"),this._pushAndSetState(this._parseLiteralBlockSingleLine),0):(this._beginMinIndentCodeBlock(this._parseLiteralBlock),0)))}_parseLiteralBlock(){if(R(this._currentLineOrUndefined()))return this._appendLine(),void this._eatLine();const e=this._lineAt(this._lineNum-1);if(this._currentLineIsOutsideBlock()&&R(e))return this._trimOutputAndAppendLine("```"),this._appendLine(),void this._popState();this._appendLine(this._currentLine()),this._eatLine()}_parseLiteralBlockSingleLine(){this._appendLine(this._currentLine()),this._appendLine("```"),this._appendLine(),this._popState(),this._eatLine()}_beginDirective(){return!!m.test(this._currentLine())&&(this._pushAndSetState(this._parseDirective),this._blockIndent=this._nextBlockIndent(),this._appendDirectiveBlock=!1,!0)}_beginFieldList(){var e,t;if(this._insideInlineCode)return!1;let n=this._currentLine();if(n.startsWith("@"))return this._appendLine(),this._appendTextLine(n),this._eatLine(),!0;const s=!(null==n?void 0:n.endsWith(":"))&&!(null==n?void 0:n.endsWith("::"))&&(null!==(t=null===(e=n.match(/:/g))||void 0===e?void 0:e.length)&&void 0!==t?t:0)%2==1,i=f.test(n);if(s||i){const e=this._lineAt(this._lineNum-1);return this._builder.endsWith(A)||this._builder.endsWith("\n\n")||O(e)||(this._builder=this._builder.slice(0,-1)+A),n=this._convertIndent(n),this._appendTextLine(n),this._eatLine(),!0}return!1}_beginTableBlock(){if(this._insideInlineCode)return!1;const e=this._currentLine();return!!l.test(e)&&(this._tableState={header:e.trimStart(),inHeader:!0},this._eatLine(),this._pushAndSetState(this._parseTableBlock),!0)}_parseTableBlock(){if(R(this._currentLineOrUndefined())||!this._tableState)return this._tableState=void 0,void this._popState();let e=this._currentLine();if(l.test(e))return this._eatLine(),this._appendLine("\n<br/>\n"),this._popState(),void(this._tableState=void 0);{let t="|";const n=this._tableState.header.split(" "),s=[];if(this._tableState.inHeader){do{let t=0;for(let i=0;i<n.length;i++){const a=n[i].length+1,r=e.slice(t,t+a);void 0===s[i]?s[i]=`${r} `:s[i]=s[i].concat(`<br>${r} `),t+=a}this._eatLine(),e=this._currentLine()}while(!R(this._currentLineOrUndefined())&&!c.test(e)&&!l.test(e));this._tableState.inHeader=!1,s.forEach((e=>{t+=`${e}|`})),this._appendLine(t);const i=e.trimStart().replace(/=/g,"-").replace(" ","|");this._appendLine(`|${i}|`),this._eatLine()}else{let s=0;n.forEach((n=>{const i=n.length+1,a=e.slice(s,s+i);t+=`${a}|`,s+=i})),this._appendLine(t),this._eatLine()}}}_beginList(){if(this._insideInlineCode)return!1;let e=this._currentLine();const t=p.exec(e);if(2===(null==t?void 0:t.length))return t[1].length>=4&&(e=" ".repeat(t[1].length/2)+e.trimLeft()),this._appendTextLine(e),this._eatLine(),this._state!==this._parseList&&this._pushAndSetState(this._parseList),!0;const n=d.exec(e);if(2===(null==n?void 0:n.length))return 0===n[1].length?e=e=" "+e:n[1].length>=4&&(e=" ".repeat(n[1].length/2)+e.trimLeft()),this._appendTextLine(e),this._eatLine(),this._state!==this._parseList&&this._pushAndSetState(this._parseList),!0;const s=u.exec(e);return 2===(null==s?void 0:s.length)&&(this._appendTextLine(e),this._eatLine(),!0)}_parseList(){if(R(this._currentLineOrUndefined())||this._currentLineIsOutsideBlock())this._popState();else if(!this._beginList()){const e=this._currentLine().trimStart();this._appendTextLine(e),this._eatLine()}}_parseDirective(){const e=g.exec(this._currentLine());if(null!==e&&3===e.length){const t=e[1],n=e[2];"class"===t&&(this._appendDirectiveBlock=!0,this._appendLine(),this._appendLine("```"),this._appendLine(n),this._appendLine("```"),this._appendLine())}0===this._blockIndent?this._popState():this._state=this._parseDirectiveBlock,this._eatLine()}_parseDirectiveBlock(){R(this._currentLineOrUndefined())||!this._currentLineIsOutsideBlock()?(this._appendDirectiveBlock&&this._appendTextLine(this._currentLine().trimLeft()),this._eatLine()):this._popState()}_appendLine(e){R(e)?this._skipAppendEmptyLine||(this._builder+="\n",this._skipAppendEmptyLine=!0):(this._builder+=e+"\n",this._skipAppendEmptyLine=!1)}_append(e){this._builder+=e,this._skipAppendEmptyLine=!1}_trimOutputAndAppendLine(e,t=!1){this._builder=this._builder.trimRight(),this._skipAppendEmptyLine=!1,t||this._appendLine(),this._appendLine(e)}}function M(e){return e.search(i)}function R(e){return void 0===e||!a.test(e)}function O(e){var t,n;return void 0!==e&&(null!==(n=null===(t=e.match(/^\s*[#`~=-]{3,}/))||void 0===t?void 0:t.length)&&void 0!==n?n:0)>0}},5678:(e,t)=>{function n(e){const t=e.replace(/\r/g,"").replace(/\t/g,"        ").split("\n");let n=Number.MAX_VALUE;t.forEach(((e,s)=>{if(t.length<=1||s>0){const t=e.trimLeft();t&&(n=Math.min(n,e.length-t.length))}})),n>=Number.MAX_VALUE&&(n=0);const s=[];for(t.forEach(((e,t)=>{0===t?s.push(e.trim()):s.push(e.substr(n).trimRight())}));s.length>0&&0===s[0].length;)s.shift();for(;s.length>0&&0===s[s.length-1].length;)s.pop();return s}Object.defineProperty(t,"__esModule",{value:!0}),t.extractParameterDocumentation=t.cleanAndSplitDocString=t.cleanDocString=void 0,t.cleanDocString=function(e){return n(e).join("\n")},t.cleanAndSplitDocString=n,t.extractParameterDocumentation=function(e,t){if(!e||!t)return;const s=n(e);for(const e of s){const n=e.trim();let s=n.indexOf("@param "+t);if(s>=0)return n.substr(s+7);if(s=n.indexOf(":param "+t),s>=0)return n.substr(s+7);if(s=n.indexOf(t+": "),s>=0)return n.substr(s);if(s=n.indexOf(t+" ("),s>=0)return n.substr(s)}}},1985:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEnumAutoValueType=t.getTypeOfEnumMember=t.isDeclInEnumClass=t.transformTypeForPossibleEnumClass=t.createEnumType=t.isKnownEnumType=void 0;const s=n(5839),i=n(1464),a=n(3550),r=n(563),o=n(8494),l=n(817),c=n(1766),p=n(1133),d=n(5168);t.isKnownEnumType=function(e){return["Enum","IntEnum","StrEnum","Flag","IntFlag"].some((t=>t===e))},t.createEnumType=function(e,t,n){const c=(0,r.getFileInfo)(e);let u="enum";if(0===n.length)return;{const e=n[0];if(0!==e.argumentCategory||!e.valueExpression||48!==e.valueExpression.nodeType)return;u=e.valueExpression.strings.map((e=>e.value)).join("")}const y=p.ClassType.createInstantiable(u,(0,o.getClassFullName)(e,c.moduleName,u),c.moduleName,c.filePath,1048576,(0,o.getTypeSourceId)(e),void 0,t.details.effectiveMetaclass);y.details.baseClasses.push(t),(0,d.computeMroLinearization)(y);const m=y.details.fields;if(m.set("__class__",l.Symbol.createWithType(68,y)),!(n.length<2)){{const t=n[1];if(0!==t.argumentCategory||!t.valueExpression||48!==t.valueExpression.nodeType)return;t.valueExpression.strings.map((e=>e.value)).join("").split(" ").forEach((n=>{if(n=n.trim()){const o=p.UnknownType.create(),c=l.Symbol.createWithType(4,o),d=t.valueExpression;(0,s.assert)(48===d.nodeType);const u=(0,r.getFileInfo)(e),y={type:1,node:d,isRuntimeTypeExpression:!0,path:u.filePath,range:(0,i.convertOffsetsToRange)(d.start,a.TextRange.getEnd(d),u.lines),moduleName:u.moduleName,isInExceptSuite:!1};c.addDeclaration(y),m.set(n,c)}}))}return y}},t.transformTypeForPossibleEnumClass=function(e,t,n){var s,i,a,l;const d=(0,o.getEnclosingClass)(t,!0);if(!d)return;const u=e.getTypeOfClass(d);if(!u||!p.ClassType.isEnumClass(u.classType))return;let y=3===(null===(s=t.parent)||void 0===s?void 0:s.nodeType)&&t.parent.leftExpression===t||54===(null===(i=t.parent)||void 0===i?void 0:i.nodeType)&&t.parent.valueExpression===t&&3===(null===(a=t.parent.parent)||void 0===a?void 0:a.nodeType)||(0,r.getFileInfo)(t).isStubFile&&54===(null===(l=t.parent)||void 0===l?void 0:l.nodeType)&&t.parent.valueExpression===t;(0,c.isSingleDunderName)(t.value)&&(y=!1),"name"!==t.value&&"value"!==t.value||(y=!1);const m=n();if((0,p.isClassInstance)(m)&&m.details.fields.get("__get__")&&(y=!1),y){const e=new p.EnumLiteral(u.classType.details.fullName,u.classType.details.name,t.value,m);return p.ClassType.cloneAsInstance(p.ClassType.cloneWithLiteral(u.classType,e))}},t.isDeclInEnumClass=function(e,t){const n=(0,o.getEnclosingClass)(t.node,!0);if(!n)return!1;const s=e.getTypeOfClass(n);return!!s&&p.ClassType.isEnumClass(s.classType)},t.getTypeOfEnumMember=function(e,t,n,s,i){if(!p.ClassType.isEnumClass(n))return;const a=n.literalValue;if(a instanceof p.EnumLiteral){if("name"===s||"_name_"===s){const n=e.getBuiltInType(t,"str");if((0,p.isInstantiableClass)(n))return{type:p.ClassType.cloneAsInstance(p.ClassType.cloneWithLiteral(n,a.itemName)),isIncomplete:i}}return"value"===s||"_value_"===s?{type:a.itemType,isIncomplete:i}:void 0}},t.getEnumAutoValueType=function(e,t){const n=(0,o.getEnclosingClass)(t);if(n){const s=e.getTypeOfClass(n);if(s){const n=e.getTypeOfObjectMember(t,p.ClassType.cloneAsInstance(s.classType),"_generate_next_value_");if(n&&(0,p.isFunction)(n.type)&&n.classType&&(0,p.isClass)(n.classType)&&!p.ClassType.isBuiltIn(n.classType,"Enum")&&n.type.details.declaredReturnType)return n.type.details.declaredReturnType}}return e.getBuiltInObject(t,"int")}},4289:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyFunctionTransform=void 0;const s=n(9744),i=n(9866),a=n(563),r=n(817),o=n(1133),l=n(5168);t.applyFunctionTransform=function(e,t,n,c,p){return(0,o.isFunction)(c)&&"functools.total_ordering"===c.details.fullName?function(e,t,n,c){var p;if(1!==n.length)return c;const d=null===(p=n[0].typeResult)||void 0===p?void 0:p.type;if(!d||!(0,o.isInstantiableClass)(d)||d.includeSubclasses)return c;const u=o.ClassType.cloneAsInstance(d);let y;const m=["__lt__","__le__","__gt__","__ge__"].filter((e=>{const t=(0,l.lookUpObjectMember)(u,e,8);return t&&!y&&(y=t),!t}));if(!y)return e.addDiagnostic((0,a.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,s.DiagnosticRule.reportGeneralTypeIssues,i.Localizer.Diagnostic.totalOrderingMissingMethod(),t),c;let g;const h=e.getTypeOfMember(y);if((0,o.isFunction)(h)&&h.details.parameters.length>=2&&h.details.parameters[1].hasDeclaredType&&(g=h.details.parameters[1].type),!g){const n=e.getBuiltInObject(t,"object");if(!n||!(0,o.isClassInstance)(n))return c;g=n}const f=e.getBuiltInObject(t,"bool");if(!f||!(0,o.isClassInstance)(f))return c;const T={category:0,name:"self",type:(0,l.synthesizeTypeVarForSelfCls)(d,!1),hasDeclaredType:!0},v={category:0,name:"__value",type:g,hasDeclaredType:!0};return m.forEach((e=>{const t=o.FunctionType.createSynthesizedInstance(e);o.FunctionType.addParameter(t,T),o.FunctionType.addParameter(t,v),t.details.declaredReturnType=f,d.details.fields.set(e,r.Symbol.createWithType(4,t))})),c}(e,t,n,p):p}},2374:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ImportResolver=t.supportedFileExtensions=t.supportedSourceFileExtensions=t.createImportedModuleDescriptor=void 0;const r=n(9489),o=n(2930),l=n(3188),c=n(6657),p=n(6886),d=n(7559),u=a(n(7559)),y=n(6956),m=n(1447),g=n(7012),h=n(1012),f=a(n(1887)),T=n(1277),v=n(1766);t.createImportedModuleDescriptor=function(e){if(0===e.length)return{leadingDots:0,nameParts:[],importedSymbols:[]};let t=0,n=0;for(;t<e.length&&"."===e[t];t++)n++;return{leadingDots:n,nameParts:e.slice(t).split("."),importedSymbols:[]}};const _=[".pyd",".so",".dylib"];t.supportedSourceFileExtensions=[".py",".pyi"],t.supportedFileExtensions=[...t.supportedSourceFileExtensions,..._],t.ImportResolver=class{constructor(e,t,n){this.fileSystem=e,this._configOptions=t,this.host=n,this._cachedImportResults=new Map,this._cachedModuleNameResults=new Map,this._cachedEntriesForPath=new Map,this.cachedParentImportResults=new h.ParentDirectoryCache((()=>this.getPythonSearchPaths([])))}invalidateCache(){this._cachedImportResults=new Map,this._cachedModuleNameResults=new Map,this.cachedParentImportResults.reset(),this._stdlibModules=void 0,this._invalidateFileSystemCache(),m.SupportPartialStubs.is(this.fileSystem)&&this.fileSystem.clearPartialStubs()}resolveImport(e,t,n){return this._resolveImport(e,t,n)}_resolveImport(e,t,n){const s=this.formatImportName(n),i=this._resolveImportStrict(s,e,t,n,[]);if(i.isImportFound||n.leadingDots>0)return i;e=(0,c.normalizePathCase)(this.fileSystem,(0,c.normalizePath)(e));const a=(0,c.ensureTrailingDirectorySeparator)((0,c.getDirectoryPath)(e)),r=this.cachedParentImportResults.getImportResult(a,s,i);if(r)return this.filterImplicitImports(r,n.importedSymbols);const o=this.getParentImportResolutionRoot(e,t.root);if(!this.cachedParentImportResults.checkValidPath(this.fileSystem,e,o))return i;const l={importPath:void 0};let p=a;for(;this._shouldWalkUp(p,o,t);){const i=this.resolveAbsoluteImport(e,p,t,n,s,[],void 0,void 0,!1,!0);if(this.cachedParentImportResults.checked(p,s,l),i.isImportFound)return l.importPath=p,this.cachedParentImportResults.add({importResult:i,path:p,importName:s}),this.filterImplicitImports(i,n.importedSymbols);let a;if([a,p]=this._tryWalkUp(p),!a)break}return this.cachedParentImportResults.checked(p,s,l),i}_resolveImportStrict(e,t,n,s,i){const a=(0,o.matchFileSpecs)(this._configOptions,t),r={importName:e,isRelative:!1,isImportFound:!1,isPartlyResolved:!1,isNamespacePackage:!1,isInitFilePresent:!1,isStubPackage:!1,importFailureInfo:i,resolvedPaths:[],importType:2,isStubFile:!1,isNativeLib:!1,implicitImports:[],filteredImplicitImports:[],nonStubImportResult:void 0};if(this.ensurePartialStubPackages(n),s.leadingDots>0){const a=this._resolveRelativeImport(t,n,s,e,i);if(a)return a.isRelative=!0,a}else{const i=this._lookUpResultsInCache(n,e,s.importedSymbols,a);if(i&&(!i.isImportFound||!i.isNamespacePackage||this._isNamespacePackageResolved(s,i.implicitImports)))return i;const o=this._resolveBestAbsoluteImport(t,n,s,!0);if(o)return o.isStubFile&&(o.nonStubImportResult=this._resolveBestAbsoluteImport(t,n,s,!1)||r),this.addResultsToCache(n,e,o,s.importedSymbols,a)}return this.addResultsToCache(n,e,r,void 0,a)}getCompletionSuggestions(e,t,n){const s=this._getCompletionSuggestionsStrict(e,t,n);if(n.leadingDots>0)return s;const i=this.getParentImportResolutionRoot(e,t.root);let a=(0,c.ensureTrailingDirectorySeparator)((0,c.getDirectoryPath)((0,c.normalizePathCase)(this.fileSystem,(0,c.normalizePath)(e))));for(;this._shouldWalkUp(a,i,t);){let i;if(this._getCompletionSuggestionsAbsolute(e,t,a,n,s,!1),[i,a]=this._tryWalkUp(a),!i)break}return s}getConfigOptions(){return this._configOptions}setConfigOptions(e){this._configOptions=e,this.invalidateCache()}_getCompletionSuggestionsStrict(e,t,n){const s=[],i=new Map;if(n.leadingDots>0)this._getCompletionSuggestionsRelative(e,t,n,i);else{n.nameParts.length>0&&this._getCompletionSuggestionsTypeshedPath(e,t,n,!0,i),t.root&&this._getCompletionSuggestionsAbsolute(e,t,t.root,n,i);for(const s of t.extraPaths)this._getCompletionSuggestionsAbsolute(e,t,s,n,i);this._configOptions.stubPath&&this._getCompletionSuggestionsAbsolute(e,t,this._configOptions.stubPath,n,i),this._getCompletionSuggestionsTypeshedPath(e,t,n,!1,i);const a=this.getPythonSearchPaths(s);for(const s of a)this._getCompletionSuggestionsAbsolute(e,t,s,n,i)}return i}getSourceFilesFromStub(e,t,n){const s=[];if(this._cachedImportResults.forEach((t=>{t.forEach((t=>{if(t.isStubFile&&t.isImportFound&&t.nonStubImportResult&&t.resolvedPaths[t.resolvedPaths.length-1]===e&&t.nonStubImportResult.isImportFound){const e=t.nonStubImportResult.resolvedPaths[t.nonStubImportResult.resolvedPaths.length-1];(e.endsWith(".py")||e.endsWith(".pyi"))&&s.push(e)}}))})),0===s.length){const t=(0,c.changeAnyExtension)(e,".py");this.dirExistsCached(t)&&s.push(t)}if(0===s.length){const n=this.getImportRoots(t),i=[];for(const t of n)if((0,c.containsPath)(t,e,!0)){const n=(0,c.getRelativePathComponentsFromDirectory)(t,e,!0);if(n.length>1){n[1].endsWith(l.stubsSuffix)&&(n[1]=n[1].substr(0,n[1].length-l.stubsSuffix.length));const e=(0,c.combinePathComponents)(n);e&&i.push(e)}}for(const e of i)for(const t of n){const n=(0,c.resolvePaths)(t,e);let i=(0,c.changeAnyExtension)(n,".py");if(this.fileExistsCached(i))s.push(i);else{const e=(0,c.stripFileExtension)(i);e.endsWith("__init__")?(i=e.substr(0,e.length-9)+".py",this.fileExistsCached(i)&&s.push(i)):(i=(0,c.combinePaths)(e,"__init__.py"),this.fileExistsCached(i)&&s.push(i))}}}return s}getModuleNameForImport(e,t,n=!1){const s=(0,r.getOrAdd)(this._cachedModuleNameResults,t.root,(()=>new Map));return(0,r.getOrAdd)(s,e,(()=>this._getModuleNameForImport(e,t,n)))}_getModuleNameForImport(e,t,n){let s,i=0,a=!1;const r=[];let o;const l=this._getStdlibTypeshedPath(t,r);if(l&&(s=this.getModuleNameFromPath(l,e),s)){const e={leadingDots:0,nameParts:s.split("."),importedSymbols:void 0};if(this._isStdlibTypeshedStubValidForVersion(e,t,[]))return{moduleName:s,importType:i,isLocalTypingsFile:a}}if(t.root){const n=this.getModuleNameInfoFromPath(t.root,e);n&&(n.containsInvalidCharacters?o=n.moduleName:s=n.moduleName),i=2}for(const n of t.extraPaths){const t=this.getModuleNameInfoFromPath(n,e);if(t)if(t.containsInvalidCharacters)o=t.moduleName;else{const e=t.moduleName;(!s||e&&e.length<s.length)&&(s=e,i=2)}}if(this._configOptions.stubPath){const t=this.getModuleNameInfoFromPath(this._configOptions.stubPath,e);if(t)if(t.containsInvalidCharacters)o=t.moduleName;else{const e=t.moduleName;(!s||e&&e.length<s.length)&&(s=e,i=2,a=!0)}}const c=this._getThirdPartyTypeshedPath(t,r);if(c){const t=this.getModuleNameFromPath(c,e,!0);(!s||t&&t.length<s.length)&&(s=t,i=1)}const p=this.getTypeshedPathEx(t,r);if(p){const t=this.getModuleNameFromPath(p,e);(!s||t&&t.length<s.length)&&(s=t,i=1)}const d=this.getPythonSearchPaths(r);for(const t of d){const n=this.getModuleNameInfoFromPath(t,e);if(n)if(n.containsInvalidCharacters)o=n.moduleName;else{const e=n.moduleName;(!s||e&&e.length<s.length)&&(s=e,i=1)}}return s?{moduleName:s,importType:i,isLocalTypingsFile:a}:n&&o?{moduleName:o,importType:i,isLocalTypingsFile:a}:{moduleName:"",importType:2,isLocalTypingsFile:a}}getTypeshedStdLibPath(e){return this._getStdlibTypeshedPath(e,[])}getTypeshedThirdPartyPath(e){return this._getThirdPartyTypeshedPath(e,[])}isStdlibModule(e,t){return this._stdlibModules||(this._stdlibModules=this._buildStdlibCache(this.getTypeshedStdLibPath(t))),this._stdlibModules.has(e.nameParts.join("."))}getImportRoots(e,t=!1){const n=[],s=[],i=this._getStdlibTypeshedPath(e,n);if(i&&s.push(i),e.root&&s.push(e.root),(0,r.appendArray)(s,e.extraPaths),this._configOptions.stubPath&&s.push(this._configOptions.stubPath),t){const t=this._getThirdPartyTypeshedPath(e,n);t&&s.push((0,c.combinePaths)(t,"..."))}else{const t=this._getThirdPartyTypeshedPackageRoots(e,n);(0,r.appendArray)(s,t)}const a=this.getTypeshedPathEx(e,n);a&&s.push(a);const o=this.getPythonSearchPaths(n);return o.length>0&&(0,r.appendArray)(s,o),s}readdirEntriesCached(e){const t=this._cachedEntriesForPath.get(e);if(t)return t;let n;try{n=this.fileSystem.readdirEntriesSync(e)}catch{n=[]}return this._cachedEntriesForPath.set(e,n),n}fileExistsCached(e){var t,n;const s=this._splitPath(e);if(!s[0]||!s[1])return!!this.fileSystem.existsSync(e)&&null!==(n=null===(t=(0,c.tryStat)(this.fileSystem,e))||void 0===t?void 0:t.isFile())&&void 0!==n&&n;const i=this.readdirEntriesCached(s[0]).find((e=>e.name===s[1]));if(null==i?void 0:i.isFile())return!0;if(null==i?void 0:i.isSymbolicLink()){const t=(0,c.tryRealpath)(this.fileSystem,e);if(t&&this.fileSystem.existsSync(t)&&(0,c.isFile)(this.fileSystem,t))return!0}return!1}dirExistsCached(e){var t,n;const s=this._splitPath(e);if(!s[0]||!s[1])return!!this.fileSystem.existsSync(e)&&null!==(n=null===(t=(0,c.tryStat)(this.fileSystem,e))||void 0===t?void 0:t.isDirectory())&&void 0!==n&&n;const i=this.readdirEntriesCached(s[0]).find((e=>e.name===s[1]));if(null==i?void 0:i.isDirectory())return!0;if(null==i?void 0:i.isSymbolicLink()){const t=(0,c.tryRealpath)(this.fileSystem,e);if(t&&this.fileSystem.existsSync(t)&&(0,c.isDirectory)(this.fileSystem,t))return!0}return!1}ensurePartialStubPackages(e){if(!m.SupportPartialStubs.is(this.fileSystem))return!1;if(this.fileSystem.isPartialStubPackagesScanned(e))return!1;const t=this.fileSystem,n=[],s=[],i=this.getTypeshedPathEx(e,n);return a(this._configOptions.stubPath),a(e.root),e.extraPaths.forEach((e=>a(e))),a(i),this.getPythonSearchPaths(n).forEach((e=>a(e))),this.fileSystem.processPartialStubPackages(s,this.getImportRoots(e),i),this._invalidateFileSystemCache(),!0;function a(e){e&&!t.isPathScanned(e)&&s.push(e)}}addResultsToCache(e,t,n,s,i){return(0,r.getOrAdd)(this._cachedImportResults,e.root,(()=>new Map)).set(this._getCacheKey(t,i),n),this.filterImplicitImports(n,s)}resolveAbsoluteImport(e,t,n,s,i,a,r=!1,o=!1,l=!1,c=!0,p=!1){if(c&&l){const o=this._resolveAbsoluteImport(e,t,n,s,i,a,r,!1,!0,!0,!0);if(o.packageDirectory&&(!o.isNamespacePackage||o.isImportFound))return o}return this._resolveAbsoluteImport(e,t,n,s,i,a,r,o,!1,c,p)}_invalidateFileSystemCache(){this._cachedEntriesForPath.clear()}_splitPath(e){const t=(0,c.getPathComponents)(e);return t.length<=1?[e,""]:[(0,c.combinePathComponents)(t.slice(0,-1)),t[t.length-1]]}_resolveAbsoluteImport(e,t,n,s,i,a,r,o,p,d,u){p?a.push(`Attempting to resolve stub package using root path '${t}'`):a.push(`Attempting to resolve using root path '${t}'`);const y=[];let m,g,h,f=t,v=!1,_=!1,I=!1,b=!1,C=!1,S=[];if(0===s.nameParts.length){const e="__init__",t=(0,c.combinePaths)(f,e+".py"),n=(0,c.combinePaths)(f,e+".pyi");d&&this.fileExistsCached(n)?(a.push(`Resolved import with file '${n}'`),y.push(n),b=!0):this.fileExistsCached(t)?(a.push(`Resolved import with file '${t}'`),y.push(t)):(a.push(`Partially resolved import with directory '${f}'`),y.push(""),v=!0),S=this._findImplicitImports(i,f,[t,n])}else for(let e=0;e<s.nameParts.length;e++){const t=0===e,r=e===s.nameParts.length-1;f=(0,c.combinePaths)(f,s.nameParts[e]),p&&t&&(f+=l.stubsSuffix,I=!0);const h=this.dirExistsCached(f);if(h){t&&(m=f);const e="__init__",n=(0,c.combinePaths)(f,e+".py"),i=(0,c.combinePaths)(f,e+".pyi");if(_=!1,d&&this.fileExistsCached(i)?(a.push(`Resolved import with file '${i}'`),y.push(i),r&&(b=!0),_=!0):this.fileExistsCached(n)&&(a.push(`Resolved import with file '${n}'`),y.push(n),_=!0),!g&&u&&this.fileExistsCached((0,c.combinePaths)(f,"py.typed"))&&(g=(0,T.getPyTypedInfo)(this.fileSystem,f)),!r){_||(y.push(""),v=!0,g=void 0);continue}if(_){S=this._findImplicitImports(s.nameParts.join("."),f,[n,i]);break}}let x=(0,c.stripTrailingDirectorySeparator)(f);const D=(0,c.getFileName)(x);x=(0,c.getDirectoryPath)(x);const F=(0,c.combinePaths)(x,D+".py"),E=(0,c.combinePaths)(x,D+".pyi");if(d&&this.fileExistsCached(E))a.push(`Resolved import with file '${E}'`),y.push(E),r&&(b=!0);else if(this.fileExistsCached(F))a.push(`Resolved import with file '${F}'`),y.push(F);else{if(o&&this.dirExistsCached(x)){const e=this._getFilesInDirectory(x).find((e=>this._isNativeModuleFileName(D,e)));if(e){const t=(0,c.combinePaths)(x,e);C=this._resolveNativeModuleStub(t,n,i,s,a,y)}}!C&&h?(a.push(`Partially resolved import with directory '${f}'`),y.push(""),r&&(S=this._findImplicitImports(i,f,[F,E]),v=!0)):C&&a.push(`Did not find file '${E}' or '${F}'`)}break}const x=y.length>0&&y.length<s.nameParts.length;return h=r?y.length>0:y.length>=s.nameParts.length,{importName:i,isRelative:!1,isNamespacePackage:v,isInitFilePresent:_,isStubPackage:I,isImportFound:h,isPartlyResolved:x,importFailureInfo:a,importType:2,resolvedPaths:y,searchPath:t,isStubFile:b,isNativeLib:C,implicitImports:S,pyTypedInfo:g,filteredImplicitImports:S,packageDirectory:m}}getTypeshedPathEx(e,t){}resolveImportEx(e,t,n,s,i=[],a=!0){}resolveNativeImportEx(e,t,n=[]){}getNativeModuleName(e){const t=(0,c.getFileExtension)(e,!1).toLowerCase();if(this._isNativeModuleFileExtension(t))return(0,c.stripFileExtension)((0,c.stripFileExtension)(e))}_getCacheKey(e,t){return`${e}-${t}`}_lookUpResultsInCache(e,t,n,s){const i=this._cachedImportResults.get(e.root);if(!i)return;const a=i.get(this._getCacheKey(t,s));return a?this.filterImplicitImports(a,n):void 0}_isNamespacePackageResolved(e,t){if(e.importedSymbols){if(!e.importedSymbols.some((e=>t.some((t=>t.name===e)))))return!1}else if(0===t.length)return!1;return!0}getModuleNameFromPath(e,t,n=!1){const s=this.getModuleNameInfoFromPath(e,t,n);if(s&&!s.containsInvalidCharacters)return s.moduleName}getModuleNameInfoFromPath(e,t,n=!1){e=e.toLowerCase(),t=t.toLowerCase(),e=(0,c.ensureTrailingDirectorySeparator)(e);let s=(0,c.stripFileExtension)(t);if(this._isNativeModuleFileExtension((0,c.getFileExtension)(t))&&(s=(0,c.stripFileExtension)(s)),!s.startsWith(e))return;s.endsWith("__init__")&&(s=s.substr(0,s.length-9));const i=s.substr(e.length),a=(0,c.getPathComponents)(i);if(a.shift(),n){if(0===a.length)return;a.shift()}if(0===a.length)return;a[0].endsWith(l.stubsSuffix)&&(a[0]=a[0].substr(0,a[0].length-l.stubsSuffix.length));const r=a.some((e=>!this._isIdentifier(e)));return{moduleName:a.join("."),containsInvalidCharacters:r}}_resolveBestAbsoluteImport(e,t,n,s){const i=this.formatImportName(n),a=[];if(s&&this._configOptions.stubPath){a.push(`Looking in stubPath '${this._configOptions.stubPath}'`);const r=this.resolveAbsoluteImport(e,this._configOptions.stubPath,t,n,i,a,void 0,!1,!0,s,!1);if(r.isImportFound){if(r.importType=2,r.isLocalTypingsFile=!0,!r.isNamespacePackage||r.resolvedPaths[r.resolvedPaths.length-1])return r;if(this._isNamespacePackageResolved(n,r.implicitImports))return r}}let r,o;t.root&&(a.push(`Looking in root directory of execution environment '${t.root}'`),o=this.resolveAbsoluteImport(e,t.root,t,n,i,a,void 0,!0,!0,s,!1),r=o);for(const l of t.extraPaths)a.push(`Looking in extraPath '${l}'`),o=this.resolveAbsoluteImport(e,l,t,n,i,a,void 0,!0,!0,s,!1),r=this._pickBestImport(r,o,n);const l=this.getPythonSearchPaths(a);if(l.length>0)for(const o of l){a.push(`Looking in python search path '${o}'`);const l=this.resolveAbsoluteImport(e,o,t,n,i,a,!1,!0,!0,s,!0);l&&(l.importType=1,r=this._pickBestImport(r,l,n))}else a.push("No python interpreter search path");if(t.root!==this._getTypeshedRoot(t,a)&&(null==r?void 0:r.pyTypedInfo)&&!r.isPartlyResolved)return r;const c=this.resolveImportEx(e,t,n,i,a,s);if(c)return c;if(s&&n.nameParts.length>0){a.push("Looking for typeshed stdlib path");const e=this._findTypeshedPath(t,n,i,!0,a);if(e)return e.isStdlibTypeshedFile=!0,e;a.push("Looking for typeshed third-party path");const s=this._findTypeshedPath(t,n,i,!1,a);s&&(s.isThirdPartyTypeshedFile=!0,r=this._pickBestImport(r,s,n))}return r}_pickBestImport(e,t,n){if(!e)return t;if(!t)return e;if(t.isImportFound){if(!e.isImportFound)return t;if(e.isNamespacePackage&&!t.isNamespacePackage)return t;if(2===e.importType&&!e.isNamespacePackage)return e;if(2===t.importType&&!t.isNamespacePackage)return t;if(e.isNamespacePackage&&t.isNamespacePackage&&n.importedSymbols&&!this._isNamespacePackageResolved(n,e.implicitImports)){if(this._isNamespacePackageResolved(n,t.implicitImports))return t;if(e.isInitFilePresent&&!t.isInitFilePresent)return e;if(!e.isInitFilePresent&&t.isInitFilePresent)return t}if(e.pyTypedInfo&&!t.pyTypedInfo)return e;if(!e.pyTypedInfo&&t.pyTypedInfo)return t;if(e.isStubFile&&!t.isStubFile)return e;if(!e.isStubFile&&t.isStubFile)return t;if(e.resolvedPaths.length>t.resolvedPaths.length)return t}else if(t.isPartlyResolved&&e.isNamespacePackage&&!t.isNamespacePackage)return t;return e}_isIdentifier(e){for(let t=0;t<e.length;t++)if(0===t?!(0,y.isIdentifierStartChar)(e.charCodeAt(t)):!(0,y.isIdentifierChar)(e.charCodeAt(t)))return!1;return!0}getPythonSearchPaths(e){if(!this._cachedPythonSearchPaths){const e=[],t=(f.findPythonSearchPaths(this.fileSystem,this._configOptions,this.host,e)||[]).map((e=>this.fileSystem.realCasePath(e)));this._cachedPythonSearchPaths={paths:[...new Set(t)],failureInfo:e}}return e.push(...this._cachedPythonSearchPaths.failureInfo),this._cachedPythonSearchPaths.paths}_findTypeshedPath(e,t,n,s,i){let a;if(i.push(`Looking for typeshed ${s?f.stdLibFolderName:f.thirdPartyFolderName} path`),s){const n=this._getStdlibTypeshedPath(e,i,t);n&&(a=[n])}else a=this._getThirdPartyTypeshedPackagePaths(t,e,i);if(a)for(const r of a)if(this.dirExistsCached(r)){const a=this.resolveAbsoluteImport(void 0,r,e,t,n,i);if(a.isImportFound)return a.importType=s?0:1,a}i.push("Typeshed path not found")}_buildStdlibCache(e){const t=new Set;if(e){const n=(e,s)=>{this.readdirEntriesCached(e).forEach((i=>{if(i.isDirectory()){const t=(0,c.combinePaths)(e,i.name);n(t,s?`${s}.${i.name}`:i.name)}else if(i.name.includes(".py")){const e=(0,c.stripFileExtension)(i.name);e.startsWith("_")||t.add(s?`${s}.${e}`:e)}}))};n(e,void 0)}return t}_buildTypeshedThirdPartyPackageMap(e){this._cachedTypeshedThirdPartyPackagePaths=new Map,e&&this.readdirEntriesCached(e).forEach((t=>{if(t.isDirectory()){const n=(0,c.combinePaths)(e,t.name);this.readdirEntriesCached(n).forEach((e=>{if("@python2"!==e.name)if(e.isDirectory()){const t=this._cachedTypeshedThirdPartyPackagePaths.get(e.name);t?t.push(n):this._cachedTypeshedThirdPartyPackagePaths.set(e.name,[n])}else if(e.isFile()&&e.name.endsWith(".pyi")){const t=(0,c.stripFileExtension)(e.name),s=this._cachedTypeshedThirdPartyPackagePaths.get(t);s?s.push(n):this._cachedTypeshedThirdPartyPackagePaths.set(t,[n])}}))}}));const t=[...this._cachedTypeshedThirdPartyPackagePaths.values()].flatMap((e=>e));this._cachedTypeshedThirdPartyPackageRoots=[...new Set(t)].sort()}_getCompletionSuggestionsTypeshedPath(e,t,n,s,i){const a=[];let r;if(s){const e=this._getStdlibTypeshedPath(t,a,n);e&&(r=[e])}else{r=this._getThirdPartyTypeshedPackagePaths(n,t,a,!1);const e=this.getTypeshedPathEx(t,a);e&&(r=null!=r?r:[],r.push(e))}r&&r.forEach((s=>{this.dirExistsCached(s)&&this._getCompletionSuggestionsAbsolute(e,t,s,n,i)}))}_getStdlibTypeshedPath(e,t,n){const s=this._getTypeshedSubdirectory(!0,e,t);if(!s||!n||this._isStdlibTypeshedStubValidForVersion(n,e,t))return s}_getThirdPartyTypeshedPath(e,t){return this._getTypeshedSubdirectory(!1,e,t)}_isStdlibTypeshedStubValidForVersion(e,t,n){this._cachedTypeshedStdLibModuleVersions||(this._cachedTypeshedStdLibModuleVersions=this._readTypeshedStdLibVersions(t,n));for(let n=1;n<=e.nameParts.length;n++){const s=e.nameParts.slice(0,n),i=this._cachedTypeshedStdLibModuleVersions.get(s.join("."));if(i){if(t.pythonVersion<i.min)return!1;if(void 0!==i.max&&t.pythonVersion>i.max)return!1}}return!0}_readTypeshedStdLibVersions(e,t){const n=new Map,s=this._getTypeshedSubdirectory(!0,e,t);if(s){const e=(0,c.combinePaths)(s,"VERSIONS");try{const s=this.fileSystem.statSync(e);s.size>0&&s.size<262144?this.fileSystem.readFileSync(e,"utf8").split(/\r?\n/).forEach((e=>{const t=e.split("#")[0].split(":");if(2!==t.length)return;const s=t[1].split("-");if(s.length>2)return;const i=t[0].trim();if(!i)return;let a=s[0].trim();a.endsWith("+")&&(a=a.substr(0,a.length-1));let r,o=(0,p.versionFromString)(a);o||(o=p.PythonVersion.V3_0),s.length>1&&(r=(0,p.versionFromString)(s[1].trim())),n.set(i,{min:o,max:r})})):t.push("Typeshed stdlib VERSIONS file is unexpectedly large")}catch(e){t.push(`Could not read typeshed stdlib VERSIONS file: '${JSON.stringify(e)}'`)}}return n}_getThirdPartyTypeshedPackagePaths(e,t,n,s=!0){const i=this._getThirdPartyTypeshedPath(t,n);this._cachedTypeshedThirdPartyPackagePaths||this._buildTypeshedThirdPartyPackageMap(i);const a=e.nameParts.length>0?e.nameParts[0]:"";return s?this._cachedTypeshedThirdPartyPackagePaths.get(a):a?(0,r.flatten)((0,r.getMapValues)(this._cachedTypeshedThirdPartyPackagePaths,(e=>e.startsWith(a)))):[]}_getThirdPartyTypeshedPackageRoots(e,t){const n=this._getThirdPartyTypeshedPath(e,t);return this._cachedTypeshedThirdPartyPackagePaths||this._buildTypeshedThirdPartyPackageMap(n),this._cachedTypeshedThirdPartyPackageRoots}_getTypeshedRoot(e,t){if(void 0!==this._cachedTypeshedRoot)return this._cachedTypeshedRoot;let n="";if(this._configOptions.typeshedPath){const e=this._configOptions.typeshedPath;this.dirExistsCached(e)&&(n=e)}else{const e=this.getPythonSearchPaths(t);for(const t of e){const e=(0,c.combinePaths)(t,"typeshed");if(this.dirExistsCached(e)){n=e;break}}}return n||(n=f.getTypeShedFallbackPath(this.fileSystem)||""),this._cachedTypeshedRoot=n,n}_getTypeshedSubdirectory(e,t,n){if(e){if(void 0!==this._cachedTypeshedStdLibPath)return this._cachedTypeshedStdLibPath}else if(void 0!==this._cachedTypeshedThirdPartyPath)return this._cachedTypeshedThirdPartyPath;let s=this._getTypeshedRoot(t,n);if(s=f.getTypeshedSubdirectory(s,e),this.dirExistsCached(s))return e?this._cachedTypeshedStdLibPath=s:this._cachedTypeshedThirdPartyPath=s,s}_resolveRelativeImport(e,t,n,s,i){i.push("Attempting to resolve relative import");const a=(0,g.getDirectoryLeadingDotsPointsTo)((0,c.getDirectoryPath)(e),n.leadingDots);if(!a)return void i.push(`Invalid relative path '${s}'`);const r=this.resolveAbsoluteImport(e,a,t,n,s,i,!1,!0);return r&&r.isStubFile&&(r.nonStubImportResult=this.resolveAbsoluteImport(e,a,t,n,s,i,!1,!0,!1,!1)||{importName:s,isRelative:!0,isImportFound:!1,isPartlyResolved:!1,isNamespacePackage:!1,isStubPackage:!1,importFailureInfo:i,resolvedPaths:[],importType:2,isStubFile:!1,isNativeLib:!1,implicitImports:[],filteredImplicitImports:[],nonStubImportResult:void 0}),this.filterImplicitImports(r,n.importedSymbols)}_getCompletionSuggestionsRelative(e,t,n,s){const i=(0,g.getDirectoryLeadingDotsPointsTo)((0,c.getDirectoryPath)(e),n.leadingDots);i&&this._getCompletionSuggestionsAbsolute(e,t,i,n,s)}_getFilesInDirectory(e){const t=this.readdirEntriesCached(e),n=t.filter((e=>e.isFile())).map((e=>e.name));return t.forEach((t=>{var s;const i=(0,c.combinePaths)(e,t.name);t.isSymbolicLink()&&(null===(s=(0,c.tryStat)(this.fileSystem,i))||void 0===s?void 0:s.isFile())&&n.push(t.name)})),n}_getCompletionSuggestionsAbsolute(e,t,n,s,i,a=!0){let r=n;const o=s.nameParts.map((e=>e));s.hasTrailingDot&&o.push("");const l=s.leadingDots,p=o.slice(0,-1);if(0===o.length)this._addFilteredSuggestionsAbsolute(e,t,r,"",i,l,p,a);else for(let n=0;n<o.length&&(n===o.length-1&&this._addFilteredSuggestionsAbsolute(e,t,r,o[n],i,l,p,a),r=(0,c.combinePaths)(r,o[n]),this.dirExistsCached(r));n++);}_addFilteredSuggestionsAbsolute(e,n,s,i,a,r,o,l){const p=(0,c.getFileSystemEntriesFromDirEntries)(this.readdirEntriesCached(s),this.fileSystem,s);p.files.forEach((p=>{const d=(0,c.getFileExtension)(p,!1).toLowerCase(),y=(0,c.stripFileExtension)(p,!0);if(t.supportedFileExtensions.some((e=>e===d))){if("__init__"===y)return;if(i&&!u.isPatternInSymbol(i,y))return;if(!this._isUniqueValidSuggestion(y,a)||!this._isResolvableSuggestion(y,r,o,e,n,l))return;a.set(y,(0,c.combinePaths)(s,p))}})),p.directories.forEach((t=>{if(i&&!t.startsWith(i))return;if(!this._isUniqueValidSuggestion(t,a)||!this._isResolvableSuggestion(t,r,o,e,n,l))return;const p=(0,c.combinePaths)(s,t,"__init__.pyi");if(this.fileExistsCached(p))return void a.set(t,p);const d=(0,c.combinePaths)(s,t,"__init__.py");this.fileExistsCached(d)?a.set(t,d):a.set(t,"")}))}_isResolvableSuggestion(e,t,n,s,i,a){const r={leadingDots:t,nameParts:[...n,e],importedSymbols:[]};if(a){const e=this.formatImportName(r),t=[];return this._resolveImportStrict(e,s,i,r,t).isImportFound}return this._resolveImport(s,i,r).isImportFound}_isUniqueValidSuggestion(e,t){return!(t.has(e)||/[.-]/.test(e)||(0,v.isDunderName)(e)&&"__future__"!==e)}filterImplicitImports(e,t){if(void 0===t){const t=Object.assign({},e);return t.filteredImplicitImports=[],t}if(0===t.length)return e;if(0===e.implicitImports.length)return e;const n=e.implicitImports.filter((e=>t.some((t=>t===e.name))));if(n.length===e.implicitImports.length)return e;const s=Object.assign({},e);return s.filteredImplicitImports=n,s}_findImplicitImports(e,t,n){const s=new Map,i=(0,c.getFileSystemEntriesFromDirEntries)(this.readdirEntriesCached(t),this.fileSystem,t);for(const a of i.files){const i=(0,c.getFileExtension)(a);let r,o=!1;if(".py"===i||".pyi"===i)r=(0,c.stripFileExtension)(a);else{if(!this._isNativeModuleFileExtension(i)||this.fileExistsCached(`${a}.py`)||this.fileExistsCached(`${a}.pyi`))continue;r=a.substr(0,a.indexOf(".")),o=!0}const l=(0,c.combinePaths)(t,a);if(!n.find((e=>e===l))){const n={isStubFile:a.endsWith(".pyi"),isNativeLib:o,name:r,path:l},i=s.get(n.name);if(!i||!i.isStubFile){if(o){const s=(0,c.combinePaths)(t,a),i=this.resolveNativeImportEx(s,`${e}.${r}`,[]);i&&(n.path=i,n.isNativeLib=!1)}s.set(n.name,n)}}}for(const e of i.directories){const i=(0,c.combinePaths)(t,e,"__init__.py"),a=i+"i";let r=!1,o="";if(this.fileExistsCached(a)?(r=!0,o=a):this.fileExistsCached(i)&&(o=i),o&&!n.find((e=>e===o))){const n={isStubFile:r,isNativeLib:!1,name:e,path:o,pyTypedInfo:(0,T.getPyTypedInfo)(this.fileSystem,(0,c.combinePaths)(t,e))};s.set(n.name,n)}}return[...s.values()]}formatImportName(e){return".".repeat(e.leadingDots)+e.nameParts.join(".")}_resolveNativeModuleStub(e,t,n,s,i,a){let r=n;if(s.leadingDots>0){const n=this.getModuleNameForImport(e,t);r=n.moduleName.length>0?n.moduleName:r}const o=this.resolveNativeImportEx(e,r,i);return o?(i.push(`Resolved native import ${n} with stub '${o}'`),a.push(o),!1):(i.push(`Resolved import with file '${e}'`),a.push(e),!0)}_isNativeModuleFileName(e,t){const n=(0,c.getFileExtension)(t,!1).toLowerCase(),s=(0,c.stripFileExtension)(t,!0);return this._isNativeModuleFileExtension(n)&&(0,d.equateStringsCaseInsensitive)(e,s)}_isNativeModuleFileExtension(e){return _.some((t=>t===e))}_tryWalkUp(e){return(0,c.isDiskPathRoot)(e)?[!1,""]:[!0,(0,c.ensureTrailingDirectorySeparator)((0,c.normalizePathCase)(this.fileSystem,(0,c.normalizePath)((0,c.combinePaths)(e,".."))))]}_shouldWalkUp(e,t,n){return e.length>t.length||e===t&&!n.root}getParentImportResolutionRoot(e,t){return t?(0,c.ensureTrailingDirectorySeparator)((0,c.normalizePathCase)(this.fileSystem,(0,c.normalizePath)(t))):(0,c.ensureTrailingDirectorySeparator)((0,c.getDirectoryPath)(e))}}},7012:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.haveSameParentModule=t.getResolvedFilePath=t.getDirectoryLeadingDotsPointsTo=t.getRelativeModuleName=t.getTextRangeForImportNameDeletion=t.getImportGroupFromModuleNameAndType=t.getAllImportNames=t.getContainingImportStatement=t.getTextEditsForAutoImportInsertion=t.getTextEditsForAutoImportInsertions=t.getTextEditsForAutoImportSymbolAddition=t.getTopLevelImports=t.compareImportStatements=t.getImportGroup=void 0;const r=n(3213),o=n(9489),l=n(6657),c=n(1464),p=n(7559),d=n(3550),u=a(n(563)),y=a(n(1766));function m(e){return e.importResult?0===e.importResult.importType?0:1===e.importResult.importType||e.importResult.isLocalTypingsFile?1:e.importResult.isRelative?3:2:2}function g(e){return y.isConstantName(e)?0:y.isTypeAliasName(e)?1:2}function h(e,t){const n=g(e)-g(t);if(0!==n)return n;const s=e.replace(/_/g,"="),i=t.replace(/_/g,"=");return(0,p.compareStringsCaseSensitive)(s,i)}function f(e,t,n,s){let i;for(const t of n.imports){if(h(t.name.value,e)>0)break;i=t}let a=!1,r="";if(n.imports.length>0){const e=(0,c.convertOffsetToPosition)(n.start,s.tokenizerOutput.lines),t=(0,c.convertOffsetToPosition)(n.imports[0].start,s.tokenizerOutput.lines),i=n.imports.length>1?(0,c.convertOffsetToPosition)(n.imports[1].start,s.tokenizerOutput.lines):void 0;if(t.line>e.line&&(void 0===i||i.line>t.line)){const e=s.tokenizerOutput.lines.getItemAt(t.line);r=s.text.substr(e.start,t.character),/^\s*$/.test(r)&&(a=!0)}}const o=i?d.TextRange.getEnd(i):n.imports.length>0?n.imports[0].start:n.start+n.length,l=(0,c.convertOffsetToPosition)(o,s.tokenizerOutput.lines),p=t?`${e} as ${t}`:`${e}`;let u;if(a){const e=s.tokenizerOutput.predominantEndOfLineSequence;u=i?`,${e}${r}${p}`:`${p},${e}${r}`}else u=i?`, ${p}`:`${p}, `;return{range:{start:l,end:l},importName:e,replacementText:u}}function T(e,t){if(t.length<2)return t.map((e=>i(e)));const n=[...(0,o.createMapFromItems)(t,(e=>`${e.importGroup} ${d.Range.print(e.range)}`))].sort(((e,t)=>(0,p.compareStringsCaseSensitive)(e[0],t[0]))).map((e=>e[1])),s=[];for(const t of n)1===t.length?s.push(i(t[0])):s.push({range:t[0].range,replacementText:t[0].preChange+t.map((e=>e.importStatement)).sort(((e,t)=>a(e,t))).join(e.tokenizerOutput.predominantEndOfLineSequence)+t[0].postChange});return s;function i(e){return{range:e.range,replacementText:e.preChange+e.importStatement+e.postChange}}function a(e,t){const n=e.startsWith("import");return n===t.startsWith("import")?e<t?-1:1:n?-1:1}}function v(e,t,n,s,i,a){const r=[];0===(e=Array.isArray(e)?e:[e]).length&&e.push({});const l=(0,o.createMapFromItems)(e,(e=>e.name?"from":"import")),p=l.get("import");p&&g(p,(e=>`import ${e.join(", ")}`));const u=l.get("from");return u&&g(u,(e=>{var n;return`from ${null!==(n=t.nameForImportFrom)&&void 0!==n?n:t.name} import ${e.join(", ")}`})),r;function g(e,l){const p=e.map((e=>function(e,t){const n=e.name?e.name:t;return{sortText:n,text:e.alias?`${n} as ${e.alias}`:n}}(e,t.name))).sort(((e,t)=>h(e.sortText,t.sortText))).reduce(((e,t)=>(0,o.addIfUnique)(e,t.text)),[]);r.push(function(e,t,n,s,i,a){let r,o="",l="";const p=(0,c.convertPositionToOffset)(a,i.tokenizerOutput.lines);if(t.orderedImports.length>0&&p>t.orderedImports[0].node.start){let e=!0,a=t.orderedImports[0],p=0;for(const r of t.orderedImports){const l=r.importResult?m(r):p;if(s<l){!e&&p<s&&(o=i.tokenizerOutput.predominantEndOfLineSequence+o);break}if(s===l&&r.moduleName>n)break;if(r.followsNonImportStatement){s>p&&(o=i.tokenizerOutput.predominantEndOfLineSequence+o);break}r===t.orderedImports[t.orderedImports.length-1]&&s>l&&(o=i.tokenizerOutput.predominantEndOfLineSequence+o),e=!e&&s<p&&s===l,p=l,a=r}a?(e?l+=i.tokenizerOutput.predominantEndOfLineSequence:o=i.tokenizerOutput.predominantEndOfLineSequence+o,r=(0,c.convertOffsetToPosition)(e?a.node.start:d.TextRange.getEnd(a.node),i.tokenizerOutput.lines)):r={line:0,character:0}}else{r={line:0,character:0};let e=!1;for(const t of i.parseTree.statements){let n=!0;if(47===t.nodeType&&1===t.statements.length){const e=t.statements[0];(48===e.nodeType||3===e.nodeType&&38===e.leftExpression.nodeType&&y.isDunderName(e.leftExpression.value))&&(n=!1)}if(n){r=(0,c.convertOffsetToPosition)(t.start,i.tokenizerOutput.lines),e=!1;break}r=(0,c.convertOffsetToPosition)(t.start+t.length,i.tokenizerOutput.lines),e=!0}l=l+i.tokenizerOutput.predominantEndOfLineSequence+i.tokenizerOutput.predominantEndOfLineSequence,e?o=i.tokenizerOutput.predominantEndOfLineSequence+o:l+=i.tokenizerOutput.predominantEndOfLineSequence}return{range:{start:r,end:r},preChange:o,importStatement:e,postChange:l,importGroup:s}}(l(p),n,t.name,s,i,a))}}function _(e){let t="";for(let n=0;n<e.leadingDots;n++)t+=".";return t+=e.nameParts.map((e=>e.value)).join("."),t}function I(e){let t=2;return e.isLocalTypingsFile||1===e.importType?t=1:0===e.importType&&(t=0),t}t.getImportGroup=m,t.compareImportStatements=function(e,t){const n=m(e),s=m(t);return n<s?-1:n>s?1:e.moduleName<t.moduleName?-1:1},t.getTopLevelImports=function(e,t=!1){const n={orderedImports:[],mapByFilePath:new Map};let s=!1,i=!1;return e.statements.forEach((e=>{47===e.nodeType?e.statements.forEach((e=>{20===e.nodeType?(i=!0,function(e,t,n){e.list.forEach((s=>{const i=u.getImportInfo(s.module);let a;i&&i.isImportFound&&(a=i.resolvedPaths[i.resolvedPaths.length-1]);const r={node:e,subnode:s,importResult:i,resolvedPath:a,moduleName:_(s.module),followsNonImportStatement:n};t.orderedImports.push(r),a&&(t.mapByFilePath.has(a)||t.mapByFilePath.set(a,r))}))}(e,n,s),s=!1):22===e.nodeType?(i=!0,function(e,t,n,s){var i;const a=u.getImportInfo(e.module);let r;if(a&&a.isImportFound&&(r=a.resolvedPaths[a.resolvedPaths.length-1]),s&&a){t.implicitImports=null!==(i=t.implicitImports)&&void 0!==i?i:new Map;for(const n of a.implicitImports){const s=e.imports.find((e=>e.name.value===n.name));s&&t.implicitImports.set(n.path,s)}}const o={node:e,importResult:a,resolvedPath:r,moduleName:_(e.module),followsNonImportStatement:n};if(t.orderedImports.push(o),r){const e=t.mapByFilePath.get(r);(!e||20===e.node.nodeType||e.moduleName.length>o.moduleName.length)&&t.mapByFilePath.set(r,o)}}(e,n,s,t),s=!1):s=i})):s=i})),n},t.getTextEditsForAutoImportSymbolAddition=function(e,t,n){const s=[];if(!t.node||22!==t.node.nodeType||t.node.isWildcardImport)return s;const i=t.node;if(0===(e=(Array.isArray(e)?e:[e]).filter((e=>!!e.name&&!i.imports.some((t=>t.name.value===e.name&&t.alias===e.alias))))).length)return s;for(const i of e)s.push(f(i.name,i.alias,t.node,n));const a=(0,o.createMapFromItems)(s,(e=>d.Range.print(e.range))),r=[];for(const e of a.values())1===e.length?r.push(e[0]):r.push({range:e[0].range,replacementText:e.sort(((e,t)=>h(e.importName,t.importName))).map((e=>e.replacementText)).join("")});return r},t.getTextEditsForAutoImportInsertions=function(e,t,n,s){const i=[];if(0===(e=Array.isArray(e)?e:[e]).length)return[];const a=(0,o.createMapFromItems)(e,(e=>{var t;return`${e.module.moduleName}-${null!==(t=e.nameForImportFrom)&&void 0!==t?t:""}`}));for(const e of a.values())i.push(...v(e,{name:e[0].module.moduleName,nameForImportFrom:e[0].nameForImportFrom},t,I(e[0].module),n,s));return T(n,i)},t.getTextEditsForAutoImportInsertion=function(e,t,n,s,i,a){return T(i,v(e,t,n,s,i,a))},t.getContainingImportStatement=function(e,t){for(;e&&((0,r.throwIfCancellationRequested)(t),20!==e.nodeType&&22!==e.nodeType);)e=e.parent;return e},t.getAllImportNames=function(e){return 20===e.nodeType?e.list:e.imports},t.getImportGroupFromModuleNameAndType=I,t.getTextRangeForImportNameDeletion=function(e,...t){const n=[];for(const s of function(e){if(0===e.length)return[];if(1===e.length)return[{start:e[0],end:e[0]}];const t=[];let n=e[0],s=n;for(const i of e)s!==i&&(s+1!==i?(t.push({start:n,end:s}),n=i,s=i):s=i);return t.push({start:n,end:s}),t}(t)){const t=e[s.start],i=e[s.end];if(0===s.start&&e.length===s.end-s.start+1)n.push(d.TextRange.fromBounds(t.start,d.TextRange.getEnd(i)));else if(s.end===e.length-1){const t=d.TextRange.getEnd(e[s.start-1]),a=d.TextRange.getEnd(i)-t;n.push({start:t,length:a})}else{const i=t.start,a=e[s.end+1].start-i;n.push({start:i,length:a})}}return n},t.getRelativeModuleName=function(e,t,n,s=!1,i){let a,r=t;(i=void 0!==i?i:(0,l.isFile)(e,t))&&(r=(0,l.getDirectoryPath)(t));let o=n;if(i){o=(0,l.getDirectoryPath)(n);const e=(0,l.stripFileExtension)((0,l.getFileName)(n));"__init__"!==e?a=e:s&&(a=(0,l.getFileName)(o),o=(0,l.getDirectoryPath)(o))}const c=(0,l.getRelativePathComponentsFromDirectory)(r,o,(t=>e.realCasePath(t)));let p=".";for(let e=1;e<c.length;e++){const t=c[e];p+=".."===t?".":t,".."!==t&&e!==c.length-1&&(p+=".")}return a&&(p="."===p[p.length-1]?p+a:p+"."+a),p},t.getDirectoryLeadingDotsPointsTo=function(e,t){let n=e;for(let e=1;e<t;e++){if(""===n)return;n=(0,l.getDirectoryPath)(n)}return n},t.getResolvedFilePath=function(e){if(e&&e.isImportFound&&0!==e.resolvedPaths.length)return 1===e.resolvedPaths.length&&""===e.resolvedPaths[0]?e.packageDirectory?e.packageDirectory:e.searchPath?e.searchPath:void 0:e.resolvedPaths[e.resolvedPaths.length-1]},t.haveSameParentModule=function(e,t){if(e.length!==t.length)return!1;let n=0;for(n=0;n<e.length-1&&e[n]===t[n];n++);return n===e.length-1}},118:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.updateNamedTupleBaseClass=t.createNamedTupleType=void 0;const r=n(1464),o=n(3550),l=n(9866),c=n(563),p=a(n(8494)),d=n(817),u=n(1133),y=n(5168);function m(e,t,n){const s=e.details.mro.findIndex((e=>(0,u.isInstantiableClass)(e)&&u.ClassType.isBuiltIn(e,"NamedTuple")));if(s<0||e.details.mro.length<s+2)return;const i=e.details.mro[s],a=e.details.mro[s+1];if(!(0,u.isInstantiableClass)(a)||!(0,y.isTupleClass)(a))return;const r=[];n?t.forEach((e=>{r.push({type:e,isUnbounded:!1})})):r.push({type:t.length>0?(0,u.combineTypes)(t):u.UnknownType.create(),isUnbounded:!0});const o=(0,y.specializeTupleClass)(a,r,n),l=u.ClassType.cloneForSpecialization(i,[],n);l.details={...l.details},l.details.mro=[...l.details.mro],l.details.mro[1]=o.details.mro[0],l.details.baseClasses=l.details.baseClasses.map((e=>(0,u.isInstantiableClass)(e)&&(0,y.isTupleClass)(e)?o:e)),e.details.mro[s]=l,e.details.mro[s+1]=o,e.details.baseClasses=e.details.baseClasses.map((e=>(0,u.isInstantiableClass)(e)&&u.ClassType.isBuiltIn(e,"NamedTuple")?l:e))}t.createNamedTupleType=function(e,t,n,s){var i,a,g;const h=(0,c.getFileInfo)(t);let f="namedtuple";if(0===n.length)e.addError(l.Localizer.Diagnostic.namedTupleFirstArg(),t);else{const s=n[0];0!==s.argumentCategory?e.addError(l.Localizer.Diagnostic.namedTupleFirstArg(),n[0].valueExpression||t):s.valueExpression&&48===s.valueExpression.nodeType&&(f=s.valueExpression.strings.map((e=>e.value)).join(""))}const T=n.find((e=>{var t;return"defaults"===(null===(t=e.name)||void 0===t?void 0:t.value)}));let v=0;if(T&&T.valueExpression){const t=e.getTypeOfExpression(T.valueExpression).type;v=(0,u.isClassInstance)(t)&&(0,y.isTupleClass)(t)&&!(0,y.isUnboundedTupleClass)(t)&&t.tupleTypeArguments?t.tupleTypeArguments.length:void 0}const _=e.getTypingType(t,"NamedTuple")||u.UnknownType.create(),I=u.ClassType.createInstantiable(f,p.getClassFullName(t,h.moduleName,f),h.moduleName,h.filePath,16777216,p.getTypeSourceId(t),void 0,(0,u.isInstantiableClass)(_)?_.details.effectiveMetaclass:u.UnknownType.create());I.details.baseClasses.push(_),I.details.typeVarScopeId=e.getScopeIdForNode(t);const b=I.details.fields;b.set("__class__",d.Symbol.createWithType(68,I));const C=(0,y.synthesizeTypeVarForSelfCls)(I,!0),S=u.FunctionType.createSynthesizedInstance("__new__",1);S.details.declaredReturnType=(0,y.convertToInstance)(C),p.isAssignmentToDefaultsFollowingNamedTuple(t)&&(S.details.flags|=32),u.FunctionType.addParameter(S,{category:0,name:"cls",type:C,hasDeclaredType:!0});const x=[],D={category:0,name:"self",type:(0,y.synthesizeTypeVarForSelfCls)(I,!1),hasDeclaredType:!0};let F=!1;const E=[];if(n.length<2)e.addError(l.Localizer.Diagnostic.namedTupleSecondArg(),t),F=!0;else{const t=n[1];if(0!==t.argumentCategory)F=!0;else if(!s&&t.valueExpression&&48===t.valueExpression.nodeType){const e=t.valueExpression.strings.map((e=>e.value)).join("").split(/[,\s]+/),n=void 0===v?0:Math.max(0,e.length-v);e.forEach(((e,i)=>{if(e=e.trim()){const a=u.UnknownType.create(),l={category:0,name:e,type:a,hasDeclaredType:s,hasDefault:i>=n};u.FunctionType.addParameter(S,l);const c=d.Symbol.createWithType(8,a);x.push(e);const p=t.valueExpression,y={type:1,node:p,isRuntimeTypeExpression:!0,path:h.filePath,range:(0,r.convertOffsetsToRange)(p.start,o.TextRange.getEnd(p),h.lines),moduleName:h.moduleName,isInExceptSuite:!1};c.addDeclaration(y),b.set(e,c),E.push(a)}}))}else if(31===(null===(i=t.valueExpression)||void 0===i?void 0:i.nodeType)||52===(null===(a=t.valueExpression)||void 0===a?void 0:a.nodeType)){const n=t.valueExpression,i=new Map,a=31===(null===(g=t.valueExpression)||void 0===g?void 0:g.nodeType)?t.valueExpression.entries:t.valueExpression.expressions,c=void 0===v?0:Math.max(0,a.length-v);a.forEach(((t,n)=>{let a,p,m,g="";s?52===t.nodeType&&2===t.expressions.length?(m=t.expressions[0],a=t.expressions[1],p=(0,y.convertToInstance)(e.getTypeOfExpressionExpectingType(a).type)):e.addError(l.Localizer.Diagnostic.namedTupleNameType(),t):(m=t,p=u.UnknownType.create()),m&&48===m.nodeType?(g=m.strings.map((e=>e.value)).join(""),g||e.addError(l.Localizer.Diagnostic.namedTupleEmptyName(),m)):F=!0,g||(g=`_${n.toString()}`),i.has(g)&&e.addError(l.Localizer.Diagnostic.namedTupleNameUnique(),m||t),i.set(g,g),p||(p=u.UnknownType.create());const f={category:0,name:g,type:p,hasDeclaredType:s,hasDefault:n>=c};u.FunctionType.addParameter(S,f),E.push(p),x.push(g);const T=d.Symbol.createWithType(2056,p);if(m&&48===m.nodeType){const e={type:1,node:m,path:h.filePath,typeAnnotationNode:a,range:(0,r.convertOffsetsToRange)(m.start,o.TextRange.getEnd(m),h.lines),moduleName:h.moduleName,isInExceptSuite:!1};T.addDeclaration(e)}b.set(g,T)})),e.setTypeForNode(n)}else F=!0}F&&(S.details.parameters=[],u.FunctionType.addDefaultParameters(S),E.push(u.AnyType.create(!1)),E.push(u.AnyType.create(!0)));const P=u.FunctionType.createSynthesizedInstance("__init__",128);u.FunctionType.addParameter(P,D),u.FunctionType.addDefaultParameters(P),P.details.declaredReturnType=u.NoneType.createInstance(),b.set("__new__",d.Symbol.createWithType(4,S)),b.set("__init__",d.Symbol.createWithType(4,P));const A=u.FunctionType.createSynthesizedInstance("keys"),N=u.FunctionType.createSynthesizedInstance("items");A.details.declaredReturnType=e.getBuiltInObject(t,"list",[e.getBuiltInObject(t,"str")]),N.details.declaredReturnType=A.details.declaredReturnType,b.set("keys",d.Symbol.createWithType(8,A)),b.set("items",d.Symbol.createWithType(8,N));const k=u.FunctionType.createSynthesizedInstance("__len__");if(k.details.declaredReturnType=e.getBuiltInObject(t,"int"),u.FunctionType.addParameter(k,D),b.set("__len__",d.Symbol.createWithType(4,k)),F){const n=u.FunctionType.createSynthesizedInstance("__getattribute__");n.details.declaredReturnType=u.AnyType.create(),u.FunctionType.addParameter(n,D),u.FunctionType.addParameter(n,{category:0,name:"name",type:e.getBuiltInObject(t,"str")}),b.set("__getattribute__",d.Symbol.createWithType(4,n))}const w=e.getBuiltInType(t,"tuple"),M=e.getBuiltInType(t,"str");if(!F&&M&&(0,u.isInstantiableClass)(M)&&w&&(0,u.isInstantiableClass)(w)){const e=x.map((e=>({type:u.ClassType.cloneAsInstance(u.ClassType.cloneWithLiteral(M,e)),isUnbounded:!1}))),t=u.ClassType.cloneAsInstance((0,y.specializeTupleClass)(w,e));b.set("__match_args__",d.Symbol.createWithType(4,t))}return(0,y.computeMroLinearization)(I),m(I,E,!F),I},t.updateNamedTupleBaseClass=m},7848:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getParameterListDetails=t.ParameterSource=t.isTypedKwargs=void 0;const s=n(1766),i=n(1133),a=n(5168);var r;t.isTypedKwargs=function(e){return 2===e.category&&(0,i.isClassInstance)(e.type)&&(0,i.isUnpackedClass)(e.type)&&i.ClassType.isTypedDictClass(e.type)&&!!e.type.details.typedDictEntries},function(e){e[e.PositionOnly=0]="PositionOnly",e[e.PositionOrKeyword=1]="PositionOrKeyword",e[e.KeywordOnly=2]="KeywordOnly"}(r=t.ParameterSource||(t.ParameterSource={})),t.getParameterListDetails=function(e){const t={firstPositionOrKeywordIndex:0,positionParamCount:0,positionOnlyParamCount:0,params:[],hasUnpackedVariadicTypeVar:!1,hasUnpackedTypedDict:!1};let n=e.details.parameters.findIndex((e=>0===e.category&&!e.name));if(n<0)for(let t=0;t<e.details.parameters.length;t++){const i=e.details.parameters[t];if(0!==i.category)break;if(!i.name)break;if((0,s.isDunderName)(i.name)||!i.name.startsWith("__"))break;n=t+1}n>=0&&(t.firstPositionOrKeywordIndex=n);for(let s=0;s<n&&!e.details.parameters[s].hasDefault;s++)t.positionOnlyParamCount++;let o=!1;const l=(s,a,l,c,p)=>{if(s.name){let d;d=void 0!==p?p:1===s.category?r.PositionOnly:o?r.KeywordOnly:n>=0&&a<n?r.PositionOnly:r.PositionOrKeyword,t.params.push({param:s,index:a,type:null!=l?l:i.FunctionType.getEffectiveParameterType(e,a),defaultArgType:c,source:d})}};return e.details.parameters.forEach(((s,c)=>{var p,d;if(1===s.category){const a=i.FunctionType.getEffectiveParameterType(e,c);if(s.name&&(0,i.isUnpackedClass)(a)&&a.tupleTypeArguments){const e=c<t.positionOnlyParamCount;a.tupleTypeArguments.forEach(((n,a)=>{const o=(0,i.isVariadicTypeVar)(n.type)||n.isUnbounded?1:0;1===o&&(t.argsIndex=t.params.length),(0,i.isVariadicTypeVar)(s.type)&&(t.hasUnpackedVariadicTypeVar=!0),l({category:o,name:`${s.name}[${a.toString()}]`,isNameSynthesized:!0,type:n.type,hasDeclaredType:!0},c,n.type,void 0,r.PositionOnly),0===o&&t.positionParamCount++,a>0&&e&&t.positionOnlyParamCount++})),!o&&(n<0||c>=n)&&(t.firstKeywordOnlyIndex=t.params.length,o=!0)}else s.name&&void 0===t.argsIndex&&(t.argsIndex=t.params.length,(0,i.isVariadicTypeVar)(s.type)&&(t.hasUnpackedVariadicTypeVar=!0)),!o&&(n<0||c>=n)&&(t.firstKeywordOnlyIndex=t.params.length,s.name&&t.firstKeywordOnlyIndex++,o=!0),l(s,c)}else if(2===s.category){o=!0;const n=i.FunctionType.getEffectiveParameterType(e,c);if((0,i.isClassInstance)(n)&&(0,i.isUnpackedClass)(n)&&n.details.typedDictEntries){void 0===t.firstKeywordOnlyIndex&&(t.firstKeywordOnlyIndex=t.params.length);const e=n;n.details.typedDictEntries.forEach(((t,n)=>{const s=(0,a.partiallySpecializeType)(t.valueType,e);l({category:0,name:n,type:s,hasDeclaredType:!0,hasDefault:!t.isRequired},c,s)})),t.hasUnpackedTypedDict=!0}else s.name&&(void 0===t.kwargsIndex&&(t.kwargsIndex=t.params.length),void 0===t.firstKeywordOnlyIndex&&(t.firstKeywordOnlyIndex=t.params.length),l(s,c))}else 0===s.category&&(s.name&&!o&&t.positionParamCount++,l(s,c,void 0,(null===(p=e.specializedTypes)||void 0===p?void 0:p.parameterDefaultArgs)?null===(d=e.specializedTypes)||void 0===d?void 0:d.parameterDefaultArgs[c]:void 0))})),t}},1012:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ParentDirectoryCache=void 0;const s=n(9489),i=n(6657);t.ParentDirectoryCache=class{constructor(e){this._importRootGetter=e,this._importChecked=new Map,this._cachedResults=new Map,this._libPathCache=void 0}getImportResult(e,t,n){var s,i,a,r;const o=null===(s=this._cachedResults.get(t))||void 0===s?void 0:s.get(e);if(o)return null!=o?o:n;const l=null===(i=this._importChecked.get(t))||void 0===i?void 0:i.get(e);return l?l.importPath&&null!==(r=null===(a=this._cachedResults.get(t))||void 0===a?void 0:a.get(l.importPath))&&void 0!==r?r:n:void 0}checkValidPath(e,t,n){var s;return!!t.startsWith(n)&&(this._libPathCache=null!==(s=this._libPathCache)&&void 0!==s?s:this._importRootGetter().map((t=>(0,i.ensureTrailingDirectorySeparator)((0,i.normalizePathCase)(e,(0,i.normalizePath)(t))))).filter((e=>e!==n)).filter((e=>e.startsWith(n))),!this._libPathCache.some((e=>t.startsWith(e))))}checked(e,t,n){(0,s.getOrAdd)(this._importChecked,t,(()=>new Map)).set(e,n)}add(e){(0,s.getOrAdd)(this._cachedResults,e.importName,(()=>new Map)).set(e.path,e.importResult)}reset(){this._importChecked.clear(),this._cachedResults.clear(),this._libPathCache=void 0}}},4482:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ParseTreeCleanerWalker=void 0;const r=a(n(563)),o=n(427);class l extends o.ParseTreeWalker{constructor(e){super(),this._parseTree=e}clean(){this.walk(this._parseTree)}visitNode(e){return r.cleanNodeAnalysisInfo(e),super.visitNode(e)}}t.ParseTreeCleanerWalker=l},8494:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getTokenAtIndex=t.isWhitespace=t.getTokenAtLeft=t.getTokenIndexAtLeft=t.getCallNodeAndActiveParameterIndex=t.getEnclosingParameter=t.CallNodeWalker=t.NameNodeWalker=t.isAssignmentToDefaultsFollowingNamedTuple=t.isDocString=t.getDocString=t.isWithinAssertExpression=t.isWithinTryBlock=t.isWithinLoop=t.isWithinAnnotationComment=t.isWithinTypeAnnotation=t.isWithinDefaultParamInitializer=t.isPartialMatchingExpression=t.isMatchingExpression=t.isSuiteEmpty=t.isNodeContainedWithinNodeType=t.getParentAnnotationNode=t.getParentNodeOfType=t.isNodeContainedWithin=t.isRequiredAllowedForAssignmentTarget=t.isClassVarAllowedForAssignmentTarget=t.isFinalAllowedForAssignmentTarget=t.getTypeAnnotationNode=t.getExecutionScopeNode=t.getTypeVarScopeNode=t.getEvaluationScopeNode=t.getEvaluationNodeForAssignmentExpression=t.getEnclosingSuiteOrModule=t.getEnclosingClassOrFunction=t.getEnclosingLambda=t.getEnclosingFunction=t.getEnclosingClassOrModule=t.getEnclosingModule=t.getEnclosingClass=t.getEnclosingSuite=t.getCallForName=t.printOperator=t.printExpression=t.printArgument=t.getTypeSourceId=t.getClassFullName=t.isCompliantWithNodeRangeRules=t.findNodeByOffset=t.findNodeByPosition=t.getNodeDepth=void 0,t.getVariableDocStringNode=t.operatorSupportsChaining=t.isValidLocationForFutureImport=t.isUnannotatedFunction=t.isBlankLine=t.getFullStatementRange=t.getStringValueRange=t.getStringNodeValueRange=t.isLastNameOfDottedName=t.isFirstNameOfDottedName=t.getFirstNameOfDottedName=t.getDottedName=t.getDecoratorName=t.getDottedNameWithGivenNodeAsLastName=t.getFirstAncestorOrSelf=t.getFirstAncestorOrSelfOfKind=t.isLastNameOfModuleName=t.isFromImportAlias=t.isFromImportName=t.isFromImportModuleName=t.isImportAlias=t.isImportModuleName=t.getTypeAnnotationForParameter=t.isFunctionSuiteEmpty=t.getFileInfoFromNode=t.getModuleNode=t.isWriteAccess=t.printParseNodeType=t.getTokenOverlapping=t.getTokenAt=void 0;const r=a(n(563)),o=n(2489),l=n(5839),c=n(1464),p=n(3550),d=n(3420),u=n(5275),y=a(n(5136)),m=n(563),g=n(427);function h(e,t){if(t<e.start||t>p.TextRange.getEnd(e))return;let n=(0,g.getChildNodes)(e);if(f(e)&&n.length>20){const e=(0,d.getIndexContaining)(n,t);e>=0&&(n=[n[e]])}for(const s of n){if(!s)continue;const n=h(s,t);if(n)return 5===e.nodeType&&n===e.leftExpression?e.destExpression:n}return e}function f(e){return 3!==e.nodeType&&48!==e.nodeType}function T(e,t){let n="";return 1===e.argumentCategory?n="*":2===e.argumentCategory&&(n="**"),e.name&&(n+=e.name.value+"="),n+=v(e.valueExpression,t),n}function v(e,t=0){switch(e.nodeType){case 38:return e.value;case 35:return v(e.leftExpression,t)+"."+e.memberName.value;case 9:return v(e.leftExpression,t)+"("+e.arguments.map((e=>T(e,t))).join(", ")+")";case 24:return v(e.baseExpression,t)+"["+e.items.map((e=>T(e,t))).join(", ")+(e.trailingComma?",":"")+"]";case 55:return _(e.operator)+v(e.expression,t);case 7:{const n=v(e.leftExpression,t)+" "+_(e.operator)+" "+v(e.rightExpression,t);return e.parenthesized?`(${n})`:n}case 40:{let t=e.value.toString();return t.endsWith("n")&&(t=t.substring(0,t.length-1)),e.isImaginary&&(t+="j"),t}case 48:return 1&t&&e.typeAnnotation?v(e.typeAnnotation,t):e.strings.map((e=>v(e,t))).join(" ");case 49:{let n="";8&e.token.flags&&(n+="r"),16&e.token.flags&&(n+="u"),32&e.token.flags&&(n+="b"),64&e.token.flags&&(n+="f");let s=e.token.escapedValue;if(0==(2&t)){const e=32;s=s.substring(0,e)}return 4&e.token.flags?1&e.token.flags?n+=`'''${s}'''`:n+=`"""${s}"""`:1&e.token.flags?n+=`'${s}'`:n+=`"${s}"`,n}case 3:return v(e.leftExpression,t)+" = "+v(e.rightExpression,t);case 4:return v(e.name,t)+" := "+v(e.rightExpression,t);case 54:return v(e.valueExpression,t)+": "+v(e.typeAnnotation,t);case 5:return v(e.leftExpression,t)+" "+_(e.operator)+" "+v(e.rightExpression,t);case 6:return"await "+v(e.expression,t);case 51:return v(e.ifExpression,t)+" if "+v(e.testExpression,t)+" else "+v(e.elseExpression,t);case 31:return`[${e.entries.map((e=>v(e,t))).join(", ")}]`;case 56:return"*"+v(e.expression,t);case 52:{const n=e.expressions.map((e=>v(e,t)));return 1===n.length?`(${n[0]}, )`:`(${n.join(", ")})`}case 60:return e.expression?"yield "+v(e.expression,t):"yield";case 61:return"yield from "+v(e.expression,t);case 18:return"...";case 32:{let n="<ListExpression>";return(0,u.isExpressionNode)(e.expression)?n=v(e.expression,t):17===e.expression.nodeType&&(n=`${v(e.expression.keyExpression,t)}: ${v(e.expression.valueExpression,t)}`),n=n+" "+e.forIfNodes.map((e=>33===e.nodeType?(e.isAsync?"async ":"")+"for "+v(e.targetExpression,t)+` in ${v(e.iterableExpression,t)}`:`if ${v(e.testExpression,t)}`)).join(" "),e.isParenthesized?`(${n}})`:n}case 46:{let n="";return e.startValue||e.endValue||e.stepValue?(e.startValue&&(n+=v(e.startValue,t)),e.endValue&&(n+=": "+v(e.endValue,t)),e.stepValue&&(n+=": "+v(e.stepValue,t))):n+=":",n}case 30:return"lambda "+e.parameters.map((e=>{let n="";return 1===e.category?n+="*":2===e.category&&(n+="**"),e.name?n+=e.name.value:0===e.category&&(n+="/"),e.defaultValue&&(n+=" = "+v(e.defaultValue,t)),n})).join(", ")+": "+v(e.expression,t);case 11:if(33===e.constType)return"True";if(15===e.constType)return"False";if(9===e.constType)return"__debug__";if(26===e.constType)return"None";break;case 15:{const n=`${e.entries.map((e=>17===e.nodeType?`${v(e.keyExpression,t)}: ${v(e.valueExpression,t)}`:16===e.nodeType?`**${v(e.expandExpression,t)}`:v(e,t)))}`;return n?`{ ${n} }`:"{}"}case 45:return e.entries.map((e=>v(e,t))).join(", ")}return"<Expression>"}function _(e){const t={0:"+",1:"+=",2:"=",3:"&",4:"&=",5:"~",6:"|",7:"|=",8:"^",9:"^=",10:"/",11:"/=",12:"==",13:"//",14:"//=",15:">",16:">=",17:"<<",18:"<<=",19:"<>",20:"<",21:"<=",22:"@",23:"@=",24:"%",25:"%=",26:"*",27:"*=",28:"!=",29:"**",30:"**=",31:">>",32:">>=",33:"-",34:"-=",36:"and",37:"or",38:"not",39:"is",40:"is not",41:"in",42:"not in"};return t[e]?t[e]:"unknown"}function I(e,t=!1){let n=e.parent;for(;n;){if(10===n.nodeType)return n;if(36===n.nodeType)return;if(28===n.nodeType&&t)return;n=n.parent}}function b(e){let t,n=e.parent;for(;n;){if(28===n.nodeType&&!n.decorators.some((e=>e===t)))return n;if(10===n.nodeType)return;t=n,n=n.parent}}function C(e){let t,n,s=e,i=!1;for(;s;){switch(41===s.nodeType&&t===s.name&&(i=!0),s.nodeType){case 28:if(s.parameters.some((e=>e===t))){if(i&&void 0!==(0,m.getScope)(s))return s}else if(t===s.suite&&void 0!==(0,m.getScope)(s))return s;break;case 30:if(s.parameters.some((e=>e===t))){if(i&&void 0!==(0,m.getScope)(s))return s}else if((!t||t===s.expression)&&void 0!==(0,m.getScope)(s))return s;break;case 10:if(t===s.suite&&void 0!==(0,m.getScope)(s))return s;break;case 32:if(void 0!==(0,m.getScope)(s)&&(t!==s.forIfNodes[0]||33!==s.forIfNodes[0].nodeType||s.forIfNodes[0].iterableExpression!==n))return s;break;case 36:if(void 0!==(0,m.getScope)(s))return s}n=t,t=s,s=s.parent}(0,l.fail)("Did not find evaluation scope")}function S(e,t){let n=e;for(;n;){if(n.nodeType===t)return n;n=n.parent}}function x(e,t){if(38===e.nodeType)return 38===t.nodeType?e.value===t.value:4===t.nodeType&&e.value===t.name.value;if(35===e.nodeType&&35===t.nodeType)return x(e.leftExpression,t.leftExpression)&&e.memberName.value===t.memberName.value;if(24===e.nodeType&&24===t.nodeType){if(!x(e.baseExpression,t.baseExpression))return!1;if(1!==t.items.length||t.trailingComma||t.items[0].name||0!==t.items[0].argumentCategory)return!1;const n=e.items[0].valueExpression;if(40===n.nodeType){const e=t.items[0].valueExpression;return!(40!==e.nodeType||e.isImaginary||!e.isInteger)&&n.value===e.value}if(55===n.nodeType&&33===n.operator&&40===n.expression.nodeType){const e=t.items[0].valueExpression;return!(55!==e.nodeType||33!==e.operator||40!==e.expression.nodeType||e.expression.isImaginary||!e.expression.isInteger)&&n.expression.value===e.expression.value}if(48===n.nodeType){const e=n,s=t.items[0].valueExpression;if(1===e.strings.length&&49===e.strings[0].nodeType&&48===s.nodeType&&1===s.strings.length&&49===s.strings[0].nodeType)return e.strings[0].value===s.strings[0].value}return!1}return!1}function D(e){if(0===e.statements.length||48!==e.statements[0].nodeType)return!1;const t=e.statements[0].strings;return 0!==t.length&&!t.some((e=>0!=(64&e.token.flags)))}t.getNodeDepth=function(e){let t=0,n=e;for(;n;)t++,n=n.parent;return t},t.findNodeByPosition=function(e,t,n){const s=(0,c.convertPositionToOffset)(t,n);if(void 0!==s)return h(e,s)},t.findNodeByOffset=h,t.isCompliantWithNodeRangeRules=f,t.getClassFullName=function(e,t,n){const s=[n];let i=e;for(;i;)i=I(i),i&&s.push(i.name.value);return s.push(t),s.reverse().join(".")},t.getTypeSourceId=function(e){return e.start},t.printArgument=T,t.printExpression=v,t.printOperator=_,t.getCallForName=function(e){var t,n,s;return 9===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&e.parent.leftExpression===e?e.parent:35===(null===(n=e.parent)||void 0===n?void 0:n.nodeType)&&e.parent.memberName===e&&9===(null===(s=e.parent.parent)||void 0===s?void 0:s.nodeType)&&e.parent.parent.leftExpression===e.parent?e.parent.parent:void 0},t.getEnclosingSuite=function(e){let t=e.parent;for(;t;){if(50===t.nodeType)return t;t=t.parent}},t.getEnclosingClass=I,t.getEnclosingModule=function(e){let t=e.parent;for(;t;){if(36===t.nodeType)return t;t=t.parent}(0,l.fail)("Module node not found")},t.getEnclosingClassOrModule=function(e,t=!1){let n=e.parent;for(;n;){if(10===n.nodeType)return n;if(36===n.nodeType)return n;if(28===n.nodeType&&t)return;n=n.parent}},t.getEnclosingFunction=b,t.getEnclosingLambda=function(e){let t=e.parent;for(;t;){if(30===t.nodeType)return t;if(50===t.nodeType)return;t=t.parent}},t.getEnclosingClassOrFunction=function(e){let t=e.parent;for(;t;){if(28===t.nodeType)return t;if(10===t.nodeType)return t;t=t.parent}},t.getEnclosingSuiteOrModule=function(e,t=!1,n=!0){let s=e.parent;for(;s;){if(50===s.nodeType)return s;if(36===s.nodeType)return s;if(30===s.nodeType&&n)return;if(28===s.nodeType&&t)return;s=s.parent}},t.getEvaluationNodeForAssignmentExpression=function(e){let t=!1,n=C(e);for(;void 0!==n;)switch(n.nodeType){case 28:case 30:case 36:return n;case 10:return t?void 0:n;case 32:t=!0,n=C(n.parent);break;default:return}},t.getEvaluationScopeNode=C,t.getTypeVarScopeNode=function(e){let t,n=e;for(;n;){switch(n.nodeType){case 28:case 10:if(!n.decorators.some((e=>e===t)))return n;break;case 77:return n}t=n,n=n.parent}},t.getExecutionScopeNode=function(e){let t=C(e);for(;10===t.nodeType||32===t.nodeType;)t=C(t.parent);return t},t.getTypeAnnotationNode=function(e){let t=e,n=e.parent;for(;n;){if(54===n.nodeType){if(n.typeAnnotation===t)return n;break}t=n,n=n.parent}},t.isFinalAllowedForAssignmentTarget=function(e){if(38===e.nodeType)return!0;if(35===e.nodeType){if(38!==e.leftExpression.nodeType)return!1;if(!I(e))return!1;const t=b(e);return!!t&&"__init__"===t.name.value}return!1},t.isClassVarAllowedForAssignmentTarget=function(e){return!!I(e,!0)},t.isRequiredAllowedForAssignmentTarget=function(e){return!!I(e,!0)},t.isNodeContainedWithin=function(e,t){let n=e;for(;n;){if(n===t)return!0;n=n.parent}return!1},t.getParentNodeOfType=S,t.getParentAnnotationNode=function(e){let t,n=e;for(;n;){if(28===n.nodeType)return t===n.returnTypeAnnotation?t:void 0;if(41===n.nodeType)return t===n.typeAnnotation||t===n.typeAnnotationComment?t:void 0;if(3===n.nodeType)return t===n.typeAnnotationComment?t:void 0;if(54===n.nodeType)return t===n.typeAnnotation?t:void 0;if(62===n.nodeType)return t===n.returnTypeAnnotation||n.paramTypeAnnotations.some((e=>e===t))?((0,l.assert)(!t||(0,u.isExpressionNode)(t)),t):void 0;t=n,n=n.parent}},t.isNodeContainedWithinNodeType=function(e,t){return void 0!==S(e,t)},t.isSuiteEmpty=function(e){let t=!1;for(const n of e.statements){if(47!==n.nodeType)return!1;for(const e of n.statements)if(18===e.nodeType)t=!0;else if(48!==e.nodeType)return!1}return t},t.isMatchingExpression=x,t.isPartialMatchingExpression=function e(t,n){return 35===t.nodeType?x(t.leftExpression,n)||e(t.leftExpression,n):24===t.nodeType&&(x(t.baseExpression,n)||e(t.baseExpression,n))},t.isWithinDefaultParamInitializer=function(e){let t,n=e;for(;n;){if(41===n.nodeType&&t===n.defaultValue)return!0;if(30===n.nodeType||28===n.nodeType||10===n.nodeType||36===n.nodeType)return!1;t=n,n=n.parent}return!1},t.isWithinTypeAnnotation=function(e,t){let n,s=e,i=!1;for(;s;){if(41===s.nodeType&&(n===s.typeAnnotation||n===s.typeAnnotationComment))return i||!t;if(28===s.nodeType&&n===s.returnTypeAnnotation)return i||!t;if(28===s.nodeType&&n===s.functionAnnotationComment)return!0;if(54===s.nodeType&&n===s.typeAnnotation)return i||!t;if(3===s.nodeType&&n===s.typeAnnotationComment)return!0;if(48===s.nodeType&&n===s.typeAnnotation&&(i=!0),30===s.nodeType||28===s.nodeType||10===s.nodeType||36===s.nodeType)return!1;n=s,s=s.parent}return!1},t.isWithinAnnotationComment=function(e){let t,n=e;for(;n;){if(28===n.nodeType&&t===n.functionAnnotationComment)return!0;if(3===n.nodeType&&t===n.typeAnnotationComment)return!0;if(30===n.nodeType||28===n.nodeType||10===n.nodeType||36===n.nodeType)return!1;t=n,n=n.parent}return!1},t.isWithinLoop=function(e){let t=e;for(;t;){switch(t.nodeType){case 26:case 57:return!0}t=t.parent}return!1},t.isWithinTryBlock=function(e,t=!1){let n,s=e;for(;s;){switch(s.nodeType){case 53:return s.trySuite===n;case 58:if(t&&s.suite===n)return!0;break;case 28:case 36:case 10:return!1}n=s,s=s.parent}return!1},t.isWithinAssertExpression=function(e){let t,n=e;for(;n;){if(2===n.nodeType)return n.testExpression===t;t=n,n=n.parent}return!1},t.getDocString=function(e){if(0===e.length)return;if(47!==e[0].nodeType)return;if(!D(e[0]))return;const t=e[0].statements[0].strings;return 1===t.length?t[0].value:t.map((e=>e.value)).join("")},t.isDocString=D,t.isAssignmentToDefaultsFollowingNamedTuple=function(e){var t,n;if(9!==e.nodeType||!e.parent||3!==e.parent.nodeType||38!==e.parent.leftExpression.nodeType||!e.parent.parent||47!==e.parent.parent.nodeType)return!1;const s=e.parent.leftExpression.value,i=e.parent.parent;if(i.statements[0]!==e.parent||!i.parent||36!==i.parent.nodeType&&50!==i.parent.nodeType)return!1;const a=i.parent;let r=a.statements.findIndex((e=>e===i));if(r<0)return!1;for(r++;r<a.statements.length;){const e=a.statements[r];if(47!==e.nodeType)break;if(48!==(null===(t=e.statements[0])||void 0===t?void 0:t.nodeType)){if(3===(null===(n=e.statements[0])||void 0===n?void 0:n.nodeType)){const t=e.statements[0];if(35===t.leftExpression.nodeType&&"__defaults__"===t.leftExpression.memberName.value){const e=t.leftExpression.leftExpression;if(35===e.nodeType&&"__new__"===e.memberName.value&&38===e.leftExpression.nodeType&&e.leftExpression.value===s)return!0}}break}r++}return!1};class F extends g.ParseTreeWalker{constructor(e){super(),this._callback=e}visitName(e){return this._callback(e,this._subscriptIndex,this._baseExpression),!0}visitIndex(e){this.walk(e.baseExpression);const t=this._subscriptIndex,n=this._baseExpression;return this._baseExpression=e.baseExpression,e.items.forEach(((e,t)=>{this._subscriptIndex=t,this.walk(e)})),this._subscriptIndex=t,this._baseExpression=n,!1}}t.NameNodeWalker=F;class E extends g.ParseTreeWalker{constructor(e){super(),this._callback=e}visitCall(e){return this._callback(e),!0}}function P(e,t,n=!1,s=!1){const i=e.getItemAtPosition(t);if(i<0)return-1;for(let a=i;a>=0;a--){const i=e.getItemAt(a);if((s||0!==i.length)&&(n||!A(i))&&p.TextRange.getEnd(i)<=t)return a}return-1}function A(e){return 2===e.type||3===e.type||4===e.type}function N(e,t){if(!(t<0))return e.getItemAt(t)}function k(e,t){return N(e,e.getItemAtPosition(t))}function w(e){let t=e;for(;t&&36!==t.nodeType;)t=t.parent;return t}function M(e,t){return R(e,(e=>e.nodeType===t))}function R(e,t){for(const n of function*(e){for(;void 0!==e;)yield e,e=e.parent}(e))if(t(n))return n}function O(e){if(38===e.nodeType)return[e];const t=[];return function e(t,n){return 38===t.nodeType?(n.push(t),!0):(n.push(t.memberName),(38===t.leftExpression.nodeType||35===t.leftExpression.nodeType)&&e(t.leftExpression,n))}(e,t)?t.reverse():void 0}function L(e){const t=e.quoteMarkLength,n=!(65536&e.flags);return p.TextRange.create(e.start+t,e.length-t-(n?t:0))}function V(e,t){const n=e.tokenizerOutput.lines.getItemAt(t);return(0,o.containsOnlyWhitespace)(e.text,n)}t.CallNodeWalker=E,t.getEnclosingParameter=function(e){let t=e;for(;t;){if(41===t.nodeType)return t;t=t.parent}},t.getCallNodeAndActiveParameterIndex=function(e,t,n){let s,i=e;for(;void 0!==i;){if(9===i.nodeType&&d(n,i,t)){s=i;break}i=i.parent}if(!s||!s.arguments)return;const a=p.TextRange.getEnd(s);if(t>a)return;const r=k(n,a-1);if(t===a&&14===(null==r?void 0:r.type))return;let o=!1,l=-1,c=!1;return s.arguments.forEach(((e,s)=>{if(o)return;let i=e.start;const a=n.getItemAtPosition(i);a>=0&&(i=p.TextRange.getEnd(n.getItemAt(a-1)));let r=p.TextRange.getEnd(e);const d=n.getItemAtPosition(r);if(d>=0)for(let e=d;e<n.count;e++){const t=n.getItemAt(e);switch(t.type){case 12:case 14:break;default:continue}r=p.TextRange.getEnd(t);break}t<r&&(l=s,c=t>=i,o=!0)})),o||(l=s.arguments.length+1),{callNode:s,activeIndex:l,activeOrFake:c};function d(e,t,n){const s=t.leftExpression.length>0?p.TextRange.getEnd(t.leftExpression)-1:t.leftExpression.start,i=p.TextRange.getEnd(t);if(n<s||i<n)return!1;if(t.arguments.length>0){const e=t.arguments[0].start,s=p.TextRange.getEnd(t.arguments[t.arguments.length-1]);if(e<=n&&n<s)return!0}const a=e.getItemAtPosition(s);if(a<0||e.count<=a)return!0;const r=e.getItemAt(a);if(5===r.type&&64&r.flags&&p.TextRange.contains(r,n)){const e=r,t=y.getUnescapedString(e),s=n-e.start-e.prefixLength-e.quoteMarkLength,a=t.formatStringSegments.find((e=>e.offset<=s&&s<e.offset+e.length));if(!a||!a.isExpression)return!0;const o=Math.min(a.length,i-e.start-e.prefixLength-e.quoteMarkLength-a.offset);for(let e=s-a.offset;e<o;e++)if("("===a.value[e])return!1;return!0}const o=e.getItemAt(a+1);return!(13===o.type&&n<p.TextRange.getEnd(o))}},t.getTokenIndexAtLeft=P,t.getTokenAtLeft=function(e,t,n=!1,s=!1){const i=P(e,t,n,s);if(!(i<0))return e.getItemAt(i)},t.isWhitespace=A,t.getTokenAtIndex=N,t.getTokenAt=k,t.getTokenOverlapping=function(e,t){const n=e.getItemAtPosition(t);if(n<0)return;const s=e.getItemAt(n);return p.TextRange.overlaps(s,t)?s:void 0},t.printParseNodeType=function(e){switch(e){case 0:return"Error";case 1:return"Argument";case 2:return"Assert";case 3:return"Assignment";case 4:return"AssignmentExpression";case 5:return"AugmentedAssignment";case 6:return"Await";case 7:return"BinaryOperation";case 8:return"Break";case 9:return"Call";case 10:return"Class";case 11:return"Constant";case 12:return"Continue";case 13:return"Decorator";case 14:return"Del";case 15:return"Dictionary";case 16:return"DictionaryExpandEntry";case 17:return"DictionaryKeyEntry";case 18:return"Ellipsis";case 19:return"If";case 20:return"Import";case 21:return"ImportAs";case 22:return"ImportFrom";case 23:return"ImportFromAs";case 24:return"Index";case 25:return"Except";case 26:return"For";case 27:return"FormatString";case 28:return"Function";case 29:return"Global";case 30:return"Lambda";case 31:return"List";case 32:return"ListComprehension";case 33:return"ListComprehensionFor";case 34:return"ListComprehensionIf";case 35:return"MemberAccess";case 36:return"Module";case 37:return"ModuleName";case 38:return"Name";case 39:return"Nonlocal";case 40:return"Number";case 41:return"Parameter";case 42:return"Pass";case 43:return"Raise";case 44:return"Return";case 45:return"Set";case 46:return"Slice";case 47:return"StatementList";case 48:return"StringList";case 49:return"String";case 50:return"Suite";case 51:return"Ternary";case 52:return"Tuple";case 53:return"Try";case 54:return"TypeAnnotation";case 55:return"UnaryOperation";case 56:return"Unpack";case 57:return"While";case 58:return"With";case 59:return"WithItem";case 60:return"Yield";case 61:return"YieldFrom";case 62:return"FunctionAnnotation";case 63:return"Match";case 64:return"Case";case 65:return"PatternSequence";case 66:return"PatternAs";case 67:return"PatternLiteral";case 68:return"PatternClass";case 69:return"PatternCapture";case 70:return"PatternMapping";case 71:return"PatternMappingKeyEntry";case 72:return"PatternMappingExpandEntry";case 73:return"PatternValue";case 74:return"PatternClassArgument";case 75:return"TypeParameter";case 76:return"TypeParameterList";case 77:return"TypeAlias"}(0,l.assertNever)(e)},t.isWriteAccess=function(e){let t=e,n=t.parent;for(;n;){switch(n.nodeType){case 3:case 5:return t===n.leftExpression;case 4:case 25:return t===n.name;case 14:return!0;case 26:case 33:return t===n.targetExpression;case 21:return t===n.alias||n.module.nameParts.length>0&&t===n.module.nameParts[0];case 23:return t===n.alias||!n.alias&&t===n.name;case 35:if(t!==n.memberName)return!1;break;case 58:return n.withItems.some((e=>e===t));case 54:if(t===n.typeAnnotation)return!1;break;case 28:case 10:case 36:return!1}t=n,n=n.parent}return!1},t.getModuleNode=w,t.getFileInfoFromNode=function(e){const t=w(e);return t?r.getFileInfo(t):void 0},t.isFunctionSuiteEmpty=function(e){let t=!0;return e.suite.statements.forEach((e=>{0!==e.nodeType&&(47===e.nodeType?e.statements.forEach((e=>{18!==e.nodeType&&48!==e.nodeType&&42!==e.nodeType&&(t=!1)})):t=!1)})),t},t.getTypeAnnotationForParameter=function(e,t){if(t>=e.parameters.length)return;const n=e.parameters[t];if(n.typeAnnotation)return n.typeAnnotation;if(n.typeAnnotationComment)return n.typeAnnotationComment;if(!e.functionAnnotationComment||e.functionAnnotationComment.isParamListEllipsis)return;let s=0;const i=e.functionAnnotationComment.paramTypeAnnotations;i.length<e.parameters.length&&(s=1);const a=t-s;return a<0||a>=i.length?void 0:i[a]},t.isImportModuleName=function(e){var t,n;return 21===(null===(n=null===(t=M(e,37))||void 0===t?void 0:t.parent)||void 0===n?void 0:n.nodeType)},t.isImportAlias=function(e){var t;return 21===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&e.parent.alias===e},t.isFromImportModuleName=function(e){var t,n;return 22===(null===(n=null===(t=M(e,37))||void 0===t?void 0:t.parent)||void 0===n?void 0:n.nodeType)},t.isFromImportName=function(e){var t;return 23===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&e.parent.name===e},t.isFromImportAlias=function(e){var t;return 23===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&e.parent.alias===e},t.isLastNameOfModuleName=function(e){var t;if(37!==(null===(t=e.parent)||void 0===t?void 0:t.nodeType))return!1;const n=e.parent;return 0!==n.nameParts.length&&n.nameParts[n.nameParts.length-1]===e},t.getFirstAncestorOrSelfOfKind=M,t.getFirstAncestorOrSelf=R,t.getDottedNameWithGivenNodeAsLastName=function(e){var t;return 35!==(null===(t=e.parent)||void 0===t?void 0:t.nodeType)||e.parent.leftExpression===e?e:e.parent},t.getDecoratorName=function(e){return function e(t){var n;return 38===t.nodeType||35===t.nodeType?null===(n=O(t))||void 0===n?void 0:n.map((e=>e.value)).join("."):9===t.nodeType?e(t.leftExpression):void 0}(e.expression)},t.getDottedName=O,t.getFirstNameOfDottedName=function e(t){return 38===t.nodeType?t:38===t.leftExpression.nodeType||35===t.leftExpression.nodeType?e(t.leftExpression):void 0},t.isFirstNameOfDottedName=function(e){var t;return 35!==(null===(t=e.parent)||void 0===t?void 0:t.nodeType)||e.parent.leftExpression===e},t.isLastNameOfDottedName=function(e){var t,n;return 35!==(null===(t=e.parent)||void 0===t?void 0:t.nodeType)||(38===e.parent.leftExpression.nodeType||35===e.parent.leftExpression.nodeType)&&e.parent.leftExpression!==e&&35!==(null===(n=e.parent.parent)||void 0===n?void 0:n.nodeType)},t.getStringNodeValueRange=function(e){return L(e.token)},t.getStringValueRange=L,t.getFullStatementRange=function(e,t,n){var s;const i=t.tokenizerOutput,a=(0,c.convertTextRangeToRange)(e,i.lines),r=null!==(s=function(e,t,n){const s=n.tokens.getItemAtPosition(t);if(s<0)return;let i=s;for(;i>0;i--){const t=n.tokens.getItemAt(i);if((0,c.convertTextRangeToRange)(t,n.lines).end.line!==e.start.line)break}for(let t=s-1;t>i;t--){const s=n.tokens.getItemAt(t);if(3!==s.type&&4!==s.type){if(2===s.type)return;return e.start}}}(a,e.start,i))&&void 0!==s?s:{line:a.start.line,character:0},o=function(e,t,n){const s=n.tokens.getItemAtPosition(t);if(s<0)return;let i=s;for(;i<n.tokens.count;i++){const t=n.tokens.getItemAt(i),s=(0,c.convertTextRangeToRange)(t,n.lines);if(e.end.line!==s.start.line)break}let a=!1;for(let e=s;e<i;e++){const t=n.tokens.getItemAt(e);if(11!==t.type&&2!==t.type){if(a)return(0,c.convertTextRangeToRange)(t,n.lines).start}else a=!0}}(a,p.TextRange.getEnd(e),i);if(o)return{start:r,end:o};if(a.end.line===i.lines.count-1)return{start:r,end:a.end};let l=1;if(n&&n.includeTrailingBlankLines)for(let e=l;a.end.line+e<i.lines.count;e++)if(!V(t,a.end.line+e)){l=e;break}return{start:r,end:{line:a.end.line+l,character:0}}},t.isBlankLine=V,t.isUnannotatedFunction=function(e){return void 0===e.returnTypeAnnotation&&e.parameters.every((e=>void 0===e.typeAnnotation&&void 0===e.typeAnnotationComment))},t.isValidLocationForFutureImport=function(e){const t=w(e);(0,l.assert)(t);let n=!1;for(const s of t.statements){if(47!==s.nodeType)return!1;for(const t of s.statements){if(t===e)return!0;if(48===t.nodeType){if(n)return!1;n=!0}else{if(22!==t.nodeType)return!1;if(0!==t.module.leadingDots||1!==t.module.nameParts.length||"__future__"!==t.module.nameParts[0].value)return!1}}}return!1},t.operatorSupportsChaining=function(e){switch(e){case 12:case 28:case 20:case 21:case 15:case 16:case 39:case 40:case 41:case 42:return!0}return!1},t.getVariableDocStringNode=function(e){var t,n,s,i;let a,r=e;for(;r&&3!==r.nodeType;)54!==r.nodeType||a||(a=r),r=r.parent;if(3!==(null==r?void 0:r.nodeType)){if(!a)return;r=a}const o=r.parent;if(47!==(null==o?void 0:o.nodeType))return;const l=o.parent;if(!l||36!==l.nodeType&&50!==l.nodeType)return;const c=l.statements.findIndex((e=>e===o));if(c<0||c===l.statements.length-1)return;const p=l.statements[c+1];if(47!==p.nodeType||!D(p))return;let d=!1;if(36===(null===(t=null==o?void 0:o.parent)||void 0===t?void 0:t.nodeType))d=!0;else if(50===(null===(n=null==o?void 0:o.parent)||void 0===n?void 0:n.nodeType)&&10===(null===(i=null===(s=null==o?void 0:o.parent)||void 0===s?void 0:s.parent)||void 0===i?void 0:i.nodeType))d=!0;else{const e=b(o);e&&"__init__"===e.name.value&&I(e,!0)&&(d=!0)}return d?p.statements[0]:void 0}},427:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ParseTreeWalker=t.ParseTreeVisitor=t.getChildNodes=void 0;const r=a(n(5839));function o(e){var t;switch(e.nodeType){case 0:return[e.child,...null!==(t=e.decorators)&&void 0!==t?t:[]];case 1:return[e.name,e.valueExpression];case 2:return[e.testExpression,e.exceptionExpression];case 4:return[e.name,e.rightExpression];case 3:return[e.leftExpression,e.rightExpression,e.typeAnnotationComment];case 5:case 7:return[e.leftExpression,e.rightExpression];case 6:case 13:case 67:case 73:case 55:case 56:case 60:case 61:return[e.expression];case 8:case 11:case 12:case 18:case 38:case 40:case 42:case 49:return[];case 9:return[e.leftExpression,...e.arguments];case 64:return[e.pattern,e.guardExpression,e.suite];case 10:return[...e.decorators,e.name,e.typeParameters,...e.arguments,e.suite];case 14:case 27:case 52:return e.expressions;case 15:case 31:case 45:return e.entries;case 16:return[e.expandExpression];case 17:return[e.keyExpression,e.valueExpression];case 19:return[e.testExpression,e.ifSuite,e.elseSuite];case 20:return e.list;case 21:return[e.module,e.alias];case 22:return[e.module,...e.imports];case 23:return[e.name,e.alias];case 24:return[e.baseExpression,...e.items];case 25:return[e.typeExpression,e.name,e.exceptSuite];case 26:return[e.targetExpression,e.iterableExpression,e.forSuite,e.elseSuite];case 28:return[...e.decorators,e.name,e.typeParameters,...e.parameters,e.returnTypeAnnotation,e.functionAnnotationComment,e.suite];case 62:return[...e.paramTypeAnnotations,e.returnTypeAnnotation];case 29:case 39:return e.nameList;case 30:return[...e.parameters,e.expression];case 32:return[e.expression,...e.forIfNodes];case 33:return[e.targetExpression,e.iterableExpression];case 34:return[e.testExpression];case 63:return[e.subjectExpression,...e.cases];case 35:return[e.leftExpression,e.memberName];case 37:return e.nameParts;case 36:case 50:return[...e.statements];case 41:return[e.name,e.typeAnnotation,e.typeAnnotationComment,e.defaultValue];case 66:return[...e.orPatterns,e.target];case 68:return[e.className,...e.arguments];case 74:return[e.name,e.pattern];case 69:case 72:return[e.target];case 71:return[e.keyPattern,e.valuePattern];case 70:case 65:return[...e.entries];case 43:return[e.typeExpression,e.valueExpression,e.tracebackExpression];case 44:return[e.returnExpression];case 46:return[e.startValue,e.endValue,e.stepValue];case 47:return e.statements;case 48:return[e.typeAnnotation,...e.strings];case 51:return[e.ifExpression,e.testExpression,e.elseExpression];case 53:return[e.trySuite,...e.exceptClauses,e.elseSuite,e.finallySuite];case 77:return[e.name,e.typeParameters,e.expression];case 54:return[e.valueExpression,e.typeAnnotation];case 75:return[e.name,e.boundExpression,e.defaultExpression];case 76:return[...e.parameters];case 57:return[e.testExpression,e.whileSuite,e.elseSuite];case 58:return[...e.withItems,e.suite];case 59:return[e.expression,e.target];default:r.assertNever(e,`Unknown node type ${e}`)}}t.getChildNodes=o;class l{constructor(e){this._default=e}visit(e){switch(e.nodeType){case 0:return this.visitError(e);case 1:return this.visitArgument(e);case 2:return this.visitAssert(e);case 4:return this.visitAssignmentExpression(e);case 3:return this.visitAssignment(e);case 5:return this.visitAugmentedAssignment(e);case 6:return this.visitAwait(e);case 7:return this.visitBinaryOperation(e);case 8:return this.visitBreak(e);case 9:return this.visitCall(e);case 64:return this.visitCase(e);case 10:return this.visitClass(e);case 11:return this.visitConstant(e);case 12:return this.visitContinue(e);case 13:return this.visitDecorator(e);case 14:return this.visitDel(e);case 15:return this.visitDictionary(e);case 16:return this.visitDictionaryExpandEntry(e);case 17:return this.visitDictionaryKeyEntry(e);case 18:return this.visitEllipsis(e);case 19:return this.visitIf(e);case 20:return this.visitImport(e);case 21:return this.visitImportAs(e);case 22:return this.visitImportFrom(e);case 23:return this.visitImportFromAs(e);case 24:return this.visitIndex(e);case 25:return this.visitExcept(e);case 26:return this.visitFor(e);case 27:return this.visitFormatString(e);case 28:return this.visitFunction(e);case 62:return this.visitFunctionAnnotation(e);case 29:return this.visitGlobal(e);case 30:return this.visitLambda(e);case 31:return this.visitList(e);case 32:return this.visitListComprehension(e);case 33:return this.visitListComprehensionFor(e);case 34:return this.visitListComprehensionIf(e);case 63:return this.visitMatch(e);case 35:return this.visitMemberAccess(e);case 37:return this.visitModuleName(e);case 36:return this.visitModule(e);case 38:return this.visitName(e);case 39:return this.visitNonlocal(e);case 40:return this.visitNumber(e);case 41:return this.visitParameter(e);case 42:return this.visitPass(e);case 66:return this.visitPatternAs(e);case 68:return this.visitPatternClass(e);case 74:return this.visitPatternClassArgument(e);case 69:return this.visitPatternCapture(e);case 67:return this.visitPatternLiteral(e);case 72:return this.visitPatternMappingExpandEntry(e);case 71:return this.visitPatternMappingKeyEntry(e);case 70:return this.visitPatternMapping(e);case 65:return this.visitPatternSequence(e);case 73:return this.visitPatternValue(e);case 43:return this.visitRaise(e);case 44:return this.visitReturn(e);case 45:return this.visitSet(e);case 46:return this.visitSlice(e);case 47:return this.visitStatementList(e);case 48:return this.visitStringList(e);case 49:return this.visitString(e);case 50:return this.visitSuite(e);case 51:return this.visitTernary(e);case 52:return this.visitTuple(e);case 53:return this.visitTry(e);case 77:return this.visitTypeAlias(e);case 54:return this.visitTypeAnnotation(e);case 75:return this.visitTypeParameter(e);case 76:return this.visitTypeParameterList(e);case 55:return this.visitUnaryOperation(e);case 56:return this.visitUnpack(e);case 57:return this.visitWhile(e);case 58:return this.visitWith(e);case 59:return this.visitWithItem(e);case 60:return this.visitYield(e);case 61:return this.visitYieldFrom(e);default:r.assertNever(e,`Unknown node type ${e}`)}}visitArgument(e){return this._default}visitAssert(e){return this._default}visitAssignment(e){return this._default}visitAssignmentExpression(e){return this._default}visitAugmentedAssignment(e){return this._default}visitAwait(e){return this._default}visitBinaryOperation(e){return this._default}visitBreak(e){return this._default}visitCall(e){return this._default}visitCase(e){return this._default}visitClass(e){return this._default}visitTernary(e){return this._default}visitContinue(e){return this._default}visitConstant(e){return this._default}visitDecorator(e){return this._default}visitDel(e){return this._default}visitDictionary(e){return this._default}visitDictionaryKeyEntry(e){return this._default}visitDictionaryExpandEntry(e){return this._default}visitError(e){return this._default}visitEllipsis(e){return this._default}visitIf(e){return this._default}visitImport(e){return this._default}visitImportAs(e){return this._default}visitImportFrom(e){return this._default}visitImportFromAs(e){return this._default}visitIndex(e){return this._default}visitExcept(e){return this._default}visitFor(e){return this._default}visitFormatString(e){return this._default}visitFunction(e){return this._default}visitFunctionAnnotation(e){return this._default}visitGlobal(e){return this._default}visitLambda(e){return this._default}visitList(e){return this._default}visitListComprehension(e){return this._default}visitListComprehensionFor(e){return this._default}visitListComprehensionIf(e){return this._default}visitMatch(e){return this._default}visitMemberAccess(e){return this._default}visitModule(e){return this._default}visitModuleName(e){return this._default}visitName(e){return this._default}visitNonlocal(e){return this._default}visitNumber(e){return this._default}visitParameter(e){return this._default}visitPass(e){return this._default}visitPatternCapture(e){return this._default}visitPatternClass(e){return this._default}visitPatternClassArgument(e){return this._default}visitPatternAs(e){return this._default}visitPatternLiteral(e){return this._default}visitPatternMappingExpandEntry(e){return this._default}visitPatternSequence(e){return this._default}visitPatternValue(e){return this._default}visitPatternMappingKeyEntry(e){return this._default}visitPatternMapping(e){return this._default}visitRaise(e){return this._default}visitReturn(e){return this._default}visitSet(e){return this._default}visitSlice(e){return this._default}visitStatementList(e){return this._default}visitString(e){return this._default}visitStringList(e){return this._default}visitSuite(e){return this._default}visitTuple(e){return this._default}visitTry(e){return this._default}visitTypeAlias(e){return this._default}visitTypeAnnotation(e){return this._default}visitTypeParameter(e){return this._default}visitTypeParameterList(e){return this._default}visitUnaryOperation(e){return this._default}visitUnpack(e){return this._default}visitWhile(e){return this._default}visitWith(e){return this._default}visitWithItem(e){return this._default}visitYield(e){return this._default}visitYieldFrom(e){return this._default}}t.ParseTreeVisitor=l,t.ParseTreeWalker=class extends l{constructor(){super(!0)}walk(e){const t=this.visitNode(e);t.length>0&&this.walkMultiple(t)}walkMultiple(e){e.forEach((e=>{e&&this.walk(e)}))}visitNode(e){return this.visit(e)?o(e):[]}}},6061:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.validateClassPattern=t.assignTypeToPatternTargets=t.checkForUnusedPattern=t.narrowTypeBasedOnPattern=void 0;const s=n(9489),i=n(5839),a=n(1290),r=n(9744),o=n(9866),l=n(563),c=n(2044),p=n(9453),d=n(4610),u=n(1133),y=n(5168),m=n(4447),g=["builtins.bool","builtins.bytearray","builtins.bytes","builtins.dict","builtins.float","builtins.frozenset","builtins.int","builtins.list","builtins.set","builtins.str","builtins.tuple"];function h(e,t,n,i){switch(n.nodeType){case 65:return function(e,t,n,i){let a=I(e,t,n.entries.length,n.starEntryIndex);return a=a.filter((t=>{if(t.definiteNoMatch)return!i;let a=!0,r=!0;const o=[];let l=t.isTuple;if(t.isIndeterminateLength&&(1===n.entries.length&&0===n.starEntryIndex||(r=!1)),n.entries.forEach(((c,p)=>{const d=b(e,n,t,p,n.entries.length,n.starEntryIndex,!0,!1),m=h(e,d,c,i);i?p===n.starEntryIndex?(0,u.isClassInstance)(m)&&m.tupleTypeArguments&&!(0,y.isUnboundedTupleClass)(m)&&m.tupleTypeArguments?(0,s.appendArray)(o,m.tupleTypeArguments.map((e=>e.type))):(o.push(m),l=!1):(o.push(m),(0,u.isNever)(m)&&(a=!1)):(0,u.isNever)(m)||(r=!1)})),!i)return!r;if(a){if(l){const s=e.getBuiltInType(n,"tuple");s&&(0,u.isInstantiableClass)(s)&&(t.subtype=u.ClassType.cloneAsInstance((0,y.specializeTupleClass)(s,o.map((e=>({type:e,isUnbounded:!1}))))))}if(t.isObject){const s=e.getTypingType(n,"Sequence");s&&(0,u.isInstantiableClass)(s)&&(t.subtype=u.ClassType.cloneAsInstance(u.ClassType.cloneForSpecialization(s,[e.stripLiteralValue((0,u.combineTypes)(o))],!0)))}}return a})),(0,u.combineTypes)(a.map((e=>e.subtype)))}(e,t,n,i);case 67:return function(e,t,n,s){const i=e.getTypeOfExpression(n.expression).type;return s?(0,y.mapSubtypes)(t,(t=>e.assignType(t,i)?i:(0,u.isClassInstance)(i)&&(0,y.isLiteralType)(i)&&(0,u.isClassInstance)(t)&&!(0,y.isLiteralType)(t)&&e.assignType(u.ClassType.cloneWithLiteral(i,void 0),t)?t:void 0)):(0,y.mapSubtypes)(t,(t=>{if(!((0,u.isClassInstance)(i)&&(0,y.isLiteralType)(i)&&(0,u.isClassInstance)(t)&&(0,y.isLiteralType)(t)&&e.assignType(i,t)||(0,u.isNoneInstance)(t)&&(0,u.isNoneInstance)(i)))return(0,u.isClassInstance)(t)&&u.ClassType.isBuiltIn(t,"bool")&&void 0===t.literalValue&&(0,u.isClassInstance)(i)&&u.ClassType.isBuiltIn(i,"bool")&&void 0!==i.literalValue?u.ClassType.cloneWithLiteral(i,!i.literalValue):t}))}(e,t,n,i);case 68:return function(e,t,n,s){let i=e.getTypeOfExpression(n.className,2).type;if((0,u.isClass)(i)&&!i.typeAliasInfo&&(i=(0,y.specializeClassType)(i)),!s){if(!(0,u.isInstantiableClass)(i))return t;let a=i;a.details.typeParameters.length>0&&(a=u.ClassType.cloneForSpecialization(a,void 0,!1));const r=(0,y.convertToInstance)(a);return e.mapSubtypesExpandTypeVars(t,void 0,((t,i)=>{if(!(0,u.isNoneInstance)(t)&&!(0,u.isClassInstance)(t))return i;if((0,u.isNoneInstance)(t)&&(0,u.isInstantiableClass)(a)&&u.ClassType.isBuiltIn(a,"NoneType"))return;if(!e.assignType(r,t))return t;if(0===n.arguments.length){if((0,u.isClass)(r)&&(0,u.isClass)(t)&&u.ClassType.isSameGenericClass(r,t))return;return t}if(!e.assignType(t,r)&&(0,u.isClass)(t)&&!u.ClassType.isFinal(t))return t;let o=[];n.arguments.some((e=>!e.name))&&(0,u.isClass)(t)&&(o=f(e,t));for(let a=0;a<n.arguments.length;a++){const r=v(e,n.arguments[a],a,o,t,s);if(!(0,u.isNever)(r))return i}}))}return u.TypeBase.isInstantiable(i)||(0,u.isNever)(i)?e.mapSubtypesExpandTypeVars(i,void 0,((i,a)=>(0,u.isAnyOrUnknown)(i)?a:(0,u.isInstantiableClass)(i)?e.mapSubtypesExpandTypeVars(t,void 0,(t=>{if((0,u.isAnyOrUnknown)(t))return(0,y.convertToInstance)(a);if((0,u.isNoneInstance)(t)&&(0,u.isInstantiableClass)(i)&&u.ClassType.isBuiltIn(i,"NoneType"))return t;if((0,u.isClassInstance)(t)){let r;if(e.assignType(i,u.ClassType.cloneAsInstantiable(t)))r=t;else{if(!e.assignType(u.ClassType.cloneAsInstantiable(t),i))return;if(r=(0,y.addConditionToType)((0,y.convertToInstance)(a),(0,y.getTypeCondition)(t)),(0,u.isInstantiableClass)(a)&&(0,u.isClassInstance)(t)&&(u.ClassType.isSpecialBuiltIn(a)||a.details.typeParameters.length>0)){const n=new m.TypeVarContext((0,y.getTypeVarScopeId)(a)),s=u.ClassType.cloneForSpecialization(a,void 0,!1),i=u.ClassType.cloneAsInstance(s);(0,c.populateTypeVarContextBasedOnExpectedType)(e,i,t,n,void 0)&&(r=(0,y.applySolvedTypeVars)(i,n,{unknownIfNotFound:!0}))}}let o=[];n.arguments.some((e=>!e.name))&&(o=f(e,i));let l=!0;if(n.arguments.forEach(((t,n)=>{const i=v(e,t,n,o,r,s);(0,u.isNever)(i)&&(l=!1)})),l)return r}})):void 0)):(e.addDiagnostic((0,l.getFileInfo)(n).diagnosticRuleSet.reportGeneralTypeIssues,r.DiagnosticRule.reportGeneralTypeIssues,o.Localizer.DiagnosticAddendum.typeNotClass().format({type:e.printType(i)}),n.className),u.NeverType.createNever())}(e,t,n,i);case 66:return function(e,t,n,s){let i=t;if(!s)return n.orPatterns.forEach((t=>{i=h(e,i,t,!1)})),i;const a=n.orPatterns.map((t=>{const n=h(e,i,t,!0);return i=h(e,i,t,!1),n}));return(0,u.combineTypes)(a)}(e,t,n,i);case 70:return function(e,t,n,s){if(!s){if(1!==n.entries.length||71!==n.entries[0].nodeType)return t;const s=n.entries[0].keyPattern,i=n.entries[0].valuePattern;if(67!==s.nodeType||66!==i.nodeType||!i.orPatterns.every((e=>67===e.nodeType)))return t;const a=e.getTypeOfExpression(s.expression).type;if(!(0,u.isClassInstance)(a)||!u.ClassType.isBuiltIn(a,"str")||void 0===a.literalValue)return t;const r=a.literalValue,o=i.orPatterns.map((t=>e.getTypeOfExpression(t.expression).type));return(0,y.mapSubtypes)(t,(t=>{if((0,u.isClassInstance)(t)&&u.ClassType.isTypedDictClass(t)){const n=(0,p.getTypedDictMembersForClass)(e,t,!0).get(r);if(n&&(n.isRequired||n.isProvided)&&(0,u.isClassInstance)(n.valueType)){const e=n.valueType;if(o.some((t=>(0,u.isClassInstance)(t)&&u.ClassType.isSameGenericClass(t,e)&&t.literalValue===e.literalValue)))return}}return t}))}let i=_(e,t);return i=i.filter((t=>{let i=!0;return n.entries.forEach((a=>{if(t.typedDict){if(71===a.nodeType){const r=h(e,e.getBuiltInObject(n,"str"),a.keyPattern,s);(0,u.isNever)(r)&&(i=!1);const o=(0,y.mapSubtypes)(r,(n=>{if((0,u.isAnyOrUnknown)(n))return n;if((0,u.isClassInstance)(n)&&u.ClassType.isBuiltIn(n,"str")){if(!(0,y.isLiteralType)(n))return u.UnknownType.create();const s=(0,p.getTypedDictMembersForClass)(e,t.typedDict).get(n.literalValue);if(s){const t=h(e,s.valueType,a.valuePattern,!0);if(!(0,u.isNever)(t))return t}}}));(0,u.isNever)(o)&&(i=!1)}}else if(t.dictTypeArgs&&71===a.nodeType){const n=h(e,t.dictTypeArgs.key,a.keyPattern,s),r=h(e,t.dictTypeArgs.value,a.valuePattern,s);((0,u.isNever)(n)||(0,u.isNever)(r))&&(i=!1)}})),i})),(0,u.combineTypes)(i.map((e=>e.subtype)))}(e,t,n,i);case 73:return function(e,t,n,s){const i=e.getTypeOfExpression(n.expression).type,a=[];return e.mapSubtypesExpandTypeVars(i,void 0,((i,r)=>{a.push(e.mapSubtypesExpandTypeVars(t,(0,y.getTypeCondition)(i),(t=>{if(!s){if((0,u.isClassInstance)(t)&&u.ClassType.isEnumClass(t)&&!(0,y.isLiteralType)(t)&&(0,u.isClassInstance)(i)&&(0,u.isSameWithoutLiteralValue)(t,i)&&(0,y.isLiteralType)(i)){const n=(0,d.enumerateLiteralsForType)(e,t);if(n)return(0,u.combineTypes)(n.filter((e=>!u.ClassType.isLiteralValueSame(i,e))))}else if((0,u.isClassInstance)(t)&&(0,u.isClassInstance)(i)&&u.ClassType.isLiteralValueSame(i,t))return;return t}return(0,u.isNever)(i)||(0,u.isNever)(t)?u.NeverType.createNever():(0,u.isAnyOrUnknown)(i)||(0,u.isAnyOrUnknown)(t)?(0,u.isUnknown)(i)||(0,u.isUnknown)(t)?(0,y.preserveUnknown)(i,t):u.AnyType.create():e.useSpeculativeMode(n.expression,(()=>e.getTypeOfMagicMethodReturn(i,[{type:t}],"__eq__",n.expression,void 0)))?r:void 0})))})),(0,u.combineTypes)(a)}(e,t,n,i);case 69:return i?t:u.NeverType.createNever();case 0:return t}}function f(e,t){const n=(0,y.lookUpClassMember)(t,"__match_args__");if(n){const t=e.getTypeOfMember(n);if((0,u.isClassInstance)(t)&&(0,y.isTupleClass)(t)&&!(0,y.isUnboundedTupleClass)(t)&&t.tupleTypeArguments){const e=t.tupleTypeArguments;if(e.every((e=>(0,u.isClassInstance)(e.type)&&u.ClassType.isBuiltIn(e.type,"str")&&(0,y.isLiteralType)(e.type))))return e.map((e=>e.type.literalValue))}}return[]}function T(e){return g.some((t=>e.details.fullName===t))}function v(e,t,n,s,i,a){var r;let o;if(t.name?o=t.name.value:n<s.length&&(o=s[n]),(0,u.isAnyOrUnknown)(i))return i;if(!(0,u.isClass)(i))return u.UnknownType.create();let l,c=!1,p=i;if(!t.name&&(0,u.isClass)(i)&&0===n&&(T(i)?c=!0:0===s.length&&i.details.mro.forEach((e=>{(0,u.isClass)(e)&&T(e)&&(p=e,c=!0)}))),c)l=u.ClassType.cloneAsInstance(p);else if(o&&(l=null===(r=e.useSpeculativeMode(t,(()=>e.getTypeOfObjectMember(t,u.ClassType.cloneAsInstance(i),o))))||void 0===r?void 0:r.type),!l){if(!a)return i;if(u.ClassType.isFinal(i))return u.NeverType.createNever();l=u.UnknownType.create()}return h(e,l,t.pattern,a)}function _(e,t){const n=[];return(0,y.doForEachSubtype)(t,(t=>{const s=e.makeTopLevelTypeVarsConcrete(t);if((0,u.isAnyOrUnknown)(s))n.push({subtype:t,dictTypeArgs:{key:s,value:s}});else if((0,u.isClassInstance)(s))if(u.ClassType.isTypedDictClass(s))n.push({subtype:t,typedDict:s});else{let e;for(const t of s.details.mro)if((0,u.isInstantiableClass)(t)&&u.ClassType.isBuiltIn(t,"Mapping")){e=t;break}if(e){const i=(0,y.partiallySpecializeType)(e,s);i.typeArguments&&i.typeArguments.length>=2&&n.push({subtype:t,dictTypeArgs:{key:i.typeArguments[0],value:i.typeArguments[1]}})}}})),n}function I(e,t,n,s){const i=[],a=void 0===s?n:n-1;return(0,y.doForEachSubtype)(t,(t=>{const n=e.makeTopLevelTypeVarsConcrete(t);let r,o=!1;if((0,u.isAnyOrUnknown)(n))i.push({subtype:t,entryTypes:[n],isIndeterminateLength:!0,definiteNoMatch:!1});else{if((0,u.isClassInstance)(n)){if(u.ClassType.isBuiltIn(n,"object"))return void i.push({subtype:t,entryTypes:[(0,y.convertToInstance)(n)],isIndeterminateLength:!0,isObject:!0,definiteNoMatch:!1});for(const e of n.details.mro){if(!(0,u.isInstantiableClass)(e))break;if(u.ClassType.isBuiltIn(e,"str")||u.ClassType.isBuiltIn(e,"bytes")||u.ClassType.isBuiltIn(e,"bytearray"))break;if(u.ClassType.isBuiltIn(e,"Sequence")){r=e;break}if((0,y.isTupleClass)(e)){r=e;break}}if(r){const e=(0,y.partiallySpecializeType)(r,n);(0,y.isTupleClass)(e)?e.tupleTypeArguments&&((0,y.isUnboundedTupleClass)(e)?(i.push({subtype:t,entryTypes:[(0,u.combineTypes)(e.tupleTypeArguments.map((e=>e.type)))],isIndeterminateLength:!0,isTuple:!0,definiteNoMatch:!1}),o=!0):e.tupleTypeArguments.length>=a&&(void 0!==s||e.tupleTypeArguments.length===a)&&(i.push({subtype:t,entryTypes:e.tupleTypeArguments.map((e=>e.type)),isIndeterminateLength:!1,isTuple:!0,definiteNoMatch:!1}),o=!0)):(i.push({subtype:t,entryTypes:[e.typeArguments&&e.typeArguments.length>0?e.typeArguments[0]:u.UnknownType.create()],isIndeterminateLength:!0,definiteNoMatch:!1}),o=!0)}}o||i.push({subtype:t,entryTypes:[],isIndeterminateLength:!0,definiteNoMatch:!0})}})),i}function b(e,t,n,s,a,r,o,l){if(n.isIndeterminateLength){let i=n.entryTypes[0];if(l){const n=e.getBuiltInObject(t,"object");n&&(0,u.isClassInstance)(n)&&(i=n)}return o||s!==r||(0,u.isNever)(i)||(i=C(e,t,i)),i}if(void 0===r||s<r)return n.entryTypes[s];if(s===r){const s=n.entryTypes.slice(r,r+n.entryTypes.length-a+1).map((t=>e.stripLiteralValue(t)));let i=(0,u.combineTypes)(s);return o||(i=C(e,t,i)),i}const c=n.entryTypes.length-(a-s);return(0,i.assert)(c>=0&&c<n.entryTypes.length),n.entryTypes[c]}function C(e,t,n){if((0,u.isNever)(n))return n;const s=(0,y.convertToInstance)(e.getBuiltInObject(t,"list"));return s&&(0,u.isClassInstance)(s)?u.ClassType.cloneForSpecialization(s,[n],!0):u.UnknownType.create()}function S(e,t,n){e.addDiagnostic((0,l.getFileInfo)(t).diagnosticRuleSet.reportUnnecessaryComparison,r.DiagnosticRule.reportUnnecessaryComparison,o.Localizer.Diagnostic.patternNeverMatches().format({type:e.printType(n)}),t)}t.narrowTypeBasedOnPattern=h,t.checkForUnusedPattern=function(e,t,n){if((0,u.isNever)(n))S(e,t,n);else if(66===t.nodeType&&t.orPatterns.length>1)t.orPatterns.forEach((t=>{const s=h(e,n,t,!0);(0,u.isNever)(s)&&S(e,t,n),n=h(e,n,t,!1)}));else{const s=h(e,n,t,!0);(0,u.isNever)(s)&&S(e,t,n)}},t.assignTypeToPatternTargets=function e(t,n,s,i,c){switch(n=h(t,n,c,!0),c.nodeType){case 65:{const a=I(t,n,c.entries.length,c.starEntryIndex).filter((e=>!e.definiteNoMatch));c.entries.forEach(((n,r)=>{const o=(0,u.combineTypes)(a.map((e=>b(t,c,e,r,c.entries.length,c.starEntryIndex,!1,i))));e(t,o,s,!1,n)}));break}case 66:c.target&&t.assignTypeToExpression(c.target,n,s,c.target),c.orPatterns.forEach((a=>{e(t,n,s,i,a),n=h(t,n,a,!1)}));break;case 69:if(c.isWildcard){if(!s){const e=(0,l.getFileInfo)(c);if((0,u.isUnknown)(n))t.addDiagnostic(e.diagnosticRuleSet.reportUnknownVariableType,r.DiagnosticRule.reportUnknownVariableType,o.Localizer.Diagnostic.wildcardPatternTypeUnknown(),c.target);else if((0,y.isPartlyUnknown)(n)){const s=new a.DiagnosticAddendum;s.addMessage(o.Localizer.DiagnosticAddendum.typeOfSymbol().format({name:"_",type:t.printType(n,{expandTypeAlias:!0})})),t.addDiagnostic(e.diagnosticRuleSet.reportUnknownVariableType,r.DiagnosticRule.reportUnknownVariableType,o.Localizer.Diagnostic.wildcardPatternTypePartiallyUnknown()+s.getString(),c.target)}}}else t.assignTypeToExpression(c.target,n,s,c.target);break;case 70:{const i=_(t,n);c.entries.forEach((n=>{const a=[],r=[];i.forEach((e=>{if(e.typedDict)if(71===n.nodeType){const s=h(t,t.getBuiltInObject(c,"str"),n.keyPattern,!0);a.push(s),(0,y.doForEachSubtype)(s,(n=>{if((0,u.isClassInstance)(n)&&u.ClassType.isBuiltIn(n,"str")&&(0,y.isLiteralType)(n)){const s=(0,p.getTypedDictMembersForClass)(t,e.typedDict).get(n.literalValue);r.push(s?s.valueType:u.UnknownType.create())}else r.push(u.UnknownType.create())}))}else 72===n.nodeType&&(a.push(t.getBuiltInObject(c,"str")),r.push(u.UnknownType.create()));else if(e.dictTypeArgs)if(71===n.nodeType){const s=h(t,e.dictTypeArgs.key,n.keyPattern,!0);a.push(s),r.push(h(t,e.dictTypeArgs.value,n.valuePattern,!0))}else 72===n.nodeType&&(a.push(e.dictTypeArgs.key),r.push(e.dictTypeArgs.value))}));const o=(0,u.combineTypes)(a),l=(0,u.combineTypes)(r);if(71===n.nodeType)e(t,o,s,!1,n.keyPattern),e(t,l,s,!1,n.valuePattern);else if(72===n.nodeType){const e=t.getBuiltInType(c,"dict"),i=t.getBuiltInObject(c,"str"),a=e&&(0,u.isInstantiableClass)(e)&&(0,u.isClassInstance)(i)?u.ClassType.cloneAsInstance(u.ClassType.cloneForSpecialization(e,[o,l],!0)):u.UnknownType.create();t.assignTypeToExpression(n.target,a,s,n.target)}}));break}case 68:{const i=c.arguments.map((e=>[]));t.mapSubtypesExpandTypeVars(n,void 0,(e=>{(0,u.isClassInstance)(e)?(0,y.doForEachSubtype)(n,(n=>{const s=t.makeTopLevelTypeVarsConcrete(n);if((0,u.isAnyOrUnknown)(s))c.arguments.forEach(((e,t)=>{i[t].push(s)}));else if((0,u.isClassInstance)(s)){let n=[];c.arguments.some((e=>!e.name))&&(n=f(t,u.ClassType.cloneAsInstantiable(e))),c.arguments.forEach(((s,a)=>{const r=v(t,s,a,n,u.ClassType.cloneAsInstantiable(e),!0);i[a].push(r)}))}})):c.arguments.forEach(((e,t)=>{i[t].push(u.UnknownType.create())}))})),c.arguments.forEach(((n,a)=>{e(t,(0,u.combineTypes)(i[a]),s,!1,n.pattern)}));break}}},t.validateClassPattern=function(e,t){const n=e.getTypeOfExpression(t.className,2).type;(0,u.isAnyOrUnknown)(n)||(n.typeAliasInfo&&(0,u.isInstantiableClass)(n)&&n.typeArguments&&n.isTypeArgumentExplicit?e.addDiagnostic((0,l.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,r.DiagnosticRule.reportGeneralTypeIssues,o.Localizer.Diagnostic.classPatternTypeAlias().format({type:e.printType(n)}),t.className):(0,u.isInstantiableClass)(n)?g.some((e=>n.details.fullName===e))&&(t.arguments.length>1?e.addDiagnostic((0,l.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,r.DiagnosticRule.reportGeneralTypeIssues,o.Localizer.Diagnostic.classPatternBuiltInArgCount(),t.arguments[1]):1===t.arguments.length&&t.arguments[0].name&&e.addDiagnostic((0,l.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,r.DiagnosticRule.reportGeneralTypeIssues,o.Localizer.Diagnostic.classPatternBuiltInArgPositional(),t.arguments[0].name)):(0,u.isNever)(n)||e.addDiagnostic((0,l.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,r.DiagnosticRule.reportGeneralTypeIssues,o.Localizer.DiagnosticAddendum.typeNotClass().format({type:e.printType(n)}),t.className))}},8408:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Program=t.MaxWorkspaceIndexFileCount=void 0;const r=n(4494),o=n(5269),l=n(3213),c=n(9489),p=n(2930),d=n(2211),u=n(5839),y=n(7991),m=n(7345),g=n(6657),h=n(1464),f=n(7559),T=n(9232),v=n(3550),_=n(3420),I=n(8718),b=n(8798),C=n(8566),S=n(7087),x=n(9209),D=n(8127),F=n(4342),E=n(598),P=n(1775),A=n(4952),N=n(1670),k=a(n(563)),w=n(7116),M=n(2835),R=n(8494),O=n(5083),L=n(4221),V=n(6025),U=n(8816),z=n(1766),B=n(1943),G=n(558),W=n(2590);t.MaxWorkspaceIndexFileCount=2e3;class j{constructor(e,t,n,s,i,a){this._disableChecker=i,this._sourceFileList=[],this._sourceFileMap=new Map,this._parsedFileCount=0,this._lookUpImport=e=>{var t;let n;if("string"==typeof e)n=this.getSourceFileInfo(e);else{const t=this._importResolver.resolveImport(e.importingFilePath,this._configOptions.findExecEnvironment(e.importingFilePath),{leadingDots:0,nameParts:e.nameParts,importedSymbols:void 0});if(t.isImportFound&&!t.isNativeLib&&t.resolvedPaths.length>0){let e=t.resolvedPaths[t.resolvedPaths.length-1];e&&(n=this.getSourceFileInfo(e),n||(e=(0,g.normalizePathCase)(this._fs,e),this.addTrackedFile(e),n=this.getSourceFileInfo(e)))}}if(!n)return;n.sourceFile.isBindingRequired()&&I.timingStats.typeCheckerTime.subtractFromTime((()=>{this._bindFile(n)}));const s=n.sourceFile.getModuleSymbolTable();if(!s)return;const i=n.sourceFile.getParseResults(),a=i.parseTree,r=k.getFileInfo(a),o=k.getDunderAllInfo(i.parseTree);return{symbolTable:s,dunderAllNames:null==o?void 0:o.names,usesUnsupportedDunderAllForm:null!==(t=null==o?void 0:o.usesUnsupportedDunderAllForm)&&void 0!==t&&t,get docString(){return(0,R.getDocString)(a.statements)},isInPyTypedPackage:r.isInPyTypedPackage}},this._console=n||new d.StandardConsole,this._logTracker=null!=s?s:new m.LogTracker(n,"FG"),this._importResolver=e,this._configOptions=t,this._cacheManager=null!=a?a:new w.CacheManager,this._cacheManager.registerCacheOwner(this),this._createNewEvaluator(),this._id=j._nextId,j._nextId+=1}dispose(){this._cacheManager.unregisterCacheOwner(this)}get evaluator(){return this._evaluator}get console(){return this._console}get id(){return this._id}setConfigOptions(e){this._configOptions=e,this._importResolver.setConfigOptions(e),this._createNewEvaluator()}get rootPath(){return this._configOptions.projectRoot}getConfigOptions(){return this._configOptions}setImportResolver(e){this._importResolver=e,this._createNewEvaluator()}getImportResolver(){return this._importResolver}setTrackedFiles(e){if(this._sourceFileList.length>0){const t=new Map;e.forEach((e=>{t.set((0,g.normalizePathCase)(this._fs,e),e)})),this._sourceFileList.forEach((e=>{const n=(0,g.normalizePathCase)(this._fs,e.sourceFile.getFilePath());t.has(n)||(e.isTracked=!1)}))}return this.addTrackedFiles(e),this._removeUnneededFiles()}setPreCheckCallback(e){this._preCheckCallback=e}setAllowedThirdPartyImports(e){this._allowedThirdPartyImports=e}addTrackedFiles(e,t=!1,n=!1){e.forEach((e=>{this.addTrackedFile(e,t,n)}))}addInterimFile(e){let t=this.getSourceFileInfo(e);return t||(t=this._createInterimFileInfo(e),this._addToSourceFileListAndMap(t)),t}addTrackedFile(e,t=!1,n=!1){let s=this.getSourceFileInfo(e);const i=this._getImportNameForFile(e);if(s)return s.sourceFile.setModuleName(i),s.isTracked=!0,s.sourceFile;const a=new L.SourceFile(this._fs,e,i,t,n,this._console,this._logTracker);return s={sourceFile:a,isTracked:!0,isOpenByClient:!1,isTypeshedFile:!1,isThirdPartyImport:t,isThirdPartyPyTypedPresent:n,diagnosticsVersion:void 0,imports:[],importedBy:[],shadows:[],shadowedBy:[]},this._addToSourceFileListAndMap(s),a}setFileOpened(e,t,n,s){var i,a;let r=this.getSourceFileInfo(e);if(r)r.isOpenByClient=!0,r.diagnosticsVersion=0;else{const t=this._getImportNameForFile(e),n=new L.SourceFile(this._fs,e,t,!1,!1,this._console,this._logTracker,null==s?void 0:s.realFilePath,null!==(i=null==s?void 0:s.ipythonMode)&&void 0!==i?i:L.IPythonMode.None),o=null==s?void 0:s.chainedFilePath;r={sourceFile:n,isTracked:null!==(a=null==s?void 0:s.isTracked)&&void 0!==a&&a,chainedSourceFile:o?this.getSourceFileInfo(o):void 0,isOpenByClient:!0,isTypeshedFile:!1,isThirdPartyImport:!1,isThirdPartyPyTypedPresent:!1,diagnosticsVersion:void 0,imports:[],importedBy:[],shadows:[],shadowedBy:[]},this._addToSourceFileListAndMap(r)}r.sourceFile.setClientVersion(t,n)}getChainedFilePath(e){var t;const n=this.getSourceFileInfo(e);return null===(t=null==n?void 0:n.chainedSourceFile)||void 0===t?void 0:t.sourceFile.getFilePath()}updateChainedFilePath(e,t){const n=this.getSourceFileInfo(e);n&&(n.chainedSourceFile=t?this.getSourceFileInfo(t):void 0,n.sourceFile.markDirty(),this._markFileDirtyRecursive(n,new Set))}setFileClosed(e,t){const n=this.getSourceFileInfo(e);return n&&(n.isOpenByClient=!1,n.isTracked=null!=t?t:n.isTracked,n.sourceFile.setClientVersion(null,[]),n.sourceFile.didContentsChangeOnDisk()&&(n.sourceFile.markDirty(),this._markFileDirtyRecursive(n,new Set))),this._removeUnneededFiles()}markAllFilesDirty(e,t=!0){const n=new Set;this._sourceFileList.forEach((s=>{e?s.sourceFile.markDirty(t):s.sourceFile.didContentsChangeOnDisk()&&(s.sourceFile.markDirty(t),this._markFileDirtyRecursive(s,n))})),n.size>0&&this._createNewEvaluator()}markFilesDirty(e,t,n=!0){const s=new Set;e.forEach((e=>{const i=this.getSourceFileInfo(e);if(i){const a=(0,g.getFileName)(e);if("builtins.pyi"===a||"__builtins__.pyi"===a)return void this.markAllFilesDirty(t,n);(t||!i.isOpenByClient&&i.sourceFile.didContentsChangeOnDisk())&&(i.sourceFile.markDirty(n),this._markFileDirtyRecursive(i,s))}})),s.size>0&&this._createNewEvaluator()}getFileCount(e=!0){return e?this._sourceFileList.filter((e=>(0,V.isUserCode)(e))).length:this._sourceFileList.length}getUserFileCount(){return this._sourceFileList.filter((e=>(0,V.isUserCode)(e))).length}getUserFiles(){return this._sourceFileList.filter((e=>(0,V.isUserCode)(e)))}getOpened(){return this._sourceFileList.filter((e=>e.isOpenByClient))}getFilesToAnalyzeCount(){let e=0;return this._disableChecker||this._sourceFileList.forEach((t=>{t.sourceFile.isCheckingRequired()&&this._shouldCheckFile(t)&&e++})),e}isCheckingOnlyOpenFiles(){return this._configOptions.checkOnlyOpenFiles||!1}functionSignatureDisplay(){return this._configOptions.functionSignatureDisplay}containsSourceFileIn(e){const t=(0,g.normalizePathCase)(this._fs,e);return this._sourceFileList.some((e=>e.sourceFile.getFilePath().startsWith(t)))}owns(e){const t=this.getSourceFileInfo(e);return t?t.isTracked:(0,p.matchFileSpecs)(this._configOptions,e)}getSourceFile(e){const t=this.getSourceFileInfo(e);if(t)return t.sourceFile}getBoundSourceFile(e){var t;return null===(t=this.getBoundSourceFileInfo(e))||void 0===t?void 0:t.sourceFile}getSourceFileInfo(e){return this._sourceFileMap.get((0,g.normalizePathCase)(this._fs,e))}getBoundSourceFileInfo(e,t,n){const s=this.getSourceFileInfo(e);if(s)return this._bindFile(s,t,n),s}analyze(e,t=r.CancellationToken.None){return this._runEvaluatorWithCancellationToken(t,(()=>{const n=new I.Duration,s=this._sourceFileList.filter((e=>e.isOpenByClient&&e.sourceFile.isCheckingRequired()));if(s.length>0){const i=e?e.openFilesTimeInMs:Number.MAX_VALUE;for(const e of s)if(this._checkTypes(e,t)&&n.getDurationInMilliseconds()>i)return!0;if(void 0!==e)return!0}if(!this._configOptions.checkOnlyOpenFiles){const s=e?e.noOpenFilesTimeInMs:Number.MAX_VALUE;for(const e of this._sourceFileList)if((0,V.isUserCode)(e)&&this._checkTypes(e,t)&&n.getDurationInMilliseconds()>s)return!0}return!1}))}analyzeFile(e,t=r.CancellationToken.None){return this._runEvaluatorWithCancellationToken(t,(()=>{const n=this.getSourceFileInfo(e);return!(!n||!this._checkTypes(n,t))}))}indexWorkspace(e,t){return this._configOptions.indexing?this._runEvaluatorWithCancellationToken(t,(()=>{const n=new Set;for(const e of this._sourceFileList)e.sourceFile.isParseRequired()||n.add(e);let s=0;for(const n of this._sourceFileList){if(!(0,V.isUserCode)(n)||!n.sourceFile.isIndexingRequired())continue;this._bindFile(n);const i=n.sourceFile.index({indexingForAutoImportMode:!1},t);i&&(s++,e(n.sourceFile.getFilePath(),i)),this._handleMemoryHighUsage()}return function(e,t){for(const n of e)n.sourceFile.isParseRequired()||t.has(n)||n.sourceFile.dropParseAndBindInfo()}(this._sourceFileList,n),s})):0}printDetailedAnalysisTimes(){const e=this._sourceFileList.filter((e=>void 0!==e.sourceFile.getCheckTime())).sort(((e,t)=>t.sourceFile.getCheckTime()-e.sourceFile.getCheckTime()));this._console.info(""),this._console.info("Analysis time by file"),e.forEach((e=>{const t=e.sourceFile.getCheckTime();this._console.info(`${t}ms: ${e.sourceFile.getFilePath()}`)}))}printDependencies(e,t){const n=this._importResolver.fileSystem,s=this._sourceFileList.filter((e=>!e.isTypeshedFile)).sort(((e,t)=>n.getOriginalFilePath(e.sourceFile.getFilePath())<n.getOriginalFilePath(t.sourceFile.getFilePath())?1:-1)),i=[];s.forEach((s=>{this._console.info("");let a=n.getOriginalFilePath(s.sourceFile.getFilePath());const r=(0,g.getRelativePath)(a,e);r&&(a=r),this._console.info(`${a}`),this._console.info(` Imports     ${s.imports.length} file`+(1===s.imports.length?"":"s")),t&&s.imports.forEach((e=>{this._console.info(`    ${n.getOriginalFilePath(e.sourceFile.getFilePath())}`)})),this._console.info(` Imported by ${s.importedBy.length} file`+(1===s.importedBy.length?"":"s")),t&&s.importedBy.forEach((e=>{this._console.info(`    ${n.getOriginalFilePath(e.sourceFile.getFilePath())}`)})),0===s.importedBy.length&&i.push(s.sourceFile)})),i.length>0&&(this._console.info(""),this._console.info(`${i.length} file${1===i.length?"":"s"} not explicitly imported`),i.forEach((e=>{this._console.info(`    ${n.getOriginalFilePath(e.getFilePath())}`)})))}writeTypeStub(e,t,n,s){for(const i of this._sourceFileList){(0,l.throwIfCancellationRequested)(s);const a=i.sourceFile.getFilePath(),r=(0,g.getRelativePath)(a,e);if(void 0!==r){let e=(0,g.normalizePath)((0,g.combinePaths)(n,r));e=t?(0,g.combinePaths)((0,g.getDirectoryPath)(e),"__init__.pyi"):(0,g.stripFileExtension)(e)+".pyi";const a=(0,g.getDirectoryPath)(e);try{(0,g.makeDirectories)(this._fs,a,n)}catch(e){throw new Error(`Could not create directory for '${a}'`)}this._bindFile(i),this._runEvaluatorWithCancellationToken(s,(()=>{new W.TypeStubWriter(e,i.sourceFile,this._evaluator).write()})),this._handleMemoryHighUsage()}}}getTypeOfSymbol(e){return this._handleMemoryHighUsage(),(this._evaluator||this._createNewEvaluator()).getEffectiveTypeOfSymbol(e)}printType(e,t){return this._handleMemoryHighUsage(),(this._evaluator||this._createNewEvaluator()).printType(e,t)}static _getPrintTypeFlags(e){let t=0;return e.diagnosticRuleSet.printUnknownAsAny&&(t|=1),e.diagnosticRuleSet.omitConditionalConstraint&&(t|=64),e.diagnosticRuleSet.omitTypeArgsIfAny&&(t|=2),e.diagnosticRuleSet.omitUnannotatedParamType&&(t|=4),e.diagnosticRuleSet.pep604Printing&&(t|=8),t}get _fs(){return this._importResolver.fileSystem}_getImportNameForFile(e){return this._importResolver.getModuleNameForImport(e,this._configOptions.getDefaultExecEnvironment(),!0).moduleName}_addShadowedFile(e,t){let n=this.getSourceFileInfo(t);return n||(n=this.addInterimFile(t)),n.shadows.includes(e)||n.shadows.push(e),e.shadowedBy.includes(n)||e.shadowedBy.push(n),n.sourceFile}_createInterimFileInfo(e){const t=this._getImportNameForFile(e);return{sourceFile:new L.SourceFile(this._fs,e,t,!1,!1,this._console,this._logTracker),isTracked:!1,isOpenByClient:!1,isTypeshedFile:!1,isThirdPartyImport:!1,isThirdPartyPyTypedPresent:!1,diagnosticsVersion:void 0,imports:[],importedBy:[],shadows:[],shadowedBy:[]}}_createNewEvaluator(){return this._evaluator&&this._evaluator.disposeEvaluator(),this._evaluator=(0,G.createTypeEvaluatorWithTracker)(this._lookUpImport,{printTypeFlags:j._getPrintTypeFlags(this._configOptions),logCalls:this._configOptions.logTypeEvaluationTime,minimumLoggingThreshold:this._configOptions.typeEvaluationTimeThreshold,evaluateUnknownImportsAsAny:!!this._configOptions.evaluateUnknownImportsAsAny,verifyTypeCacheEvaluatorFlags:!!this._configOptions.internalTestMode},this._logTracker,this._configOptions.logTypeEvaluationTime?(0,B.createTracePrinter)(this._importResolver.getImportRoots(this._configOptions.findExecEnvironment(this._configOptions.projectRoot))):void 0),this._evaluator}_parseFile(e,t,n){if((n||this._isFileNeeded(e)&&e.sourceFile.isParseRequired())&&(e.sourceFile.parse(this._configOptions,this._importResolver,t)&&(this._parsedFileCount++,this._updateSourceFileImports(e,this._configOptions)),e.sourceFile.isFileDeleted())){e.isTracked=!1;const t=new Set;this._markFileDirtyRecursive(e,t),this._importResolver.invalidateCache()}}_bindFile(e,t,n){var s,i;if(!(n||this._isFileNeeded(e)&&e.sourceFile.isBindingRequired()))return;this._parseFile(e,t,n);const a=t=>{if(!t||t===e)return;if(this._bindFile(t),t.sourceFile.isFileDeleted())return;const n=t.sourceFile.getParseResults();if(!n)return;const s=k.getScope(n.parseTree);return(0,u.assert)(void 0!==s),s};let r;e.builtinsImport&&e.builtinsImport!==e&&(r=null!==(i=null!==(s=a(e.chainedSourceFile))&&void 0!==s?s:a(e.ipythonDisplayImport))&&void 0!==i?i:a(e.builtinsImport));let o=e.sourceFile.getParseResults().futureImports;e.chainedSourceFile&&(o=this._getEffectiveFutureImports(o,e.chainedSourceFile)),e.effectiveFutureImports=o.size>0?o:void 0,e.sourceFile.bind(this._configOptions,this._lookUpImport,r,o)}_getEffectiveFutureImports(e,t){var n;const s=new Set(e);return null===(n=t.effectiveFutureImports)||void 0===n||n.forEach((e=>{s.add(e)})),s}_buildModuleSymbolsMap(e,t,n,s){return(0,C.buildModuleSymbolsMap)(this._sourceFileList.filter((n=>n!==e&&(!t||(0,V.isUserCode)(n)))),n,s)}_shouldCheckFile(e){return!!e.isOpenByClient||!(this._configOptions.checkOnlyOpenFiles||!e.isTracked)}_checkTypes(e,t){return this._logTracker.log(`analyzing: ${e.sourceFile.getFilePath()}`,(n=>{if(!this._isFileNeeded(e))return n.suppress(),!1;if(!e.sourceFile.isCheckingRequired())return n.suppress(),!1;if(!this._shouldCheckFile(e))return n.suppress(),!1;if(this._bindFile(e),this._preCheckCallback){const t=e.sourceFile.getParseResults();t&&this._preCheckCallback(t,this._evaluator)}if(!this._disableChecker){let n;if(e.sourceFile.getIPythonMode()===L.IPythonMode.CellDocs){n=[];const s=(0,V.collectImportedByFiles)(e);for(const e of s){if(!(0,V.isUserCode)(e))continue;const s=this._cacheManager.pauseTracking();try{this._checkTypes(e,t)}finally{s.dispose()}const i=e.sourceFile.getParseResults();i&&n.push(i)}}const s=this._configOptions.findExecEnvironment(e.sourceFile.getFilePath());e.sourceFile.check(this._importResolver,this._evaluator,this._createSourceMapper(s,t,e),n)}if(this._handleMemoryHighUsage(),"none"!==this._configOptions.diagnosticRuleSet.reportImportCycles&&!this._allowedThirdPartyImports){const t=new Map;this._getImportsRecursive(e,t,0),t.forEach((e=>{I.timingStats.cycleDetectionTime.timeOperation((()=>{const t=new Map;this._detectAndReportImportCycles(e,t)||t.forEach((e=>{e.sourceFile.setNoCircularDependencyConfirmed()}))}))}))}return!0}))}_getImportsRecursive(e,t,n){const s=(0,g.normalizePathCase)(this._fs,e.sourceFile.getFilePath());if(!t.has(s))if(n>256)e.sourceFile.setHitMaxImportDepth(256);else{t.set(s,e),(0,V.isUserCode)(e)&&this._parseFile(e);for(const s of e.imports)this._getImportsRecursive(s,t,n+1)}}_detectAndReportImportCycles(e,t,n=[],s=new Map){if(e.sourceFile.isStubFile()||e.isThirdPartyImport)return!1;if(e.sourceFile.isNoCircularDependencyConfirmed())return!1;const i=(0,g.normalizePathCase)(this._fs,e.sourceFile.getFilePath());t.set(i,e);let a=!1;if(s.has(i))a=!0,n.length>1&&e===n[0]&&this._logImportCycle(n);else{if(s.has(i))return!1;s.set(i,!0),n.push(e);for(const i of e.imports)this._detectAndReportImportCycles(i,t,n,s)&&(a=!0);s.set(i,!1),n.pop()}return a}_logImportCycle(e){const t=new M.CircularDependency;e.forEach((e=>{t.appendPath(e.sourceFile.getFilePath())})),t.normalizeOrder();const n=t.getPaths()[0],s=this.getSourceFileInfo(n);(0,u.assert)(void 0!==s),s.sourceFile.addCircularDependency(t)}_markFileDirtyRecursive(e,t,n=!1){const s=(0,g.normalizePathCase)(this._fs,e.sourceFile.getFilePath());if(t.has(s))return;e.sourceFile.markReanalysisRequired(n),t.add(s),e.importedBy.forEach((n=>{const s=n.chainedSourceFile===e;this._markFileDirtyRecursive(n,t,s)}));let i=e.chainedSourceFile;for(;i;){if(i.sourceFile.isCheckingRequired())return;i.sourceFile.markReanalysisRequired(!1),i=i.chainedSourceFile}}getTextOnRange(e,t,n){const s=this.getSourceFileInfo(e);if(!s)return;const i=s.sourceFile,a=i.getOpenFileContents();return void 0!==a?this._runEvaluatorWithCancellationToken(n,(()=>{this._parseFile(s);const e=i.getParseResults(),n=(0,h.convertRangeToTextRange)(t,e.tokenizerOutput.lines);if(n)return a.substr(n.start,n.length)})):void 0}getAutoImports(e,t,n,s,i,a){const r=this.getSourceFileInfo(e);if(!r)return[];const o=r.sourceFile,l=o.getOpenFileContents();return void 0===l?[]:this._runEvaluatorWithCancellationToken(a,(()=>{var p;this._bindFile(r);const d=o.getParseResults(),u=(0,h.convertRangeToTextRange)(t,d.tokenizerOutput.lines);if(!u)return[];const y=(0,R.findNodeByOffset)(d.parseTree,u.start);if(!y)return[];const m=l.substr(u.start,u.length),g=this._buildModuleSymbolsMap(r,!!i.libraryMap,!0,a);i.patternMatcher=null!==(p=i.patternMatcher)&&void 0!==p?p:(e,t)=>(0,f.computeCompletionSimilarity)(e,t)>n;const T=new C.AutoImporter(this._configOptions.findExecEnvironment(e),this._importResolver,d,t.start,new x.CompletionMap,g,i),v=[],_=(0,O.getScopeForNode)(y);if(_){const e=null==s?void 0:s.get(m);e&&(0,c.appendArray)(v,T.getAutoImportCandidatesForAbbr(m,e,a)),v.push(...T.getAutoImportCandidates(m,n,void 0,a).filter((e=>!_.lookUpSymbolRecursive(e.name))))}return v}))}getDiagnostics(e){const t=this._removeUnneededFiles();return this._sourceFileList.forEach((n=>{if(this._shouldCheckFile(n)){const s=n.sourceFile.getDiagnostics(e,n.diagnosticsVersion);void 0!==s&&(t.push({filePath:n.sourceFile.getFilePath(),version:n.sourceFile.getClientVersion(),diagnostics:s}),n.diagnosticsVersion=n.sourceFile.getDiagnosticVersion())}else!n.isOpenByClient&&e.checkOnlyOpenFiles&&void 0!==n.diagnosticsVersion&&(t.push({filePath:n.sourceFile.getFilePath(),version:n.sourceFile.getClientVersion(),diagnostics:[]}),n.diagnosticsVersion=void 0)})),t}getDiagnosticsForRange(e,t){const n=this.getSourceFile(e);if(!n)return[];const s=n.getDiagnostics(this._configOptions);return s?s.filter((e=>(0,v.doRangesIntersect)(e.range,t))):[]}getDefinitionsForPosition(e,t,n,s){return this._runEvaluatorWithCancellationToken(s,(()=>{const i=this.getSourceFileInfo(e);if(!i)return;this._bindFile(i);const a=this._configOptions.findExecEnvironment(e);return i.sourceFile.getDefinitionsForPosition(this._createSourceMapper(a,s,i),t,n,this._evaluator,s)}))}getTypeDefinitionsForPosition(e,t,n){return this._runEvaluatorWithCancellationToken(n,(()=>{const s=this.getSourceFileInfo(e);if(!s)return;this._bindFile(s);const i=this._configOptions.findExecEnvironment(e);return s.sourceFile.getTypeDefinitionsForPosition(this._createSourceMapper(i,n,s,!1,!0),t,this._evaluator,e,n)}))}reportReferencesForPosition(e,t,n,s,i){this._runEvaluatorWithCancellationToken(i,(()=>{const a=this.getSourceFileInfo(e);if(!a)return;const r=(0,V.isUserCode)(a);this._bindFile(a);const o=this._configOptions.findExecEnvironment(e),c=this._getDeclarationForPosition(a,t,D.DocumentSymbolCollectorUseCase.Reference,this._createSourceMapper(o,i,a),i,s);if(c)if(c.requiresGlobalSearch){for(const e of this._sourceFileList)if((0,l.throwIfCancellationRequested)(i),e.isOpenByClient||!r||(0,V.isUserCode)(e)){const t=e.sourceFile.getFileContent();t&&!c.symbolNames.some((e=>t.search(e)>=0))||(this._bindFile(e),e.sourceFile.addReferences(c,n,this._evaluator,i)),this._handleMemoryHighUsage()}if(n)for(const e of c.declarations){if((0,l.throwIfCancellationRequested)(i),c.locations.some((t=>t.path===e.path)))continue;const t=this.getSourceFileInfo(e.path);if(!t)continue;const s=new A.ReferencesResult(c.requiresGlobalSearch,c.nodeAtOffset,c.symbolNames,c.declarations,c.useCase);t.sourceFile.addReferences(s,n,this._evaluator,i);for(const t of s.locations)t.path===e.path&&(0,v.doesRangeContain)(e.range,t.range)&&c.addLocations(t)}}else a.sourceFile.addReferences(c,n,this._evaluator,i)}))}getFileIndex(e,t,n){if(t.indexingForAutoImportMode){const t=(0,g.stripFileExtension)((0,g.getFileName)(e));if((0,z.isPrivateOrProtectedName)(t))return}return this._handleMemoryHighUsage(),this._runEvaluatorWithCancellationToken(n,(()=>{var s;const i=this.getSourceFileInfo(e);if(!i)return;const a=null!==(s=i.sourceFile.getFileContent())&&void 0!==s?s:"";return t.indexingForAutoImportMode&&!t.includeAllSymbols&&!i.sourceFile.isStubFile()&&!i.sourceFile.isThirdPartyPyTypedPresent()&&a.indexOf("__all__")<0?void 0:(this._bindFile(i,a),i.sourceFile.index(t,n))}))}addSymbolsForDocument(e,t,n){return this._runEvaluatorWithCancellationToken(n,(()=>{const s=this.getSourceFileInfo(e);s&&(s.sourceFile.getCachedIndexResults()||this._bindFile(s),s.sourceFile.addHierarchicalSymbolsForDocument(t,n))}))}reportSymbolsForWorkspace(e,t,n){this._runEvaluatorWithCancellationToken(n,(()=>{if(e)for(const s of this._sourceFileList){if(!(0,V.isUserCode)(s))continue;s.sourceFile.getCachedIndexResults()||this._bindFile(s);const i=s.sourceFile.getSymbolsForDocument(e,n);i.length>0&&t(i),this._handleMemoryHighUsage()}}))}getHoverForPosition(e,t,n,s){return this._runEvaluatorWithCancellationToken(s,(()=>{const i=this.getSourceFileInfo(e);if(!i)return;this._bindFile(i);const a=this._configOptions.findExecEnvironment(e);return i.sourceFile.getHoverForPosition(this._createSourceMapper(a,s,i,!0),t,n,this._evaluator,this.functionSignatureDisplay(),s)}))}getDocumentHighlight(e,t,n){return this._runEvaluatorWithCancellationToken(n,(()=>{const s=this.getSourceFileInfo(e);if(!s)return;this._bindFile(s);const i=this._configOptions.findExecEnvironment(e);return s.sourceFile.getDocumentHighlight(this._createSourceMapper(i,n,s),t,this._evaluator,n)}))}getSignatureHelpForPosition(e,t,n,s){return this._runEvaluatorWithCancellationToken(s,(()=>{const i=this.getSourceFileInfo(e);if(!i)return;this._bindFile(i);const a=this._configOptions.findExecEnvironment(e);return i.sourceFile.getSignatureHelpForPosition(t,this._createSourceMapper(a,s,i,!0),this._evaluator,n,s)}))}async getCompletionsForPosition(e,t,n,s,i,a,r){const l=this.getSourceFileInfo(e);if(!l)return;let c;const p=this._logTracker.log(`completion at ${e}:${t.line}:${t.character}`,(o=>{var p;const d=this._runEvaluatorWithCancellationToken(r,(()=>{this._bindFile(l);const o=this._configOptions.findExecEnvironment(e);return c=this._createSourceMapper(o,r,l,!0),l.sourceFile.getCompletionsForPosition(t,n,this._configOptions,this._importResolver,this._lookUpImport,this._evaluator,s,c,i,a,(()=>this._buildModuleSymbolsMap(l,!!a,s.includeUserSymbolsInAutoImport,r)),r)}));return o.add(`found ${null!==(p=null==d?void 0:d.completionMap.size)&&void 0!==p?p:"null"} items`),d})),d={completionList:o.CompletionList.create(null==p?void 0:p.completionMap.toArray()),memberAccessInfo:null==p?void 0:p.memberAccessInfo,autoImportInfo:null==p?void 0:p.autoImportInfo,extensionInfo:null==p?void 0:p.extensionInfo},u=l.sourceFile.getParseResults();if((null==u?void 0:u.parseTree)&&(null==u?void 0:u.text)){const e=(0,h.convertPositionToOffset)(t,u.tokenizerOutput.lines);void 0!==e&&c&&await Promise.all(y.Extensions.getProgramExtensions(u.parseTree).map((t=>{var n;return null===(n=t.completionListExtension)||void 0===n?void 0:n.updateCompletionResults(this.evaluator,c,s,d,u,e,this._configOptions.functionSignatureDisplay,r)})))}return d}resolveCompletionItem(e,t,n,s,i,a){return this._runEvaluatorWithCancellationToken(a,(()=>{const r=this.getSourceFileInfo(e);if(!r)return;this._bindFile(r);const o=this._configOptions.findExecEnvironment(e);r.sourceFile.resolveCompletionItem(this._configOptions,this._importResolver,this._lookUpImport,this._evaluator,n,this._createSourceMapper(o,a,r,!0),s,i,(()=>this._buildModuleSymbolsMap(r,!!i,n.includeUserSymbolsInAutoImport,a)),t,a)}))}renameModule(e,t,n){return this._runEvaluatorWithCancellationToken(n,(()=>{if((0,g.isFile)(this._fs,e)&&!this.getSourceFileInfo(e))return;const s=N.RenameModuleProvider.createForModule(this._importResolver,this._configOptions,this._evaluator,e,t,n);return s?(this._processModuleReferences(s,s.lastModuleName,e),{edits:s.getEdits(),fileOperations:[]}):void 0}))}moveSymbolAtPosition(e,t,n,s,i){return this._runEvaluatorWithCancellationToken(i,(()=>{var r,o;const p=(0,g.getFileExtension)(e),d=(0,g.getFileExtension)(t);if(p.toLowerCase()!==d.toLowerCase())return;const u=this.getSourceFileInfo(e);if(!u)return;const y=this.getBoundSourceFileInfo(t);if(u===y)return;this._bindFile(u);const m=u.sourceFile.getParseResults();if(!m)return;const f=(0,h.convertPositionToOffset)(n,m.tokenizerOutput.lines);if(void 0===f)return;const I=(0,R.findNodeByOffset)(m.parseTree,f);if(void 0===I)return;if(38!==I.nodeType||!N.RenameModuleProvider.canMoveSymbol(this._configOptions,this._evaluator,I))return;const C=this._configOptions.findExecEnvironment(e),S=D.DocumentSymbolCollector.getDeclarationsForNode(I,this._evaluator,!1,D.DocumentSymbolCollectorUseCase.Rename,i,this._createSourceMapper(C,i,u)),x=N.RenameModuleProvider.createForSymbol(this._importResolver,this._configOptions,this._evaluator,e,t,S,i);if(!x)return;this._processModuleReferences(x,I.value,e);const A=x.declarations.find((e=>e.node&&(0,g.getFileExtension)(e.path)===p));if(!A)return;const k=N.RenameModuleProvider.getSymbolTextRange(m,A),w=new F.ImportAdder(this._configOptions,this._importResolver,this._evaluator),M=w.collectImportsForSymbolsUsed(m,k,i);let O=0,L=0;const V=null==y?void 0:y.sourceFile.getParseResults();if(V){const e=x.tryGetFirstSymbolUsage(V);if(O=(0,P.getInsertionPointForSymbolUnderModule)(this._evaluator,V,I.value,{symbolDeclToIgnore:A.path,insertBefore:e}),void 0===O)return;L=(0,E.getModuleStatementIndentation)(V)}const U=(0,E.reindentSpan)(m,k,L),z=N.RenameModuleProvider.getSymbolFullStatementTextRange(m,A);x.textEditTracker.addEdit(e,(0,h.convertTextRangeToRange)(v.TextRange.combine([U.originalSpan,z]),m.tokenizerOutput.lines),"");const B=[];let G=U.text;if(V){const e=(0,h.convertTextRangeToRange)({start:O,length:0},V.tokenizerOutput.lines),n=function(e,t){if(0===t.line&&0===t.character)return 0;const n=t.line>0&&(0,R.isBlankLine)(e,t.line-1)?t.line>1&&(0,R.isBlankLine)(e,t.line-2)?0:1:2;return 0!==t.character?n+1:n}(V,e.end);G="\n".repeat(n)+G,x.textEditTracker.addEdit(t,e,G)}else B.push({kind:"create",filePath:t}),x.textEditTracker.addEdit(t,(0,v.getEmptyRange)(),G);const W=this.clone();let j=x.getEdits();const $=(0,b.applyTextEditsToString)(j.filter((e=>e.filePath===t)),null!==(r=null==V?void 0:V.tokenizerOutput.lines)&&void 0!==r?r:new _.TextRangeCollection([]),null!==(o=null==y?void 0:y.sourceFile.getFileContent())&&void 0!==o?o:"");a(W,t,$);const q=function(e,t,n,i,a){const r=e.getBoundSourceFile(t),o=null==r?void 0:r.getParseResults();if(!o)return;const l=w.applyImports(n,t,o,i,s.importFormat,a);return(0,b.applyTextEditsToString)(l,o.tokenizerOutput.lines,r.getFileContent())}(W,t,M,O,i);j=Y(j,t,V,$,q);const K=(0,b.applyTextEditsToString)(j.filter((t=>t.filePath===e)),m.tokenizerOutput.lines,u.sourceFile.getFileContent());a(W,e,K);const H=function e(t,n,s,i,r){var o;(0,l.throwIfCancellationRequested)(r),t.analyzeFile(n,r);const p=t.getBoundSourceFile(n),d=null==p?void 0:p.getParseResults();if(!d)return;const u=new T.TextEditTracker;for(const e of t.getDiagnosticsForRange(n,(0,h.convertTextRangeToRange)(d.parseTree,d.tokenizerOutput.lines)).filter((e=>{var t;return 3===e.category&&(null===(t=e.getActions())||void 0===t?void 0:t.some((e=>"pyright.unusedImport"===e.action)))}))){const t=(0,R.findNodeByPosition)(d.parseTree,e.range.start,d.tokenizerOutput.lines);if(38!==(null==t?void 0:t.nodeType))continue;const n=37===(null===(o=t.parent)||void 0===o?void 0:o.nodeType)?t.parent.nameParts:[t];for(const[e,i]of s.declarations){if(e.node&&v.TextRange.containsRange(e.node,t)){u.removeNodes({node:t,parseResults:d});break}const s=(0,R.getDottedName)((0,R.getDottedNameWithGivenNodeAsLastName)(i[0]));if(s&&(0,c.arrayEquals)(n,s,((e,t)=>e.value===t.value))){u.removeNodes({node:t,parseResults:d});break}}}const y=p.getFileContent(),m=(0,b.applyTextEditsToString)(u.getEdits(r).filter((e=>e.filePath===n)),d.tokenizerOutput.lines,y);return i>10||y===m?m:(a(t,n,m),e(t,n,s,i+1,r))}(W,e,M,0,i);return j=Y(j,e,m,K,H),W.dispose(),{edits:j,fileOperations:B};function Y(e,t,n,s,i){return void 0===i||s===i||(e=e.filter((e=>e.filePath!==t))).push({filePath:t,range:n?(0,h.convertTextRangeToRange)(n.parseTree,n.tokenizerOutput.lines):(0,v.getEmptyRange)(),replacementText:i}),e}}));function a(e,t,n){var s,i;const a=e.getSourceFileInfo(t),r=a?(null!==(s=a.sourceFile.getClientVersion())&&void 0!==s?s:0)+1:0,o=a?null===(i=a.chainedSourceFile)||void 0===i?void 0:i.sourceFile.getFilePath():void 0,l=a?a.sourceFile.getIPythonMode():L.IPythonMode.None,c=!a||a.isTracked,p=a?a.sourceFile.getRealFilePath():t;e.setFileOpened(t,r,[{text:n}],{chainedFilePath:o,ipythonMode:l,isTracked:c,realFilePath:p})}}clone(){var e;const t=new j(this._importResolver,this._configOptions,this._console,new m.LogTracker(this._console,"Cloned")),n=this.getUserFiles();t.setTrackedFiles(n.map((e=>e.sourceFile.getFilePath()))),t.markAllFilesDirty(!0);for(const n of this.getOpened()){const s=n.sourceFile.getClientVersion();void 0!==s&&t.setFileOpened(n.sourceFile.getFilePath(),s,[{text:n.sourceFile.getOpenFileContents()}],{chainedFilePath:null===(e=n.chainedSourceFile)||void 0===e?void 0:e.sourceFile.getFilePath(),ipythonMode:n.sourceFile.getIPythonMode(),isTracked:n.isTracked,realFilePath:n.sourceFile.getRealFilePath()})}return t}canRenameSymbolAtPosition(e,t,n,s,i){return this._runEvaluatorWithCancellationToken(i,(()=>{const a=this.getSourceFileInfo(e);if(!a)return;this._bindFile(a);const r=this._getReferenceResult(a,e,t,s,i);if(!r)return;if(r.containsOnlyImportDecls&&!this._supportRenameModule(r.declarations,n))return;if("none"===this._getRenameSymbolMode(a,r,n))return;const o=a.sourceFile.getParseResults();return{range:(0,h.convertTextRangeToRange)(r.nodeAtOffset,o.tokenizerOutput.lines),declarations:r.declarations}}))}renameSymbolAtPosition(e,t,n,s,i,a){return this._runEvaluatorWithCancellationToken(a,(()=>{var r;const o=this.getSourceFileInfo(e);if(!o)return;this._bindFile(o);const l=this._getReferenceResult(o,e,t,i,a);if(!l)return;if(l.containsOnlyImportDecls){if(!this._supportRenameModule(l.declarations,s))return;const t=N.RenameModuleProvider.getRenameModulePathInfo(N.RenameModuleProvider.getRenameModulePath(l.declarations),n);if(!t)return;const i=this.renameModule(t.filePath,t.newFilePath,a);if(null==i||i.fileOperations.push({kind:"rename",oldFilePath:t.filePath,newFilePath:t.newFilePath}),(0,U.isStubFile)(t.filePath)){const s=this._importResolver.getSourceFilesFromStub(t.filePath,this._configOptions.findExecEnvironment(e),!1);for(const e of s){const t=N.RenameModuleProvider.getRenameModulePathInfo(e,n);t&&(null==i||i.fileOperations.push({kind:"rename",oldFilePath:t.filePath,newFilePath:t.newFilePath}))}}return i}const c=this._getRenameSymbolMode(o,l,s);switch(c){case"singleFileMode":o.sourceFile.addReferences(l,!0,this._evaluator,a);break;case"multiFileMode":for(const e of this._sourceFileList){if((0,V.isUserCode)(e)){const t=null!==(r=e.sourceFile.getFileContent())&&void 0!==r?r:"";if(!l.symbolNames.some((e=>t.search(e)>=0)))continue;this._bindFile(e,t),e.sourceFile.addReferences(l,!0,this._evaluator,a)}this._handleMemoryHighUsage()}break;case"none":return;default:(0,u.assertNever)(c)}const p=[];return l.locations.forEach((e=>{p.push({filePath:e.path,range:e.range,replacementText:n})})),{edits:p,fileOperations:[]}}))}getCallForPosition(e,t,n){const s=this.getSourceFileInfo(e);if(!s)return;this._bindFile(s);const i=this._configOptions.findExecEnvironment(e),a=s.sourceFile.getDeclarationForPosition(this._createSourceMapper(i,n,s),t,this._evaluator,void 0,D.DocumentSymbolCollectorUseCase.Reference,n);if(!a||0===a.declarations.length)return;const{targetDecl:r,callItemUri:o,symbolName:l}=S.CallHierarchyProvider.getTargetDeclaration(a,e);return S.CallHierarchyProvider.getCallForDeclaration(l,r,this._evaluator,n,o)}getIncomingCallsForPosition(e,t,n){const s=this.getSourceFileInfo(e);if(!s)return;this._bindFile(s);const i=this._configOptions.findExecEnvironment(e),a=s.sourceFile.getDeclarationForPosition(this._createSourceMapper(i,n,s),t,this._evaluator,void 0,D.DocumentSymbolCollectorUseCase.Reference,n);if(!a||0===a.declarations.length)return;const{targetDecl:r,symbolName:o}=S.CallHierarchyProvider.getTargetDeclaration(a,e);let l=[];const c=8===r.type?[s]:this._sourceFileList;for(const e of c)if((0,V.isUserCode)(e)||e.isOpenByClient){this._bindFile(e);const t=S.CallHierarchyProvider.getIncomingCallsForDeclaration(e.sourceFile.getFilePath(),o,r,e.sourceFile.getParseResults(),this._evaluator,n);t&&(l=l.concat(...t)),this._handleMemoryHighUsage()}return l}getOutgoingCallsForPosition(e,t,n){const s=this.getSourceFileInfo(e);if(!s)return;this._bindFile(s);const i=this._configOptions.findExecEnvironment(e),a=s.sourceFile.getDeclarationForPosition(this._createSourceMapper(i,n,s),t,this._evaluator,void 0,D.DocumentSymbolCollectorUseCase.Reference,n);if(!a||0===a.declarations.length)return;const{targetDecl:r}=S.CallHierarchyProvider.getTargetDeclaration(a,e);return S.CallHierarchyProvider.getOutgoingCallsForDeclaration(r,s.sourceFile.getParseResults(),this._evaluator,n)}performQuickAction(e,t,n,s){const i=this.getSourceFileInfo(e);if(i)return this._bindFile(i),i.sourceFile.performQuickAction(t,n,s)}getCacheUsage(){const e=this._evaluator.getTypeCacheEntryCount()/75e4,t=this._parsedFileCount/1e3;return Math.max(e,t)}emptyCache(){this._createNewEvaluator(),this._discardCachedParseResults(),this._parsedFileCount=0,y.Extensions.getProgramExtensions(this.rootPath).forEach((e=>e.clearCache?e.clearCache():null))}test_createSourceMapper(e,t){return this._createSourceMapper(e,r.CancellationToken.None,t,!1)}_getRenameSymbolMode(e,t,n){const s=(0,V.isUserCode)(e);return n||s&&!t.requiresGlobalSearch||!s&&e.isOpenByClient&&t.declarations.every((t=>this.getSourceFileInfo(t.path)===e))?"singleFileMode":t.declarations.every((e=>(0,V.isUserCode)(this.getSourceFileInfo(e.path))))?"multiFileMode":"none"}_supportRenameModule(e,t){return!t&&e.every((e=>(0,V.isUserCode)(this.getSourceFileInfo(e.path))))}_getReferenceResult(e,t,n,s,i){const a=this._configOptions.findExecEnvironment(t),r=this._getDeclarationForPosition(e,n,D.DocumentSymbolCollectorUseCase.Rename,this._createSourceMapper(a,i),i);if(r){if(s&&r.containsOnlyImportDecls)return r;if(0!==r.nonImportDeclarations.length)return new A.ReferencesResult(r.requiresGlobalSearch,r.nodeAtOffset,r.symbolNames,r.nonImportDeclarations,r.useCase)}}_getDeclarationForPosition(e,t,n,s,i,a){return e.sourceFile.getDeclarationForPosition(s,t,this._evaluator,a,n,i,Array.from((0,V.collectImportedByFiles)(e)).map((e=>e.sourceFile)))}_processModuleReferences(e,t,n){var s;for(const i of this._sourceFileList){if(!(0,V.isUserCode)(i))continue;const a=i.sourceFile.getFilePath(),r=null!==(s=i.sourceFile.getFileContent())&&void 0!==s?s:"";if(a!==n&&r.indexOf(t)<0)continue;this._bindFile(i,r);const o=i.sourceFile.getParseResults();o&&(e.renameReferences(o),this._handleMemoryHighUsage())}}_handleMemoryHighUsage(){}_discardCachedParseResults(){for(const e of this._sourceFileList)e.sourceFile.dropParseAndBindInfo()}_runEvaluatorWithCancellationToken(e,t){try{return e?this._evaluator.runWithCancellationToken(e,t):t()}catch(e){throw l.OperationCanceledException.is(e)||this._createNewEvaluator(),e}}_removeUnneededFiles(){const e=[];for(let t=0;t<this._sourceFileList.length;){const n=this._sourceFileList[t];this._isFileNeeded(n)?(this._shouldCheckFile(n)||void 0===n.diagnosticsVersion||(e.push({filePath:n.sourceFile.getFilePath(),version:n.sourceFile.getClientVersion(),diagnostics:[]}),n.diagnosticsVersion=void 0),t++):(e.push({filePath:n.sourceFile.getFilePath(),version:n.sourceFile.getClientVersion(),diagnostics:[]}),n.sourceFile.prepareForClose(),this._removeSourceFileFromListAndMap(n.sourceFile.getFilePath(),t),n.imports.forEach((s=>{const i=s.importedBy.findIndex((e=>e===n));if(!(i<0||(s.importedBy.splice(i,1),this._isFileNeeded(s)))){const n=this._sourceFileList.findIndex((e=>e===s));n>=0&&n<t&&(e.push({filePath:s.sourceFile.getFilePath(),version:s.sourceFile.getClientVersion(),diagnostics:[]}),s.sourceFile.prepareForClose(),this._removeSourceFileFromListAndMap(s.sourceFile.getFilePath(),n),t--)}})),n.shadowedBy.forEach((e=>{e.shadows=e.shadows.filter((e=>e!==n))})),n.shadowedBy=[])}return e}_isFileNeeded(e){return!e.sourceFile.isFileDeleted()&&(!(!e.isTracked&&!e.isOpenByClient)||e.shadows.length>0||0!==e.importedBy.length&&this._isImportNeededRecursive(e,new Set))}_isImportNeededRecursive(e,t){if(e.isTracked||e.isOpenByClient||e.shadows.length>0)return!0;const n=(0,g.normalizePathCase)(this._fs,e.sourceFile.getFilePath());if(t.has(n))return!1;t.add(n);for(const n of e.importedBy)if(this._isImportNeededRecursive(n,t))return!0;return!1}_createSourceMapper(e,t,n,s,i){return new U.SourceMapper(this._importResolver,e,this._evaluator,((e,t)=>{let n=this.getSourceFileInfo(e);return n||(n=this.addInterimFile(e)),this._addShadowedFile(n,t),this.getBoundSourceFile(t)}),(e=>{let t=this.getBoundSourceFileInfo(e);return t||(t=this.addInterimFile(e),this._parseFile(t,void 0,!0)),t}),null!=s&&s,null!=i&&i,n,t)}_isImportAllowed(e,t,n){if(t.isNativeLib)return!1;let s=this._configOptions.useLibraryCodeForTypes||1===t.importType&&!!t.pyTypedInfo||2===t.importType&&e.isThirdPartyPyTypedPresent;return!((1===t.importType||e.isThirdPartyImport&&2===t.importType)&&(this._allowedThirdPartyImports?(t.isRelative||this._allowedThirdPartyImports.some((e=>t.importName===e||!!t.importName.startsWith(e+"."))))&&(s=!0):(e.isThirdPartyImport&&this._configOptions.useLibraryCodeForTypes||t.isNamespacePackage&&t.filteredImplicitImports.some((e=>!!e.pyTypedInfo)))&&(s=!0),!n))||s}_updateSourceFileImports(e,t){const n=[],s=e.sourceFile.getImports(),i=t=>{let n=!1,s=!1;return 1===t.importType?(n=!0,t.pyTypedInfo&&(s=!0)):e.isThirdPartyImport&&2===t.importType&&(n=!0,e.isThirdPartyPyTypedPresent&&(s=!0)),{isThirdPartyImport:n,isPyTypedPresent:s}},a=new Map;if(e.chainedSourceFile)if(e.chainedSourceFile.sourceFile.isFileDeleted())e.chainedSourceFile=void 0;else{const t=e.chainedSourceFile.sourceFile.getFilePath();a.set((0,g.normalizePathCase)(this._fs,t),{path:t,isTypeshedFile:!1,isThirdPartyImport:!1,isPyTypedPresent:!1})}s.forEach((n=>{if(n.isImportFound){if(this._isImportAllowed(e,n,n.isStubFile)&&n.resolvedPaths.length>0){const e=n.resolvedPaths[n.resolvedPaths.length-1];if(e){const t=i(n);a.set((0,g.normalizePathCase)(this._fs,e),{path:e,isTypeshedFile:!!n.isStdlibTypeshedFile||!!n.isThirdPartyTypeshedFile,isThirdPartyImport:t.isThirdPartyImport,isPyTypedPresent:t.isPyTypedPresent})}}n.filteredImplicitImports.forEach((t=>{if(this._isImportAllowed(e,n,t.isStubFile)&&!t.isNativeLib){const e=i(n);a.set((0,g.normalizePathCase)(this._fs,t.path),{path:t.path,isTypeshedFile:!!n.isStdlibTypeshedFile||!!n.isThirdPartyTypeshedFile,isThirdPartyImport:e.isThirdPartyImport,isPyTypedPresent:e.isPyTypedPresent})}})),n.nonStubImportResult&&!n.nonStubImportResult.isImportFound&&(e.sourceFile.isStubFile()||n.isStdlibTypeshedFile||t.verboseOutput&&(this._console.info(`Could not resolve source for '${n.importName}' in file '${e.sourceFile.getFilePath()}'`),n.nonStubImportResult.importFailureInfo&&n.nonStubImportResult.importFailureInfo.forEach((e=>{this._console.info(`  ${e}`)}))))}else t.verboseOutput&&(this._console.info(`Could not import '${n.importName}' in file '${e.sourceFile.getFilePath()}'`),n.importFailureInfo&&n.importFailureInfo.forEach((e=>{this._console.info(`  ${e}`)})))}));const r=new Map;e.imports.forEach((t=>{const n=(0,g.normalizePathCase)(this._fs,t.sourceFile.getFilePath());a.has(n)?r.set(n,t):t.importedBy=t.importedBy.filter((t=>(0,g.normalizePathCase)(this._fs,t.sourceFile.getFilePath())!==(0,g.normalizePathCase)(this._fs,e.sourceFile.getFilePath())))})),a.forEach(((t,s)=>{if(!r.has(s)){let i=this.getSourceFileInfo(t.path);if(!i){const e=this._getImportNameForFile(t.path);i={sourceFile:new L.SourceFile(this._fs,t.path,e,t.isThirdPartyImport,t.isPyTypedPresent,this._console,this._logTracker),isTracked:!1,isOpenByClient:!1,isTypeshedFile:t.isTypeshedFile,isThirdPartyImport:t.isThirdPartyImport,isThirdPartyPyTypedPresent:t.isPyTypedPresent,diagnosticsVersion:void 0,imports:[],importedBy:[],shadows:[],shadowedBy:[]},this._addToSourceFileListAndMap(i),n.push(i)}i.importedBy.push(e),r.set(s,i)}})),e.imports=[],a.forEach(((t,n)=>{this.getSourceFileInfo(n)&&e.imports.push(this.getSourceFileInfo(n))})),e.builtinsImport=void 0;const o=e.sourceFile.getBuiltinsImport();if(o&&o.isImportFound){const t=o.resolvedPaths[o.resolvedPaths.length-1];e.builtinsImport=this.getSourceFileInfo(t)}e.ipythonDisplayImport=void 0;const l=e.sourceFile.getIPythonDisplayImport();if(l&&l.isImportFound){const t=l.resolvedPaths[l.resolvedPaths.length-1];e.ipythonDisplayImport=this.getSourceFileInfo(t)}return n}_removeSourceFileFromListAndMap(e,t){this._sourceFileMap.delete((0,g.normalizePathCase)(this._fs,e)),this._sourceFileList.splice(t,1)}_addToSourceFileListAndMap(e){const t=(0,g.normalizePathCase)(this._fs,e.sourceFile.getFilePath());(0,u.assert)(!this._sourceFileMap.has(t)),this._sourceFileList.push(e),this._sourceFileMap.set(t,e)}}t.Program=j,j._nextId=0},9335:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.assignProperty=t.clonePropertyWithDeleter=t.clonePropertyWithSetter=t.createProperty=t.validatePropertyMethod=void 0;const s=n(1290),i=n(9744),a=n(9866),r=n(563),o=n(8494),l=n(817),c=n(1133),p=n(5168);function d(e,t,n){const s=t.details.fields,i=c.FunctionType.createSynthesizedInstance("__get__",256);c.FunctionType.addParameter(i,{category:0,name:"self",type:c.AnyType.create(),hasDeclaredType:!0}),c.FunctionType.addParameter(i,{category:0,name:"obj",type:c.NoneType.createInstance(),hasDeclaredType:!0}),c.FunctionType.addParameter(i,{category:0,name:"objtype",type:c.AnyType.create(),hasDeclaredType:!0,hasDefault:!0,defaultType:c.AnyType.create()}),i.details.declaredReturnType=c.FunctionType.isClassMethod(n)?c.FunctionType.getSpecializedReturnType(n):t,i.details.declaration=n.details.declaration,i.details.typeVarScopeId=(0,p.getTypeVarScopeId)(n);const a=c.FunctionType.createSynthesizedInstance("__get__",256);c.FunctionType.addParameter(a,{category:0,name:"self",type:c.AnyType.create(),hasDeclaredType:!0});const r=n.details.parameters.length>0?n.details.parameters[0].type:c.AnyType.create();c.FunctionType.addParameter(a,{category:0,name:"obj",type:r,hasDeclaredType:!0}),c.FunctionType.addParameter(a,{category:0,name:"objtype",type:c.AnyType.create(),hasDeclaredType:!0,hasDefault:!0,defaultType:c.AnyType.create()}),a.details.declaredReturnType=c.FunctionType.getSpecializedReturnType(n),a.details.declaration=n.details.declaration,a.details.typeVarScopeId=(0,p.getTypeVarScopeId)(n);const o=c.OverloadedFunctionType.create([a,i]),d=l.Symbol.createWithType(4,o);s.set("__get__",d)}function u(e,t,n){const s=t.details.fields,i=c.FunctionType.createSynthesizedInstance("__set__");c.FunctionType.addParameter(i,{category:0,name:"self",type:c.AnyType.create(),hasDeclaredType:!0});let a=n.details.parameters.length>0?n.details.parameters[0].type:c.AnyType.create();(0,c.isTypeVar)(a)&&a.details.isSynthesizedSelf&&(a=e.makeTopLevelTypeVarsConcrete(a)),c.FunctionType.addParameter(i,{category:0,name:"obj",type:(0,c.combineTypes)([a,c.NoneType.createInstance()]),hasDeclaredType:!0}),i.details.declaredReturnType=c.NoneType.createInstance(),i.details.typeVarScopeId=(0,p.getTypeVarScopeId)(n);let r=c.UnknownType.create();n.details.parameters.length>=2&&0===n.details.parameters[1].category&&n.details.parameters[1].name&&(r=n.details.parameters[1].type),c.FunctionType.addParameter(i,{category:0,name:"value",type:r,hasDeclaredType:!0});const o=l.Symbol.createWithType(4,i);s.set("__set__",o)}function y(e,t,n){const s=t.details.fields,i=c.FunctionType.createSynthesizedInstance("__delete__");c.FunctionType.addParameter(i,{category:0,name:"self",type:c.AnyType.create(),hasDeclaredType:!0}),i.details.typeVarScopeId=(0,p.getTypeVarScopeId)(n);let a=n.details.parameters.length>0?n.details.parameters[0].type:c.AnyType.create();(0,c.isTypeVar)(a)&&a.details.isSynthesizedSelf&&(a=e.makeTopLevelTypeVarsConcrete(a)),c.FunctionType.addParameter(i,{category:0,name:"obj",type:(0,c.combineTypes)([a,c.NoneType.createInstance()]),hasDeclaredType:!0}),i.details.declaredReturnType=c.NoneType.createInstance();const r=l.Symbol.createWithType(4,i);s.set("__delete__",r)}function m(e,t){const n=t.details.fields,s=n.get("fget"),i=null==s?void 0:s.getSynthesizedType();i&&(0,c.isFunction)(i)&&d(0,t,i);const a=n.get("fset"),r=null==a?void 0:a.getSynthesizedType();r&&(0,c.isFunction)(r)&&u(e,t,r);const o=n.get("fdel"),l=null==o?void 0:o.getSynthesizedType();l&&(0,c.isFunction)(l)&&y(e,t,l)}function g(e){const t=e.details.fields;["getter","setter","deleter"].forEach((n=>{const s=c.FunctionType.createSynthesizedInstance(n);c.FunctionType.addParameter(s,{category:0,name:"self",type:c.AnyType.create(),hasDeclaredType:!0}),c.FunctionType.addParameter(s,{category:0,name:"accessor",type:c.AnyType.create(),hasDeclaredType:!0}),s.details.declaredReturnType=e;const i=l.Symbol.createWithType(4,s);t.set(n,i)}))}t.validatePropertyMethod=function(e,t,n){c.FunctionType.isStaticMethod(t)&&e.addDiagnostic((0,r.getFileInfo)(n).diagnosticRuleSet.reportGeneralTypeIssues,i.DiagnosticRule.reportGeneralTypeIssues,a.Localizer.Diagnostic.propertyStaticMethod(),n)},t.createProperty=function(e,t,n,s){const i=(0,r.getFileInfo)(t),a=e.getBuiltInType(t,"type"),u=c.ClassType.isBuiltIn(n,"property")?(0,o.getTypeSourceId)(t):n.details.typeSourceId,y=c.ClassType.createInstantiable(n.details.name,(0,o.getClassFullName)(t,i.moduleName,`__property_${s.details.name}`),i.moduleName,i.filePath,2049,u,void 0,(0,c.isInstantiableClass)(a)?a:c.UnknownType.create());y.details.typeVarScopeId=n.details.typeVarScopeId;const h=e.getBuiltInType(t,"object");y.details.baseClasses.push((0,c.isInstantiableClass)(h)?h:c.UnknownType.create()),(0,p.computeMroLinearization)(y);const f=y.details.fields;n.details.fields.forEach(((e,t)=>{e.isIgnoredForProtocolMatch()||["__get__","__set__","__delete__","fget","fset","fdel"].some((e=>e===t))||f.set(t,e)}));const T=c.ClassType.cloneAsInstance(y);y.isAsymmetricDescriptor=!1,m(e,T);const v=l.Symbol.createWithType(4,c.FunctionType.cloneWithNewFlags(s,4|s.details.flags));return f.set("fget",v),c.FunctionType.isClassMethod(s)&&(y.details.flags|=4194304),d(0,T,s),g(T),T},t.clonePropertyWithSetter=function(e,t,n,d){if(!(0,p.isProperty)(t))return t;const y=t,h=y.details.flags;let f=!!y.isAsymmetricDescriptor;const T=(0,r.getFileInfo)(d);if(d.parameters.length>=2){const t=(0,o.getTypeAnnotationForParameter)(d,1);if(t){const n=e.getGetterTypeFromProperty(y,!1);if(n&&!(0,c.isAnyOrUnknown)(n)){const r=e.getTypeOfAnnotation(t,{associateTypeVarsWithScope:!0});if("none"!==T.diagnosticRuleSet.reportPropertyTypeMismatch){const o=new s.DiagnosticAddendum;e.assignType(n,r,o)||e.addDiagnostic(T.diagnosticRuleSet.reportPropertyTypeMismatch,i.DiagnosticRule.reportPropertyTypeMismatch,a.Localizer.Diagnostic.setterGetterTypeMismatch()+o.getString(),t)}(0,c.isTypeSame)(n,r)||(f=!0)}}}const v=c.ClassType.createInstantiable(y.details.name,y.details.fullName,y.details.moduleName,(0,r.getFileInfo)(d).filePath,h,y.details.typeSourceId,y.details.declaredMetaclass,y.details.effectiveMetaclass);v.details.typeVarScopeId=y.details.typeVarScopeId;const _=e.getBuiltInType(d,"object");v.details.baseClasses.push((0,c.isInstantiableClass)(_)?_:c.UnknownType.create()),(0,p.computeMroLinearization)(v),v.isAsymmetricDescriptor=f;const I=c.ClassType.cloneAsInstance(v),b=v.details.fields;y.details.fields.forEach(((e,t)=>{e.isIgnoredForProtocolMatch()||b.set(t,e)})),m(e,I);const C=l.Symbol.createWithType(4,c.FunctionType.cloneWithNewFlags(n,4|n.details.flags));return b.set("fset",C),u(e,I,n),g(I),I},t.clonePropertyWithDeleter=function(e,t,n,s){var i;if(!(0,p.isProperty)(t))return t;const a=t,o=c.ClassType.createInstantiable(a.details.name,a.details.fullName,a.details.moduleName,(0,r.getFileInfo)(s).filePath,a.details.flags,a.details.typeSourceId,a.details.declaredMetaclass,a.details.effectiveMetaclass);o.details.typeVarScopeId=a.details.typeVarScopeId;const d=e.getBuiltInType(s,"object");o.details.baseClasses.push((0,c.isInstantiableClass)(d)?d:c.UnknownType.create()),(0,p.computeMroLinearization)(o);const u=c.ClassType.cloneAsInstance(o);o.isAsymmetricDescriptor=null!==(i=a.isAsymmetricDescriptor)&&void 0!==i&&i;const h=o.details.fields;a.details.fields.forEach(((e,t)=>{e.isIgnoredForProtocolMatch()||h.set(t,e)})),m(e,u);const f=l.Symbol.createWithType(4,c.FunctionType.cloneWithNewFlags(n,4|n.details.flags));return h.set("fdel",f),y(e,u,n),g(u),u},t.assignProperty=function(e,t,n,s,i,r,o,l,d=0){const u=c.ClassType.cloneAsInstance(i),y=c.ClassType.cloneAsInstance(s);let m=!0;return[{name:"fget",missingDiagMsg:a.Localizer.DiagnosticAddendum.missingGetter,incompatibleDiagMsg:a.Localizer.DiagnosticAddendum.incompatibleGetter},{name:"fset",missingDiagMsg:a.Localizer.DiagnosticAddendum.missingSetter,incompatibleDiagMsg:a.Localizer.DiagnosticAddendum.incompatibleSetter},{name:"fdel",missingDiagMsg:a.Localizer.DiagnosticAddendum.missingDeleter,incompatibleDiagMsg:a.Localizer.DiagnosticAddendum.incompatibleDeleter}].forEach((a=>{var g,h;const f=t.details.fields.get(a.name);let T=f?null===(g=e.getDeclaredTypeOfSymbol(f))||void 0===g?void 0:g.type:void 0;if(T&&(0,c.isFunction)(T)){const t=n.details.fields.get(a.name);let g=t?null===(h=e.getDeclaredTypeOfSymbol(t))||void 0===h?void 0:h.type:void 0;if(!g||!(0,c.isFunction)(g))return null==r||r.addMessage(a.missingDiagMsg()),void(m=!1);e.inferReturnTypeIfNecessary(g),g=(0,p.partiallySpecializeType)(g,i),e.inferReturnTypeIfNecessary(T),T=(0,p.partiallySpecializeType)(T,s),l&&(T=(0,p.applySolvedTypeVars)(T,l)),T=c.FunctionType.cloneWithNewFlags(T,-5&T.details.flags),g=c.FunctionType.cloneWithNewFlags(g,-5&g.details.flags);const f=e.bindFunctionToClassOrObject(y,T,void 0,void 0,d),v=e.bindFunctionToClassOrObject(u,g,void 0,void 0,d);f&&v&&e.assignType(f,v,r,o,void 0,0,d)||(m=!1)}})),m}},4124:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.assignModuleToProtocol=t.assignClassToProtocol=void 0;const s=n(9866),i=n(9335),a=n(1133),r=n(5168),o=n(4447),l=[];t.assignClassToProtocol=function(e,t,n,c,p,d,u,y,m){var g;const h=0!=(1&u);if(m>a.maxTypeRecursionCount)return!0;if(m++,l.some((e=>(0,a.isTypeSame)(e.srcType,n)&&(0,a.isTypeSame)(e.destType,t))))return!h;if(!h&&!y&&0===t.details.typeParameters.length&&0===n.details.typeParameters.length&&(null===(g=n.details.compatibleProtocols)||void 0===g?void 0:g.has(t.details.fullName)))return!0;l.push({srcType:n,destType:t});let f=!0;try{f=function(e,t,n,l,c,p,d,u,y){if(0!=(1&d))return(0,a.isTypeSame)(t,n);const m=a.ClassType.cloneForSpecialization(t,void 0,!1),g=new o.TypeVarContext((0,r.getTypeVarScopeId)(t)),h=new o.TypeVarContext((0,r.getTypeVarScopeId)(t)),f=e.stripLiteralValue(n);if((0,r.populateTypeVarContextForSelfType)(h,t,f),a.ClassType.isTypedDictClass(n)){const t=e.getTypedDictClassType();t&&(0,a.isInstantiableClass)(t)&&(n=t)}let T=!0;const v=new Set,_=(0,r.buildTypeVarContextFromSpecializedClass)(n);let I=16&d;if(I|=(0,r.containsLiteralType)(n,!0)?128:0,t.details.mro.forEach((o=>{(0,a.isInstantiableClass)(o)&&a.ClassType.isProtocolClass(o)&&(T||l)&&o.details.fields.forEach(((c,p)=>{var d;if((T||l)&&c.isClassMember()&&!c.isIgnoredForProtocolMatch()&&!v.has(p)){let m,b=!1;if(!u&&"__class_getitem__"===p)return;if("__slots__"===p)return;if(v.add(p),u&&n.details.effectiveMetaclass&&(0,a.isInstantiableClass)(n.details.effectiveMetaclass)&&(m=(0,r.lookUpClassMember)(n.details.effectiveMetaclass,p),m&&(_.addSolveForScope((0,r.getTypeVarScopeId)(n.details.effectiveMetaclass)),b=!0)),m||(m=(0,r.lookUpClassMember)(n,p)),m){let v=null===(d=e.getDeclaredTypeOfSymbol(c))||void 0===d?void 0:d.type;if(v){let d;if(a.ClassType.isSameGenericClass(o,t)||(v=(0,r.partiallySpecializeType)(v,o)),(0,a.isInstantiableClass)(m.classType)){const t=e.getEffectiveTypeOfSymbol(m.symbol);(0,a.isFunction)(t)&&e.inferReturnTypeIfNecessary(t),d=(0,r.partiallySpecializeType)(t,m.classType,f)}else d=a.UnknownType.create();if((0,a.isFunction)(d)||(0,a.isOverloadedFunction)(d)){if(b){const t=e.bindFunctionToClassOrObject(a.ClassType.cloneAsInstance(n),d,void 0,void 0,y,!1,n);if(t&&(d=(0,r.removeParamSpecVariadicsFromSignature)(t)),(0,a.isFunction)(v)||(0,a.isOverloadedFunction)(v)){const t=e.bindFunctionToClassOrObject(a.ClassType.cloneAsInstance(n),v,void 0,void 0,y,!1,n);t&&(v=(0,r.removeParamSpecVariadicsFromSignature)(t))}}else if((0,a.isInstantiableClass)(m.classType)){v=(0,r.applySolvedTypeVars)(v,h);const t=e.bindFunctionToClassOrObject(u?n:a.ClassType.cloneAsInstance(n),d,m.classType,void 0,y);if(t&&(d=(0,r.removeParamSpecVariadicsFromSignature)(t)),(0,a.isFunction)(v)||(0,a.isOverloadedFunction)(v)){const t=e.bindFunctionToClassOrObject(a.ClassType.cloneAsInstance(n),v,m.classType,void 0,y);t&&(v=(0,r.removeParamSpecVariadicsFromSignature)(t))}}}else v=(0,r.applySolvedTypeVars)(v,h);const _=null==l?void 0:l.createAddendum();if((0,a.isClassInstance)(v)&&a.ClassType.isPropertyClass(v))if((0,a.isClassInstance)(d)&&a.ClassType.isPropertyClass(d)&&!u)(0,i.assignProperty)(e,a.ClassType.cloneAsInstantiable(v),a.ClassType.cloneAsInstantiable(d),o,n,null==_?void 0:_.createAddendum(),g,h,y)||(_&&_.addMessage(s.Localizer.DiagnosticAddendum.memberTypeMismatch().format({name:p})),T=!1);else{const t=e.getGetterTypeFromProperty(v,!0);t&&e.assignType(t,d,null==_?void 0:_.createAddendum(),g,void 0,I,y)||(_&&_.addMessage(s.Localizer.DiagnosticAddendum.memberTypeMismatch().format({name:p})),T=!1)}else{const t=c.getDeclarations()[0],n=1===(null==t?void 0:t.type)&&!t.isFinal;e.assignType(v,d,null==_?void 0:_.createAddendum(),g,void 0,n?1|I:I,y)||(_&&(n&&_.addMessage(s.Localizer.DiagnosticAddendum.memberIsInvariant().format({name:p})),_.addMessage(s.Localizer.DiagnosticAddendum.memberTypeMismatch().format({name:p}))),T=!1)}const C=c.getTypedDeclarations().some((e=>1===e.type&&!!e.isFinal));C!==m.symbol.getTypedDeclarations().some((e=>1===e.type&&!!e.isFinal))&&(C?_&&_.addMessage(s.Localizer.DiagnosticAddendum.memberIsFinalInProtocol().format({name:p})):_&&_.addMessage(s.Localizer.DiagnosticAddendum.memberIsNotFinalInProtocol().format({name:p})),T=!1)}c.isClassVar()&&!m.symbol.isClassVar()&&(null==l||l.addMessage(s.Localizer.DiagnosticAddendum.protocolMemberClassVar().format({name:p})),T=!1)}else null==l||l.addMessage(s.Localizer.DiagnosticAddendum.protocolMemberMissing().format({name:p})),T=!1}}))})),T&&t.details.typeParameters.length>0){const n=(0,r.applySolvedTypeVars)(m,g);if(t.typeArguments)e.verifyTypeArgumentsAssignable(t,n,l,c,p,d,y)||(T=!1);else if(c&&t.details.typeParameters.length>0&&n.typeArguments&&!c.isLocked()){const e=n.typeArguments;for(let n=0;n<t.details.typeParameters.length;n++){const s=n<e.length?e[n]:a.UnknownType.create();c.setTypeVarType(t.details.typeParameters[n],void 0,void 0,s)}}}return T}(e,t,n,c,p,d,u,y,m)}catch(e){throw l.pop(),e}return l.pop(),f&&!y&&0===t.details.typeParameters.length&&0===n.details.typeParameters.length&&(n.details.compatibleProtocols||(n.details.compatibleProtocols=new Set),n.details.compatibleProtocols.add(t.details.fullName)),f},t.assignModuleToProtocol=function(e,t,n,i,l,c,p){if(p>a.maxTypeRecursionCount)return!0;p++;let d=!0;const u=new Set,y=a.ClassType.cloneForSpecialization(t,void 0,!1),m=new o.TypeVarContext((0,r.getTypeVarScopeId)(t));if(t.details.mro.forEach((o=>{(0,a.isInstantiableClass)(o)&&a.ClassType.isProtocolClass(o)&&o.details.fields.forEach(((o,l)=>{var c;if(o.isClassMember()&&!o.isIgnoredForProtocolMatch()&&!u.has(l)){u.add(l);const y=n.fields.get(l);if(y){let n=null===(c=e.getDeclaredTypeOfSymbol(o))||void 0===c?void 0:c.type;if(n){n=(0,r.partiallySpecializeType)(n,t);const o=e.getEffectiveTypeOfSymbol(y);if(((0,a.isFunction)(o)||(0,a.isOverloadedFunction)(o))&&((0,a.isFunction)(n)||(0,a.isOverloadedFunction)(n))){const s=e.bindFunctionToClassOrObject(a.ClassType.cloneAsInstance(t),n,t,void 0,p);s&&(n=s)}const c=null==i?void 0:i.createAddendum();e.assignType(n,o,null==c?void 0:c.createAddendum(),m,void 0,0,p)||(c&&c.addMessage(s.Localizer.DiagnosticAddendum.memberTypeMismatch().format({name:l})),d=!1)}}else null==i||i.addMessage(s.Localizer.DiagnosticAddendum.protocolMemberMissing().format({name:l})),d=!1}}))})),d&&t.details.typeParameters.length>0&&t.typeArguments){const n=(0,r.applySolvedTypeVars)(y,m);e.verifyTypeArgumentsAssignable(t,n,i,l,void 0,c,p)||(d=!1)}return d}},1277:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPyTypedInfo=void 0;const s=n(6657);t.getPyTypedInfo=function(e,t){if(!e.existsSync(t)||!(0,s.isDirectory)(e,t))return;let n=!1;const i=(0,s.combinePaths)(t,"py.typed");if(!e.existsSync(t)||!(0,s.isFile)(e,i))return;const a=e.statSync(i);if(a.size>0&&a.size<65536){const t=e.readFileSync(i,"utf8");(t.match(/partial\n/)||t.match(/partial\r\n/))&&(n=!0)}return{pyTypedPath:i,isPartiallyTyped:n}}},1887:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getPathsFromPthFiles=t.isPythonBinary=t.findPythonSearchPaths=t.getTypeshedSubdirectory=t.getTypeShedFallbackPath=t.thirdPartyFolderName=t.stdLibFolderName=void 0;const r=n(2489),o=a(n(3188)),l=n(6657),c=n(6886);function p(e,t){const n=[];return e.readdirEntriesSync(t).filter((e=>(e.isFile()||e.isSymbolicLink())&&e.name.endsWith(".pth"))).sort(((e,t)=>(0,r.compareComparableValues)(e.name,t.name))).forEach((s=>{const i=(0,l.combinePaths)(t,s.name),a=(0,l.tryStat)(e,i);(null==a?void 0:a.isFile())&&a.size>0&&a.size<65536&&e.readFileSync(i,"utf8").split(/\r?\n/).forEach((s=>{const i=s.trim();if(i.length>0&&!i.startsWith("#")&&!i.match(/^import\s/)){const s=(0,l.combinePaths)(t,i);e.existsSync(s)&&(0,l.isDirectory)(e,s)&&n.push(s)}}))})),n}function d(e,t){return!e.some((e=>e===t))&&(e.push(t),!0)}t.stdLibFolderName="stdlib",t.thirdPartyFolderName="stubs",t.getTypeShedFallbackPath=function(e){let t=e.getModulePath();if(!t)return;t=(0,l.getDirectoryPath)((0,l.ensureTrailingDirectorySeparator)((0,l.normalizePath)(t)));const n=(0,l.combinePaths)(t,o.typeshedFallback);if(e.existsSync(n))return n;const s=(0,l.combinePaths)((0,l.getDirectoryPath)(t),o.typeshedFallback);return e.existsSync(s)?s:void 0},t.getTypeshedSubdirectory=function(e,n){return(0,l.combinePaths)(e,n?t.stdLibFolderName:t.thirdPartyFolderName)},t.findPythonSearchPaths=function(e,t,n,s,i,a){if(s.push("Finding python search paths"),void 0!==t.venvPath&&t.venv){const n=t.venv,i=(0,l.combinePaths)(t.venvPath,n),a=[],r=[];if([o.lib,o.lib64,o.libAlternate].forEach((n=>{const p=function(e,t,n,s){if(!e.existsSync(t))return void s.push(`Did not find '${t}'`);s.push(`Found path '${t}'; looking for ${o.sitePackages}`);const i=(0,l.combinePaths)(t,o.sitePackages);if(e.existsSync(i))return s.push(`Found path '${i}'`),i;s.push(`Did not find '${i}', so looking for python subdirectory`);const a=(0,l.getFileSystemEntries)(e,t).directories.filter((n=>{if(n.startsWith("python3.")){const s=(0,l.combinePaths)(t,n,o.sitePackages);return e.existsSync(s)}return!1}));if(n){const e=a.find((e=>e===`python${(0,c.versionToString)(n)}`));if(e){const n=(0,l.combinePaths)(t,e,o.sitePackages);return s.push(`Found path '${n}'`),n}}if(a.length>0){const e=(0,l.combinePaths)(t,a[0],o.sitePackages);return s.push(`Found path '${e}'`),e}}(e,(0,l.combinePaths)(i,n),t.defaultPythonVersion,s);p&&(d(a,p),r.push(p))})),r.forEach((t=>{p(e,t).forEach((e=>{d(a,e)}))})),a.length>0)return s.push(`Found the following '${o.sitePackages}' dirs`),a.forEach((e=>{s.push(`  ${e}`)})),a;s.push(`Did not find any '${o.sitePackages}' dirs. Falling back on python interpreter.`)}const r=n.getPythonSearchPaths(t.pythonPath,s);return i&&a?r.paths.filter((e=>!(0,l.containsPath)(a,e,!0)||(0,l.containsPath)(r.prefix,e,!0))):r.paths},t.isPythonBinary=function(e){return"python"===(e=e.trim())||"python3"===e},t.getPathsFromPthFiles=p},8752:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRegionComments=void 0;const s=n(1464);t.getRegionComments=function(e){const t=[];for(let n=0;n<e.tokenizerOutput.tokens.count;n++){const s=e.tokenizerOutput.tokens.getItemAt(n);if(s.comments)for(const n of s.comments){const s=r(n,e);void 0!==s&&t.push({type:s,comment:n})}}return t};const i=/^\s*region\b/,a=/^\s*endregion\b/;function r(e,t){const n=e.start-1,r=(0,s.convertOffsetToPosition)(n,t.tokenizerOutput.lines);if(0!==r.character){const e=n-r.character;if(t.text.slice(e,n).trimStart().length>0)return}const o=i.exec(e.value),l=a.exec(e.value);return o?0:l?1:void 0}},1561:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Scope=void 0;const s=n(5839),i=n(817);t.Scope=class{constructor(e,t){this.symbolTable=new Map,this.notLocalBindings=new Map,this.type=e,this.parent=t}getGlobalScope(){let e=this,t=!1;for(;e;){if(3===e.type||4===e.type)return{scope:e,isBeyondExecutionScope:t};1===e.type&&(t=!0),e=e.parent}return(0,s.fail)("failed to find scope"),{scope:this,isBeyondExecutionScope:t}}isIndependentlyExecutable(){return 3===this.type||1===this.type}lookUpSymbol(e){return this.symbolTable.get(e)}lookUpSymbolRecursive(e,t=!1,n=!1){const s=this.symbolTable.get(e);if(s){if(t&&s.isExternallyHidden())return;const e=s.getDeclarations();if(0===e.length||e.some((e=>1!==e.type||!e.isDefinedByMemberAccess)))return{symbol:s,isOutsideCallerModule:t,isBeyondExecutionScope:n,scope:this}}let i,a=n||this.isIndependentlyExecutable();if(1===this.notLocalBindings.get(e)){const e=this.getGlobalScope();e.scope!==this&&(i=e.scope,e.isBeyondExecutionScope&&(a=!0))}else i=this.parent;if(i)return i.lookUpSymbolRecursive(e,t||3===this.type,a)}addSymbol(e,t){const n=new i.Symbol(t);return this.symbolTable.set(e,n),n}getBindingType(e){return this.notLocalBindings.get(e)}setBindingType(e,t){return this.notLocalBindings.set(e,t)}setSlotsNames(e){this.slotsNames=e}getSlotsNames(){return this.slotsNames}}},5083:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.findTopNodeInScope=t.getScopeHierarchy=t.getScopeForNode=t.getBuiltInScope=void 0;const s=n(563),i=n(8494);function a(e){const t=(0,i.getEvaluationScopeNode)(e);return(0,s.getScope)(t)}t.getBuiltInScope=function(e){let t=e;for(;4!==t.type;)t=t.parent;return t},t.getScopeForNode=a,t.getScopeHierarchy=function(e,t){const n=[];let s=e;for(;s;){const e=a(s);if(!e)return;if(0!==n.length&&n[n.length-1]===e||n.push(e),e===t)return n;s=s.parent}return t?void 0:n},t.findTopNodeInScope=function(e,t){let n,i=e,a=!1;for(;i;){if((0,s.getScope)(i)===t)a=!0;else if(a)return n;n=i,i=i.parent}}},4221:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.parseFile=t.SourceFile=t.IPythonMode=void 0;const r=n(2714),o=n(1267),l=a(n(1766)),c=n(3213),p=n(2930),d=n(2211),u=n(5839),y=n(1290),m=n(9744),g=n(3980),h=n(7991),f=n(7345),T=n(1049),v=n(6657),_=n(1464),I=a(n(7559)),b=n(3550),C=n(3420),S=n(8718),x=n(9209),D=n(3778),F=n(8221),E=n(2816),P=n(3334),A=n(2858),N=n(4952),k=n(9437),w=n(9866),M=n(5275),R=n(2540),O=a(n(563)),L=n(6052),V=n(6329),U=a(n(2272)),z=n(4482),B=n(2041);var G;function W(e,t,n,s,i){var a;const r=e.findExecEnvironment(t),o=new R.ParseOptions;return o.ipythonMode=s,t.endsWith("pyi")&&(o.isStubFile=!0),o.pythonVersion=r.pythonVersion,o.skipFunctionAndClassBody=null!==(a=e.indexGenerationMode)&&void 0!==a&&a,(new R.Parser).parseSourceFile(n,o,i)}!function(e){e[e.None=0]="None",e[e.CellDocs=1]="CellDocs"}(G=t.IPythonMode||(t.IPythonMode={})),t.SourceFile=class{constructor(e,t,n,s,i,a,r,l,c=G.None){this._isFileDeleted=!1,this._diagnosticVersion=0,this._fileContentsVersion=0,this._lastFileContentLength=void 0,this._lastFileContentHash=void 0,this._analyzedFileContentsVersion=-1,this._parseTreeNeedsCleaning=!1,this._isBindingInProgress=!1,this._parseDiagnostics=[],this._commentDiagnostics=[],this._bindDiagnostics=[],this._checkerDiagnostics=[],this._typeIgnoreLines=new Map,this._pyrightIgnoreLines=new Map,this._diagnosticRuleSet=(0,p.getBasicDiagnosticRuleSet)(),this._circularDependencies=[],this._noCircularDependencyConfirmed=!1,this._isBindingNeeded=!0,this._isCheckingNeeded=!0,this._indexingNeeded=!0,this._ipythonMode=G.None,this.fileSystem=e,this._console=a||new d.StandardConsole,this._filePath=t,this._realFilePath=null!=l?l:t,this._moduleName=n,this._isStubFile=t.endsWith(".pyi"),this._isThirdPartyImport=s,this._isThirdPartyPyTypedPresent=i;const u=(0,v.getFileName)(t);this._isTypingStubFile=this._isStubFile&&(this._filePath.endsWith((0,v.normalizeSlashes)("stdlib/typing.pyi"))||"typing_extensions.pyi"===u),this._isTypingExtensionsStubFile=this._isStubFile&&"typing_extensions.pyi"===u,this._isBuiltInStubFile=!1,this._isStubFile&&(this._filePath.endsWith((0,v.normalizeSlashes)("stdlib/collections/__init__.pyi"))||this._filePath.endsWith((0,v.normalizeSlashes)("stdlib/asyncio/futures.pyi"))||this._filePath.endsWith((0,v.normalizeSlashes)("stdlib/asyncio/tasks.pyi"))||this._filePath.endsWith((0,v.normalizeSlashes)("stdlib/builtins.pyi"))||this._filePath.endsWith((0,v.normalizeSlashes)("stdlib/_importlib_modulespec.pyi"))||this._filePath.endsWith((0,v.normalizeSlashes)("stdlib/dataclasses.pyi"))||this._filePath.endsWith((0,v.normalizeSlashes)("stdlib/abc.pyi"))||this._filePath.endsWith((0,v.normalizeSlashes)("stdlib/enum.pyi"))||this._filePath.endsWith((0,v.normalizeSlashes)("stdlib/queue.pyi"))||this._filePath.endsWith((0,v.normalizeSlashes)("stdlib/types.pyi")))&&(this._isBuiltInStubFile=!0),this._logTracker=null!=r?r:new f.LogTracker(a,o.isMainThread?"FG":"BG"),this._ipythonMode=c}getRealFilePath(){return this._realFilePath}getIPythonMode(){return this._ipythonMode}getFilePath(){return this._filePath}getModuleName(){return this._moduleName}setModuleName(e){this._moduleName=e}getDiagnosticVersion(){return this._diagnosticVersion}isStubFile(){return this._isStubFile}isThirdPartyPyTypedPresent(){return this._isThirdPartyPyTypedPresent}getDiagnostics(e,t){if(this._diagnosticVersion===t)return;let n=!0;this._isThirdPartyImport&&(n=!1);let s=[...this._parseDiagnostics,...this._commentDiagnostics,...this._bindDiagnostics,...this._checkerDiagnostics];const i=s,a=new Map(this._typeIgnoreLines),r=new Map(this._pyrightIgnoreLines);this._diagnosticRuleSet.enableTypeIgnoreComments&&this._typeIgnoreLines.size>0&&(s=s.filter((e=>{if(3!==e.category&&4!==e.category&&5!==e.category)for(let t=e.range.start.line;t<=e.range.end.line;t++)if(this._typeIgnoreLines.has(t))return a.delete(t),!1;return!0}))),this._pyrightIgnoreLines.size>0&&(s=s.filter((e=>{if(4!==e.category&&5!==e.category)for(let t=e.range.start.line;t<=e.range.end.line;t++){const n=this._pyrightIgnoreLines.get(t);if(n){if(!n.rulesList)return r.delete(t),!1;const s=e.getRule();if(!s)return!0;if(n.rulesList.find((e=>e.text===s))){const e=r.get(t);if(null==e?void 0:e.rulesList){const n=e.rulesList.filter((e=>e.text!==s));0===n.length?r.delete(t):r.set(t,{range:e.range,rulesList:n})}return!1}return!0}}return!0})));const o=[];if("none"!==this._diagnosticRuleSet.reportUnnecessaryTypeIgnoreComment){const e=(0,y.convertLevelToCategory)(this._diagnosticRuleSet.reportUnnecessaryTypeIgnoreComment),t=i.filter((e=>0===e.category||1===e.category||2===e.category)),n=e=>i.find((t=>4===t.category&&t.range.start.line<=e.start.line&&t.range.end.line>=e.end.line));if(0===t.length&&void 0!==this._typeIgnoreAll){const t=this._typeIgnoreAll.range.start,s=t+this._typeIgnoreAll.range.length,i=(0,_.convertOffsetsToRange)(t,s,this._parseResults.tokenizerOutput.lines);!n(i)&&this._diagnosticRuleSet.enableTypeIgnoreComments&&o.push(new y.Diagnostic(e,w.Localizer.Diagnostic.unnecessaryTypeIgnore(),i))}a.forEach((t=>{var s;if(null===(s=this._parseResults)||void 0===s?void 0:s.tokenizerOutput.lines){const s=t.range.start,i=s+t.range.length,a=(0,_.convertOffsetsToRange)(s,i,this._parseResults.tokenizerOutput.lines);!n(a)&&this._diagnosticRuleSet.enableTypeIgnoreComments&&o.push(new y.Diagnostic(e,w.Localizer.Diagnostic.unnecessaryTypeIgnore(),a))}})),r.forEach((t=>{var s;if(null===(s=this._parseResults)||void 0===s?void 0:s.tokenizerOutput.lines)if(t.rulesList)t.rulesList.forEach((t=>{const s=t.range.start,i=s+t.range.length,a=(0,_.convertOffsetsToRange)(s,i,this._parseResults.tokenizerOutput.lines);n(a)||o.push(new y.Diagnostic(e,w.Localizer.Diagnostic.unnecessaryPyrightIgnoreRule().format({name:t.text}),a))}));else{const s=t.range.start,i=s+t.range.length,a=(0,_.convertOffsetsToRange)(s,i,this._parseResults.tokenizerOutput.lines);n(a)||o.push(new y.Diagnostic(e,w.Localizer.Diagnostic.unnecessaryPyrightIgnore(),a))}}))}if("none"!==this._diagnosticRuleSet.reportImportCycles&&this._circularDependencies.length>0){const e=(0,y.convertLevelToCategory)(this._diagnosticRuleSet.reportImportCycles);this._circularDependencies.forEach((t=>{const n=new y.Diagnostic(e,w.Localizer.Diagnostic.importCycleDetected()+"\n"+t.getPaths().map((e=>"  "+e)).join("\n"),(0,b.getEmptyRange)());n.setRule(m.DiagnosticRule.reportImportCycles),s.push(n)}))}return void 0!==this._hitMaxImportDepth&&s.push(new y.Diagnostic(0,w.Localizer.Diagnostic.importDepthExceeded().format({depth:this._hitMaxImportDepth}),(0,b.getEmptyRange)())),this._addTaskListDiagnostics(e.taskListTokens,s),e.ignore.find((e=>e.regExp.test(this._realFilePath)))&&(s=[]),this._diagnosticRuleSet.enableTypeIgnoreComments&&void 0!==this._typeIgnoreAll&&(s=s.filter((e=>0!==e.category&&1!==e.category&&2!==e.category))),s=s.concat(o),n||(s=s.filter((e=>3===e.category||4===e.category||5===e.category))),s}_addTaskListDiagnostics(e,t){var n,s;if(!e||0===e.length||!t)return;if(!(null===(s=null===(n=this._parseResults)||void 0===n?void 0:n.tokenizerOutput)||void 0===s?void 0:s.tokens))return;const i=this._parseResults.tokenizerOutput;for(let n=0;n<i.tokens.count;n++){const s=i.tokens.getItemAt(n);if(s.comments&&0!==s.comments.length)for(const n of s.comments)for(const s of e){const e="^[\\s]*"+s.text+"([\\s]*$|[\\W]+)";if(!RegExp(e,"i").test(n.value))continue;let a=n.start;a+=n.value.toLowerCase().indexOf(s.text.toLowerCase());const r=b.TextRange.getEnd(n),o=(0,_.convertOffsetsToRange)(a,r,i.lines);t.push(new y.Diagnostic(6,n.value.trim(),o,s.priority))}}}getImports(){return this._imports||[]}getBuiltinsImport(){return this._builtinsImport}getIPythonDisplayImport(){return this._ipythonDisplayImport}getModuleSymbolTable(){return this._moduleSymbolTable}getCheckTime(){return this._checkTime}didContentsChangeOnDisk(){if(this._clientDocument)return!1;if(void 0===this._lastFileContentLength)return!1;try{const e=this.fileSystem.readFileSync(this._filePath,"utf8");if(e.length!==this._lastFileContentLength)return!0;if(I.hashString(e)!==this._lastFileContentHash)return!0}catch(e){return!0}return!1}dropParseAndBindInfo(){}markDirty(e=!0){this._fileContentsVersion++,this._noCircularDependencyConfirmed=!1,this._isCheckingNeeded=!0,this._isBindingNeeded=!0,this._indexingNeeded=e,this._moduleSymbolTable=void 0,this._cachedIndexResults=void 0;const t=this.getFilePath();h.Extensions.getProgramExtensions(t).forEach((e=>e.fileDirty?e.fileDirty(t):null))}markReanalysisRequired(e){this._isCheckingNeeded=!0,this._noCircularDependencyConfirmed=!1,this._parseResults&&(this._parseResults.containsWildcardImport||void 0!==O.getDunderAllInfo(this._parseResults.parseTree)||e)&&(this._parseTreeNeedsCleaning=!0,this._isBindingNeeded=!0,this._moduleSymbolTable=void 0)}getClientVersion(){var e;return null===(e=this._clientDocument)||void 0===e?void 0:e.version}getOpenFileContents(){var e;return null===(e=this._clientDocument)||void 0===e?void 0:e.getText()}getFileContent(){const e=this.getOpenFileContents();if(void 0!==e)return e;try{const e=this.fileSystem.statSync(this._filePath);if(e.size>52428800)throw this._console.error(`File length of "${this._filePath}" is ${e.size} which exceeds the maximum supported file size of 52428800`),new Error("File larger than max");return this.fileSystem.readFileSync(this._filePath,"utf8")}catch(e){return}}setClientVersion(e,t){if(null===e)this._clientDocument=void 0;else{this._clientDocument||(this._clientDocument=r.TextDocument.create(this._filePath,"python",e,"")),this._clientDocument=r.TextDocument.update(this._clientDocument,t,e);const n=this._clientDocument.getText(),s=I.hashString(n);n.length===this._lastFileContentLength&&s===this._lastFileContentHash||this.markDirty(),this._lastFileContentLength=n.length,this._lastFileContentHash=s,this._isFileDeleted=!1}}prepareForClose(){}isFileDeleted(){return this._isFileDeleted}isParseRequired(){return!this._parseResults||this._analyzedFileContentsVersion!==this._fileContentsVersion}isBindingRequired(){return!this._isBindingInProgress&&(!!this.isParseRequired()||this._isBindingNeeded)}isIndexingRequired(){return this._indexingNeeded}isCheckingRequired(){return this._isCheckingNeeded}getParseResults(){if(!this.isParseRequired())return this._parseResults}getCachedIndexResults(){return this._cachedIndexResults}cacheIndexResults(e){this._cachedIndexResults=e}addCircularDependency(e){let t=!1;this._circularDependencies.length<4&&(this._circularDependencies.some((t=>t.isEqual(e)))||(this._circularDependencies.push(e),t=!0)),t&&this._diagnosticVersion++}setNoCircularDependencyConfirmed(){this._noCircularDependencyConfirmed=!0}isNoCircularDependencyConfirmed(){return!this.isParseRequired()&&this._noCircularDependencyConfirmed}setHitMaxImportDepth(e){this._hitMaxImportDepth=e}parse(e,t,n){return this._logTracker.log(`parsing: ${this._getPathForLogging(this._filePath)}`,(s=>{if(!this.isParseRequired())return s.suppress(),!1;const i=new g.DiagnosticSink;let a=this.getOpenFileContents();if(void 0===a)try{const e=S.timingStats.readFileTime.totalTime;S.timingStats.readFileTime.timeOperation((()=>{if(a=null!=n?n:this.getFileContent(),void 0===a)throw new Error("Can't get file content");this._lastFileContentLength=a.length,this._lastFileContentHash=I.hashString(a)})),s.add(`fs read ${S.timingStats.readFileTime.totalTime-e}ms`)}catch(e){i.addError("Source file could not be read",(0,b.getEmptyRange)()),a="",this.fileSystem.existsSync(this._filePath)||(this._isFileDeleted=!0)}try{const n=W(e,this._filePath,a,this._ipythonMode,i);(0,u.assert)(void 0!==n&&void 0!==n.tokenizerOutput),this._parseResults=n,this._typeIgnoreLines=this._parseResults.tokenizerOutput.typeIgnoreLines,this._typeIgnoreAll=this._parseResults.tokenizerOutput.typeIgnoreAll,this._pyrightIgnoreLines=this._parseResults.tokenizerOutput.pyrightIgnoreLines;const s=e.findExecEnvironment(this._filePath);S.timingStats.resolveImportsTime.timeOperation((()=>{const e=this._resolveImports(t,n.importedModules,s);this._imports=e.imports,this._builtinsImport=e.builtinsImportResult,this._ipythonDisplayImport=e.ipythonDisplayImportResult,this._parseDiagnostics=i.fetchAndClear()}));const r=void 0!==e.strict.find((e=>e.regExp.test(this._realFilePath))),o=[];this._diagnosticRuleSet=U.getFileLevelDirectives(this._parseResults.tokenizerOutput.tokens,e.diagnosticRuleSet,r,o),this._commentDiagnostics=[],o.forEach((e=>{this._commentDiagnostics.push(new y.Diagnostic(0,e.message,(0,_.convertTextRangeToRange)(e.range,this._parseResults.tokenizerOutput.lines)))}))}catch(e){const t=(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e);this._console.error(w.Localizer.Diagnostic.internalParseError().format({file:this.getFilePath(),message:t})),this._parseResults={text:"",parseTree:M.ModuleNode.create({start:0,length:0}),importedModules:[],futureImports:new Set,tokenizerOutput:{tokens:new C.TextRangeCollection([]),lines:new C.TextRangeCollection([]),typeIgnoreAll:void 0,typeIgnoreLines:new Map,pyrightIgnoreLines:new Map,predominantEndOfLineSequence:"\n",predominantTabSequence:"    ",predominantSingleQuoteCharacter:"'"},containsWildcardImport:!1,typingSymbolAliases:new Map},this._imports=void 0,this._builtinsImport=void 0,this._ipythonDisplayImport=void 0;const n=new g.DiagnosticSink;n.addError(w.Localizer.Diagnostic.internalParseError().format({file:this.getFilePath(),message:t}),(0,b.getEmptyRange)()),this._parseDiagnostics=n.fetchAndClear()}return this._analyzedFileContentsVersion=this._fileContentsVersion,this._indexingNeeded=!0,this._isBindingNeeded=!0,this._isCheckingNeeded=!0,this._parseTreeNeedsCleaning=!1,this._hitMaxImportDepth=void 0,this._diagnosticVersion++,!0}))}index(e,t){return this._logTracker.log(`indexing: ${this._getPathForLogging(this._filePath)}`,(n=>{if(!this._parseResults||!this.isIndexingRequired())return void n.suppress();this._indexingNeeded=!1;const s=E.DocumentSymbolProvider.indexSymbols(O.getFileInfo(this._parseResults.parseTree),this._parseResults,e,t);n.add(`found ${s.length}`);const i=(0,v.stripFileExtension)((0,v.getFileName)(this._filePath));return{privateOrProtected:l.isPrivateOrProtectedName(i),symbols:s}}))}getDefinitionsForPosition(e,t,n,s,i){if(this._parseResults)return D.DefinitionProvider.getDefinitionsForPosition(e,this._parseResults,t,n,s,i)}getTypeDefinitionsForPosition(e,t,n,s,i){if(this._parseResults)return D.DefinitionProvider.getTypeDefinitionsForPosition(e,this._parseResults,t,n,s,i)}getDeclarationForPosition(e,t,n,s,i,a,r){if(this._parseResults)return N.ReferencesProvider.getDeclarationForPosition(e,this._parseResults,this._filePath,t,n,s,i,a,r)}addReferences(e,t,n,s){this._parseResults&&N.ReferencesProvider.addReferences(this._parseResults,this._filePath,e,t,n,s)}addHierarchicalSymbolsForDocument(e,t){(this._parseResults||this._cachedIndexResults)&&E.DocumentSymbolProvider.addHierarchicalSymbolsForDocument(this._parseResults?O.getFileInfo(this._parseResults.parseTree):void 0,this.getCachedIndexResults(),this._parseResults,e,t)}getSymbolsForDocument(e,t){return this._parseResults||this._cachedIndexResults?E.DocumentSymbolProvider.getSymbolsForDocument(this._parseResults?O.getFileInfo(this._parseResults.parseTree):void 0,this.getCachedIndexResults(),this._parseResults,this._filePath,e,t):[]}getHoverForPosition(e,t,n,s,i,a){if(!this._isBindingNeeded&&this._parseResults)return P.HoverProvider.getHoverForPosition(e,this._parseResults,t,n,s,i,a)}getDocumentHighlight(e,t,n,s){if(!this._isBindingNeeded&&this._parseResults)return F.DocumentHighlightProvider.getDocumentHighlight(this._parseResults,t,n,s)}getSignatureHelpForPosition(e,t,n,s,i){if(this._parseResults)return k.SignatureHelpProvider.getSignatureHelpForPosition(this._parseResults,e,t,n,s,i)}getCompletionsForPosition(e,t,n,s,i,a,r,o,l,c,p,d){if(!this._parseResults)return;const u=this.getOpenFileContents();return void 0!==u?new x.CompletionProvider(t,this._parseResults,u,s,e,this._filePath,n,i,a,r,o,{nameMap:l,libraryMap:c,getModuleSymbolsMap:p},d).getCompletionsForPosition():void 0}resolveCompletionItem(e,t,n,s,i,a,r,o,l,c,p){const d=this.getOpenFileContents();if(!this._parseResults||void 0===d)return;const u=(0,T.fromLSPAny)(c.data);new x.CompletionProvider(u.workspacePath,this._parseResults,d,t,u.position,this._filePath,e,n,s,i,a,{nameMap:r,libraryMap:o,getModuleSymbolsMap:l},p).resolveCompletionItem(c)}performQuickAction(e,t,n){if(this._parseResults&&void 0!==this.getClientVersion())return(0,A.performQuickAction)(e,t,this._parseResults,n)}bind(e,t,n,s){return(0,u.assert)(!this.isParseRequired(),"Bind called before parsing"),(0,u.assert)(this.isBindingRequired(),"Bind called unnecessarily"),(0,u.assert)(!this._isBindingInProgress,"Bind called while binding in progress"),(0,u.assert)(void 0!==this._parseResults,"Parse results not available"),this._logTracker.log(`binding: ${this._getPathForLogging(this._filePath)}`,(()=>{try{S.timingStats.bindTime.timeOperation((()=>{this._cleanParseTreeIfRequired();const i=this._buildFileInfo(e,this._parseResults.text,t,n,s);O.setFileInfo(this._parseResults.parseTree,i);const a=new L.Binder(i,e.indexGenerationMode);this._isBindingInProgress=!0,a.bindModule(this._parseResults.parseTree),e.internalTestMode&&(new B.TestWalker).walk(this._parseResults.parseTree),this._bindDiagnostics=i.diagnosticSink.fetchAndClear();const r=O.getScope(this._parseResults.parseTree);(0,u.assert)(void 0!==r,"Module scope not returned by binder"),this._moduleSymbolTable=r.symbolTable}))}catch(e){const t=(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e);this._console.error(w.Localizer.Diagnostic.internalBindError().format({file:this.getFilePath(),message:t}));const n=new g.DiagnosticSink;n.addError(w.Localizer.Diagnostic.internalBindError().format({file:this.getFilePath(),message:t}),(0,b.getEmptyRange)()),this._bindDiagnostics=n.fetchAndClear()}finally{this._isBindingInProgress=!1}this._diagnosticVersion++,this._isCheckingNeeded=!0,this._indexingNeeded=!0,this._isBindingNeeded=!1}))}check(e,t,n,s){return(0,u.assert)(!this.isParseRequired(),"Check called before parsing"),(0,u.assert)(!this.isBindingRequired(),"Check called before binding"),(0,u.assert)(!this._isBindingInProgress,"Check called while binding in progress"),(0,u.assert)(this.isCheckingRequired(),"Check called unnecessarily"),(0,u.assert)(void 0!==this._parseResults,"Parse results not available"),this._logTracker.log(`checking: ${this._getPathForLogging(this._filePath)}`,(()=>{try{S.timingStats.typeCheckerTime.timeOperation((()=>{const i=new S.Duration;new V.Checker(e,t,this._parseResults,n,s).check(),this._isCheckingNeeded=!1;const a=O.getFileInfo(this._parseResults.parseTree);this._checkerDiagnostics=a.diagnosticSink.fetchAndClear(),this._checkTime=i.getDurationInMilliseconds()}))}catch(e){if(!c.OperationCanceledException.is(e)){const t=(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e);this._console.error(w.Localizer.Diagnostic.internalTypeCheckingError().format({file:this.getFilePath(),message:t}));const n=new g.DiagnosticSink;n.addError(w.Localizer.Diagnostic.internalTypeCheckingError().format({file:this.getFilePath(),message:t}),(0,b.getEmptyRange)()),this._checkerDiagnostics=n.fetchAndClear(),this._isCheckingNeeded=!1}throw e}finally{this._circularDependencies=[],this._diagnosticVersion++}}))}test_enableIPythonMode(e){this._ipythonMode=e?G.CellDocs:G.None}_buildFileInfo(e,t,n,s,i){return(0,u.assert)(void 0!==this._parseResults,"Parse results not available"),{importLookup:n,futureImports:i,builtinsScope:s,diagnosticSink:new g.TextRangeDiagnosticSink(this._parseResults.tokenizerOutput.lines),executionEnvironment:e.findExecEnvironment(this._filePath),diagnosticRuleSet:this._diagnosticRuleSet,fileContents:t,lines:this._parseResults.tokenizerOutput.lines,typingSymbolAliases:this._parseResults.typingSymbolAliases,definedConstants:e.defineConstant,filePath:this._filePath,moduleName:this._moduleName,isStubFile:this._isStubFile,isTypingStubFile:this._isTypingStubFile,isTypingExtensionsStubFile:this._isTypingExtensionsStubFile,isBuiltInStubFile:this._isBuiltInStubFile,isInPyTypedPackage:this._isThirdPartyPyTypedPresent,ipythonMode:this._ipythonMode,accessedSymbolSet:new Set}}_cleanParseTreeIfRequired(){this._parseResults&&this._parseTreeNeedsCleaning&&(new z.ParseTreeCleanerWalker(this._parseResults.parseTree).clean(),this._parseTreeNeedsCleaning=!1)}_resolveImports(e,t,n){const s=[],i=(t,i=!1)=>{const a=e.resolveImport(this._filePath,n,{leadingDots:0,nameParts:t,importedSymbols:void 0});if(!i||a.isImportFound)return 0===a.resolvedPaths.length||a.resolvedPaths[0]!==this._filePath?(s.push(a),a):void 0};let a;this._isThirdPartyImport||this._isStubFile||(a=i(["__builtins__"],!0)),a||(a=i(["builtins"]));const r=this._ipythonMode?i(["IPython","display"]):void 0;for(const i of t){const t=e.resolveImport(this._filePath,n,{leadingDots:i.leadingDots,nameParts:i.nameParts,importedSymbols:i.importedSymbols});s.push(t),i.nameParts.length===i.nameNode.nameParts.length?O.setImportInfo(i.nameNode,t):((0,u.assert)(i.nameParts.length>0),(0,u.assert)(i.nameParts.length-1<i.nameNode.nameParts.length),O.setImportInfo(i.nameNode.nameParts[i.nameParts.length-1],t))}return{imports:s,builtinsImportResult:a,ipythonDisplayImportResult:r}}_getPathForLogging(e){return this.fileSystem.isMappedFilePath(e)?this.fileSystem.getOriginalFilePath(e):e}},t.parseFile=W},6025:(e,t)=>{function n(e,t){e.importedBy.forEach((e=>{t.has(e)||(t.add(e),n(e,t))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.collectImportedByFiles=t.isUserCode=void 0,t.isUserCode=function(e){return!!e&&e.isTracked&&!e.isThirdPartyImport&&!e.isTypeshedFile},t.collectImportedByFiles=function(e){const t=new Set;return n(e,t),t}},8816:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.isStubFile=t.SourceMapper=void 0;const r=a(n(563)),o=a(n(8494)),l=n(9489),c=n(2489),p=n(5839),d=n(6657),u=n(8905),y=n(6025),m=n(8608),g=n(1133),h=n(5168);function f(e){return".pyi"===(0,d.getAnyExtensionFromPath)(e,[".pyi"],!1)}t.SourceMapper=class{constructor(e,t,n,s,i,a,r,o,l){this._importResolver=e,this._execEnv=t,this._evaluator=n,this._fileBinder=s,this._boundSourceGetter=i,this._mapCompiled=a,this._preferStubs=r,this._fromFile=o,this._cancelToken=l}findModules(e){var t;return(this._isStubThatShouldBeMappedToImplementation(e)?this._getBoundSourceFilesFromStubFile(e):[null===(t=this._boundSourceGetter(e))||void 0===t?void 0:t.sourceFile]).filter(c.isDefined).map((e=>{var t;return null===(t=e.getParseResults())||void 0===t?void 0:t.parseTree})).filter(c.isDefined)}getModuleNode(e){var t,n;return null===(n=null===(t=this._boundSourceGetter(e))||void 0===t?void 0:t.sourceFile.getParseResults())||void 0===n?void 0:n.parseTree}findDeclarations(e){return(0,u.isClassDeclaration)(e)?this._findClassOrTypeAliasDeclarations(e):(0,u.isFunctionDeclaration)(e)?this._findFunctionOrTypeAliasDeclarations(e):(0,u.isVariableDeclaration)(e)?this._findVariableDeclarations(e):(0,u.isParameterDeclaration)(e)?this._findParameterDeclarations(e):(0,u.isSpecialBuiltInClassDeclaration)(e)?this._findSpecialBuiltInClassDeclarations(e):[]}findClassDeclarationsByType(e,t){const n=[];return this._addClassTypeDeclarations(e,t,n,new Set),n.filter((e=>(0,u.isClassDeclaration)(e))).map((e=>e))}findFunctionDeclarations(e){return this._findFunctionOrTypeAliasDeclarations(e).filter((e=>(0,u.isFunctionDeclaration)(e))).map((e=>e))}isUserCode(e){return(0,y.isUserCode)(this._boundSourceGetter(e))}getNextFileName(e){const t=(0,d.stripFileExtension)(e);let n=1,s=`${t}_${n}.py`;for(;this.isUserCode(s)&&n<1e3;)n+=1,s=`${t}_${n}.py`;return s}_findSpecialBuiltInClassDeclarations(e,t=new Set){if(38===e.node.valueExpression.nodeType){const n=e.node.valueExpression.value;return this._getBoundSourceFilesFromStubFile(e.path).flatMap((e=>this._findClassDeclarationsByName(e,n,t)))}return[]}_findClassOrTypeAliasDeclarations(e,t=new Set){const n=this._getFullClassName(e.node);return this._getBoundSourceFilesFromStubFile(e.path).flatMap((e=>this._findClassDeclarationsByName(e,n,t)))}_findFunctionOrTypeAliasDeclarations(e,t=new Set){const n=e.node.name.value,s=this._getBoundSourceFilesFromStubFile(e.path);if(e.isMethod){const i=o.getEnclosingClass(e.node);if(void 0===i)return[];const a=this._getFullClassName(i);return s.flatMap((e=>this._findMethodDeclarationsByName(e,a,n,t)))}return s.flatMap((e=>this._findFunctionDeclarationsByName(e,n,t)))}_findVariableDeclarations(e,t=new Set){if(38!==e.node.nodeType)return[];const n=e.node.value,s=this._getBoundSourceFilesFromStubFile(e.path),i=o.getEnclosingClass(e.node);if(i){const e=this._getFullClassName(i);return s.flatMap((s=>this._findFieldDeclarationsByName(s,e,n,t)))}return s.flatMap((e=>this._findVariableDeclarationsByName(e,n,t)))}_findParameterDeclarations(e){const t=[];if(!e.node.name)return t;const n=o.getEnclosingFunction(e.node);if(!n)return t;const s=this._evaluator.getDeclarationsForNameNode(n.name);if(!s)return t;const i=new Set;for(const n of s)for(const s of this._findFunctionOrTypeAliasDeclarations(n,i))t.push(...this._lookUpSymbolDeclarations(s.node,e.node.name.value).filter((e=>(0,u.isParameterDeclaration)(e))).map((e=>e)));return t}_findMemberDeclarationsByName(e,t,n,s,i){const a=[],r=this._findClassDeclarationsByName(e,t,i);for(const e of r.filter((e=>(0,u.isClassDeclaration)(e))).map((e=>e))){const t=this._evaluator.getTypeOfClass(e.node);if(!t)continue;const r=(0,h.lookUpClassMember)(t.classType,n);if(r)for(const e of r.symbol.getDeclarations())s(e,i,a)}return a}_findFieldDeclarationsByName(e,t,n,s){let i=[];const a=`@${e.getFilePath()}/c/${t}/v/${n}`;return s.has(a)||(s.add(a),i=this._findMemberDeclarationsByName(e,t,n,((e,t,n)=>{if((0,u.isVariableDeclaration)(e))if(this._isStubThatShouldBeMappedToImplementation(e.path))for(const s of this._findVariableDeclarations(e,t))(0,u.isVariableDeclaration)(s)&&n.push(s);else n.push(e)}),s),s.delete(a)),i}_findMethodDeclarationsByName(e,t,n,s){let i=[];const a=`@${e.getFilePath()}/c/${t}/f/${n}`;return s.has(a)||(s.add(a),i=this._findMemberDeclarationsByName(e,t,n,((e,t,n)=>{(0,u.isFunctionDeclaration)(e)&&(this._isStubThatShouldBeMappedToImplementation(e.path)?(0,l.appendArray)(n,this._findFunctionOrTypeAliasDeclarations(e,t)):n.push(e))}),s),s.delete(a)),i}_findVariableDeclarationsByName(e,t,n){var s;const i=[],a=`@${e.getFilePath()}/v/${t}`;if(n.has(a))return i;n.add(a);const r=null===(s=e.getParseResults())||void 0===s?void 0:s.parseTree;if(!r)return i;const o=this._lookUpSymbolDeclarations(r,t);if(0===o.length)this._addDeclarationsFollowingWildcardImports(r,t,i,n);else for(const e of o)this._addVariableDeclarations(e,i,n);return n.delete(a),i}_findFunctionDeclarationsByName(e,t,n){var s;const i=[],a=`@${e.getFilePath()}/f/${t}`;if(n.has(a))return i;n.add(a);const r=null===(s=e.getParseResults())||void 0===s?void 0:s.parseTree;if(!r)return i;const o=this._lookUpSymbolDeclarations(r,t);if(0===o.length)this._addDeclarationsFollowingWildcardImports(r,t,i,n);else for(const e of o)this._addClassOrFunctionDeclarations(e,i,n);return n.delete(a),i}_findClassDeclarationsByName(e,t,n){var s;let i=[];const a=null===(s=e.getParseResults())||void 0===s?void 0:s.parseTree;if(a){let s=t.split(".");s.length>0&&(i=this._findClassDeclarations(e,s[0],a,n),s=s.slice(1));for(const t of s)i=i.flatMap((s=>this._findClassDeclarations(e,t,s.node,n)))}return i}_findClassDeclarations(e,t,n,s){const i=[],a=`@${e.getFilePath()}[${n.start}]${t}`;if(s.has(a))return i;s.add(a);const r=this._lookUpSymbolDeclarations(n,t);if(0===r.length&&36===n.nodeType)this._addDeclarationsFollowingWildcardImports(n,t,i,s);else for(const e of r)this._addClassOrFunctionDeclarations(e,i,s);return s.delete(a),i}_addVariableDeclarations(e,t,n){if((0,u.isVariableDeclaration)(e))this._isStubThatShouldBeMappedToImplementation(e.path)?(0,l.appendArray)(t,this._findVariableDeclarations(e,n)):t.push(e);else if((0,u.isAliasDeclaration)(e)){const s=this._evaluator.resolveAliasDeclaration(e,!0);s&&((0,u.isVariableDeclaration)(s)?this._addVariableDeclarations(s,t,n):((0,u.isClassDeclaration)(s)||(0,u.isFunctionDeclaration)(s))&&this._addClassOrFunctionDeclarations(s,t,n))}}_addClassOrFunctionDeclarations(e,t,n){var s;if((0,u.isClassDeclaration)(e))this._isStubThatShouldBeMappedToImplementation(e.path)?(0,l.appendArray)(t,this._findClassOrTypeAliasDeclarations(e,n)):t.push(e);else if((0,u.isFunctionDeclaration)(e))this._isStubThatShouldBeMappedToImplementation(e.path)?(0,l.appendArray)(t,this._findFunctionOrTypeAliasDeclarations(e,n)):t.push(e);else if((0,u.isAliasDeclaration)(e)){const s=this._handleSpecialBuiltInModule(e),i=this._evaluator.resolveAliasDeclaration(s,!0);i&&!(0,u.isAliasDeclaration)(i)&&this._addClassOrFunctionDeclarations(i,t,n)}else if((0,u.isVariableDeclaration)(e)){this._addVariableDeclarations(e,t,n);const i=null!==(s=e.typeAliasName)&&void 0!==s?s:e.node,a=this._evaluator.getType(i);if(!a)return;if((0,g.isFunction)(a)&&a.details.declaration)this._addClassOrFunctionDeclarations(a.details.declaration,t,n);else if((0,g.isOverloadedFunction)(a))for(const e of a.overloads.map((e=>e.details.declaration)).filter(c.isDefined))this._addClassOrFunctionDeclarations(e,t,n);else(0,g.isInstantiableClass)(a)&&this._addClassTypeDeclarations(e.path,a,t,n)}}_handleSpecialBuiltInModule(e){if(e.path||!e.node)return e;if("io"!==e.moduleName&&"collections"!==e.moduleName)return e;const t=this._importResolver.getTypeshedStdLibPath(this._execEnv);if(!t)return e;const n=o.getFileInfoFromNode(e.node);if(!n)return e;const s=(0,d.combinePaths)(t,function(){switch(e.node.nodeType){case 21:case 22:return e.node.module;case 23:return e.node.parent.module;default:return(0,p.assertNever)(e.node)}}().nameParts.map((e=>e.value)).join(".")+".pyi"),i=this._getSourceFiles(s,n.filePath);if(0===i.length)return e;const a={...e};return a.path=i[0].getFilePath(),a}_addClassTypeDeclarations(e,t,n,s){const i=t.details.filePath,a=this._getSourceFiles(i,void 0,e),r=t.details.fullName.substring(t.details.moduleName.length+1);for(const e of a)(0,l.appendArray)(n,this._findClassDeclarationsByName(e,r,s))}_getSourceFiles(e,t,n){const s=[];if(this._isStubThatShouldBeMappedToImplementation(e))(0,l.appendArray)(s,this._getBoundSourceFilesFromStubFile(e,t,n));else{const t=this._boundSourceGetter(e);t&&s.push(t.sourceFile)}return s}_addDeclarationsFollowingWildcardImports(e,t,n,s){var i,a;const o=null===(i=r.getScope(e))||void 0===i?void 0:i.symbolTable;if(o)for(const e of o.values())for(const i of e.getDeclarations()){if(!(0,u.isAliasDeclaration)(i)||!i.path||22!==i.node.nodeType||!i.node.isWildcardImport)continue;const e=`@${i.path}/l/${t}`;if(s.has(e))continue;s.add(e);const r=this._getSourceFiles(i.path);for(const e of r){const i=null===(a=e.getParseResults())||void 0===a?void 0:a.parseTree;if(!i)continue;const r=this._lookUpSymbolDeclarations(i,t);if(0===r.length)this._addDeclarationsFollowingWildcardImports(i,t,n,s);else for(const e of r){const t=this._evaluator.resolveAliasDeclaration(e,!0);t&&((0,u.isFunctionDeclaration)(t)||(0,u.isClassDeclaration)(t)?this._addClassOrFunctionDeclarations(t,n,s):(0,u.isVariableDeclaration)(t)&&this._addVariableDeclarations(t,n,s))}}}}_lookUpSymbolDeclarations(e,t){if(void 0===e)return[];const n=r.getScope(e),s=null==n?void 0:n.lookUpSymbol(t),i=null==s?void 0:s.getDeclarations();return null!=i?i:[]}_getFullClassName(e){const t=[];let n=e;for(;void 0!==n;)t.push(n.name.value),n=o.getEnclosingClass(n);return t.reverse().join(".")}_getBoundSourceFilesFromStubFile(e,t,n){var s;return this._getSourcePathsFromStub(e,null!=n?n:null===(s=this._fromFile)||void 0===s?void 0:s.sourceFile.getFilePath()).map((n=>this._fileBinder(null!=t?t:e,n))).filter(c.isDefined)}_getSourcePathsFromStub(e,t){let n=this._importResolver.getSourceFilesFromStub(e,this._execEnv,this._mapCompiled);if(n.length>0)return n;const s=this._getStubFileImportTree(e,t);for(let e=0;e<s.length;e++)if(n=this._importResolver.getSourceFilesFromStub(s[e],this._execEnv,this._mapCompiled),n.length>0)return n;return[]}_getStubFileImportTree(e,t){return t&&this._isStubThatShouldBeMappedToImplementation(e)?(0,m.buildImportTree)(t,e,(e=>{const t=this._boundSourceGetter(e);return t?t.importedBy.map((e=>e.sourceFile.getFilePath())):[]}),this._cancelToken).filter((e=>this._isStubThatShouldBeMappedToImplementation(e))):[e]}_isStubThatShouldBeMappedToImplementation(e){return!this._preferStubs&&(!!f(e)&&this._importResolver.getSourceFilesFromStub(e,this._execEnv,this._mapCompiled).every((t=>t!==e)))}},t.isStubFile=f},8608:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildImportTree=void 0;class n{constructor(){this.value=0}}function s(e,t,n,i,a,r){if(a.value>1e3||r.isCancellationRequested)return[];if(a.value+=1,t===e)return i.length?i:[t];if(i.length>1&&i.find((e=>e===t)))return[];const o=n(t);for(let l=0;l<o.length&&!r.isCancellationRequested;l++){const c=s(e,o[l],n,[...i,t],a,r);if(c.length>0)return c}return[]}t.buildImportTree=function(e,t,i,a){const r=s(e,t,i,[],new n,a);return r.length>0?r:[t]}},8235:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateStaticBoolLikeExpression=t.evaluateStaticBoolExpression=void 0;const s=n(2930);function i(e,t,n,c,p){if(4===e.nodeType)return i(e.rightExpression,t,n,c,p);if(55===e.nodeType){if(38===e.operator){const s=a(e.expression,t,n,c,p);if(void 0!==s)return!s}}else if(7===e.nodeType){if(37===e.operator||36===e.operator){const s=i(e.leftExpression,t,n,c,p),a=i(e.rightExpression,t,n,c,p);if(void 0===s||void 0===a)return;return 37===e.operator?s||a:s&&a}if(l(e.leftExpression,p)&&52===e.rightExpression.nodeType){const n=function(e){let t;if(e.expressions.length>=2){if(40===e.expressions[0].nodeType&&!e.expressions[0].isImaginary&&40===e.expressions[1].nodeType&&!e.expressions[1].isImaginary){const n=e.expressions[0],s=e.expressions[1];"number"==typeof n.value&&"number"==typeof s.value&&(t=256*n.value+s.value)}}else if(1===e.expressions.length){const n=e.expressions[0];"number"==typeof n.value&&(t=256*n.value)}return t}(e.rightExpression);return r(e.operator,t.pythonVersion,n)}if(24===e.leftExpression.nodeType&&l(e.leftExpression.baseExpression,p)&&1===e.leftExpression.items.length&&!e.leftExpression.trailingComma&&!e.leftExpression.items[0].name&&0===e.leftExpression.items[0].argumentCategory&&40===e.leftExpression.items[0].valueExpression.nodeType&&!e.leftExpression.items[0].valueExpression.isImaginary&&0===e.leftExpression.items[0].valueExpression.value&&40===e.rightExpression.nodeType)return r(e.operator,Math.floor(t.pythonVersion/256),e.rightExpression.value);if(function(e,t=["sys"]){return!(35!==e.nodeType||38!==e.leftExpression.nodeType||"platform"!==e.memberName.value||!t.some((t=>t===e.leftExpression.value)))}(e.leftExpression,p)&&48===e.rightExpression.nodeType){const n=e.rightExpression.strings.map((e=>e.value)).join(""),i=function(e){return e.pythonPlatform===s.PythonPlatform.Darwin?"darwin":e.pythonPlatform===s.PythonPlatform.Windows?"win32":e.pythonPlatform===s.PythonPlatform.Linux?"linux":void 0}(t);return o(e.operator,i,n)}if(function(e){return 35===e.nodeType&&38===e.leftExpression.nodeType&&"os"===e.leftExpression.value&&"name"===e.memberName.value}(e.leftExpression)&&48===e.rightExpression.nodeType){const n=e.rightExpression.strings.map((e=>e.value)).join(""),i=function(e){return e.pythonPlatform===s.PythonPlatform.Darwin?"posix":e.pythonPlatform===s.PythonPlatform.Windows?"nt":e.pythonPlatform===s.PythonPlatform.Linux?"posix":void 0}(t);if(void 0!==i)return o(e.operator,i,n)}else if(48===e.rightExpression.nodeType){let t;if(38===e.leftExpression.nodeType?t=n.get(e.leftExpression.value):35===e.leftExpression.nodeType&&(t=n.get(e.leftExpression.memberName.value)),void 0!==t&&"string"==typeof t){const n=e.rightExpression.strings.map((e=>e.value)).join("");return o(e.operator,t,n)}}}else if(11===e.nodeType){if(33===e.constType)return!0;if(15===e.constType)return!1}else if(38===e.nodeType){if("TYPE_CHECKING"===e.value)return!0;const t=n.get(e.value);if(void 0!==t)return!!t}else if(35===e.nodeType){if(c&&"TYPE_CHECKING"===e.memberName.value&&38===e.leftExpression.nodeType&&c.some((t=>t===e.leftExpression.value)))return!0;const t=n.get(e.memberName.value);if(void 0!==t)return!!t}}function a(e,t,n,s,a){return(11!==e.nodeType||26!==e.constType)&&i(e,t,n,s,a)}function r(e,t,n){if(void 0!==t&&void 0!==n){if(t=BigInt(t),n=BigInt(n),20===e)return t<n;if(21===e)return t<=n;if(15===e)return t>n;if(16===e)return t>=n;if(12===e)return t===n;if(28===e)return t!==n}}function o(e,t,n){if(void 0!==t&&void 0!==n){if(12===e)return t===n;if(28===e)return t!==n}}function l(e,t=["sys"]){return!(35!==e.nodeType||38!==e.leftExpression.nodeType||"version_info"!==e.memberName.value||!t.some((t=>t===e.leftExpression.value)))}t.evaluateStaticBoolExpression=i,t.evaluateStaticBoolLikeExpression=a},817:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Symbol=t.indeterminateSymbolId=void 0;const s=n(5523);let i=1;t.indeterminateSymbolId=0;class a{constructor(e){this.id=i++,this._flags=e}static createWithType(e,t){const n=new a(e);return n._synthesizedType=t,n}isInitiallyUnbound(){return!!(1&this._flags)}setIsExternallyHidden(){this._flags|=2}isExternallyHidden(){return!!(2&this._flags)}setIsIgnoredForProtocolMatch(){this._flags|=64}isIgnoredForProtocolMatch(){return!!(64&this._flags)}setIsClassMember(){this._flags|=4}isClassMember(){return!!(4&this._flags)}setIsInstanceMember(){this._flags|=8}isInstanceMember(){return!!(8&this._flags)}setIsClassVar(){this._flags|=128}isClassVar(){return!!(128&this._flags)}setIsInitVar(){this._flags|=1024}isInitVar(){return!!(1024&this._flags)}setIsInDunderAll(){this._flags|=256}isInDunderAll(){return!!(256&this._flags)}setIsPrivateMember(){this._flags|=32}isPrivateMember(){return!!(32&this._flags)}setPrivatePyTypedImport(){this._flags|=512}isPrivatePyTypedImport(){return!!(512&this._flags)}isNamedTupleMemberMember(){return!!(2048&this._flags)}addDeclaration(e){if(this._declarations){const t=this._declarations.findIndex((t=>(0,s.areDeclarationsSame)(t,e)));if(t<0)this._declarations.push(e),this._declarations.forEach((e=>{1===e.type&&e.typeAliasName&&delete e.typeAliasName}));else{const n=this._declarations[t];(0,s.hasTypeForDeclaration)(e)?(this._declarations[t]=e,1===n.type&&1===e.type&&!e.inferredTypeSource&&n.inferredTypeSource&&(e.inferredTypeSource=n.inferredTypeSource)):1===e.type&&1===n.type&&(e.isFinal&&(n.isFinal=!0),n.typeAliasName=e.typeAliasName,!n.inferredTypeSource&&e.inferredTypeSource&&(n.inferredTypeSource=e.inferredTypeSource))}}else this._declarations=[e]}hasDeclarations(){return!!this._declarations&&this._declarations.length>0}getDeclarations(){return this._declarations?this._declarations:[]}hasTypedDeclarations(){return!!this._synthesizedType||this.getDeclarations().some((e=>(0,s.hasTypeForDeclaration)(e)))}getTypedDeclarations(){return this.getDeclarations().filter((e=>(0,s.hasTypeForDeclaration)(e)))}getSynthesizedType(){return this._synthesizedType}}t.Symbol=a},1766:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isPublicConstantOrTypeAlias=t.isTypeAliasName=t.isConstantName=t.isSingleDunderName=t.isDunderName=t.isPrivateOrProtectedName=t.isProtectedName=t.isPrivateName=void 0;const n=/^[A-Z0-9_]+$/,s=/^[_]+$/,i=/^_{0,2}[A-Z][A-Za-z0-9_]+$/;function a(e){return e.length>2&&e.startsWith("__")&&!e.endsWith("__")}function r(e){return e.length>1&&e.startsWith("_")&&!e.startsWith("__")}function o(e){return a(e)||r(e)}function l(e){return!!e.match(n)&&!e.match(s)}function c(e){return!!e.match(i)}t.isPrivateName=a,t.isProtectedName=r,t.isPrivateOrProtectedName=o,t.isDunderName=function(e){return e.length>4&&e.startsWith("__")&&e.endsWith("__")},t.isSingleDunderName=function(e){return e.length>2&&e.startsWith("_")&&e.endsWith("_")},t.isConstantName=l,t.isTypeAliasName=c,t.isPublicConstantOrTypeAlias=function(e){return!o(e)&&(l(e)||c(e))}},2917:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isVisibleExternally=t.isTypedDictMemberAccessedThroughIndex=t.getLastTypedDeclaredForSymbol=void 0,t.getLastTypedDeclaredForSymbol=function(e){const t=e.getTypedDeclarations();if(t.length>0)return t[t.length-1]},t.isTypedDictMemberAccessedThroughIndex=function(e){const t=e.getTypedDeclarations();return t.length>0&&1===t[t.length-1].type},t.isVisibleExternally=function(e){return!e.isExternallyHidden()&&!e.isPrivatePyTypedImport()}},2041:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NameTypeWalker=t.TestWalker=void 0;const s=n(427),i=n(5839),a=n(3550),r=n(8494);class o extends s.ParseTreeWalker{constructor(){super()}visitNode(e){const t=super.visitNode(e);return this._verifyParentChildLinks(e,t),this._verifyChildRanges(e,t),t}_verifyParentChildLinks(e,t){t.forEach((t=>{t&&t.parent!==e&&(0,i.fail)(`Child node ${t.nodeType} does not contain a reference to its parent ${e.nodeType}`)}))}_verifyChildRanges(e,t){let n;const s=(0,r.isCompliantWithNodeRangeRules)(e);t.forEach((t=>{if(t){let r=!1;if(!s)switch(e.nodeType){case 3:t===e.typeAnnotationComment&&(r=!0),3===t.nodeType&&(r=!0);break;case 48:t===e.typeAnnotation&&(r=!0);break;default:(0,i.fail)(`node ${e.nodeType} is not marked as not following range rules.`)}r||((t.start<e.start||a.TextRange.getEnd(t)>a.TextRange.getEnd(e))&&(0,i.fail)(`Child node ${t.nodeType} is not contained within its parent ${e.nodeType}`),n&&t.start<a.TextRange.getEnd(n)&&62!==n.nodeType&&(0,i.fail)("Child node is not after previous child node"),n=t)}}))}}t.TestWalker=o;class l extends s.ParseTreeWalker{constructor(e){super(),this._evaluator=e}visitName(e){var t,n;return 23!==(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&21!==(null===(n=e.parent)||void 0===n?void 0:n.nodeType)&&this._evaluator.isNodeReachable(e,void 0)&&this._evaluator.getType(e),!0}}t.NameTypeWalker=l},1943:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.createTracePrinter=void 0;const r=n(2489),o=n(5839),l=n(6657),c=n(1464),p=n(5275),d=a(n(563)),u=a(n(8494)),y=n(817),m=n(1133);t.createTracePrinter=function(e){function t(e,t="'"){return e?`${t}${e}${t}`:""}e=e.map((e=>(0,l.ensureTrailingDirectorySeparator)(e))).sort(((e,t)=>e.localeCompare(t))).reverse();const n=/[\\/]/g;function s(t){if(t){if("string"==typeof t){for(const s of e)if(t.startsWith(s)){const e=t.substring(s.length);return(0,l.stripFileExtension)(e).replace(n,".")}return t}if(t.nameParts)return t.nameParts.join(".")}return""}function i(e){var n,s,a,r,l,c;if(e)switch(e.category){case 2:return`Any ${t(null===(n=e.typeAliasInfo)||void 0===n?void 0:n.fullName)}`;case 7:return m.TypeBase.isInstantiable(e)?`Class '${e.details.name}' (${e.details.moduleName})`:`Object '${e.details.name}' (${e.details.moduleName})`;case 5:return`Function '${e.details.name}' (${e.details.moduleName})`;case 8:return`Module '${e.moduleName}' (${e.moduleName})`;case 4:return`Never ${t(null===(s=e.typeAliasInfo)||void 0===s?void 0:s.fullName)}`;case 3:return`None ${t(null===(a=e.typeAliasInfo)||void 0===a?void 0:a.fullName)}`;case 6:return`OverloadedFunction [${e.overloads.map((e=>t(i(e),'"'))).join(",")}]`;case 10:return`TypeVar '${e.details.name}' ${t(null===(r=e.typeAliasInfo)||void 0===r?void 0:r.fullName)}`;case 0:return`Unbound ${t(null===(l=e.typeAliasInfo)||void 0===l?void 0:l.fullName)}`;case 9:return`Union [${e.subtypes.map((e=>t(i(e),'"'))).join(",")}]`;case 1:return`Unknown ${t(null===(c=e.typeAliasInfo)||void 0===c?void 0:c.fullName)}`;default:(0,o.assertNever)(e)}return""}function a(e){if(e)switch(e.type){case 8:return`Alias, ${h(e.node)} (${s(e.path)})`;case 6:return`Class, ${h(e.node)} (${s(e.path)})`;case 5:return`Function, ${h(e.node)} (${s(e.path)})`;case 0:return`Intrinsic, ${h(e.node)} ${e.intrinsicType} (${s(e.path)})`;case 2:return`Parameter, ${h(e.node)} (${s(e.path)})`;case 3:return`TypeParameter, ${h(e.node)} (${s(e.path)})`;case 7:return`SpecialBuiltInClass, ${h(e.node)} (${s(e.path)})`;case 1:return`Variable, ${h(e.node)} (${s(e.path)})`;case 4:return`TypeAlias, ${h(e.node)} (${s(e.path)})`;default:(0,o.assertNever)(e)}return""}function g(e){for(;36!==e.nodeType&&e.parent;)e=e.parent;return 36===e.nodeType?d.getFileInfo(e):void 0}function h(e,n=!1){var i;if(!e)return"";let a=n?`(${s(null===(i=g(e))||void 0===i?void 0:i.filePath)})`:"";const r=g(e);if(null==r?void 0:r.lines){const t=(0,c.convertOffsetToPosition)(e.start,r.lines);a+=` [${t.line+1}:${t.character+1}]`}if((0,p.isExpressionNode)(e))return t(function(e,t=30){return e.length<t?e:e.substring(0,t)+" <shortened> "}(u.printExpression(e)),'"')+` ${a}`;switch(e.nodeType){case 21:return`importAs '${h(e.module)}' ${t(e.alias?h(e.alias):"")} ${a}`;case 22:return`importFrom [${e.imports.map((e=>t(h(e),'"'))).join(",")}]`;case 23:return`ImportFromAs '${h(e.name)}' ${t(e.alias?h(e.alias):"")} ${a}`;case 36:return`module ${a}`;case 10:return`class '${h(e.name)}' ${a}`;case 28:return`function '${h(e.name)}' ${a}`;case 37:return`moduleName '${e.nameParts.map((e=>h(e))).join(".")}' ${a}`;case 1:return`argument '${e.name?h(e.name):"N/A"}' ${a}`;case 41:return`parameter '${e.name?h(e.name):"N/A"}' ${a}`;default:return`${u.printParseNodeType(e.nodeType)} ${a}`}}return{print:function(e){return e?function(e){const t=e;return t&&(0,r.isNumber)(t.nodeType)}(e)?h(e,!0):function(e){const t=e;return t&&(0,r.isNumber)(t.type)&&(0,r.isString)(t.path)&&(0,r.isString)(t.moduleName)}(e)?a(e):e instanceof y.Symbol?(t=e)?t.hasDeclarations()?`symbol ${a(t.getDeclarations()[0])}`:"<symbol>":"":function(e){const t=e;return t&&(0,r.isNumber)(t.category)&&(0,r.isNumber)(t.flags)}(e)?i(e):"":"";var t},printFileOrModuleName:s}}},4320:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.SpeculativeTypeTracker=void 0;const r=n(5839),o=a(n(8494)),l=n(1133);t.SpeculativeTypeTracker=class{constructor(){this._speculativeContextStack=[],this._speculativeTypeCache=new Map}enterSpeculativeContext(e,t){this._speculativeContextStack.push({speculativeRootNode:e,entriesToUndo:[],allowCacheRetention:t})}leaveSpeculativeContext(){(0,r.assert)(this._speculativeContextStack.length>0),this._speculativeContextStack.pop().entriesToUndo.forEach((e=>{e.cache.delete(e.id)}))}isSpeculative(e){if(0===this._speculativeContextStack.length)return!1;if(!e)return!0;for(let t=this._speculativeContextStack.length-1;t>=0;t--)if(o.isNodeContainedWithin(e,this._speculativeContextStack[t].speculativeRootNode))return!0;return!1}trackEntry(e,t){const n=this._speculativeContextStack.length;n>0&&this._speculativeContextStack[n-1].entriesToUndo.push({cache:e,id:t})}disableSpeculativeMode(){const e=this._speculativeContextStack;return this._speculativeContextStack=[],e}enableSpeculativeMode(e){(0,r.assert)(0===this._speculativeContextStack.length),this._speculativeContextStack=e}addSpeculativeType(e,t,n,s){if((0,r.assert)(this._speculativeContextStack.length>0),this._speculativeContextStack.some((e=>!e.allowCacheRetention)))return;let i=this._speculativeTypeCache.get(e.id);i||(i=[],this._speculativeTypeCache.set(e.id,i)),i.push({typeResult:t,expectedType:s,incompleteGenerationCount:n})}getSpeculativeType(e,t){if(this._speculativeContextStack.some((t=>o.isNodeContainedWithin(e,t.speculativeRootNode)))){const n=this._speculativeTypeCache.get(e.id);if(n)for(const e of n)if(t){if(e.expectedType&&(0,l.isTypeSame)(t,e.expectedType))return e}else if(!e.expectedType)return e}}}},3371:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getVariableDocString=t.getFunctionOrClassDeclDocString=t.getClassDocString=t.getModuleDocString=t.getModuleDocStringFromPaths=t.getModuleDocStringFromModuleNodes=t.getVariableInStubFileDocStrings=t.getPropertyDocStringInherited=t.getOverloadedFunctionDocStringsInherited=t.getFunctionDocStringInherited=void 0;const r=n(8905),o=a(n(8494)),l=n(8816),c=n(1133),p=n(9489),d=n(5168);function u(e,t){if(6===e.category){if(0===e.overloads.length)return!1;e=e.overloads[0]}return"builtins"===e.details.moduleName&&!!t&&!!e.boundToType&&!c.ClassType.isSameGenericClass(t,e.boundToType)}function y(e,t){const n=[];if(!(0,l.isStubFile)(e.path))return n;for(const s of t.findDeclarations(e))if((0,r.isVariableDeclaration)(s)&&s.docString)n.push(s.docString);else if((0,r.isClassDeclaration)(s)||(0,r.isFunctionDeclaration)(s)){const e=h(s);e&&n.push(e)}return n}function m(e){for(const t of e)if(t.statements){const e=o.getDocString(t.statements);if(e)return e}}function g(e,t){const n=[];for(const s of e)(0,l.isStubFile)(s)&&(0,p.addIfNotNull)(n,t.getModuleNode(s)),n.push(...t.findModules(s));return m(n)}function h(e){var t,n,s;return o.getDocString(null!==(s=null===(n=null===(t=e.node)||void 0===t?void 0:t.suite)||void 0===n?void 0:n.statements)&&void 0!==s?s:[])}function f(e,t,n){if(!(0,c.isOverloadedFunction)(e))return;const s=[];if(e.overloads.some((e=>e.details.docString)))e.overloads.forEach((e=>{e.details.docString&&s.push(e.details.docString)}));else if(t&&(0,l.isStubFile)(t.path)&&(0,r.isFunctionDeclaration)(t)){const e=v(n.findFunctionDeclarations(t));e&&s.push(e)}return s}function T(e,t){let n=v([e]);return!n&&(0,l.isStubFile)(e.path)&&(n=v(t.findFunctionDeclarations(e))),n}function v(e){for(const t of e){const e=h(t);if(e)return e}}t.getFunctionDocStringInherited=function(e,t,n,s){let i;if(!u(e,s)&&t&&(0,r.isFunctionDeclaration)(t)&&(i=function(e,t,n){if(!(0,c.isFunction)(e))return;let s=e.details.docString;return!s&&t&&(s=T(t,n)),!s&&e.details.declaration&&(s=T(e.details.declaration,n)),s}(e,t,n)),!i&&s){const t=e.details.name,a=(0,d.getClassMemberIterator)(s,t,29);for(const e of a)if(e.symbol.getDeclarations().length>0){const t=e.symbol.getDeclarations().slice(-1)[0];if((0,r.isFunctionDeclaration)(t)&&(i=T(t,n),i))break}}return i||e.details.docString},t.getOverloadedFunctionDocStringsInherited=function(e,t,n,s,i){var a;let r;if(!u(e,i))for(const s of t)if(r=f(e,s,n),r&&r.length>0)return r;if(i&&e.overloads.length>0){const t=e.overloads[0].details.name,o=(0,d.getClassMemberIterator)(i,t,29);for(const e of o){const t=e.symbol.getDeclarations().slice(-1)[0],i=null===(a=s.getTypeForDeclaration(t))||void 0===a?void 0:a.type;if(i&&(r=f(i,t,n),r&&r.length>0))break}}return null!=r?r:[]},t.getPropertyDocStringInherited=function(e,t,n){const s=o.getEnclosingClass(e.node.name,!1),i=s?n.getTypeOfClass(s):void 0;if(i)return function(e,t,n,s){var i,a;if(!e||!(0,r.isFunctionDeclaration)(e))return;const o=null===(i=n.getTypeForDeclaration(e))||void 0===i?void 0:i.type;if(!o||!(0,d.isMaybeDescriptorInstance)(o))return;const l=28===e.node.nodeType?e.node.name.value:void 0;if(!l)return;const p=(0,d.getClassIterator)(s,0);for(const[e]of p){if(!(0,c.isInstantiableClass)(e))continue;const s=e.details.fields.get(l),i=null==s?void 0:s.getDeclarations();if(i)for(const e of i)if((0,r.isFunctionDeclaration)(e)){const s=null===(a=n.getTypeForDeclaration(e))||void 0===a?void 0:a.type;if(s&&(0,d.isMaybeDescriptorInstance)(s)){const n=T(e,t);if(n)return n}}}}(e,t,n,i.classType)},t.getVariableInStubFileDocStrings=y,t.getModuleDocStringFromModuleNodes=m,t.getModuleDocStringFromPaths=g,t.getModuleDocString=function(e,t,n){var s;let i=e.docString;return i||(i=g([null!==(s=null==t?void 0:t.path)&&void 0!==s?s:e.filePath],n)),i},t.getClassDocString=function(e,t,n){let s=e.details.docString;if(!s&&t&&(0,r.isClassDeclaration)(t)&&(s=v([t]),!s&&t&&(0,l.isStubFile)(t.path)&&6===t.type))for(const e of n.findDeclarations(t)){if((0,r.isVariableDeclaration)(e)&&e.docString){s=e.docString;break}if((0,r.isClassDeclaration)(e)||(0,r.isFunctionDeclaration)(e)){s=h(e);break}}if(!s&&t){const i=n.findClassDeclarationsByType(t.path,e);i&&(s=v(i.filter((e=>(0,r.isClassDeclaration)(e))).map((e=>e))))}return s},t.getFunctionOrClassDeclDocString=h,t.getVariableDocString=function(e,t){if(e)return void 0!==e.docString?e.docString:y(e,t).find((e=>e))}},7887:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.createTypeEvaluator=t.maxCodeComplexity=void 0;const r=n(3213),o=n(9489),l=n(5839),c=n(1290),p=n(9744),d=n(1464),u=n(6886),y=n(3550),m=n(9866),g=n(5275),h=n(2540),f=n(691),T=a(n(563)),v=n(4184),_=n(4972),I=n(2044),b=n(1901),C=n(6168),S=n(5523),x=n(1985),D=n(4289),F=n(118),E=n(7848),P=a(n(8494)),A=n(6061),N=n(9335),k=n(4124),w=a(n(5083)),M=n(8235),R=n(817),O=n(1766),L=n(2917),V=n(4320),U=n(9453),z=n(503),B=a(n(3843)),G=n(1133),W=n(5168),j=n(4447),$={0:["__add__","__radd__"],33:["__sub__","__rsub__"],26:["__mul__","__rmul__"],13:["__floordiv__","__rfloordiv__"],10:["__truediv__","__rtruediv__"],24:["__mod__","__rmod__"],29:["__pow__","__rpow__"],22:["__matmul__","__rmatmul__"],3:["__and__","__rand__"],6:["__or__","__ror__"],8:["__xor__","__rxor__"],17:["__lshift__","__rlshift__"],31:["__rshift__","__rrshift__"],12:["__eq__","__eq__"],28:["__ne__","__ne__"],20:["__lt__","__gt__"],21:["__le__","__ge__"],15:["__gt__","__lt__"],16:["__ge__","__le__"]},q={36:!0,37:!0,39:!0,40:!0,41:!0,42:!0},K=new Map([["asyncio.futures.Future",u.PythonVersion.V3_9],["asyncio.tasks.Task",u.PythonVersion.V3_9],["builtins.dict",u.PythonVersion.V3_9],["builtins.frozenset",u.PythonVersion.V3_9],["builtins.list",u.PythonVersion.V3_9],["builtins._PathLike",u.PythonVersion.V3_9],["builtins.set",u.PythonVersion.V3_9],["builtins.tuple",u.PythonVersion.V3_9],["collections.ChainMap",u.PythonVersion.V3_9],["collections.Counter",u.PythonVersion.V3_9],["collections.defaultdict",u.PythonVersion.V3_9],["collections.DefaultDict",u.PythonVersion.V3_9],["collections.deque",u.PythonVersion.V3_9],["collections.OrderedDict",u.PythonVersion.V3_9],["queue.Queue",u.PythonVersion.V3_9]]),H=new Map([["builtins.float",["builtins.int"]],["builtins.complex",["builtins.float","builtins.int"]],["builtins.bytes",["builtins.bytearray","builtins.memoryview"]]]);t.maxCodeComplexity=768,t.createTypeEvaluator=function(e,n){const s=[],i=new Set,a=new V.SpeculativeTypeTracker,Y=[];let Z,Q,J,X,ee,te,ne,se,ie,ae,re,oe,le,ce=new Set,pe=new Map,de=new Map,ue=new Map,ye=new Map,me=[],ge=!1,he=0;const fe=[];let Te;function ve(){Z&&(0,r.throwIfCancellationRequested)(Z)}function _e(e){return Te&&xe(e)?Te.get(e.id):de.get(e.id)}function Ie(e){const t=_e(e);return!(!t||t.typeResult.isIncomplete&&t.incompleteGenerationCount!==he)}function be(e,t){var s,i;const a=_e(e);if(a&&!a.typeResult.isIncomplete){if(n.verifyTypeCacheEvaluatorFlags&&void 0!==t){const r=a.flags;if(void 0!==r&&t!==r){const a=T.getFileInfo(e),o=(0,d.convertOffsetToPosition)(e.start,a.lines),c=`Type cache flag mismatch for node type ${e.nodeType} (parent ${null!==(i=null===(s=e.parent)||void 0===s?void 0:s.nodeType)&&void 0!==i?i:"none"}): cached flags = ${r}, access flags = ${t}, file = {${a.filePath} [${o.line+1}:${o.character+1}]}`;n.verifyTypeCacheEvaluatorFlags?(0,l.fail)(c):console.log(c)}}return a.typeResult.type}}function Ce(e,t,n,s,i=!1){const r=Te&&xe(e)?Te:de;if(t.isIncomplete){const n=r.get(e.id);void 0===n||(0,G.isTypeSame)(t.type,n.typeResult.type)||he++}else he++;r.set(e.id,{typeResult:t,flags:n,incompleteGenerationCount:he}),a.isSpeculative(e)&&(a.trackEntry(r,e.id),i&&a.addSpeculativeType(e,t,he,null==s?void 0:s.expectedType))}function Se(e,t=G.UnknownType.create(),n=0){Ce(e,{type:t},n)}function xe(e){const t=fe.length;if(0===t)return!1;const n=fe[t-1];let s=e;for(;s;){if(s===n.functionNode)return!0;s=s.parent}return!1}function De(e,t){return s.findIndex((n=>n.symbolId===e.id&&n.declaration===t))}function Fe(e,t){const n=De(e,t);if(n>=0){for(let e=n+1;e<s.length;e++)s[e].isResultValid=!1;return!1}return s.push({symbolId:e.id,declaration:t,isResultValid:!0}),!0}function Ee(e){const t=s.pop();return(0,l.assert)(t.symbolId===e.id),t.isResultValid}function Pe(e,t,n){const i=De(e,t);i>=0&&(s[i].partialType=n)}function Ae(e,t){const n=De(e,t);if(n>=0)return s[n].partialType}function Ne(e){var t;return null===(t=Ts(e,(()=>{gs(e)})))||void 0===t?void 0:t.type}function ke(e){let t=e,n=e;for(;n;)(0,g.isExpressionNode)(n)&&(t=n),n=n.parent;for(gs(t),n=e;n;){const e=ye.get(n.id);if(e)return{type:e,node:n};if(n===t)break;n=n.parent}}function we(e){ge||(ge=!0,X=Ds(e,"object"),ee=xs(e,"type"),te=Ds(e,"function"),Je(e,"Collection"),Q=Xe(e,"NoneType")||G.AnyType.create(),ne=xs(e,"tuple"),se=xs(e,"bool"),ie=xs(e,"int"),ae=xs(e,"str"),re=xs(e,"dict"),oe=Je(e,"TypedDict"),le=Je(e,"_TypedDict"))}function Me(e,t=0,n){var s,i;const r=_e(e);if(r&&(!r.typeResult.isIncomplete||r.incompleteGenerationCount===he))return r.typeResult;{const t=a.getSpeculativeType(e,null==n?void 0:n.expectedType);if(t&&(!t.typeResult.isIncomplete||t.incompleteGenerationCount===he))return t.typeResult}let o;ve(),n&&(n.expectedType=(0,W.transformPossibleRecursiveTypeAlias)(n.expectedType)),we(e);let d=0!=(128&t);switch(e.nodeType){case 38:o=function(e,t){var n;const s=T.getFileInfo(e),i=e.value;let a,r,o=!1;const c=0!=(4&t)||s.isStubFile,d=T.getTypeParameterSymbol(e);if(d){a=d,(0,l.assert)(1===a.getDeclarations().length);const t=(0,L.getLastTypedDeclaredForSymbol)(a);(0,l.assert)(3===(null==t?void 0:t.type)),r=ws(t.node),Tt(s,a,e)}else{let n=Fs(e,i,!c,c&&0!=(256&t));if(!n){const s=Ns(e);s&&(n=Fs(s,s.value,!c,c&&0!=(256&t)))}if(n){let d=!c;if(4===n.scope.type&&(d=!1),a=n.symbol,Tt(s,a,e),!s.diagnosticRuleSet.analyzeUnannotatedFunctions){const t=P.getEnclosingFunction(e);if(t&&P.isUnannotatedFunction(t))return{type:G.AnyType.create(),isIncomplete:!1}}const u=Vs(a,d?e:void 0);let y=(0,W.transformPossibleRecursiveTypeAlias)(u.type);u.isIncomplete&&((0,G.isUnbound)(y)&&(y=G.UnknownType.create(!0)),o=!0),u.isRecursiveDefinition&&nt(e)&&ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.recursiveDefinition().format({name:i}),e);const g=!!y&&(0,G.isInstantiableClass)(y)&&G.ClassType.isSpecialBuiltIn(y);if(r=y,d&&!g){let s=y;if(!n.isBeyondExecutionScope&&a.isInitiallyUnbound()&&(s=G.UnboundType.create(),3===n.scope.type)){(0,l.assert)(n.scope.parent);const e=n.scope.parent.lookUpSymbol(i);e&&(s=Vs(e).type)}const c=_s(e,a.id,s,void 0,{skipConditionalNarrowing:0!=(256&t)});if(c.type&&(r=c.type),c.isIncomplete&&(o=!0),!c.type&&n.isBeyondExecutionScope){const t=function(e,t,n){if(!t.symbol.getDeclarations().every((e=>1===e.type||2===e.type||8===e.type)))return;const s=w.getScopeHierarchy(e,t.scope);if(s&&s.length>=2&&s.every((e=>1===e.type||3===e.type))){const i=w.findTopNodeInScope(e,s[s.length-2]);if(i&&(28===i.nodeType||30===i.nodeType)){const s=T.getFlowNode(i);if(s&&t.symbol.getDeclarations().every((e=>{if(2===e.type)return!0;if(8===e.type)return!0;const t=T.getFlowNode(e.node);return!!t&&!hi.isFlowNodeReachable(t,s,!0)})))return _s(e,t.symbol.id,n,i)}}}(e,n,y);(null==t?void 0:t.type)&&(r=t.type),(null==t?void 0:t.isIncomplete)&&(o=!0)}}if(r=It(e,r,t),0!=(256&t)&&u.includesVariableDecl&&!r.typeAliasInfo){let n=(0,G.isTypeVar)(r)||(0,W.isTypeAliasPlaceholder)(r);(0,G.isClass)(r)&&!r.includeSubclasses&&(n=!0),n||s.isTypingStubFile||!u.includesIllegalTypeAliasDecl&&G.TypeBase.isInstantiable(r)&&0==(2&t)||(ct(s.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeAnnotationVariable(),e),r=G.UnknownType.create())}}else"reveal_type"===i||"reveal_locals"===i?r=G.AnyType.create():(ct(s.diagnosticRuleSet.reportUndefinedVariable,p.DiagnosticRule.reportUndefinedVariable,m.Localizer.Diagnostic.symbolIsUndefined().format({name:i}),e),r=G.UnknownType.create())}if((0,G.isParamSpec)(r)&&32&t&&(rt(m.Localizer.Diagnostic.paramSpecContext(),e),r=G.UnknownType.create()),(0,G.isTypeVar)(r)&&!r.details.isParamSpec&&!r.isVariadicInUnion&&0==(128&t)&&r.details.name===i&&(7!==(null===(n=e.parent)||void 0===n?void 0:n.nodeType)||6!==e.parent.operator)){const t=r.details.isVariadic?Je(e,"TypeVarTuple"):Je(e,"TypeVar");r=t&&(0,G.isInstantiableClass)(t)?G.ClassType.cloneAsInstance(t):G.UnknownType.create()}return 0!=(128&t)&&0==(1024&t)&&(0,G.isInstantiableClass)(r)&&G.ClassType.isBuiltIn(r,"Generic")&&ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.genericNotAllowed(),e),(0,G.isTypeVar)(r)&&!r.details.isSynthesized&&(r=_t(e,r,t)),{type:r,isIncomplete:o}}(e,t);break;case 35:o=function(e,t){const n=2|571652&t,s=Me(e.leftExpression,n);if((0,W.isTypeAliasPlaceholder)(s.type))return{type:G.UnknownType.create(!0),isIncomplete:!0};const i=St(e,s,{method:"get"},2|t);if((0,_.isCodeFlowSupportedForReference)(e)){Ce(e,{...i,isIncomplete:!0},t),Ce(e.memberName,{...i,isIncomplete:!0},t);let n=i.type,a=!!i.isIncomplete;if((0,G.isUnbound)(n)){const t=mt(s.type);let i;(0,G.isInstantiableClass)(t)?i=(0,W.lookUpClassMember)(t,e.memberName.value,1):(0,G.isClassInstance)(t)&&(i=(0,W.lookUpObjectMember)(t,e.memberName.value,1)),i&&(n=js(i),a=!1)}const r=_s(e,R.indeterminateSymbolId,n,void 0,{isTypeAtStartIncomplete:a,skipConditionalNarrowing:0!=(256&t)});r.type&&(i.type=r.type),r.isIncomplete&&(i.isIncomplete=!0),i.type=It(e,i.type,t)}return s.isIncomplete&&(i.isIncomplete=!0),Ce(e.memberName,i,t),i}(e,t);break;case 24:o=function(e,t=0){const n=Me(e.baseExpression,2|t);if(128&t&&48===e.baseExpression.nodeType){const t=T.getFileInfo(e);!t.isStubFile&&t.executionEnvironment.pythonVersion<u.PythonVersion.V3_10&&rt(m.Localizer.Diagnostic.stringNotSubscriptable(),e.baseExpression)}if(0==(4&t)){let s=0!=(32768&t);if(s){const t=P.getExecutionScopeNode(e);36===(null==t?void 0:t.nodeType)&&(s=!1)}if(!s){const t=T.getFileInfo(e);if((0,G.isInstantiableClass)(n.type)&&G.ClassType.isBuiltIn(n.type)&&!n.type.aliasName){const s=K.get(n.type.details.fullName);void 0!==s&&t.executionEnvironment.pythonVersion<s&&!t.isStubFile&&rt(m.Localizer.Diagnostic.classNotRuntimeSubscriptable().format({name:n.type.aliasName||n.type.details.name}),e.baseExpression)}}}const s=Pt(e,n,{method:"get"},t);if((0,_.isCodeFlowSupportedForReference)(e)){let i=!0;if(gt(n.type,void 0,(e=>{(0,G.isClassInstance)(e)&&(G.ClassType.isBuiltIn(e)||G.ClassType.isTypedDictClass(e))||(i=!1)})),i){Ce(e,s,t);const i=_s(e,R.indeterminateSymbolId,s.type,void 0,{isTypeAtStartIncomplete:!!n.isIncomplete||!!s.isIncomplete,skipConditionalNarrowing:0!=(256&t)});i.type&&(s.type=i.type),i.isIncomplete&&(s.isIncomplete=!0)}}return n.isIncomplete&&(s.isIncomplete=!0),s}(e,t);break;case 9:o=function(e,t,n){var s;const i=Me(e.leftExpression,2),r=e.arguments.map((e=>({valueExpression:e.valueExpression,argumentCategory:e.argumentCategory,node:e,name:e.name})));let o={type:G.UnknownType.create()};if((0,W.isTypeAliasPlaceholder)(i.type))o.isIncomplete=!0;else{if(38===e.leftExpression.nodeType&&"super"===e.leftExpression.value)o=function(e){let t,n;if(e.arguments.length>2&&rt(m.Localizer.Diagnostic.superCallArgCount(),e.arguments[2]),e.arguments.length>0){t=Me(e.arguments[0].valueExpression).type;const n=mt(t);(0,G.isAnyOrUnknown)(n)||(0,G.isInstantiableClass)(n)||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.superCallFirstArg().format({type:mi(t)}),e.arguments[0].valueExpression)}else{const n=P.getEnclosingClass(e);if(n){const e=jn(n);t=e?e.classType:G.UnknownType.create()}else rt(m.Localizer.Diagnostic.superCallZeroArgForm(),e.leftExpression),t=G.UnknownType.create()}if(e.arguments.length>1){const s=mt(Me(e.arguments[1].valueExpression).type);let i=!1;(0,G.isAnyOrUnknown)(s)||((0,G.isClassInstance)(s)?((0,G.isInstantiableClass)(t)&&((0,W.derivesFromClassRecursive)(G.ClassType.cloneAsInstantiable(s),t,!0)||(i=!0)),n=s):(0,G.isInstantiableClass)(s)?((0,G.isInstantiableClass)(t)&&((0,W.derivesFromClassRecursive)(s,t,!0)||(i=!0)),n=s):i=!0),i&&ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.superCallSecondArg().format({type:mi(t)}),e.arguments[1].valueExpression)}else{const s=P.getEnclosingFunction(e);let i;if(s){const e=Jn(s);if(e){const t=e.functionType;G.FunctionType.isClassMethod(t)?t.details.parameters.length>0&&t.details.parameters[0].hasDeclaredType&&(i=mt(t.details.parameters[0].type)):G.FunctionType.isInstanceMethod(t)&&t.details.parameters.length>0&&t.details.parameters[0].hasDeclaredType&&(i=mt((0,W.convertToInstantiable)(t.details.parameters[0].type)))}}i&&(0,G.isInstantiableClass)(i)?n=i:(0,G.isInstantiableClass)(t)&&(n=t)}let s=!0;if(e.arguments.length<=1){const t=P.getEnclosingFunction(e);if(t){const e=Jn(t);e&&(G.FunctionType.isStaticMethod(e.functionType)||G.FunctionType.isConstructorMethod(e.functionType)||G.FunctionType.isClassMethod(e.functionType))&&(s=!1)}}const i=e.parent;if(35===i.nodeType){const e=i.memberName.value,a=(0,W.lookUpClassMember)(t,e,1);if(a&&(0,G.isInstantiableClass)(a.classType))return{type:s?G.ClassType.cloneAsInstance(a.classType):a.classType,bindToType:n?G.TypeBase.cloneForCondition((0,W.synthesizeTypeVarForSelfCls)(n,!s),n.condition):void 0}}if((0,G.isInstantiableClass)(t)){if(t.details.mro.some((e=>(0,G.isAnyOrUnknown)(e))))return{type:G.UnknownType.create()};const e=t.details.baseClasses;if(e.length>0){const t=e[0];if((0,G.isInstantiableClass)(t))return{type:s?G.ClassType.cloneAsInstance(t):t}}}return{type:G.UnknownType.create()}}(e);else if((0,G.isAnyOrUnknown)(i.type)&&38===e.leftExpression.nodeType&&"reveal_type"===e.leftExpression.value)o=Lt(e,t);else if((0,G.isFunction)(i.type)&&"reveal_type"===i.type.details.builtInName)o=Lt(e,t);else if((0,G.isFunction)(i.type)&&"assert_type"===i.type.details.builtInName)o=function(e,t){if(2!==e.arguments.length||0!==e.arguments[0].argumentCategory||void 0!==e.arguments[0].name||0!==e.arguments[0].argumentCategory||void 0!==e.arguments[1].name)return rt(m.Localizer.Diagnostic.assertTypeArgs(),e),{type:G.UnknownType.create()};const n=Me(e.arguments[0].valueExpression,void 0,t);if(n.isIncomplete)return{type:G.UnknownType.create(!0),isIncomplete:!0};const s=(0,W.convertToInstance)(Cs(e.arguments[1]).type);return(0,G.isTypeSame)(s,n.type,{treatAnySameAsUnknown:!0,ignorePseudoGeneric:!0})||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.assertTypeTypeMismatch().format({expected:mi(s),received:mi(n.type)}),e.arguments[0].valueExpression),{type:n.type}}(e,t);else if((0,G.isAnyOrUnknown)(i.type)&&38===e.leftExpression.nodeType&&"reveal_locals"===e.leftExpression.value)0===e.arguments.length?o.type=function(e){let t,n=e;for(;n&&(t=w.getScopeForNode(n),!t||0===t.type);)n=n.parent;const s=[];return t&&t.symbolTable.forEach(((e,t)=>{if(!e.isIgnoredForProtocolMatch()){const n=Ls(e);s.push(m.Localizer.DiagnosticAddendum.typeOfSymbol().format({name:t,type:mi(n,{expandTypeAlias:!0})}))}})),s.length>0?at(s.join("\n"),e):at(m.Localizer.Diagnostic.revealLocalsNone(),e),G.NoneType.createInstance()}(e):rt(m.Localizer.Diagnostic.revealLocalsArgs(),e);else{const n=Ht(e,r,i,void 0,!1,t);o.type=null!==(s=n.returnType)&&void 0!==s?s:G.UnknownType.create(),n.argumentErrors?o.typeErrors=!0:o.overloadsUsedForCall=n.overloadsUsedForCall,n.isTypeIncomplete&&(o.isIncomplete=!0)}i.isIncomplete&&(o.isIncomplete=!0)}return a.isSpeculative(e)||i.isIncomplete||(0,G.isInstantiableClass)(i.type)&&G.ClassType.isBuiltIn(i.type,"TypeVar")&&T.getFileInfo(e).isTypingStubFile||r.forEach((e=>{e.valueExpression&&48!==e.valueExpression.nodeType&&!Ie(e.valueExpression)&&Me(e.valueExpression)})),0!=(256&n)&&(ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeAnnotationCall(),e),o={type:G.UnknownType.create()}),o}(e,n,t);break;case 52:o=function(e,t,n){if(0!=(128&n)&&0===e.expressions.length&&!t)return{type:Nt([]),isEmptyTupleShorthand:!0};let s,i=null==t?void 0:t.expectedType,a=t&&(0,G.isAny)(t.expectedType);if(t&&(0,G.isUnion)(t.expectedType)){let n;(0,W.doForEachSubtype)(t.expectedType,(s=>{if((0,G.isAny)(s)&&(a=!0),!n){const i=Ps(e,(()=>Rt(e,(0,W.makeInferenceContext)(s,null==t?void 0:t.typeVarContext))));i&&Zs(s,i.type)&&(n=s)}})),i=n}if(i){const n=Rt(e,(0,W.makeInferenceContext)(i,null==t?void 0:t.typeVarContext));if(n&&!n.typeErrors)return n;s=null==n?void 0:n.expectedTypeDiagAddendum}const r=function(e){const t=e.expressions.map((e=>Me(e))),n=t.some((e=>e.isIncomplete));if(!ne||!(0,G.isInstantiableClass)(ne))return{type:G.UnknownType.create()};const s=(0,W.convertToInstance)((0,W.specializeTupleClass)(ne,Ot(t)));return n&&(0,W.getContainerDepth)(s)>8?{type:G.UnknownType.create()}:{type:s,isIncomplete:n}}(e);return a&&(r.type=G.AnyType.create()),{...r,expectedTypeDiagAddendum:s}}(e,n,t);break;case 11:o=function(e,t){let n;if(26===e.constType?n=0!=(128&t)?G.NoneType.createType():G.NoneType.createInstance():33!==e.constType&&15!==e.constType&&9!==e.constType||(n=Ds(e,"bool"),n&&(0,G.isClassInstance)(n)&&(33===e.constType?n=G.ClassType.cloneWithLiteral(n,!0):15===e.constType&&(n=G.ClassType.cloneWithLiteral(n,!1)))),n)return{type:n}}(e,t);break;case 48:{const n=0!=(8&t)&&!function(e){if(e.parent&&24===e.parent.nodeType){const t=Me(e.parent.baseExpression).type;if(t&&(0,G.isInstantiableClass)(t)&&G.ClassType.isSpecialBuiltIn(t,"Literal"))return!0}return!1}(e);n&&(d=!1),o=function(e,t,n){let s;if(n){let n=132|t;if(0==(4194304&t)&&(n|=524288),e.typeAnnotation)s=Me(e.typeAnnotation,n);else if(!e.typeAnnotation&&1===e.strings.length){const t=function(e){const t=T.getFileInfo(e),n=new h.Parser,s=e.strings[0].value,i=e.strings[0].start+e.strings[0].token.prefixLength+e.strings[0].token.quoteMarkLength,a=new h.ParseOptions;a.isStubFile=t.isStubFile,a.pythonVersion=t.executionEnvironment.pythonVersion,a.reportErrorsForParsedStringContents=!0;const r=n.parseTextExpression(t.fileContents,i,s.length,a,void 0,void 0,t.typingSymbolAliases);if(r.parseTree&&62!==r.parseTree.nodeType)return r.diagnostics.forEach((t=>{rt(t.message,e)})),r.parseTree.parent=e,r.parseTree}(e);t&&(s=Me(t,n))}s||(ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.expectedTypeNotString(),e),s={type:G.UnknownType.create()})}else{let t=!0,n=!1;e.strings.forEach((e=>{const s=Re(e);s.isIncomplete&&(n=!0);let i=!1;(0,G.isClassInstance)(s.type)&&(G.ClassType.isBuiltIn(s.type,"str")&&void 0!==s.type.literalValue||G.ClassType.isBuiltIn(null==s?void 0:s.type,"LiteralString"))&&(i=!0),i||(t=!1)}));const i=0!=(32&e.strings[0].token.flags);if(e.strings.some((e=>27===e.nodeType))){if(t){const t=Je(e,"LiteralString");t&&(0,G.isInstantiableClass)(t)&&(s={type:G.ClassType.cloneAsInstance(t)})}s||(s={type:Ds(e,i?"bytes":"str"),isIncomplete:n})}else s={type:Dn(e,i?"bytes":"str",e.strings.map((e=>e.value)).join("")),isIncomplete:n}}return s}(e,t,n);break}case 40:o=function(e,t){return e.isImaginary?{type:Ds(e,"complex")}:e.isInteger?{type:Dn(e,"int",e.value)}:{type:Ds(e,"float")}}(e);break;case 18:o=function(e,t,n){return 0!=(1&e)?{type:G.AnyType.create(!0)}:0!=(512&e)?{type:G.UnknownType.create()}:{type:Ds(n,"ellipsis")||G.AnyType.create()}}(t,0,e);break;case 55:o=function(e,t){const n=Me(e.expression);let s=mt(n.type);const i=n.isIncomplete;if((0,G.isNever)(s))return{type:G.NeverType.createNever(),isIncomplete:i};const a={0:"__pos__",33:"__neg__",5:"__invert__"};let r;if(38!==e.operator&&(0,W.isOptionalType)(s)&&(ct(T.getFileInfo(e).diagnosticRuleSet.reportOptionalOperand,p.DiagnosticRule.reportOptionalOperand,m.Localizer.Diagnostic.noneOperator().format({operator:P.printOperator(e.operator)}),e.expression),s=(0,G.removeNoneFromUnion)(s)),!n.isIncomplete){const t=(0,W.getLiteralTypeClassName)(s);"int"===t?0===e.operator?r=s:33===e.operator&&(r=(0,W.mapSubtypes)(s,(e=>{const t=e;return G.ClassType.cloneWithLiteral(t,-t.literalValue)}))):"bool"===t&&38===e.operator&&(r=(0,W.mapSubtypes)(s,(e=>{const t=e;return G.ClassType.cloneWithLiteral(t,!t.literalValue)})))}if(!r)if(38===e.operator)r=Ds(e,"bool"),r||(r=G.UnknownType.create());else if(r=(0,G.isAnyOrUnknown)(s)?s:dn(s,[],a[e.operator],e,t),!r){ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,t?m.Localizer.Diagnostic.typeNotSupportUnaryOperatorBidirectional().format({operator:P.printOperator(e.operator),type:mi(s),expectedType:mi(t.expectedType)}):m.Localizer.Diagnostic.typeNotSupportUnaryOperator().format({operator:P.printOperator(e.operator),type:mi(s)}),e),r=G.UnknownType.create()}return{type:r,isIncomplete:i}}(e,n);break;case 7:o=on(e,n,t);break;case 5:o=cn(e,n);break;case 31:case 45:o=function(e,t){let n,s=null==t?void 0:t.expectedType;if(t&&(0,G.isUnion)(t.expectedType)){let n,i;(0,W.doForEachSubtype)(t.expectedType,(s=>{if(i&&!i.typeErrors)return;const a=Ps(e,(()=>hn(e,(0,W.makeInferenceContext)(s,null==t?void 0:t.typeVarContext))));a&&Zs(s,a.type)&&(!i||i.typeErrors&&!a.typeErrors)&&(n=s,i=a)})),s=n}if(s){const i=hn(e,(0,W.makeInferenceContext)(s,null==t?void 0:t.typeVarContext));if(i&&!i.typeErrors)return i;n=null==i?void 0:i.expectedTypeDiagAddendum}return{...fn(e,void 0!==t),expectedTypeDiagAddendum:n}}(e,n);break;case 46:o=function(e){return a.isSpeculative(e)||(e.startValue&&Me(e.startValue),e.endValue&&Me(e.endValue),e.stepValue&&Me(e.stepValue)),{type:Ds(e,"slice")}}(e);break;case 6:o=function(e,t,n){const s=n?is(e,n.expectedType,!1):void 0,i=Me(e.expression,t,(0,W.makeInferenceContext)(s)),a={type:Ye(i.type,e.expression)};return i.isIncomplete&&(a.isIncomplete=!0),a}(e,t,n);break;case 51:o=function(e,t,n){Me(e.testExpression);const s=[];let i=!1,a=!1;const r=T.getFileInfo(e),o=(0,M.evaluateStaticBoolExpression)(e.testExpression,r.executionEnvironment,r.definedConstants);if(!1!==o&&nt(e.ifExpression)){const r=Me(e.ifExpression,t,n);s.push(r.type),r.isIncomplete&&(i=!0),r.typeErrors&&(a=!0)}if(!0!==o&&nt(e.elseExpression)){const r=Me(e.elseExpression,t,n);s.push(r.type),r.isIncomplete&&(i=!0),r.typeErrors&&(a=!0)}return{type:(0,G.combineTypes)(s),isIncomplete:i,typeErrors:a}}(e,t,n);break;case 32:o=function(e,t){var n;let s,i=!1,a=!1,r=e.forIfNodes.some((e=>33===e.nodeType&&e.isAsync||34===e.nodeType&&6===e.testExpression.nodeType)),o=G.UnknownType.create();6===e.expression.nodeType&&(r=!0),t&&(s=null===(n=Ze({type:t.expectedType},r,void 0))||void 0===n?void 0:n.type);const l=bn(e,s);l.isIncomplete&&(i=!0),l.typeErrors&&(a=!0);const c=l.type;!r&&t&&(0,G.isClassInstance)(t.expectedType)&&G.ClassType.isBuiltIn(t.expectedType,"AsyncGenerator")&&(r=!0);const p=Je(e,r?"AsyncGenerator":"Generator");return p&&(0,G.isInstantiableClass)(p)&&(o=G.ClassType.cloneAsInstance(G.ClassType.cloneForSpecialization(p,r?[c,G.NoneType.createInstance()]:[c,G.NoneType.createInstance(),G.NoneType.createInstance()],!0))),{type:o,isIncomplete:i,typeErrors:a}}(e,n);break;case 15:o=function(e,t){let n,s=null==t?void 0:t.expectedType;if(t&&(0,G.isUnion)(t.expectedType)){let n,i;(0,W.doForEachSubtype)(t.expectedType,(s=>{if(i&&!i.typeErrors)return;const a=Ps(e,(()=>yn(e,(0,W.makeInferenceContext)(s,null==t?void 0:t.typeVarContext))));a&&Zs(s,a.type)&&(!i||i.typeErrors&&!a.typeErrors)&&(n=s,i=a)})),s=n}if(s){n=new c.DiagnosticAddendum;const i=yn(e,(0,W.makeInferenceContext)(s,null==t?void 0:t.typeVarContext),n);if(i)return i}return{...mn(e,!!t),expectedTypeDiagAddendum:n}}(e,n);break;case 30:o=function(e,t){let n=!!(null==t?void 0:t.isTypeIncomplete);const s=G.FunctionType.createInstance("","","",131072);s.details.typeVarScopeId=bt(e),Ce(e,{type:s,isIncomplete:!0},0);let i=[];if(t){(0,W.mapSubtypes)(t.expectedType,(e=>{if((0,G.isFunction)(e)&&i.push(e),(0,G.isClassInstance)(e)){const t=qe(e,"__call__");t&&(0,G.isFunction)(t)&&i.push(t)}}));const n=e.parameters.filter((e=>0===e.category&&void 0===e.defaultValue)).length,s=e.parameters.filter((e=>0===e.category)).length;i=i.filter((e=>{const t=e.details.parameters.filter((e=>!!e.name&&!e.hasDefault)).length;return e.details.parameters.some((e=>!!e.name&&0!==e.category))||t>=n&&t<=s}))}const r=i.length>0?i[0]:void 0;let o=!0;e.parameters.forEach(((t,n)=>{let i=G.UnknownType.create();if(r&&n<r.details.parameters.length&&(i=G.FunctionType.getEffectiveParameterType(r,n)),t.name&&Ce(t.name,{type:ts(e,t.category,i)},0),t.defaultValue&&Me(t.defaultValue,1),n>=0){let e=!1;0===t.category&&t.name?(0,O.isPrivateName)(t.name.value)&&(e=!0):o=!1,o&&!e&&s.details.parameters.length>0&&G.FunctionType.addParameter(s,{category:0,type:G.UnknownType.create()}),e||(o=!1)}const a={category:t.category,name:t.name?t.name.value:void 0,hasDefault:!!t.defaultValue,defaultValueExpression:t.defaultValue,hasDeclaredType:!0,type:i};G.FunctionType.addParameter(s,a)})),o&&s.details.parameters.length>0&&G.FunctionType.addParameter(s,{category:0,type:G.UnknownType.create()});const l=r?Bs(r):void 0,c=()=>{const t=Me(e.expression,void 0,(0,W.makeInferenceContext)(l));s.inferredReturnType=t.type,t.isIncomplete&&(n=!0)};return a.isSpeculative(e)||(null==t?void 0:t.isTypeIncomplete)?Ps(e.expression,(()=>{c()}),!1):c(),s.details.flags&=-131073,{type:s,isIncomplete:n}}(e,n);break;case 3:o=Me(e.rightExpression),ht(e.leftExpression,o.type,!!o.isIncomplete,e.rightExpression,!0,!0);break;case 4:o=Me(e.rightExpression),ht(e.name,o.type,!!o.isIncomplete,e.rightExpression,!0);break;case 60:o=function(e){let t,n,s=!1;const i=P.getEnclosingFunction(e);if(i){const e=Jn(i);if(e){const s=G.FunctionType.getSpecializedReturnType(e.functionType);if(s){t=(0,W.getGeneratorYieldType)(s,!!i.isAsync);const e=(0,W.getGeneratorTypeArgs)(s);e&&e.length>=2&&(n=e[1])}}}return e.expression&&Me(e.expression,void 0,(0,W.makeInferenceContext)(t)).isIncomplete&&(s=!0),{type:n||G.UnknownType.create(),isIncomplete:s}}(e);break;case 61:o=function(e){var t,n;const s=Me(e.expression),i=s.type;let a,r=(0,W.getGeneratorTypeArgs)(i);if(r)a=r.length>=2?r[2]:G.UnknownType.create();else if((0,G.isClassInstance)(i)&&G.ClassType.isBuiltIn(i,"Coroutine"))a=G.UnknownType.create();else{const i=null!==(n=null===(t=Qe(s,!1,e))||void 0===t?void 0:t.type)&&void 0!==n?n:G.UnknownType.create();r=(0,W.getGeneratorTypeArgs)(i),r&&(a=r.length>=2?r[2]:G.UnknownType.create())}return{type:a||G.UnknownType.create()}}(e);break;case 56:o=function(e,t,n){var s;let i,a;if(n){const t=xs(e,"Iterable");t&&(0,G.isInstantiableClass)(t)&&(a=G.ClassType.cloneAsInstance(G.ClassType.cloneForSpecialization(t,[n.expectedType],!0)))}const r=Me(e.expression,t,(0,W.makeInferenceContext)(a)),o=r.type;if(0==(64&t)&&(0,G.isVariadicTypeVar)(o)&&!o.isVariadicUnpacked)i={type:G.TypeVarType.cloneForUnpacked(o)};else if(0!=(2097152&t)&&(0,G.isInstantiableClass)(o)&&G.ClassType.isBuiltIn(o,"tuple"))i={type:G.ClassType.cloneForUnpacked(o)};else{const t=null!==(s=Ze(r,!1,e))&&void 0!==s?s:{type:G.UnknownType.create(!!r.isIncomplete),isIncomplete:r.isIncomplete};i={type:t.type,unpackedType:o,isIncomplete:t.isIncomplete}}return i}(e,t,n);break;case 54:o=Me(e.typeAnnotation,33256);break;case 49:case 27:o=Re(e);break;case 0:Es(e,(()=>{e.child&&Me(e.child)})),o={type:G.UnknownType.create()};break;default:(0,l.assertNever)(e,`Illegal node type: ${e.nodeType}`)}if(o||(0,l.fail)(`Unhandled expression type '${P.printExpression(e)}'`),!d||o.isIncomplete||(64&t&&(0,G.isVariadicTypeVar)(o.type)&&!o.type.isVariadicInUnion&&(rt(m.Localizer.Diagnostic.typeVarTupleContext(),e),o.type=G.UnknownType.create()),(0,W.isEffectivelyInstantiable)(o.type))||(0,G.isClassInstance)(o.type)&&G.ClassType.isTupleClass(o.type)&&0===(null===(s=o.type.tupleTypeArguments)||void 0===s?void 0:s.length)||(dt(o.type,e),o.type=G.UnknownType.create(),o.typeErrors=!0),Ce(e,o,t,n,!0),n&&!(0,G.isAnyOrUnknown)(n.expectedType)&&!(0,G.isNever)(n.expectedType)&&(ye.set(e.id,n.expectedType),!o.isIncomplete&&!o.expectedTypeDiagAddendum)){const t=new c.DiagnosticAddendum;Zs(n.expectedType,o.type,t,new j.TypeVarContext(null===(i=n.typeVarContext)||void 0===i?void 0:i.getSolveForScopes()))||(o.typeErrors=!0,o.expectedTypeDiagAddendum=t,t.addTextRange(e))}return o}function Re(e){const t=0!=(32&e.token.flags);let n;if(27===e.nodeType){let s=!0;if(e.expressions.forEach((e=>{const t=Me(e).type;(0,W.doForEachSubtype)(t,(e=>{(0,G.isClassInstance)(e)&&(G.ClassType.isBuiltIn(e,"LiteralString")||G.ClassType.isBuiltIn(e,"str")&&void 0!==e.literalValue)||(s=!1)}))})),!t&&s){const t=Je(e,"LiteralString");t&&(0,G.isInstantiableClass)(t)&&(n={type:G.ClassType.cloneAsInstance(t)})}n||(n={type:Ds(e,t?"bytes":"str")})}else n={type:Dn(e,t?"bytes":"str",e.value)};return n}function Oe(e){return(0,W.mapSubtypes)(e,(e=>{if((0,G.isClass)(e)){if(void 0!==e.literalValue)return G.ClassType.cloneWithLiteral(e,void 0);if(G.ClassType.isBuiltIn(e,"LiteralString")&&ae&&(0,G.isInstantiableClass)(ae)){let t=G.ClassType.cloneAsInstance(ae);return e.condition&&(t=G.TypeBase.cloneForCondition(t,(0,W.getTypeCondition)(e))),t}}return e}))}function Le(e,t){return Ve(e,{associateTypeVarsWithScope:!0,allowTypeVarTuple:1===t,allowUnpackedTypedDict:2===t,allowUnpackedTuple:1===t})}function Ve(e,t){var n,s,i;const a=T.getFileInfo(e);if(a.isTypingStubFile||a.isTypingExtensionsStubFile){const t=function(e){if(!e.parent||54!==e.parent.nodeType)return;if(38!==e.parent.valueExpression.nodeType)return;const t=e.parent.valueExpression.value,n=new Map([["Tuple",{alias:"tuple",module:"builtins"}],["Generic",{alias:"",module:"builtins"}],["Protocol",{alias:"",module:"builtins"}],["Callable",{alias:"",module:"builtins"}],["Type",{alias:"type",module:"builtins"}],["ClassVar",{alias:"",module:"builtins"}],["Final",{alias:"",module:"builtins"}],["Literal",{alias:"",module:"builtins"}],["TypedDict",{alias:"_TypedDict",module:"self"}],["Union",{alias:"",module:"builtins"}],["Optional",{alias:"",module:"builtins"}],["Annotated",{alias:"",module:"builtins"}],["TypeAlias",{alias:"",module:"builtins"}],["Concatenate",{alias:"",module:"builtins"}],["TypeGuard",{alias:"",module:"builtins"}],["StrictTypeGuard",{alias:"",module:"builtins"}],["Unpack",{alias:"",module:"builtins"}],["Required",{alias:"",module:"builtins"}],["NotRequired",{alias:"",module:"builtins"}],["Self",{alias:"",module:"builtins"}],["NoReturn",{alias:"",module:"builtins"}],["Never",{alias:"",module:"builtins"}],["LiteralString",{alias:"",module:"builtins"}]]).get(t);if(n){const s=be(e,0);if(s)return(0,l.assert)((0,G.isInstantiableClass)(s)),s;const i=Vn(e,t,n);return"LiteralString"===t&&(i.details.baseClasses.push(null!=ae?ae:G.AnyType.create()),(0,W.computeMroLinearization)(i)),Ce(e,{type:i},0),i}}(e);if(t)return t}let r=393;(null==t?void 0:t.isVariableAnnotation)&&(r|=32768),(null==t?void 0:t.allowFinal)||(r|=16),(null==t?void 0:t.allowClassVar)||(r|=131072),(null==t?void 0:t.allowTypeVarTuple)?r|=2097152:r|=64,(null==t?void 0:t.allowParamSpec)||(r|=32),(null==t?void 0:t.associateTypeVarsWithScope)?r|=8192:r|=4096,(null==t?void 0:t.allowUnpackedTypedDict)&&(r|=8388608),(null==t?void 0:t.allowUnpackedTuple)&&(r|=2097152),(null==t?void 0:t.notParsedByInterpreter)&&(r|=524288),(null==t?void 0:t.allowRequired)&&(r|=1048576),(0,f.isAnnotationEvaluationPostponed)(a)&&(r|=4),3===(null===(n=null==e?void 0:e.parent)||void 0===n?void 0:n.nodeType)&&e.parent.typeAnnotationComment===e?r|=524292:62===(null===(s=null==e?void 0:e.parent)||void 0===s?void 0:s.nodeType)?(e.parent.returnTypeAnnotation===e||e.parent.paramTypeAnnotations.some((t=>t===e)))&&(r|=524292):41===(null===(i=null==e?void 0:e.parent)||void 0===i?void 0:i.nodeType)&&e.parent.typeAnnotationComment===e&&(r|=524292);const o=Me(e,r).type;return(0,G.isModule)(o)&&ct(a.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.moduleAsType(),e),(0,W.convertToInstance)(o)}function Ue(e,t){let n=T.getFileInfo(e).isStubFile?4:0;9!==e.expression.nodeType&&(n|=2);const s=Me(e.expression,n);if((0,G.isInstantiableClass)(s.type)&&G.ClassType.isBuiltIn(s.type,"classmethod")&&(0,W.isProperty)(t))return t;const i=[{argumentCategory:0,typeResult:{type:t}}],a=Ht(e.expression,i,s,void 0,!0).returnType||G.UnknownType.create();return!(0,G.isFunction)(a)||a.details.declaredReturnType||a.details.parameters.some(((e,t)=>!(e.name&&!e.hasDeclaredType&&(0!==e.category||0===t&&e.isTypeInferred))))?(0,W.isPartlyUnknown)(a)&&(0,G.isFunction)(s.type)&&!s.type.details.parameters.find((e=>void 0!==e.typeAnnotation))&&void 0===s.type.details.declaredReturnType?t:a:t}function ze(e,t=0){if(e=mt(e),t>G.maxTypeRecursionCount)return!0;switch(t++,e.category){case 0:case 1:case 2:case 4:case 3:return!0;case 9:return void 0!==(0,G.findSubtype)(e,(e=>ze(e,t)));case 5:case 6:case 8:case 10:return!1;case 7:{if(G.TypeBase.isInstantiable(e))return!1;if((0,W.isTupleClass)(e)&&e.tupleTypeArguments)return(0,W.isUnboundedTupleClass)(e)||0===e.tupleTypeArguments.length;const t=e.details.mro.find((e=>!(0,G.isClass)(e)||(0,W.isTupleClass)(e)));if(t&&(0,G.isClass)(t)&&t.tupleTypeArguments)return(0,W.isUnboundedTupleClass)(t)||0===t.tupleTypeArguments.length;if(G.ClassType.isBuiltIn(e,"bool")&&void 0!==e.literalValue)return!1===e.literalValue;if(G.ClassType.isProtocolClass(e))return!0;if((0,W.lookUpObjectMember)(e,"__len__"))return!0;const n=(0,W.lookUpObjectMember)(e,"__bool__");if(n){const e=js(n);if((0,G.isFunction)(e)&&e.details.declaredReturnType){const t=e.details.declaredReturnType;if((0,G.isClassInstance)(t)&&G.ClassType.isBuiltIn(t,"bool")&&!0===t.literalValue)return!1}return!0}return!1}}}function Be(e,t=0){if(e=mt(e),t>G.maxTypeRecursionCount)return!0;switch(t++,e.category){case 1:case 5:case 6:case 8:case 10:case 4:case 2:return!0;case 9:return void 0!==(0,G.findSubtype)(e,(e=>Be(e,t)));case 0:case 3:return!1;case 7:{if(G.TypeBase.isInstantiable(e))return!0;if((0,W.isTupleClass)(e)&&e.tupleTypeArguments&&0===e.tupleTypeArguments.length)return!1;if(!1===e.literalValue||0===e.literalValue||e.literalValue===BigInt(0)||""===e.literalValue)return!1;if(G.ClassType.isProtocolClass(e))return!0;const t=(0,W.lookUpObjectMember)(e,"__bool__");if(t){const e=js(t);if((0,G.isFunction)(e)&&e.details.declaredReturnType){const t=e.details.declaredReturnType;if((0,G.isClassInstance)(t)&&G.ClassType.isBuiltIn(t,"bool")&&!1===t.literalValue)return!1}}return!0}}}function Ge(e){return(0,W.mapSubtypes)(e,(e=>{const t=mt(e);if((0,G.isClassInstance)(t)){if(void 0!==t.literalValue)return t.literalValue?void 0:e;if(G.ClassType.isBuiltIn(t,"bool"))return G.ClassType.cloneWithLiteral(t,!1);if(G.ClassType.isBuiltIn(t,"int"))return G.ClassType.cloneWithLiteral(t,0);if(G.ClassType.isBuiltIn(t,["str","bytes"]))return G.ClassType.cloneWithLiteral(t,"")}if(ze(e))return e}))}function We(e){return(0,W.mapSubtypes)(e,(e=>{const t=mt(e);if((0,G.isClassInstance)(t)){if(void 0!==t.literalValue)return t.literalValue?e:void 0;if(G.ClassType.isBuiltIn(t,"bool"))return G.ClassType.cloneWithLiteral(t,!0)}if(Be(e))return e}))}function je(e,t,n,s={method:"get"},i,a=0,r){const o=xt(e,G.ClassType.cloneAsInstantiable(t),!0,n,s,i,8|a,r);if(o)return{type:o.type,classType:o.classType,isIncomplete:!!o.isTypeIncomplete,isAsymmetricDescriptor:o.isAsymmetricDescriptor}}function $e(e,t,n,s={method:"get"},i,a=0,r){let o;const l=i?new c.DiagnosticAddendum:void 0,d=i?new c.DiagnosticAddendum:void 0;if(G.ClassType.isPartiallyEvaluated(t))return ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.classDefinitionCycle().format({name:t.details.name}),e),{type:G.UnknownType.create()};if(0==(32&a)&&(o=xt(e,t,!1,n,s,l,1|a,r)),o&&o.classType&&o.symbol&&(0,G.isClass)(o.classType)&&G.ClassType.isProtocolClass(o.classType)){const t=(0,L.getLastTypedDeclaredForSymbol)(o.symbol);t&&1===t.type&&!o.isClassVar&&ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.protocolMemberNotClassVar().format({memberName:n,className:o.classType.details.name}),e)}const u=void 0!==(null==o?void 0:o.classType);if(!o){const i=t.details.effectiveMetaclass;i&&(0,G.isInstantiableClass)(i)&&!G.ClassType.isSameGenericClass(i,t)&&(o=xt(e,i,!0,n,s,d,a,t))}if(o)return{type:o.type,isIncomplete:!!o.isTypeIncomplete,isAsymmetricDescriptor:o.isAsymmetricDescriptor};const y=u?l:d;i&&y&&i.addAddendum(y)}function qe(e,t,n=0,s=!1){const i=(0,W.lookUpClassMember)(e,t,8);if(i){const t=js(i);if((0,G.isFunction)(t)||(0,G.isOverloadedFunction)(t)){const i=ri(G.ClassType.cloneAsInstance(e),t,void 0,void 0,n,s);if(i)return i}else if((0,G.isAnyOrUnknown)(t)){const e=G.FunctionType.createSynthesizedInstance("",32768);return G.FunctionType.addDefaultParameters(e),e}}}function Ke(e){if(54===e.nodeType&&38===e.valueExpression.nodeType){const t=Fs(e,e.valueExpression.value,!1);if(t)return void 0!==t.symbol.getDeclarations().find((e=>pi(e)))}return!1}function He(e,t){var n,s;let i,a,r,o=!0;switch(e.nodeType){case 38:{const t=Fs(e,e.value,!0);if(t&&(i=t.symbol,!(null===(n=Us(i,e))||void 0===n?void 0:n.type)&&2===t.scope.type)){const t=P.getEnclosingClassOrFunction(e);if(t&&10===t.nodeType){const n=jn(t);if(n){const t=(0,W.lookUpClassMember)(n.classType,e.value,24);t&&(i=t.symbol)}}}break}case 54:return He(e.valueExpression,t);case 35:{const t=mt(Me(e.leftExpression,2).type);let n;(0,G.isClassInstance)(t)?(n=(0,W.lookUpObjectMember)(t,e.memberName.value,16),a=t,r=null==n?void 0:n.classType,(null==n?void 0:n.isInstanceMember)&&(o=!1)):(0,G.isInstantiableClass)(t)&&(n=(0,W.lookUpClassMember)(t,e.memberName.value,24),a=t,r=null==n?void 0:n.classType),n&&(i=n.symbol);break}case 24:{const n=mt(Me(e.baseExpression,2).type);if(n&&(0,G.isClassInstance)(n)){const s=(0,W.lookUpClassMember)(n,"__setitem__");if(s){const t=js(s);if((0,G.isFunction)(t)){const i=ri(n,t,(0,G.isInstantiableClass)(s.classType)?s.classType:void 0,e,void 0,!1);if(i&&(0,G.isFunction)(i)&&i.details.parameters.length>=2){const e=G.FunctionType.getEffectiveParameterType(i,1);if(!(0,G.isAnyOrUnknown)(e))return e}}}else if(G.ClassType.isTypedDictClass(n)){const s=(0,U.getTypeOfIndexedTypedDict)(gi,e,n,t||{method:"get"});if(s)return s.type}}break}}if(i){let t=null===(s=Us(i))||void 0===s?void 0:s.type;if(t){if((0,G.isClassInstance)(t)){const e=(0,W.lookUpClassMember)(t,"__set__"),n=e?js(e):void 0;if(n&&(0,G.isFunction)(n)&&n.details.parameters.length>=3&&(t=n.details.parameters[2].type,(0,G.isAnyOrUnknown)(t)))return}return a&&(r&&(0,G.isInstantiableClass)(r)&&(t=(0,W.partiallySpecializeType)(t,r)),((0,G.isFunction)(t)||(0,G.isOverloadedFunction)(t))&&o&&(t=ri(a,t,void 0,e))),t}}}function Ye(e,t){return(0,W.mapSubtypes)(e,(e=>{if(e=mt(e),(0,G.isAnyOrUnknown)(e))return e;if((0,G.isClassInstance)(e)){const n=vt(e,"__await__",[],t);if(n){if((0,G.isAnyOrUnknown)(n))return n;if((0,G.isClassInstance)(n)&&vt(n,"__iter__",[],t)){const e=function(e){if((0,G.isAnyOrUnknown)(e))return e;if((0,G.isClassInstance)(e)&&G.ClassType.isBuiltIn(e,"Generator")){const t=e.typeArguments;if(t&&t.length>=3)return t[2]}}(n);if(e)return e}}}return t&&ct(T.getFileInfo(t).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeNotAwaitable().format({type:mi(e)}),t),G.UnknownType.create()}))}function Ze(e,t,n){const s=t?"__aiter__":"__iter__",i=t?"__anext__":"__next__";let a=!0,r=(0,W.transformPossibleRecursiveTypeAlias)(e.type);r=mt(r),(0,W.isOptionalType)(r)&&(n&&!e.isIncomplete&&ct(T.getFileInfo(n).diagnosticRuleSet.reportOptionalIterable,p.DiagnosticRule.reportOptionalIterable,m.Localizer.Diagnostic.noneNotIterable(),n),r=(0,G.removeNoneFromUnion)(r));const o=(0,W.mapSubtypes)(r,(r=>{if(r=mt(r),(0,G.isAnyOrUnknown)(r))return r;const o=new c.DiagnosticAddendum;if((0,G.isClass)(r)){let e;if(G.TypeBase.isInstance(r)){if((0,W.isTupleClass)(r)&&r.tupleTypeArguments&&0===r.tupleTypeArguments.length)return G.NeverType.createNever();e=vt(r,s,[],n)}else G.TypeBase.isInstantiable(r)&&r.details.effectiveMetaclass&&(0,G.isInstantiableClass)(r.details.effectiveMetaclass)&&(e=vt(G.ClassType.cloneAsInstance(r.details.effectiveMetaclass),s,[],n,r));if(e){const a=new c.DiagnosticAddendum,r=gt(e,void 0,(e=>{if((0,G.isAnyOrUnknown)(e))return e;if((0,G.isClassInstance)(e)){let s=vt(e,i,[],n);if(s)return s=(0,W.mapSubtypes)(s,(e=>(0,G.isTypeVar)(e)&&(0,G.isUnpackedVariadicTypeVar)(e)?null!=X?X:G.UnknownType.create():e)),t?Ye(s,n):s;a.addMessage(m.Localizer.Diagnostic.methodNotDefinedOnType().format({name:i,type:mi(e)}))}else a.addMessage(m.Localizer.Diagnostic.methodReturnsNonObject().format({name:s}))}));if(a.isEmpty())return r;o.addAddendum(a)}else{if(!t&&(0,G.isClassInstance)(r)){const e=vt(r,"__getitem__",[{argumentCategory:0,typeResult:{type:ie&&(0,G.isInstantiableClass)(ie)?G.ClassType.cloneAsInstance(ie):G.UnknownType.create()}}],n);if(e)return e}o.addMessage(m.Localizer.Diagnostic.methodNotDefined().format({name:s}))}}n&&!e.isIncomplete&&ct(T.getFileInfo(n).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeNotIterable().format({type:mi(r)})+o.getString(),n),a=!1}));return a?{type:o,isIncomplete:e.isIncomplete}:void 0}function Qe(e,t,n){const s=t?"__aiter__":"__iter__";let i=!0,a=mt(e.type);(0,W.isOptionalType)(a)&&(n&&!e.isIncomplete&&ct(T.getFileInfo(n).diagnosticRuleSet.reportOptionalIterable,p.DiagnosticRule.reportOptionalIterable,m.Localizer.Diagnostic.noneNotIterable(),n),a=(0,G.removeNoneFromUnion)(a));const r=(0,W.mapSubtypes)(a,(e=>{if((0,G.isAnyOrUnknown)(e))return e;if((0,G.isClass)(e)){let t;if(G.TypeBase.isInstance(e)?t=vt(e,s,[],n):G.TypeBase.isInstantiable(e)&&e.details.effectiveMetaclass&&(0,G.isInstantiableClass)(e.details.effectiveMetaclass)&&(t=vt(G.ClassType.cloneAsInstance(e.details.effectiveMetaclass),s,[],n,e)),t)return mt(t)}n&&ct(T.getFileInfo(n).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeNotIterable().format({type:mi(e)}),n),i=!1}));return i?{type:r,isIncomplete:e.isIncomplete}:void 0}function Je(e,t){var n;return null!==(n=et(e,t,["typing"]))&&void 0!==n?n:et(e,t,["typing_extensions"])}function Xe(e,t){return et(e,t,["_typeshed"])}function et(t,n,s){const i=T.getFileInfo(t),a=e({nameParts:s,importingFilePath:i.filePath});if(!a)return;const r=a.symbolTable.get(n);return r?Ls(r):void 0}function tt(e){const n=28===e.nodeType?e:P.getExecutionScopeNode(e);if(T.getCodeFlowComplexity(n)>t.maxCodeComplexity){let t=n;28===n.nodeType?t=n.name:36===n.nodeType&&(t={start:0,length:0});const s=T.getFileInfo(e);return pt(s,s.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.codeTooComplexToAnalyze(),t),!0}return!1}function nt(e,t){if(tt(e))return!0;const n=T.getFlowNode(e);if(!n)return!!e.parent&&nt(e.parent,t);const s=t?T.getFlowNode(t):void 0;return hi.isFlowNodeReachable(n,s)}function st(e){const t=T.getAfterFlowNode(e);return!!(t&&(tt(e)||hi.isFlowNodeReachable(t)&&function(e,t){const n=vs(e.id);if(tt(e))return!0;const s=n.getTypeFromCodeFlow(t,void 0,void 0,G.UnboundType.create(),{skipNoReturnCallAnalysis:!0});return void 0!==s.type&&!(0,G.isNever)(s.type)}(e,t)))}function it(e,t,n=!0){if(tt(e))return!0;const s=T.getFlowNode(e),i=T.getFlowNode(t);return!(!s||!i)&&(s===i?n:hi.isFlowNodeReachable(i,s,!0))}function at(e,t,n){return ot("information",e,t,n)}function rt(e,t,n){return ot("error",e,t,n)}function ot(e,t,n,s){if(!lt(n)&&nt(n))return T.getFileInfo(n).diagnosticSink.addDiagnosticWithTextRange(e,t,s||n)}function lt(e){return Y.some((t=>P.isNodeContainedWithin(e,t)))||a.isSpeculative(e)}function ct(e,t,n,s,i){if("none"===e)return;if(!T.getFileInfo(s).diagnosticRuleSet.analyzeUnannotatedFunctions){const e=P.getEnclosingFunction(s);if(e&&P.isUnannotatedFunction(e)&&P.isNodeContainedWithin(s,e.suite))return}const a=ot(e,n,s,i);return a&&a.setRule(t),a}function pt(e,t,n,s,i){if("none"===t)return;const a=e.diagnosticSink.addDiagnosticWithTextRange(t,s,i);return n&&a.setRule(n),a}function dt(e,t){const n=T.getFileInfo(t),s=new c.DiagnosticAddendum;(0,G.isUnion)(e)&&(0,W.doForEachSubtype)(e,(e=>{(0,W.isEffectivelyInstantiable)(e)||s.addMessage(m.Localizer.DiagnosticAddendum.typeNotClass().format({type:mi(e)}))})),ct(n.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeExpectedClass().format({type:mi(e)})+s.getString(),t)}function ut(e,t,n,s,i,a=!1,r){var o,l,d;const u=e.value,y=Fs(e,u,!1);if(!y)return;const g=y.symbol.getDeclarations();let h=null===(o=Us(y.symbol))||void 0===o?void 0:o.type;const f=T.getFileInfo(e);if(void 0===h&&2===y.scope.type){const t=P.getEnclosingClass(e);if(t){const n=jn(t);if(n){const t=(0,W.lookUpClassMember)(n.classType,e.value,1);(null==t?void 0:t.isTypeDeclared)&&(h=js(t))}}}let v=t;const _=!!h&&(0,G.isClassInstance)(h)&&G.ClassType.isBuiltIn(h,"TypeAlias");if(h&&!_){let n=new c.DiagnosticAddendum;Zs(h,t,n)?v=si(h,t):(r&&(n=r),ct(f.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeAssignmentMismatch().format({sourceType:mi(t),destType:mi(h)})+n.getString(),null!=i?i:e,null!==(d=null!==(l=n.getEffectiveTextRange())&&void 0!==l?l:i)&&void 0!==d?d:e),v=h)}else{const t=w.getScopeForNode(e);2===(null==t?void 0:t.type)&&(!G.TypeBase.isInstance(v)||(0,O.isConstantName)(u)||li(y.symbol)||(v=Oe(v)))}const I=g.find((e=>1===e.type));I&&1===I.type&&(I.isConstant?e!==(0,S.getNameNodeForDeclaration)(g[0])&&ct(f.diagnosticRuleSet.reportConstantRedefinition,p.DiagnosticRule.reportConstantRedefinition,m.Localizer.Diagnostic.constantRedefinition().format({name:u}),e):ci(I)&&!a&&ct(f.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.finalReassigned().format({name:u}),e)),n||_n(f.diagnosticRuleSet.reportUnknownVariableType,p.DiagnosticRule.reportUnknownVariableType,e,v,e,s),Ce(e,{type:v,isIncomplete:n},0)}function yt(e,t,n,s,i){var a;const r=e.memberName.value,o=T.getFileInfo(e),c=P.getEnclosingClass(e);if(!c)return;const d=jn(c);if(d&&(0,G.isInstantiableClass)(d.classType)){let c=(0,W.lookUpClassMember)(d.classType,r,s?0:8);const u=d.classType.details.fields;if(c){const n=(0,G.isInstantiableClass)(c.classType)?c.classType:void 0,y=n&&G.ClassType.isSameGenericClass(d.classType,n);if(y&&s&&(null==n?void 0:n.details.inheritedSlotsNames)&&n.details.localSlotsNames&&n.details.localSlotsNames.length>0&&!n.details.inheritedSlotsNames.some((e=>e===r))){const t=(0,W.lookUpClassMember)(n,r,8);let s=!1;if(t){const e=Ls(t.symbol);((0,G.isAnyOrUnknown)(e)||(0,G.isUnbound)(e)||(0,W.isMaybeDescriptorInstance)(e))&&(s=!0)}s||ct(o.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.slotsAttributeError().format({name:r}),e.memberName)}if(y&&c.isInstanceMember===s){const t=u.get(r);(0,l.assert)(void 0!==t);const n=t.getDeclarations();n.length>0&&1===n[0].type&&i&&e.memberName!==n[0].node&&n[0].isConstant&&ct(o.diagnosticRuleSet.reportConstantRedefinition,p.DiagnosticRule.reportConstantRedefinition,m.Localizer.Diagnostic.constantRedefinition().format({name:e.memberName.value}),e.memberName)}else{const n=null===(a=Us(c.symbol))||void 0===a?void 0:a.type;if(n&&!(0,W.isProperty)(n)&&!c.isInstanceMember&&s){Tt(o,c.symbol,e.memberName);const n=js(c);t=(0,G.combineTypes)([t,n])}}}c=(0,W.lookUpClassMember)(d.classType,r,16),c||!i||n||_n(o.diagnosticRuleSet.reportUnknownMemberType,p.DiagnosticRule.reportUnknownMemberType,e.memberName,t,e,!0)}}function mt(e,t=!1,n){return(0,W.mapSubtypes)(e,(e=>{if((0,G.isParamSpec)(e)){if("args"===e.paramSpecAccess)return ne&&(0,G.isInstantiableClass)(ne)&&X&&(0,G.isClassInstance)(X)?G.ClassType.cloneAsInstance((0,W.specializeTupleClass)(ne,[{type:X,isUnbounded:!0}])):G.UnknownType.create();if("kwargs"===e.paramSpecAccess)return re&&(0,G.isInstantiableClass)(re)&&ae&&(0,G.isInstantiableClass)(ae)&&X&&(0,G.isClassInstance)(X)?G.ClassType.cloneAsInstance(G.ClassType.cloneForSpecialization(re,[(0,W.convertToInstance)(ae),X],!0)):G.UnknownType.create()}if(t&&(0,G.isFunction)(e)&&0===e.details.parameters.length&&e.details.paramSpec){const t=G.FunctionType.createInstance("","","",32832);return G.FunctionType.addDefaultParameters(t),G.FunctionType.cloneForParamSpec(e,t)}if((0,G.isVariadicTypeVar)(e)&&ne&&(0,G.isInstantiableClass)(ne))return(0,W.convertToInstance)((0,W.specializeTupleClass)(ne,[{type:e,isUnbounded:!1}],!0,!0));if((0,G.isTypeVar)(e)&&!e.details.recursiveTypeAliasName){if(e.details.boundType){const t=G.TypeBase.isInstantiable(e)?(0,W.convertToInstantiable)(e.details.boundType):e.details.boundType;return e.details.isSynthesized?t:(0,W.addConditionToType)(t,[{typeVarName:G.TypeVarType.getNameWithScope(e),constraintIndex:0,isConstrainedTypeVar:!1}])}if(e.details.recursiveTypeAliasName)return e;if(e.details.constraints.length>0){const t=[];return e.details.constraints.forEach(((s,i)=>{if(n){const t=G.TypeVarType.getNameWithScope(e),s=n.find((e=>e.typeVarName===t));if(s&&s.constraintIndex!==i)return}G.TypeBase.isInstantiable(e)&&(s=(0,W.convertToInstantiable)(s)),t.push((0,W.addConditionToType)(s,[{typeVarName:G.TypeVarType.getNameWithScope(e),constraintIndex:i,isConstrainedTypeVar:!0}]))})),(0,G.combineTypes)(t)}if(e.details.isExemptFromBoundCheck)return G.AnyType.create();if(G.TypeBase.isInstantiable(e)){if(ee&&(0,G.isInstantiableClass)(ee))return e.details.isSynthesized?ee:(0,W.addConditionToType)(G.ClassType.cloneAsInstance(ee),[{typeVarName:G.TypeVarType.getNameWithScope(e),constraintIndex:0,isConstrainedTypeVar:!1}])}else if(X)return e.details.isSynthesized?X:(0,W.addConditionToType)(X,[{typeVarName:G.TypeVarType.getNameWithScope(e),constraintIndex:0,isConstrainedTypeVar:!1}]);return G.AnyType.create()}return e}))}function gt(e,t,n){const s=[];let i=!1;const a=e=>{let a=(0,G.isUnion)(e)?e:mt(e);a=(0,W.transformPossibleRecursiveTypeAlias)(a),(0,W.doForEachSubtype)(a,(a=>{var r;if(t&&!G.TypeCondition.isCompatible((0,W.getTypeCondition)(a),t))return;let o=n(a,e);if(o!==e&&(i=!0),o){const e=null===(r=(0,W.getTypeCondition)(a))||void 0===r?void 0:r.filter((e=>e.isConstrainedTypeVar));e&&e.length>0&&(o=(0,W.addConditionToType)(o,e)),s.push(o)}}))};if((0,G.isUnion)(e)?e.subtypes.forEach((e=>{a(e)})):a(e),!i)return e;const r=(0,G.combineTypes)(s);return 9===r.category&&G.UnionType.addTypeAliasSource(r,e),r}function ht(e,t,n,s,r=!1,o=!1,l){if((0,G.isTypeVar)(t)&&s&&9===s.nodeType){const n=Me(s.leftExpression,2).type;(0,G.isInstantiableClass)(n)&&(G.ClassType.isBuiltIn(n,"TypeVar")||G.ClassType.isBuiltIn(n,"TypeVarTuple")||G.ClassType.isBuiltIn(n,"ParamSpec"))&&(38===e.nodeType&&e.value===t.details.name||rt(t.details.isParamSpec?m.Localizer.Diagnostic.paramSpecAssignedName().format({name:G.TypeVarType.getReadableName(t)}):m.Localizer.Diagnostic.typeVarAssignedName().format({name:G.TypeVarType.getReadableName(t)}),e))}switch(t=(0,G.removeUnbound)(t),e.nodeType){case 38:ut(e,t,n,r,s,o,l);break;case 35:!function(e,t,n,s,r){const o=Me(e.leftExpression,2),l=mt(o.type);if(38===e.leftExpression.nodeType){const i=P.getEnclosingClass(e);if(i){const a=jn(i);if(a&&(0,G.isInstantiableClass)(a.classType)&&((0,G.isClassInstance)(l)?G.ClassType.isSameGenericClass(l,a.classType)&&yt(e,t,n,!0,s):(0,G.isInstantiableClass)(l)&&G.ClassType.isSameGenericClass(l,a.classType)&&yt(e,t,n,!1,s),G.ClassType.isProtocolClass(a.classType))){const t=a.classType.details.fields.get(e.memberName.value);t&&0===t.getDeclarations().filter((e=>!P.getEnclosingFunction(e.node))).length&&rt(m.Localizer.Diagnostic.assignmentInProtocol(),e.memberName)}}}var c;St(e,o,{method:"set",setType:{type:t,isIncomplete:n},setErrorNode:s,setExpectedTypeDiag:r},0).isAsymmetricDescriptor&&(c=e,a.isSpeculative(void 0)||i.add(c.id)),Ce(e.memberName,{type:t,isIncomplete:n},0),Ce(e,{type:t,isIncomplete:n},0)}(e,t,n,s,l);break;case 24:{const i=Me(e.baseExpression,2);Pt(e,i,{method:"set",setType:{type:t,isIncomplete:n},setErrorNode:s,setExpectedTypeDiag:l},0),Ce(e,{type:t,isIncomplete:n},0);break}case 31:case 52:!function(e,t,n,s){const i=31===e.nodeType?e.entries:e.expressions,a=new Array(i.length);for(let e=0;e<i.length;e++)a[e]=[];const r=i.findIndex((e=>56===e.nodeType)),o=i.findIndex((e=>56===e.nodeType));t=mt(t);const l=new c.DiagnosticAddendum;(0,W.doForEachSubtype)(t,(t=>{var c,p;const d=(0,W.getSpecializedTupleType)(t);if(d&&d.tupleTypeArguments){const n=d.tupleTypeArguments.map((e=>(0,W.addConditionToType)(e.type,(0,W.getTypeCondition)(t)))),s=d.tupleTypeArguments.findIndex((e=>e.isUnbounded));if(s>=0&&n.length<a.length){const e=n.length>0?n[s]:G.AnyType.create();for(;n.length<a.length;)n.splice(s,0,e)}if(r>=0)if(n.length>a.length){const t=n.splice(r,n.length-a.length+1);let s=(0,G.combineTypes)(t);31===e.nodeType&&(s=Oe(s)),n.splice(r,0,s)}else n.length===a.length-1&&n.splice(r,0,G.NeverType.createNever());if(n.forEach(((e,t)=>{t<a.length&&a[t].push(e)})),n.length!==i.length){const s=o>=0?i.length-1:i.length,a=l.createAddendum();a.addMessage((31===e.nodeType?m.Localizer.DiagnosticAddendum.listAssignmentMismatch():m.Localizer.DiagnosticAddendum.tupleAssignmentMismatch()).format({type:mi(t)})),a.createAddendum().addMessage(m.Localizer.DiagnosticAddendum.tupleSizeMismatch().format({expected:s,received:n.length}))}}else{const e=null!==(p=null===(c=Ze({type:t,isIncomplete:n},!1,s))||void 0===c?void 0:c.type)&&void 0!==p?p:G.UnknownType.create();for(let n=0;n<i.length;n++)a[n].push((0,W.addConditionToType)(e,(0,W.getTypeCondition)(t)))}})),l.isEmpty()||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,(31===e.nodeType?m.Localizer.Diagnostic.listAssignmentMismatch():m.Localizer.Diagnostic.tupleAssignmentMismatch()).format({type:mi(t)})+l.getString(),e),i.forEach(((e,t)=>{const i=a[t];ht(e,0===i.length?G.UnknownType.create():(0,G.combineTypes)(i),n,s,!0)})),Ce(e,{type:t,isIncomplete:n},0)}(e,t,n,s);break;case 54:{const n=Ve(e.typeAnnotation,{isVariableAnnotation:!0,allowFinal:P.isFinalAllowedForAssignmentTarget(e.valueExpression),allowClassVar:P.isClassVarAllowedForAssignmentTarget(e.valueExpression)});(0,G.isClassInstance)(n)&&(G.ClassType.isBuiltIn(n,"Final")||G.ClassType.isBuiltIn(n,"ClassVar"))||(0,G.isClassInstance)(n)&&G.ClassType.isBuiltIn(n,"TypeAlias")||Zs(n,t)&&((0,G.isClassInstance)(t)&&G.ClassType.isEnumClass(t)||(t=si(n,t))),ht(e.valueExpression,t,!1,s,r,o,l);break}case 56:38===e.expression.nodeType&&ut(e.expression,Ds(e.expression,"list",[t]),!1,r,s);break;case 0:e.child&&Es(e.child,(()=>{Me(e.child)}));break;default:rt(m.Localizer.Diagnostic.assignmentTargetExpr(),e)}}function ft(e){switch(e.nodeType){case 38:Me(e);break;case 35:{const t=Me(e.leftExpression,2),n=St(e,t,{method:"del"},0);Ce(e.memberName,{type:n.type},0),Ce(e,{type:n.type},0);break}case 24:{const t=Me(e.baseExpression,2);Pt(e,t,{method:"del"},0),Ce(e,{type:G.UnboundType.create()},0);break}case 52:e.expressions.forEach((e=>{ft(e)}));break;case 0:e.child&&Es(e.child,(()=>{Me(e.child)}));break;default:ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.delTargetExpr(),e)}}function Tt(e,t,n){a.isSpeculative(n)||e.accessedSymbolSet.add(t.id)}function vt(e,t,n,s,i){const a=(0,W.lookUpObjectMember)(e,t,8);if(!a)return;const r=$s(a,e);if(!r)return;const o=r.type;if((0,G.isAnyOrUnknown)(o))return o;if((0,G.isFunction)(o)||(0,G.isOverloadedFunction)(o)){const t=ri(i||e,o,a&&(0,G.isInstantiableClass)(a.classType)?a.classType:void 0,s,void 0,!1,i);if(t){if(!(0,G.isOverloadedFunction)(t))return Bs(t);if(s){const e=zt(s,{type:t,isIncomplete:r.isIncomplete},n);if(e)return Bs(e)}}}}function _t(e,t,n){var s;if(G.TypeBase.isInstantiable(t)&&!t.scopeId&&!(0,W.isTypeAliasPlaceholder)(t)){const i=function(e,t){var n;let s=e,i=0;for((0,l.assert)(G.TypeBase.isInstantiable(t));s&&(s=P.getTypeVarScopeNode(s),s);){let e,a=!1;if(10===s.nodeType){const t=jn(s);t&&!G.ClassType.isPartiallyEvaluated(t.classType)&&(e=t.classType.details.typeParameters),a=!!s.typeParameters,i++}else if(28===s.nodeType){const i=Jn(s);if(i){const s=i.functionType.details;if(e=s.typeParameters,null===(n=s.rescopedTypeParameters)||void 0===n?void 0:n.some((e=>e.details.name===t.details.name)))return{type:t,isRescoped:!0,foundInterveningClass:!1}}a=!!s.typeParameters}else 77===s.nodeType&&(a=!!s.typeParameters);if(e){const n=e.find((e=>e.details.name===t.details.name));if(null==n?void 0:n.scopeId)return{type:t=G.TypeVarType.cloneForScopeId(t,n.scopeId,n.scopeName,n.scopeType),isRescoped:!1,foundInterveningClass:i>1&&!a}}s=s.parent}for(s=e;s;){let n,i;if(77===s.nodeType?(n=be(s.name,0),i=s):3===s.nodeType&&(n=be(s.leftExpression,0)),n&&n&&(0,G.isTypeVar)(n)&&n.details.recursiveTypeAliasScopeId&&n.details.recursiveTypeAliasName)return i&&!t.details.isTypeParamSyntax&&ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeParameterNotDeclared().format({name:t.details.name,container:i.name.value}),e),{type:G.TypeVarType.cloneForScopeId(t,n.details.recursiveTypeAliasScopeId,n.details.recursiveTypeAliasName,2),isRescoped:!1,foundInterveningClass:!1};s=s.parent}return{type:t,isRescoped:!1,foundInterveningClass:!1}}(e,t);if(t=i.type,0!=(2048&n)&&void 0!==t.scopeId){if(!t.details.isSynthesized&&!t.details.isParamSpec){if(t.details.isTypeParamSyntax)return t;const n=P.getTypeVarScopeNode(e);if(n&&n.typeParameters&&!n.typeParameters.parameters.some((t=>t.name===e)))return t;ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeVarUsedByOuterScope().format({name:t.details.name}),e)}}else if(0!=(8192&n)){if(void 0===t.scopeId)if(i.foundInterveningClass)ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeVarUsedByOuterScope().format({name:t.details.name}),e);else{let n=P.getEnclosingClassOrFunction(e);if(n&&35===(null===(s=e.parent)||void 0===s?void 0:s.nodeType)&&e.parent.leftExpression===e){const s=e.parent.memberName.value;if("args"===s||"kwargs"===s){const s=P.getEnclosingClassOrFunction(n);28===(null==s?void 0:s.nodeType)?i.isRescoped?ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.paramSpecScopedToReturnType().format({name:t.details.name}),e):n=s:i.type.scopeId||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.paramSpecNotUsedByOuterScope().format({name:t.details.name}),e)}}n?(n.typeParameters&&!n.typeParameters.parameters.some((e=>e.name.value===t.details.name))&&ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeParameterNotDeclared().format({name:t.details.name,container:n.name.value}),e),t=G.TypeVarType.cloneForScopeId(t,bt(n),n.name.value,28===n.nodeType?1:0)):(0,l.fail)("AssociateTypeVarsWithCurrentScope flag was set but enclosing scope not found")}}else if(0!=(4096&n)&&(void 0===t.scopeId||i.foundInterveningClass)&&!t.details.isSynthesized){let n;n=i.isRescoped?(0,G.isParamSpec)(t)?m.Localizer.Diagnostic.paramSpecScopedToReturnType():m.Localizer.Diagnostic.typeVarScopedToReturnType():(0,G.isParamSpec)(t)?m.Localizer.Diagnostic.paramSpecNotUsedByOuterScope():m.Localizer.Diagnostic.typeVarNotUsedByOuterScope(),ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,n.format({name:t.details.name}),e)}}return(0,G.isUnpackedVariadicTypeVar)(t)&&(t=G.TypeVarType.cloneForPacked(t)),t}function It(e,t,n){var s;if(0!=(2&n))return t;if((0,G.isInstantiableClass)(t)&&(0!=(128&n)&&(0,W.requiresTypeArguments)(t)&&!t.typeArguments&&ct(T.getFileInfo(e).diagnosticRuleSet.reportMissingTypeArgument,p.DiagnosticRule.reportMissingTypeArgument,m.Localizer.Diagnostic.typeArgsMissingForClass().format({name:t.aliasName||t.details.name}),e),t.typeArguments||(t=null===(s=Is(t,void 0,n,e))||void 0===s?void 0:s.type)),0!=(128&n)&&t.typeAliasInfo&&t.typeAliasInfo.typeParameters&&t.typeAliasInfo.typeParameters.length>0&&!t.typeAliasInfo.typeArguments){let n=!1;const s=[],i=new j.TypeVarContext(t.typeAliasInfo.typeVarScopeId);t.typeAliasInfo.typeParameters.forEach((e=>{let t;e.details.defaultType||(n=!0),t=e.details.defaultType||e.details.isParamSpec?(0,W.applySolvedTypeVars)(e,i,{unknownIfNotFound:!0}):G.UnknownType.create(),s.push(t),i.setTypeVarType(e,t)})),n&&ct(T.getFileInfo(e).diagnosticRuleSet.reportMissingTypeArgument,p.DiagnosticRule.reportMissingTypeArgument,m.Localizer.Diagnostic.typeArgsMissingForAlias().format({name:t.typeAliasInfo.name}),e),t=G.TypeBase.cloneForTypeAlias((0,W.applySolvedTypeVars)(t,i,{unknownIfNotFound:!0}),t.typeAliasInfo.name,t.typeAliasInfo.fullName,t.typeAliasInfo.typeVarScopeId,t.typeAliasInfo.typeParameters,s)}return t}function bt(e){let t="";return(10===e.nodeType||28===e.nodeType)&&(t=e.name.value),`${T.getFileInfo(e).filePath}.${e.start.toString()}-${t}`}function Ct(e){const t=[];let n=e;for(;n&&(n=P.getTypeVarScopeNode(n),n);)t.push(bt(n)),n=n.parent;return t}function St(e,t,s,i){var a,r,o;let l=t.type;const d=e.memberName.value;let y=new c.DiagnosticAddendum;const g=T.getFileInfo(e);let h,f,v=!!t.isIncomplete;if(t.isIncomplete&&(0,G.isUnbound)(t.type))return{type:G.UnknownType.create(!0),isIncomplete:!0};(0,G.isUnion)(l)&&G.TypeBase.isSpecialForm(l)&&X&&(l=X);const _=t=>{if(Q&&(0,G.isInstantiableClass)(Q))return G.TypeBase.isInstance(t)?je(e.memberName,G.ClassType.cloneAsInstance(Q),d,s,y):$e(e.memberName,Q,d,s,y)};switch((0,G.isParamSpec)(l)&&l.paramSpecAccess&&(l=mt(l)),l.category){case 2:case 1:case 4:h=l;break;case 10:if(l.details.isParamSpec){if("args"===d){const t=P.getEnclosingParameter(e);return t&&1===t.category?{type:G.TypeVarType.cloneForParamSpecAccess(l,"args"),isIncomplete:v}:(rt(m.Localizer.Diagnostic.paramSpecArgsUsage(),e),{type:G.UnknownType.create(v),isIncomplete:v})}if("kwargs"===d){const t=P.getEnclosingParameter(e);return t&&2===t.category?{type:G.TypeVarType.cloneForParamSpecAccess(l,"kwargs"),isIncomplete:v}:(rt(m.Localizer.Diagnostic.paramSpecKwargsUsage(),e),{type:G.UnknownType.create(v),isIncomplete:v})}return v||ct(g.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.paramSpecUnknownMember().format({name:d}),e),{type:G.UnknownType.create(v),isIncomplete:v}}return 128&i?(v||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeVarNoMember().format({type:mi(l),name:d}),e.leftExpression),{type:G.UnknownType.create(v),isIncomplete:v}):l.details.recursiveTypeAliasName?{type:G.UnknownType.create(!0),isIncomplete:!0}:St(e,{type:mt(l),bindToType:l,isIncomplete:v},s,0);case 7:if(G.TypeBase.isInstantiable(l)){const n=$e(e.memberName,l,d,s,y,0,t.bindToType);h=null==n?void 0:n.type,(null==n?void 0:n.isIncomplete)&&(v=!0),(null==n?void 0:n.isAsymmetricDescriptor)&&(f=!0)}else{const n=(0,x.getTypeOfEnumMember)(gi,e,l,d,v);if(n)return n;const i=je(e.memberName,l,d,s,y,void 0,t.bindToType);i&&(h=(0,W.addConditionToType)(i.type,(0,W.getTypeCondition)(l))),(null==i?void 0:i.isIncomplete)&&(v=!0),(null==i?void 0:i.isAsymmetricDescriptor)&&(f=!0)}break;case 8:{const t=G.ModuleType.getField(l,d);if(t&&!t.isExternallyHidden())"get"===s.method&&Tt(T.getFileInfo(e),t,e.memberName),h=Vs(t,void 0,!0).type,(0,G.isTypeVar)(h)&&(h=_t(e,h,i)),(0,G.isUnbound)(h)&&(h=G.UnknownType.create(!0)),t.isPrivateMember()&&ct(T.getFileInfo(e).diagnosticRuleSet.reportPrivateUsage,p.DiagnosticRule.reportPrivateUsage,m.Localizer.Diagnostic.privateUsedOutsideOfModule().format({name:d}),e.memberName),t.isPrivatePyTypedImport()&&ct(T.getFileInfo(e).diagnosticRuleSet.reportPrivateImportUsage,p.DiagnosticRule.reportPrivateImportUsage,m.Localizer.Diagnostic.privateImportFromPyTypedModule().format({name:d,module:l.moduleName}),e.memberName);else{if("get"===s.method){const e=G.ModuleType.getField(l,"__getattr__");if(e&&(g.executionEnvironment.pythonVersion>=u.PythonVersion.V3_7||e.getDeclarations().some((e=>e.path.toLowerCase().endsWith(".pyi"))))){const t=Vs(e);(0,G.isFunction)(t.type)&&(h=Bs(t.type),t.isIncomplete&&(v=!0))}}!h&&l.notPresentFieldType&&(h=l.notPresentFieldType),h||(v||ct(g.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.moduleUnknownMember().format({memberName:d,moduleName:l.moduleName}),e.memberName),h=n.evaluateUnknownImportsAsAny?G.AnyType.create():G.UnknownType.create())}break}case 9:h=(0,W.mapSubtypes)(l,(n=>{if((0,G.isNoneInstance)(n)){const t=_(n);return t?(h=(0,W.addConditionToType)(t.type,(0,W.getTypeCondition)(l)),t.isIncomplete&&(v=!0),h):void(v||ct(T.getFileInfo(e).diagnosticRuleSet.reportOptionalMemberAccess,p.DiagnosticRule.reportOptionalMemberAccess,m.Localizer.Diagnostic.noneUnknownMember().format({name:d}),e.memberName))}if(!(0,G.isUnbound)(n)){const i=St(e,{type:n,isIncomplete:t.isIncomplete},s,0);return i.isIncomplete&&(v=!0),i.type}}));break;case 5:case 6:if("__defaults__"===d)h=G.AnyType.create();else if("__self__"===d){const e=(0,G.isFunction)(l)?l:l.overloads[0];void 0!==e.preBoundFlags&&0==(4&e.preBoundFlags)&&(h=e.boundToType)}else h=te?St(e,{type:te},s,i).type:G.AnyType.create();break;case 3:{const e=_(l);e&&(h=(0,W.addConditionToType)(e.type,(0,W.getTypeCondition)(l)),e.isIncomplete&&(v=!0));break}default:y.addMessage(m.Localizer.DiagnosticAddendum.typeUnsupported().format({type:mi(l)}))}if(!h){const n=(0,G.isFunction)(l)||(0,G.isOverloadedFunction)(l)||(0,G.isClassInstance)(l)&&G.ClassType.isBuiltIn(l,"function");if(!t.isIncomplete){let t=m.Localizer.Diagnostic.memberAccess();"set"===s.method?t=m.Localizer.Diagnostic.memberSet():"del"===s.method&&(t=m.Localizer.Diagnostic.memberDelete()),s.setExpectedTypeDiag&&(y=s.setExpectedTypeDiag);const[i,r]=n?[g.diagnosticRuleSet.reportFunctionMemberAccess,p.DiagnosticRule.reportFunctionMemberAccess]:[g.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues];ct(i,r,t.format({name:d,type:mi(l)})+y.getString(),e.memberName,null!==(a=y.getEffectiveTextRange())&&void 0!==a?a:e.memberName)}h=n?G.AnyType.create():G.UnknownType.create()}if(0==(2&i)&&(0,G.isInstantiableClass)(h)&&!h.typeArguments&&(h=null===(r=Is(h,void 0,i,e))||void 0===r?void 0:r.type),"get"===s.method){let t=v;if((0,G.isInstantiableClass)(h)){const n=P.getParentNodeOfType(e,1);n&&9===(null===(o=null==n?void 0:n.parent)||void 0===o?void 0:o.nodeType)&&(t=!0)}t||_n(g.diagnosticRuleSet.reportUnknownMemberType,p.DiagnosticRule.reportUnknownMemberType,e.memberName,h,e,!1)}return{type:h,isIncomplete:v,isAsymmetricDescriptor:f,isRequired:!1,isNotRequired:!1}}function xt(e,t,n,s,i,a,r,o){var c,p;let d=0;1&r&&(d|=8),2&r&&(d|=2),4&r&&(d|=4),256&r&&(d|=32),128&r&&(d|=1);let u=(0,W.lookUpClassMember)(t,s,16|d);if(u||(u=(0,W.lookUpClassMember)(t,s,d)),u){let l,d=!1;if(u.symbol.isInitVar())return void(null==a||a.addMessage(m.Localizer.DiagnosticAddendum.memberIsInitVar().format({name:s})));if("get"!==i.method){const a=P.getEnclosingClass(e);if(a){const e=null===(c=jn(a))||void 0===c?void 0:c.classType;if(e&&(0,G.isInstantiableClass)(e)&&G.ClassType.isSameGenericClass(e,t)){if(l=null===(p=Us(u.symbol))||void 0===p?void 0:p.type,l&&(0,G.isInstantiableClass)(u.classType)&&(l=(0,W.partiallySpecializeType)(l,u.classType)),"set"===i.method&&u.symbol.isClassVar()&&n){const e=$s(u,o||"__new__"===s?void 0:t);e&&(0,W.isDescriptorInstance)(e.type,!0)&&(l=e.type,r&=8)}l||(l=G.UnknownType.create())}}}if(!l){const e=$s(u,o||"__new__"===s?void 0:t);e?(l=e.type,e.isIncomplete&&(d=!0)):l=G.UnknownType.create()}if((0,G.isClass)(u.classType)&&G.ClassType.isTypedDictClass(u.classType)){const e=u.symbol.getTypedDeclarations();if(e.length>0&&1===e[0].type)return void(null==a||a.addMessage(m.Localizer.DiagnosticAddendum.memberUnknown().format({name:s})))}"get"===i.method&&(0,G.isInstantiableClass)(u.classType)&&G.ClassType.isSameGenericClass(u.classType,t)&&Tt(T.getFileInfo(e),u.symbol,e);const y=function(e,t,n,s,i,a,r,o,l,c){const p=0!=(16&a);let d=!0,u=!1;if(e=(0,W.mapSubtypes)(e,(e=>{var y,g,h;const f=mt(e),T=!t||t.isClassMember;if((0,G.isClass)(f)&&T){let e=f,p=!1;if(G.TypeBase.isInstantiable(f)&&(f.details.effectiveMetaclass&&(0,G.isInstantiableClass)(f.details.effectiveMetaclass)&&(i||"get"===l.method)?(e=(0,W.convertToInstance)(f.details.effectiveMetaclass),p=!0):e=void 0),e){let T;T="get"===l.method?"__get__":"set"===l.method?"__set__":"__delete__";const v=(0,W.lookUpClassMember)(e,T,8);if(G.ClassType.isPropertyClass(e))if("set"===l.method){if(!v)return null==c||c.addMessage(m.Localizer.DiagnosticAddendum.propertyMissingSetter().format({name:o})),void(d=!1)}else if("del"===l.method&&!v)return null==c||c.addMessage(m.Localizer.DiagnosticAddendum.propertyMissingDeleter().format({name:o})),void(d=!1);if(v){let o=js(v);const _=[{argumentCategory:0,typeResult:{type:G.ClassType.isClassProperty(e)?n:i?s||G.ClassType.cloneAsInstance(n):G.NoneType.createInstance()}}];if("get"===l.method?_.push({argumentCategory:0,typeResult:{type:n}}):"set"===l.method&&_.push({argumentCategory:0,typeResult:{type:null!==(g=null===(y=l.setType)||void 0===y?void 0:y.type)&&void 0!==g?g:G.UnknownType.create(),isIncomplete:!!(null===(h=l.setType)||void 0===h?void 0:h.isIncomplete)}}),G.ClassType.isPropertyClass(e)&&t&&(0,G.isInstantiableClass)(t.classType)&&(zs(o),o=(0,W.partiallySpecializeType)(o,t.classType),0!=(1&a)&&G.ClassType.isProtocolClass(n)&&(null==c||c.addMessage(m.Localizer.DiagnosticAddendum.propertyAccessFromProtocolClass()),d=!1)),o&&((0,G.isFunction)(o)||(0,G.isOverloadedFunction)(o))){const s=o,i=Es(r,(()=>{var i;let a;G.ClassType.isPropertyClass(f)&&!p?t&&(0,G.isInstantiableClass)(t.classType)&&(a=t.classType):(0,G.isInstantiableClass)(v.classType)&&(a=v.classType);let o=ri(e,s,a,r,void 0,void 0,p?f:void 0);if(o&&((0,G.isFunction)(o)||(0,G.isOverloadedFunction)(o))){const e=new j.TypeVarContext((0,W.getTypeVarScopeId)(o));if(a){const e=(0,W.partiallySpecializeType)(o,a,n);e&&((0,G.isFunction)(e)||(0,G.isOverloadedFunction)(e))&&(o=e)}const t=Ht(r,_,{type:o},e,!0);if(t.argumentErrors){if("set"===l.method)if(l.setType&&(0,G.isFunction)(o)&&o.details.parameters.length>=2&&!l.setType.isIncomplete){const e=G.FunctionType.getEffectiveParameterType(o,1);null==c||c.addMessage(m.Localizer.DiagnosticAddendum.typeIncompatible().format({destType:mi(e),sourceType:mi(l.setType.type)}))}else(0,G.isOverloadedFunction)(o)&&(null==c||c.addMessage(m.Localizer.Diagnostic.noOverload().format({name:T})));return d=!1,G.AnyType.create()}return"get"===l.method?null!==(i=t.returnType)&&void 0!==i?i:G.UnknownType.create():G.AnyType.create()}}));if("set"===l.method&&(0,G.isClass)(v.classType)&&function(e){var t;if(void 0!==e.isAsymmetricDescriptor)return e.isAsymmetricDescriptor;let n=!1;const s=(0,W.lookUpClassMember)(e,"__get__",2),i=(0,W.lookUpClassMember)(e,"__set__",2);if(s&&i){const e=Ls(s.symbol),a=Ls(i.symbol);if((0,G.isFunction)(e)&&(0,G.isFunction)(a)&&a.details.parameters.length>=3&&e.details.declaredReturnType){const s=G.FunctionType.getEffectiveParameterType(a,2),i=null!==(t=G.FunctionType.getSpecializedReturnType(e))&&void 0!==t?t:G.UnknownType.create();(0,G.isTypeSame)(s,i)||(n=!0)}}else n=!1;return e.isAsymmetricDescriptor=n,n}(v.classType)&&(u=!0),i)return i}}}}else if((0,G.isFunction)(f)||(0,G.isOverloadedFunction)(f)){if("set"===l.method){let e=!1;if((0,G.isFunction)(f))e=G.FunctionType.isFinal(f);else{const t=G.OverloadedFunctionType.getImplementation(f);t&&(e=G.FunctionType.isFinal(t))}if(e&&t&&(0,G.isClass)(t.classType))return null==c||c.addMessage(m.Localizer.Diagnostic.finalMethodOverride().format({name:o,className:t.classType.details.name})),void(d=!1)}if(!i||t&&!t.isInstanceMember)return!i&&(0,G.isClass)(n)&&0==(16&a)&&n.details.mro.some((e=>(0,G.isClass)(e)&&G.ClassType.isBuiltIn(e,"type")))?f:ri(i?G.ClassType.cloneAsInstance(n):n,f,t&&(0,G.isInstantiableClass)(t.classType)?t.classType:void 0,r,void 0,p,s)}if("set"===l.method){if((null==t?void 0:t.symbol.isClassVar())&&8&a)return null==c||c.addMessage(m.Localizer.DiagnosticAddendum.memberSetClassVar().format({name:o})),void(d=!1);const n=null==t?void 0:t.symbol.getDeclarations().find((e=>ci(e)));if(n&&!P.isNodeContainedWithin(r,n.node)){const e=P.getEnclosingFunction(r);if(!e||"__init__"!==e.name.value)return null==c||c.addMessage(m.Localizer.Diagnostic.finalReassigned().format({name:o})),void(d=!1)}if((null==t?void 0:t.isInstanceMember)&&(0,G.isClass)(t.classType)&&G.ClassType.isReadOnlyInstanceVariables(t.classType))return null==c||c.addMessage(m.Localizer.DiagnosticAddendum.readOnlyAttribute().format({name:o})),void(d=!1);let s=!1;if((t&&t.symbol.hasTypedDeclarations()||t&&!t.symbol.getDeclarations().some((e=>e.node===r)))&&(s=!0),s){let n=e;return i&&!t.isInstanceMember&&(0,G.isFunction)(f)&&(G.FunctionType.isClassMethod(f)||G.FunctionType.isInstanceMethod(f))&&(n=G.FunctionType.clone(f,!0)),n}}return e})),d)return{type:e,isAsymmetricDescriptor:u}}(l,u,t,o,n,r,e,s,i,a);if(!y)return;if(l=y.type,"set"===i.method&&i.setType){if(!Zs(l,i.setType.type,null==a?void 0:a.createAddendum()))return void(i.setType.isIncomplete||null==a||a.addMessage(m.Localizer.DiagnosticAddendum.memberAssignment().format({type:mi(i.setType.type),name:s,classType:yi(t)})));if((0,G.isInstantiableClass)(u.classType)&&G.ClassType.isFrozenDataClass(u.classType)&&n)return void(null==a||a.addMessage(m.Localizer.DiagnosticAddendum.dataClassFrozen().format({name:mi(G.ClassType.cloneAsInstance(u.classType))})))}return{symbol:u.symbol,type:l,isTypeIncomplete:d,isClassMember:!u.isInstanceMember,isClassVar:u.isClassVar,classType:u.classType,isAsymmetricDescriptor:y.isAsymmetricDescriptor}}if(0==(65&r)){const n=function(e,t,n,s){var i,a,r,o,c;const p=n=>{var s;return null===(s=$e(t,e,n,{method:"get"},void 0,68))||void 0===s?void 0:s.type};let d;if("get"===n.method?d=null!==(i=p("__getattribute__"))&&void 0!==i?i:p("__getattr__"):"set"===n.method?d=p("__setattr__"):((0,l.assert)("del"===n.method),d=p("__delattr__")),d){let i=G.AnyType.create();ae&&(0,G.isInstantiableClass)(ae)&&(i=G.ClassType.cloneWithLiteral(G.ClassType.cloneAsInstance(ae),s));const l=[{argumentCategory:0,typeResult:{type:G.ClassType.cloneAsInstance(e)}},{argumentCategory:0,typeResult:{type:i}}];if("set"===n.method&&l.push({argumentCategory:0,typeResult:{type:null!==(r=null===(a=n.setType)||void 0===a?void 0:a.type)&&void 0!==r?r:G.UnknownType.create(),isIncomplete:!!(null===(o=n.setType)||void 0===o?void 0:o.isIncomplete)}}),(0,G.isFunction)(d)||(0,G.isOverloadedFunction)(d)){const n=ri(e,d,e,t);if(n&&((0,G.isFunction)(n)||(0,G.isOverloadedFunction)(n))){const e=new j.TypeVarContext((0,W.getTypeVarScopeId)(n));return null!==(c=Ht(t,l,{type:n},e,!0).returnType)&&void 0!==c?c:G.UnknownType.create()}}}}(t,e,i,s);if(n)return{symbol:void 0,type:n,isTypeIncomplete:!1,isClassMember:!1,isClassVar:!1,isAsymmetricDescriptor:!1}}null==a||a.addMessage(m.Localizer.DiagnosticAddendum.memberUnknown().format({name:s}))}function Dt(e,t,n){const s=t.findIndex((e=>(0,G.isVariadicTypeVar)(e)));if(s>=0){const i=t[s];if(ne&&(0,G.isInstantiableClass)(ne))if(s<e.length){const n=e.slice(s,s+1+e.length-t.length);if(1===n.length&&(0,G.isVariadicTypeVar)(n[0].type))Ft(n[0].type,n[0].node);else{n.forEach(((e,t)=>{Cn(e,{allowEmptyTuple:0===t,allowVariadicTypeVar:!0,allowUnpackedTuples:!0})}));const i=[];1===n.length&&n[0].isEmptyTupleShorthand||n.forEach((e=>{(0,G.isUnpackedClass)(e.type)&&e.type.tupleTypeArguments?(0,o.appendArray)(i,e.type.tupleTypeArguments):i.push({type:(0,W.convertToInstance)(e.type),isUnbounded:!1})}));const a=(0,W.convertToInstance)((0,W.specializeTupleClass)(ne,i,!0,!0));e=[...e.slice(0,s),{node:e[s].node,type:a},...e.slice(s+1+e.length-t.length,e.length)]}}else i.details.defaultType||e.push({node:n,type:(0,W.convertToInstance)((0,W.specializeTupleClass)(ne,[],!0,!0))})}return e}function Ft(e,t){return!!e.isVariadicUnpacked||(rt(m.Localizer.Diagnostic.unpackedTypeVarTupleExpected().format({name1:e.details.name,name2:e.details.name}),t),!1)}function Et(e,t,n){var s,i,a;if(!(null===(s=t.typeAliasInfo)||void 0===s?void 0:s.typeParameters)||0===t.typeAliasInfo.typeParameters.length&&t.typeAliasInfo.typeArguments)return;if(!G.TypeBase.isInstantiable(t))return;if(t.typeAliasInfo.typeArguments)return;const r=t.typeAliasInfo.typeParameters;let o=Dt(Mt(e,n),r,e);if(1===r.length&&r[0].details.isParamSpec&&o&&o.every((e=>!(0,W.isEllipsisType)(e.type)&&!e.typeList&&!(0,G.isParamSpec)(e.type)))&&(o=[{type:G.UnknownType.create(),node:o[0].node,typeList:o}]),!r.some((e=>e.details.isVariadic&&!e.isVariadicInUnion))){let n=r.length;const s=r.findIndex((e=>!!e.details.defaultType));s>=0&&(n=s),o.length>r.length?rt(m.Localizer.Diagnostic.typeArgsTooMany().format({name:mi(t),expected:r.length,received:o.length}),o[r.length].node):o.length<n&&rt(m.Localizer.Diagnostic.typeArgsTooFew().format({name:mi(t),expected:r.length,received:o.length}),e.items[e.items.length-1])}if((0,G.isInstantiableClass)(t)&&"mypy_extensions.FlexibleAlias"===t.details.fullName&&o.length>=1)return{node:e,type:o[0].type};const l=new j.TypeVarContext(t.typeAliasInfo.typeVarScopeId),p=new c.DiagnosticAddendum;r.forEach(((e,s)=>{if(e.details.isParamSpec&&s<o.length){const t=o[s].type;if(o[s].typeList){const t=G.FunctionType.createSynthesizedInstance("",65536);G.TypeBase.setSpecialForm(t),o[s].typeList.forEach(((e,n)=>{G.FunctionType.addParameter(t,{category:0,name:`__p${n}`,isNameSynthesized:!0,type:(0,W.convertToInstance)(e.type),hasDeclaredType:!0})})),(0,I.assignTypeToTypeVar)(gi,e,t,p,l,128)}else if((0,G.isParamSpec)(t))(0,I.assignTypeToTypeVar)(gi,e,(0,W.convertToInstance)(t),p,l,128);else if((0,G.isInstantiableClass)(t)&&G.ClassType.isBuiltIn(t,"Concatenate")){const n=t.typeArguments,s=G.FunctionType.createInstance("","","",0);n&&n.length>0&&n.forEach(((e,t)=>{t===n.length-1?(G.FunctionType.addParameter(s,{category:0,isNameSynthesized:!1,type:G.UnknownType.create()}),(0,G.isParamSpec)(e)&&(s.details.paramSpec=e)):G.FunctionType.addParameter(s,{category:0,name:`__p${t}`,isNameSynthesized:!0,hasDeclaredType:!0,type:e})})),(0,I.assignTypeToTypeVar)(gi,e,s,p,l,128)}else if((0,W.isEllipsisType)(t)){const t=G.FunctionType.createSynthesizedInstance("",98304);G.TypeBase.setSpecialForm(t),G.FunctionType.addDefaultParameters(t),(0,I.assignTypeToTypeVar)(gi,e,t,p,l)}else rt(m.Localizer.Diagnostic.typeArgListExpected(),o[s].node)}else{let i;if(s<o.length&&o[s].typeList&&rt(m.Localizer.Diagnostic.typeArgListNotAllowed(),o[s].node),i=s<o.length?(0,W.convertToInstance)(o[s].type):e.details.defaultType?(0,W.applySolvedTypeVars)(e,l,{unknownIfNotFound:!0}):G.UnknownType.create(),0!=(16384&n)){const e=function(e){if(!e.typeAliasInfo||!e.typeAliasInfo.typeParameters)return;if(e.typeAliasInfo.usageVariance)return e.typeAliasInfo.usageVariance;const t=e.typeAliasInfo.typeParameters,n=t.map((()=>1));return e.typeAliasInfo.usageVariance=n,At(e,t,n),n}(t);if(e&&s<e.length){const t=e[s];if(!(0,W.isVarianceOfTypeArgumentCompatible)(i,t)){const e=p.createAddendum();e.addMessage(m.Localizer.DiagnosticAddendum.varianceMismatchForTypeAlias().format({typeVarName:mi(i),typeAliasParam:mi(r[s])})),e.addTextRange(o[s].node)}}}(0,I.assignTypeToTypeVar)(gi,e,i,p,l,128)}})),p.isEmpty()||rt(m.Localizer.Diagnostic.typeNotSpecializable().format({type:mi(t)})+p.getString(),e,null!==(i=p.getEffectiveTextRange())&&void 0!==i?i:e);const d=l.getPrimarySignature(),u=[];return null===(a=t.typeAliasInfo.typeParameters)||void 0===a||a.forEach((e=>{let t;if((0,G.isParamSpec)(e)){const n=d.getParamSpecType(e);t=n?(0,W.convertParamSpecValueToType)(n):G.UnknownType.create()}else t=d.getTypeVarType(e);u.push(t||G.UnknownType.create())})),{type:G.TypeBase.cloneForTypeAlias((0,W.applySolvedTypeVars)(t,l),t.typeAliasInfo.name,t.typeAliasInfo.fullName,t.typeAliasInfo.typeVarScopeId,t.typeAliasInfo.typeParameters,u),node:e}}function Pt(e,t,n,s){const i=Et(e,t.type,s);if(i)return i;if((0,G.isTypeVar)(t.type)&&(0,W.isTypeAliasPlaceholder)(t.type)){const n=Mt(e,s).map((e=>(0,W.convertToInstance)(e.type)));return{type:G.TypeBase.cloneForTypeAlias(t.type,t.type.details.recursiveTypeAliasName,"",t.type.details.recursiveTypeAliasScopeId,t.type.details.recursiveTypeParameters,n)}}let a=t.isIncomplete,r=!1,o=!1;const l=gt(t.type,void 0,((t,i)=>{var l;if((0,G.isAnyOrUnknown)(t))return t;if(128&s&&(0,G.isTypeVar)(i))return ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeVarNotSubscriptable().format({type:mi(i)}),e.baseExpression),Mt(e,s),G.UnknownType.create();if((0,G.isInstantiableClass)(t)){if(t.details.effectiveMetaclass&&(0,G.isInstantiableClass)(t.details.effectiveMetaclass)&&!G.ClassType.isBuiltIn(t.details.effectiveMetaclass,["type","_InitVarMeta"])&&0==(128&s)){const i=$e(e,t,kt(n),void 0,void 0,96);if(256&s&&ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeArgsExpectingNone().format({name:mi(G.ClassType.cloneAsInstance(t))}),e),i)return wt(e,t,n).type}if("set"===n.method?ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.genericClassAssigned(),e.baseExpression):"del"===n.method&&ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.genericClassDeleted(),e.baseExpression),G.ClassType.isSpecialBuiltIn(t,"Literal"))return function(e,t){if(0===e.items.length)return rt(m.Localizer.Diagnostic.literalEmptyArgs(),e.baseExpression),G.UnknownType.create();const n=[];for(const t of e.items){let s;const i=t.valueExpression;if(0!==t.argumentCategory)rt(m.Localizer.Diagnostic.unpackedArgInTypeArgument(),i),s=G.UnknownType.create();else if(t.name)rt(m.Localizer.Diagnostic.keywordArgInTypeArgument(),i),s=G.UnknownType.create();else if(48===i.nodeType){s=Fn(e,0!=(32&i.strings[0].token.flags)?"bytes":"str",i.strings.map((e=>e.value)).join(""))}else 40===i.nodeType?!i.isImaginary&&i.isInteger&&(s=Fn(e,"int",i.value)):11===i.nodeType?33===i.constType?s=Fn(e,"bool",!0):15===i.constType?s=Fn(e,"bool",!1):26===i.constType&&(s=G.NoneType.createType()):55===i.nodeType&&33===i.operator&&40===i.expression.nodeType&&!i.expression.isImaginary&&i.expression.isInteger&&(s=Fn(e,"int",-i.expression.value));if(!s){const e=Me(i);if((0,G.isClassInstance)(e.type)&&G.ClassType.isEnumClass(e.type)&&void 0!==e.type.literalValue)s=G.ClassType.cloneAsInstantiable(e.type);else{let t=!0;(0,W.doForEachSubtype)(e.type,(e=>{(0,G.isInstantiableClass)(e)&&void 0!==e.literalValue||(t=!1)})),t&&(s=e.type)}}s||(rt(m.Localizer.Diagnostic.literalUnsupportedType(),t),s=G.UnknownType.create()),n.push(s)}return(0,G.combineTypes)(n)}(e);if(G.ClassType.isBuiltIn(t,"InitVar")){const t=Mt(e,s);return 1===t.length?t[0].type:(rt(m.Localizer.Diagnostic.typeArgsMismatchOne().format({received:t.length}),e.baseExpression),G.UnknownType.create())}if(G.ClassType.isEnumClass(t))return G.ClassType.cloneAsInstance(t);const i=(0,G.isInstantiableClass)(t)&&G.ClassType.isBuiltIn(t,"Annotated"),a=(0,G.isInstantiableClass)(t)&&G.ClassType.hasCustomClassGetItem(t),c=(null===(l=t.details.typeParameters)||void 0===l?void 0:l.length)>0||G.ClassType.isSpecialBuiltIn(t)||G.ClassType.isBuiltIn(t,"type")||G.ClassType.isPartiallyEvaluated(t),d=(0,G.isInstantiableClass)(t)&&G.ClassType.isBuiltIn(t,"Final"),u=(0,G.isInstantiableClass)(t)&&G.ClassType.isBuiltIn(t,"ClassVar"),y=(0,G.isInstantiableClass)(t)&&G.ClassType.isBuiltIn(t,"dict")&&!t.aliasName;let g=Mt(e,s,{isAnnotatedClass:i,hasCustomClassGetItem:a||!c,isFinalAnnotation:d,isClassVarAnnotation:u,supportsTypedDictTypeArg:y});if(i||(g=Dt(g,t.details.typeParameters,e)),a)return t;if(t.typeArguments)return ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.classAlreadySpecialized().format({type:mi((0,W.convertToInstance)(t),{expandTypeAlias:!0})}),e.baseExpression),t;const h=Is(t,g,s,e);return h.isRequired?r=!0:h.isNotRequired&&(o=!0),h.type}if((0,G.isClassInstance)(t)){const s=wt(e,t,n);return s.isIncomplete&&(a=!0),s.type}return(0,G.isNever)(t)||(0,G.isUnbound)(t)?G.NeverType.createNever():(0,G.isNoneInstance)(t)&&!a?(ct(T.getFileInfo(e).diagnosticRuleSet.reportOptionalSubscript,p.DiagnosticRule.reportOptionalSubscript,m.Localizer.Diagnostic.noneNotSubscriptable(),e.baseExpression),G.UnknownType.create()):(a||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeNotSubscriptable().format({type:mi(t)}),e.baseExpression),G.UnknownType.create())}));return t.isIncomplete||e.items.forEach((e=>{Ie(e.valueExpression)||Me(e.valueExpression,4&s)})),{type:l,isIncomplete:a,isRequired:r,isNotRequired:o}}function At(e,t,n,s=0){function i(e,i){(0,W.doForEachSubtype)(e,(e=>{const a=t.findIndex((t=>(0,G.isTypeSame)(t,e)));a>=0?n[a]=(0,W.combineVariances)(n[a],i):At(e,t,n,s)}))}s>G.maxTypeRecursionCount||(s++,(0,W.doForEachSubtype)(e,(e=>{if(5===e.category){if(e.specializedTypes){e.specializedTypes.parameterTypes.forEach((e=>{i(e,4)}));const t=e.specializedTypes.returnType;t&&i(t,3)}}else 7===e.category&&e.typeArguments&&(qn(e),e.typeArguments.forEach(((t,n)=>{var s;if((0,W.isTupleClass)(e))i(t,3);else if(n<e.details.typeParameters.length){const a=e.details.typeParameters[n];(0,G.isUnpackedClass)(t)&&t.tupleTypeArguments?t.tupleTypeArguments.forEach((e=>{i(e.type,2)})):i(t,null!==(s=a.computedVariance)&&void 0!==s?s:a.details.declaredVariance)}})))})))}function Nt(e,t=!1){return ne&&(0,G.isInstantiableClass)(ne)?(0,W.convertToInstance)((0,W.specializeTupleClass)(ne,e.map((e=>({type:e,isUnbounded:t}))))):G.UnknownType.create()}function kt(e){return"get"===e.method?"__getitem__":"set"===e.method?"__setitem__":((0,l.assert)("del"===e.method),"__delitem__")}function wt(e,t,n){var s,i,a,r,o,l;if((0,G.isClassInstance)(t)&&G.ClassType.isTypedDictClass(t)){const s=(0,U.getTypeOfIndexedTypedDict)(gi,e,t,n);if(s)return s}const c=kt(n),d=(0,G.isClassInstance)(t)?null===(s=je(e,t,c,void 0,void 0,64))||void 0===s?void 0:s.type:null===(i=$e(e,t,c,void 0,void 0,96))||void 0===i?void 0:i.type;if(!d)return ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.methodNotDefinedOnType().format({name:c,type:mi(t)}),e.baseExpression),{type:G.UnknownType.create()};if(1===e.items.length&&!e.trailingComma&&!e.items[0].name&&0===e.items[0].argumentCategory&&(0,G.isClassInstance)(t)){const n=e.items[0].valueExpression,s=Me(n).type;if((0,G.isClassInstance)(s)&&G.ClassType.isBuiltIn(s,"int")&&(0,W.isLiteralType)(s)&&"number"==typeof s.literalValue){const e=s.literalValue,n=(0,W.getSpecializedTupleType)(t);if(n&&n.tupleTypeArguments&&!(0,W.isUnboundedTupleClass)(n)){if(e>=0&&e<n.tupleTypeArguments.length)return{type:n.tupleTypeArguments[e].type};if(e<0&&n.tupleTypeArguments.length+e>=0)return{type:n.tupleTypeArguments[n.tupleTypeArguments.length+e].type}}}else if((0,G.isClassInstance)(s)&&G.ClassType.isBuiltIn(s,"slice")){const e=(0,W.getSpecializedTupleType)(t);if(e&&e.tupleTypeArguments&&!(0,W.isUnboundedTupleClass)(e)&&46===n.nodeType&&!n.stepValue){const t=(t,n)=>{let s=n;if(t){const n=Me(t).type;(0,G.isClassInstance)(n)&&G.ClassType.isBuiltIn(n,"int")&&(0,W.isLiteralType)(n)&&"number"==typeof n.literalValue?(s=n.literalValue,s<0&&(s=e.tupleTypeArguments.length+s)):s=-1}return s},s=t(n.startValue,0),i=t(n.endValue,e.tupleTypeArguments.length);if(s>=0&&i>0&&i<=e.tupleTypeArguments.length&&ne&&(0,G.isInstantiableClass)(ne))return{type:G.ClassType.cloneAsInstance((0,W.specializeTupleClass)(ne,e.tupleTypeArguments.slice(s,i)))}}}}const u=e.items.filter((e=>0===e.argumentCategory&&!e.name)),y=e.items.filter((e=>1===e.argumentCategory)),g=e.items.filter((e=>0===e.argumentCategory&&!!e.name)),h=e.items.filter((e=>2===e.argumentCategory));let f,v=!1;if(1!==u.length||0!==y.length||e.trailingComma)if(0===u.length&&0===y.length)f=ne&&(0,G.isInstantiableClass)(ne)?(0,W.convertToInstance)((0,W.specializeTupleClass)(ne,[])):G.UnknownType.create();else{const e=[];u.forEach((t=>{const n=Me(t.valueExpression);e.push(n.type),n.isIncomplete&&(v=!0)})),y.forEach((t=>{var n,s;const i=Me(t.valueExpression);i.isIncomplete&&(v=!0);const a=null!==(s=null===(n=Ze(i,!1,t.valueExpression))||void 0===n?void 0:n.type)&&void 0!==s?s:G.UnknownType.create();e.push(a)})),f=Nt(e,y.length>0)}else{const e=Me(u[0].valueExpression);f=e.type,e.isIncomplete&&(v=!0)}let _,I=[{argumentCategory:0,typeResult:{type:f,isIncomplete:v}}];if("set"===n.method){let e=null!==(r=null===(a=n.setType)||void 0===a?void 0:a.type)&&void 0!==r?r:G.AnyType.create();(0,G.isTypeVar)(e)&&e.details.constraints.length>0&&(e=mt(e,void 0,(0,G.isClassInstance)(t)?t.condition:void 0)),I.push({argumentCategory:0,typeResult:{type:e,isIncomplete:!!(null===(o=n.setType)||void 0===o?void 0:o.isIncomplete)}})}return g.forEach((e=>{I.push({argumentCategory:0,valueExpression:e.valueExpression,node:e,name:e.name})})),h.forEach((e=>{I.push({argumentCategory:2,valueExpression:e.valueExpression,node:e})})),0===g.length&&0===h.length&&1===u.length&&Ps(e,(()=>{if(_=Ht(e,I,{type:d}),_.argumentErrors&&(0,G.isClassInstance)(f)){const t=[...I];if(t[0]={...t[0]},je(e,f,"__index__")){const n=Ds(e,"int");(0,G.isClassInstance)(n)&&(t[0].typeResult={type:n})}_=Ht(e,t,{type:d}),_.argumentErrors||(I=t)}})),_=Ht(e,I,{type:d}),{type:null!==(l=_.returnType)&&void 0!==l?l:G.UnknownType.create(),isIncomplete:!!_.isTypeIncomplete}}function Mt(e,t,n){const s=[];let i=t;(null==n?void 0:n.isFinalAnnotation)||(null==n?void 0:n.isClassVarAnnotation)?i|=131088:(i&=-1065059,(null==n?void 0:n.isAnnotatedClass)||(i|=131088),i|=2097152);const a=(e,t)=>{let s;return s=(null==n?void 0:n.hasCustomClassGetItem)||(null==n?void 0:n.isAnnotatedClass)&&t>0?{...Me(e,131170),node:e}:function(e,t,n){let s,i=137|t;if(T.getFileInfo(e).isStubFile&&(i|=4),31===e.nodeType)s={type:G.UnknownType.create(),typeList:e.entries.map((e=>({...Me(e,i),node:e}))),node:e},Se(e,G.UnknownType.create());else if(15===e.nodeType&&n){const t=oe&&(0,G.isInstantiableClass)(oe)?(0,U.createTypedDictTypeInlined)(gi,e,oe):void 0;s={type:ae&&(0,G.isInstantiableClass)(ae)?ae:G.UnknownType.create(),inlinedTypeDict:t,node:e}}else s={...Me(e,i),node:e},15===e.nodeType&&rt(m.Localizer.Diagnostic.dictInAnnotation(),e),(0,G.isClass)(s.type)&&G.ClassType.isBuiltIn(s.type,"Protocol")&&rt(m.Localizer.Diagnostic.protocolNotAllowedInTypeArgument(),e),0!=(131072&t)&&(0,G.isClass)(s.type)&&G.ClassType.isBuiltIn(s.type,"ClassVar")&&rt(m.Localizer.Diagnostic.classVarNotAllowed(),e);return s}(e,i,!!(null==n?void 0:n.supportsTypedDictTypeArg)&&0===t),s};return 1===e.items.length&&!e.trailingComma&&!e.items[0].name&&52===e.items[0].valueExpression.nodeType&&e.items[0].valueExpression.expressions.length>0?(e.items[0].valueExpression.expressions.forEach(((e,t)=>{s.push(a(e,t))})),Se(e.items[0].valueExpression,G.UnknownType.create())):e.items.forEach(((e,t)=>{const n=a(e.valueExpression,t);0!==e.argumentCategory&&1===e.argumentCategory&&((0,G.isVariadicTypeVar)(n.type)&&!n.type.isVariadicUnpacked?n.type=G.TypeVarType.cloneForUnpacked(n.type):(0,G.isInstantiableClass)(n.type)&&!n.type.includeSubclasses&&(0,W.isTupleClass)(n.type)&&(n.type=G.ClassType.cloneForUnpacked(n.type))),e.name&&rt(m.Localizer.Diagnostic.keywordArgInTypeArgument(),e.valueExpression),s.push(n)})),s}function Rt(e,t){if(t.expectedType=(0,W.transformPossibleRecursiveTypeAlias)(t.expectedType),!(0,G.isClassInstance)(t.expectedType))return;if(!ne||!(0,G.isInstantiableClass)(ne))return;let n=[];if((0,W.isTupleClass)(t.expectedType)&&t.expectedType.tupleTypeArguments){n=t.expectedType.tupleTypeArguments.map((e=>(0,W.transformPossibleRecursiveTypeAlias)(e.type)));const s=t.expectedType.tupleTypeArguments.findIndex((e=>e.isUnbounded));if(s>=0)if(n.length>e.expressions.length)n.splice(s,1);else for(;n.length<e.expressions.length;)n.splice(s,0,n[s])}else{const s=new j.TypeVarContext((0,W.getTypeVarScopeId)(ne));if(!(0,I.populateTypeVarContextBasedOnExpectedType)(gi,G.ClassType.cloneAsInstance(ne),t.expectedType,s,Ct(e)))return;const i=(0,W.applySolvedTypeVars)(ne,s);if(!i.typeArguments||1!==i.typeArguments.length)return;const a=(0,W.transformPossibleRecursiveTypeAlias)(i.typeArguments[0]);for(let t=0;t<e.expressions.length;t++)n.push(a)}const s=e.expressions.map(((e,t)=>Me(e,void 0,(0,W.makeInferenceContext)(t<n.length?n[t]:void 0)))),i=s.some((e=>e.isIncomplete)),a=(0,W.convertToInstance)((0,W.specializeTupleClass)(ne,Ot(s),!0));let r;return s.some((e=>e.expectedTypeDiagAddendum))&&(r=new c.DiagnosticAddendum,s.forEach((e=>{e.expectedTypeDiagAddendum&&r.addAddendum(e.expectedTypeDiagAddendum)}))),{type:a,expectedTypeDiagAddendum:r,isIncomplete:i}}function Ot(e){const t=[];for(const n of e){let e;if(n.unpackedType?e=n.unpackedType:(0,G.isUnpacked)(n.type)&&(e=n.type),e&&(0,G.isClassInstance)(e)&&e.tupleTypeArguments){const n=e.tupleTypeArguments;n?(0,o.appendArray)(t,n):t.push({type:G.UnknownType.create(),isUnbounded:!0})}else(0,G.isNever)(n.type)&&n.isIncomplete&&!n.unpackedType?t.push({type:G.UnknownType.create(!0),isUnbounded:!1}):t.push({type:n.type,isUnbounded:!!n.unpackedType})}if(t.filter((e=>e.isUnbounded)).length>1){const e=t.findIndex((e=>e.isUnbounded)),n=t.splice(e);t.push({type:(0,G.combineTypes)(n.map((e=>e.type))),isUnbounded:!0})}return t}function Lt(e,t){let n,s,i,a,r;if(e.arguments.forEach(((e,t)=>{if(0===t)0!==e.argumentCategory||e.name||(n=e.valueExpression);else if(0===e.argumentCategory&&e.name)if("expected_text"===e.name.value){a=e.valueExpression;const t=Me(e.valueExpression).type;(0,G.isClassInstance)(t)&&G.ClassType.isBuiltIn(t,"str")&&"string"==typeof t.literalValue?r=t.literalValue:rt(m.Localizer.Diagnostic.revealTypeExpectedTextArg(),e.valueExpression)}else"expected_type"===e.name.value&&(s=e.valueExpression,i=(0,W.convertToInstance)(Cs(e).type));else n=void 0})),!n)return rt(m.Localizer.Diagnostic.revealTypeArgs(),e),{type:G.UnknownType.create()};const o=Me(n,void 0,t),l=o.type,c=P.printExpression(n),p=mi(l,{expandTypeAlias:!0});if(void 0!==r&&r!==p&&rt(m.Localizer.Diagnostic.revealTypeExpectedTextMismatch().format({expected:r,received:p}),null!=a?a:n),i&&!(0,G.isTypeSame)(i,l,{ignorePseudoGeneric:!0})){const e=mi(i);rt(m.Localizer.Diagnostic.revealTypeExpectedTypeMismatch().format({expected:e,received:p}),null!=s?s:n)}return at(m.Localizer.DiagnosticAddendum.typeOfSymbol().format({name:c,type:p}),e.arguments[0]),{type:l,isIncomplete:o.isIncomplete}}function Vt(e,t,n,s,i,a){var r,o;const l=[],c=[];let p=!1,d=[],u=!1;for(let i=0;i<t.length;i++){let y;const m=t[i],g=m.some((e=>void 0!==e));let h=[];u=!1;for(let t=0;t<n.length;t++){const i=n[t].overload;let f=n[t];g&&(f={...n[t]},f.argParams=f.argParams.map(((e,t)=>{if(!m[t])return e;const n={...e};return n.argType=m[t],n})));const T=c.length>0?c[c.length-1].typeVarContext.clone():s,v=null!==(r=null==T?void 0:T.clone())&&void 0!==r?r:new j.TypeVarContext((0,W.getTypeVarScopeId)(i));v.addSolveForScope((0,W.getTypeVarScopeId)(i)),i.details.constructorTypeVarScopeId&&v.addSolveForScope(i.details.constructorTypeVarScopeId),v.unlock();const _=Ps(e,(()=>Zt(e,f,v,!0,a)));if(_.isTypeIncomplete&&(p=!0),!_.argumentErrors&&_.returnType){d.push(i),y=i;const e={overload:y,matchResults:f,typeVarContext:v,returnType:_.returnType,argResults:null!==(o=_.argResults)&&void 0!==o?o:[]};if(c.push(e),!_.isArgumentAnyOrUnknown){l.push(_.returnType),u=!0;break}h.push(e)}}if(!u)if(h=Ut(h),1===h.length)d=[h[0].overload],l.push(h[0].returnType);else{let e=[];h.forEach((t=>{let n=!1;for(let s=0;s<e.length;s++){if(Zs(e[s],t.returnType)){n=!0;break}if(Zs(t.returnType,e[s])){e[s]=G.NeverType.createNever();break}}n||e.push(t.returnType)})),e=e.filter((e=>!(0,G.isNever)(e)));const t=(0,G.combineTypes)(e);l.push(e.length>1?G.UnknownType.createPossibleType(t):t)}if(!y)return{argumentErrors:!0,isTypeIncomplete:p,overloadsUsedForCall:d}}s&&u&&s.copyFromClone(c[c.length-1].typeVarContext);const y=null!=s?s:c[0].typeVarContext;y.unlock(),y.addSolveForScope((0,W.getTypeVarScopeId)(c[0].overload));const m=Zt(e,c[0].matchResults,y,i,a);return m.isTypeIncomplete&&(p=!0),{argumentErrors:m.argumentErrors,isArgumentAnyOrUnknown:m.isArgumentAnyOrUnknown,returnType:(0,G.combineTypes)(l),isTypeIncomplete:p,specializedInitSelfType:m.specializedInitSelfType,overloadsUsedForCall:d}}function Ut(e){if(e.length<2)return e;if((0,W.areTypesSame)(e.map((e=>e.returnType)),{treatAnySameAsUnknown:!0}))return[e[0]];const t=e[0].argResults;if(!t)return e;for(let n=0;n<t.length;n++)if((0,G.isAnyOrUnknown)(t[n].argType)){const t=e.map((e=>n<e.matchResults.argParams.length?e.matchResults.argParams[n].paramType:G.UnknownType.create()));if(!(0,W.areTypesSame)(t,{treatAnySameAsUnknown:!0}))return e}return[e[0]]}function zt(e,t,n){let s,i=0,a=[];return G.OverloadedFunctionType.getOverloads(t.type).forEach((s=>{Ps(e,(()=>{const r=Yt(e,n,{type:s,isIncomplete:t.isIncomplete},i);r.argumentErrors||a.push(r),i++}))})),a=Bt(a),a.forEach(((t,n)=>{void 0===s&&Ps(e,(()=>{const i=Qt(e,t,new j.TypeVarContext((0,W.getTypeVarScopeId)(t.overload)),!0);i&&!i.argumentErrors&&(s=n)}))})),void 0===s?void 0:a[s].overload}function Bt(e){return e.sort(((e,t)=>e.relevance!==t.relevance?t.relevance-e.relevance:e.overloadIndex-t.overloadIndex))}function Gt(e,t,n,s,i,a){let r,o=[];if(Ps(e,(()=>{let s=0;G.OverloadedFunctionType.getOverloads(n.type).forEach((i=>{const a=Yt(e,t,{type:i,isIncomplete:n.isIncomplete},s);a.argumentErrors||o.push(a),s++}))})),o=Bt(o),0===o.length){if(!lt(e)){const s=n.type.overloads[0].details.name||"<anonymous function>",i=new c.DiagnosticAddendum,a=t.map((e=>mi(bs(e).type)));i.addMessage(m.Localizer.DiagnosticAddendum.argumentTypes().format({types:a.join(", ")})),ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.noOverload().format({name:s})+i.getString(),e)}return{argumentErrors:!0,isTypeIncomplete:!1,overloadsUsedForCall:[]}}const l=t=>{const n=o.reduce(((e,t)=>t.overloadIndex>e.overloadIndex?t:e)),i=null!=s?s:new j.TypeVarContext;return i.addSolveForScope((0,W.getTypeVarScopeId)(n.overload)),n.overload.details.constructorTypeVarScopeId&&i.addSolveForScope(n.overload.details.constructorTypeVarScopeId),i.unlock(),Zt(e,n,i,t,a)};if(1===o.length)return l(!1);let d=[t.map((e=>{}))],u=!!n.isIncomplete;for(;;){const n=Vt(e,d,o,s,i,a);if(n.isTypeIncomplete&&(u=!0),!n.argumentErrors)return n;if(r||Ps(e,(()=>{r=t.map((e=>{if(e.typeResult)return e.typeResult.type;if(e.valueExpression){const t=e.valueExpression;return Ps(t,(()=>Me(t).type))}return G.AnyType.create()}))})),d=Wt(r,d),!d||d.length>64)break}if(!lt(e)&&!u){const e=l(!0);return e.returnType=G.UnknownType.create(),{...e,argumentErrors:!0}}return{argumentErrors:!0,isTypeIncomplete:!1,overloadsUsedForCall:[]}}function Wt(e,t){let n,s=e.length-1;for(;s>=0&&!t[0][s];)s--;if(s++,s>=e.length)return;for(;s<e.length;){const t=e[s];if((0,G.isUnion)(t)){n=mt(t);break}if((0,G.isTypeVar)(t)&&t.details.constraints.length>1){n=mt(t);break}s++}if(!n)return;const i=[];return t.forEach((e=>{(0,W.doForEachSubtype)(n,(t=>{const n=[...e];n[s]=t,i.push(n)}))})),i}function jt(e,t,n,s,i){var r;let o,l=!1,c=!1,d=!1,u=!1;const y=[],g=e=>(0,G.isFunction)(e)&&G.FunctionType.isSkipConstructorCheck(e),h=null===(r=je(e,G.ClassType.cloneAsInstance(n),"__init__",{method:"get"},void 0,68))||void 0===r?void 0:r.type;if(h&&!g(h)){if(i){const a=$t(e,t,n,s,i,h);a&&!a.argumentErrors&&(o=a.returnType,a.isTypeIncomplete&&(d=!0),y.push(...a.overloadsUsedForCall))}if(!o){const i=n.typeArguments?(0,W.buildTypeVarContextFromSpecializedClass)(n,!1):new j.TypeVarContext((0,W.getTypeVarScopeId)(n));i.addSolveForScope((0,W.getTypeVarScopeId)(h));const a=Ht(e,t,{type:h},i,s);if(a.argumentErrors)c=!0;else{let e=n;a.specializedInitSelfType&&(0,G.isClassInstance)(a.specializedInitSelfType)&&G.ClassType.isSameGenericClass(a.specializedInitSelfType,n)&&(e=G.ClassType.cloneAsInstantiable(a.specializedInitSelfType)),o=Kt(e,void 0,i),a.isTypeIncomplete&&(d=!0),y.push(...a.overloadsUsedForCall)}}l=!0,s=!0}if(!c){const a=n.details.effectiveMetaclass;let r;if(a&&(0,G.isInstantiableClass)(a)&&!G.ClassType.isSameGenericClass(a,n)&&(r=xt(e,a,!0,"__call__",{method:"get"},void 0,352,n),r&&(u=!0)),r||(r=xt(e,n,!1,"__new__",{method:"get"},void 0,21,n)),r&&!g(r.type)){const a=r.type;let p;if(i&&!o){const r=$t(e,t,n,s,i,a);r&&!r.argumentErrors&&(p=r.returnType,o=p,r.isTypeIncomplete&&(d=!0))}const u=new j.TypeVarContext((0,W.getTypeVarScopeId)(n));let y;n.typeAliasInfo&&u.addSolveForScope(n.typeAliasInfo.typeVarScopeId),u.addSolveForScope((0,W.getTypeVarScopeId)(a)),y=(0,b.hasConstructorTransform)(n)?Ps(e,(()=>Ht(e,t,r,u,s))):Ht(e,t,r,u,s),y.isTypeIncomplete&&(d=!0),y.argumentErrors?c=!0:p||(p=y.returnType,p&&((0,G.isClassInstance)(p)&&G.ClassType.isSameGenericClass(p,n)?((0,W.isPartlyUnknown)(p)||(0,W.requiresSpecialization)(p))&&void 0!==o||((0,G.isClassInstance)(p)&&G.ClassType.isTupleClass(p)&&!p.tupleTypeArguments&&p.typeArguments&&1===p.typeArguments.length&&(p=(0,W.specializeTupleClass)(p,[{type:p.typeArguments[0],isUnbounded:!0}])),o=p):o||(0,G.isUnknown)(p)||(o=p))),o?(0,G.isClassInstance)(o)&&(0,W.isTupleClass)(o)&&!o.tupleTypeArguments&&(o=function(e,t){let n=e;return t&&(0,G.isClassInstance)(t.expectedType)&&(0,W.isTupleClass)(t.expectedType)&&t.expectedType.tupleTypeArguments&&(n=(0,W.specializeTupleClass)(e,t.expectedType.tupleTypeArguments)),n}(o,i)):o=Kt(n,i,u),l=!0}}if(l||t.forEach((e=>{e.valueExpression&&!a.isSpeculative(e.valueExpression)&&Me(e.valueExpression)})),!l&&t.some((e=>0===e.argumentCategory))&&(n.details.effectiveMetaclass&&(0,G.isInstantiableClass)(n.details.effectiveMetaclass)&&!G.ClassType.isBuiltIn(n.details.effectiveMetaclass)||u||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.constructorNoArgs().format({type:n.aliasName||n.details.name}),e)),!o)if(!i&&n.typeArguments)o=(0,W.convertToInstance)(n);else{const t=new j.TypeVarContext((0,W.getTypeVarScopeId)(n));i&&(0,I.populateTypeVarContextBasedOnExpectedType)(gi,G.ClassType.cloneAsInstance(n),i.expectedType,t,Ct(e)),o=Kt(n,i,t)}if(!c){const s=(0,b.applyConstructorTransform)(gi,e,t,n,{argumentErrors:c,returnType:o,isTypeIncomplete:d});o=s.returnType,s.isTypeIncomplete&&(d=!0),s.argumentErrors&&(c=!0)}return{argumentErrors:c,returnType:o,isTypeIncomplete:d,overloadsUsedForCall:y}}function $t(e,t,n,s,i,a){let r=!1,o=!1;const l=[],c=(0,W.mapSubtypes)(i.expectedType,(i=>{i=(0,W.transformPossibleRecursiveTypeAlias)(i);const c=new j.TypeVarContext((0,W.getTypeVarScopeId)(n));if((0,I.populateTypeVarContextBasedOnExpectedType)(gi,G.ClassType.cloneAsInstance(n),i,c,Ct(e))){let p;if(Ps(e,(()=>{p=Ht(e,t,{type:a},c.clone(),s)})),!p.argumentErrors)return p=Ht(e,t,{type:a},c,s),p.isTypeIncomplete&&(r=!0),p.argumentErrors&&(o=!0),l.push(...p.overloadsUsedForCall),qt(n,i,c)}}));if(!(0,G.isNever)(c))return{returnType:c,isTypeIncomplete:r,argumentErrors:o,overloadsUsedForCall:l}}function qt(e,t,n){const s=(0,W.applySolvedTypeVars)(G.ClassType.cloneAsInstance(e),n);if(Zs(t,s))return(0,G.isAny)(t)?t:s}function Kt(e,t,n){let s=!0;if(t){const i=(0,W.mapSubtypes)(t.expectedType,(t=>qt(e,t,n)));if(!(0,G.isNever)(i))return i;e.typeArguments&&(s=!1)}const i=(0,W.applySolvedTypeVars)(e,n,{unknownIfNotFound:s});return G.ClassType.cloneAsInstance(i)}function Ht(e,t,n,s,i=!1,r,o=0){let l,d=!1,u=!1;const y=[];if(o>G.maxTypeRecursionCount)return{returnType:G.UnknownType.create(),argumentErrors:!0,overloadsUsedForCall:y};if(o++,G.TypeBase.isSpecialForm(n.type)){const t=9===e.nodeType?e.leftExpression:e;return ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeNotCallable().format({expression:P.printExpression(t),type:mi(n.type,{expandTypeAlias:!0})}),t),{returnType:G.UnknownType.create(),argumentErrors:!0,overloadsUsedForCall:y}}let g=gt(n.type,void 0,((g,h)=>{var f,v,_,I,b,C,S;switch(g.category){case 1:case 2:return n.isIncomplete||t.forEach((e=>{e.valueExpression&&!a.isSpeculative(e.valueExpression)&&bs(e)})),g;case 5:{if(G.TypeBase.isInstantiable(g))return ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.callableNotInstantiable().format({type:mi(g)}),e),void(d=!0);if("namedtuple"===g.details.builtInName)return ct(T.getFileInfo(e).diagnosticRuleSet.reportUntypedNamedTuple,p.DiagnosticRule.reportUntypedNamedTuple,m.Localizer.Diagnostic.namedTupleNoTypes(),e),(0,F.createNamedTupleType)(gi,e,t,!1);if("NewType"===g.details.builtInName)return rn(e,t);let a=s;a||(a=new j.TypeVarContext((0,W.getTypeVarScopeId)(g)),G.FunctionType.isConstructorMethod(g)&&a.addSolveForScope(G.WildcardTypeVarScopeId));const o=Xt(e,t,{type:g,isIncomplete:n.isIncomplete},a,i,r);if(o.isTypeIncomplete&&(u=!0),y.push(...o.overloadsUsedForCall),o.argumentErrors)d=!0;else{l=o.specializedInitSelfType;const n=(0,D.applyFunctionTransform)(gi,e,t,g,{argumentErrors:o.argumentErrors,returnType:null!==(f=o.returnType)&&void 0!==f?f:G.UnknownType.create(u),isTypeIncomplete:u});o.returnType=n.returnType,n.isTypeIncomplete&&(u=!0),n.argumentErrors&&(d=!0)}return"__import__"===g.details.builtInName?G.AnyType.create():o.returnType}case 6:{if("cast"===g.overloads[0].details.builtInName&&2===t.length){const n=Cs(t[0]).type,s=bs(t[1]).type;return(0,G.isInstantiableClass)(n)&&(0,G.isClassInstance)(s)&&(0,G.isTypeSame)(n,G.ClassType.cloneAsInstantiable(s),{ignorePseudoGeneric:!0})&&ct(T.getFileInfo(e).diagnosticRuleSet.reportUnnecessaryCast,p.DiagnosticRule.reportUnnecessaryCast,m.Localizer.Diagnostic.unnecessaryCast().format({type:mi(s)}),e),(0,W.convertToInstance)(n)}const a=Gt(e,t,{type:g,isIncomplete:n.isIncomplete},s,i,r);if(y.push(...a.overloadsUsedForCall),a.isTypeIncomplete&&(u=!0),a.argumentErrors)d=!0;else{l=a.specializedInitSelfType;const n=(0,D.applyFunctionTransform)(gi,e,t,g,{argumentErrors:a.argumentErrors,returnType:null!==(v=a.returnType)&&void 0!==v?v:G.UnknownType.create(u),isTypeIncomplete:u});a.returnType=n.returnType,n.isTypeIncomplete&&(u=!0),n.argumentErrors&&(d=!0)}return null!==(_=a.returnType)&&void 0!==_?_:G.UnknownType.create()}case 7:if(G.TypeBase.isInstantiable(g)){if(void 0!==g.literalValue)return ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.literalNotCallable(),e),d=!0,G.UnknownType.create();if(G.ClassType.isBuiltIn(g)){const n=g.aliasName||g.details.name;if("type"===n){if(jt(e,t,g,i,r),1===t.length){const e=bs(t[0]).type;return(0,W.mapSubtypes)(e,(e=>(0,G.isClassInstance)(e)||(0,G.isTypeVar)(e)&&G.TypeBase.isInstance(e)||(0,G.isNoneInstance)(e)?(0,W.convertToInstantiable)(Oe(e)):(0,G.isFunction)(e)&&G.TypeBase.isInstance(e)?G.FunctionType.cloneAsInstantiable(e):G.AnyType.create()))}return t.length>=2&&function(e,t){const n=T.getFileInfo(e),s=bs(t[0]).type;if(!(0,G.isClassInstance)(s)||!G.ClassType.isBuiltIn(s,"str"))return;const i=s.literalValue||"_",a=bs(t[1]).type;if(!(0,G.isClassInstance)(a)||!(0,W.isTupleClass)(a)||void 0===a.tupleTypeArguments)return;const r=G.ClassType.createInstantiable(i,P.getClassFullName(e,n.moduleName,i),n.moduleName,n.filePath,0,P.getTypeSourceId(e),void 0,a.details.effectiveMetaclass);return a.tupleTypeArguments.forEach((n=>{const s=mt(n.type);(0,W.isEffectivelyInstantiable)(s)?r.details.baseClasses.push(s):dt(n.type,t[1].valueExpression||e)})),(0,W.computeMroLinearization)(r)||rt(m.Localizer.Diagnostic.methodOrdering(),e),r}(e,t)||G.AnyType.create()}if("TypeVar"===n)return function(e,t){var n,s,i,a,r,o,l;let c,d,u="";if(0===t.length)return void rt(m.Localizer.Diagnostic.typeVarFirstArg(),e);const y=t[0];y.valueExpression&&48===y.valueExpression.nodeType?u=y.valueExpression.strings.map((e=>e.value)).join(""):rt(m.Localizer.Diagnostic.typeVarFirstArg(),y.valueExpression||e);const g=G.TypeVarType.createInstantiable(u,!1),h=new Map;for(let p=1;p<t.length;p++){const u=t[p].name,y=u?u.value:void 0;if(y){if(h.get(y)&&rt(m.Localizer.Diagnostic.duplicateParam().format({name:y}),t[p].valueExpression||e),"bound"===y)if(g.details.constraints.length>0)rt(m.Localizer.Diagnostic.typeVarBoundAndConstrained(),t[p].valueExpression||e);else{const i=null!==(s=null===(n=t[p].typeResult)||void 0===n?void 0:n.type)&&void 0!==s?s:Ss(t[p].valueExpression).type;(0,W.requiresSpecialization)(i,!0)&&rt(m.Localizer.Diagnostic.typeVarBoundGeneric(),t[p].valueExpression||e),g.details.boundType=(0,W.convertToInstance)(i)}else if("covariant"===y)t[p].valueExpression&&an(t[p].valueExpression)&&(4===g.details.declaredVariance||0===g.details.declaredVariance?rt(m.Localizer.Diagnostic.typeVarVariance(),t[p].valueExpression):g.details.declaredVariance=3);else if("contravariant"===y)t[p].valueExpression&&an(t[p].valueExpression)&&(3===g.details.declaredVariance||0===g.details.declaredVariance?rt(m.Localizer.Diagnostic.typeVarVariance(),t[p].valueExpression):g.details.declaredVariance=4);else if("infer_variance"===y)t[p].valueExpression&&an(t[p].valueExpression)&&(3===g.details.declaredVariance||4===g.details.declaredVariance?rt(m.Localizer.Diagnostic.typeVarVariance(),t[p].valueExpression):g.details.declaredVariance=0);else if("default"===y){d=t[p].valueExpression;const e=null!==(a=null===(i=t[p].typeResult)||void 0===i?void 0:i.type)&&void 0!==a?a:Ss(t[p].valueExpression).type;g.details.defaultType=(0,W.convertToInstance)(e)}else rt(m.Localizer.Diagnostic.typeVarUnknownParam().format({name:y}),(null===(r=t[p].node)||void 0===r?void 0:r.name)||t[p].valueExpression||e);h.set(y,y)}else if(g.details.boundType)rt(m.Localizer.Diagnostic.typeVarBoundAndConstrained(),t[p].valueExpression||e);else{const n=null!==(l=null===(o=t[p].typeResult)||void 0===o?void 0:o.type)&&void 0!==l?l:Ss(t[p].valueExpression).type;(0,W.requiresSpecialization)(n,!0)&&rt(m.Localizer.Diagnostic.typeVarConstraintGeneric(),t[p].valueExpression||e),G.TypeVarType.addConstraint(g,(0,W.convertToInstance)(n)),void 0===c&&(c=t[p])}}if(1===g.details.constraints.length&&c&&ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeVarSingleConstraint(),c.valueExpression||e),g.details.defaultType&&d){const t=new j.TypeVarContext(G.WildcardTypeVarScopeId),n=mt((0,W.applySolvedTypeVars)(g.details.defaultType,t,{unknownIfNotFound:!0}));g.details.boundType?Zs(g.details.boundType,n)||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeVarDefaultBoundMismatch(),d):g.details.constraints.length>0&&(g.details.constraints.some((e=>(0,G.isTypeSame)(e,n)))||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeVarDefaultConstraintMismatch(),d))}return g}(e,t);if("TypeVarTuple"===n)return function(e,t){var n,s;let i="";if(0===t.length)return void rt(m.Localizer.Diagnostic.typeVarFirstArg(),e);const a=t[0];a.valueExpression&&48===a.valueExpression.nodeType?i=a.valueExpression.strings.map((e=>e.value)).join(""):rt(m.Localizer.Diagnostic.typeVarFirstArg(),a.valueExpression||e);const r=G.TypeVarType.createInstantiable(i,!1);r.details.isVariadic=!0;for(let i=1;i<t.length;i++){const a=t[i].name,o=a?a.value:void 0;if(o)if("default"===o){const e=t[i].valueExpression;e&&(r.details.defaultType=nn(e))}else rt(m.Localizer.Diagnostic.typeVarTupleUnknownParam().format({name:(null===(n=t[i].name)||void 0===n?void 0:n.value)||"?"}),(null===(s=t[i].node)||void 0===s?void 0:s.name)||t[i].valueExpression||e)}return r}(e,t);if("ParamSpec"===n)return function(e,t){if(0===t.length)return void rt(m.Localizer.Diagnostic.paramSpecFirstArg(),e);const n=t[0];let s="";n.valueExpression&&48===n.valueExpression.nodeType?s=n.valueExpression.strings.map((e=>e.value)).join(""):rt(m.Localizer.Diagnostic.paramSpecFirstArg(),n.valueExpression||e);const i=G.TypeVarType.createInstantiable(s,!0);for(let n=1;n<t.length;n++){const s=t[n].name,a=s?s.value:void 0;if(!a){rt(m.Localizer.Diagnostic.paramSpecUnknownArg(),t[n].valueExpression||e);break}if("default"===a){const e=t[n].valueExpression;e&&(i.details.defaultType=sn(e))}else rt(m.Localizer.Diagnostic.paramSpecUnknownParam().format({name:a}),s||t[n].valueExpression||e)}return i}(e,t);if("NamedTuple"===n)return(0,F.createNamedTupleType)(gi,e,t,!0);if("NewType"===n)return rn(e,t);if("Protocol"===n||"Generic"===n||"Callable"===n||"Concatenate"===n||"Type"===n)return ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeNotIntantiable().format({type:n}),e),G.AnyType.create();if((0,G.isClass)(h)&&(0,x.isKnownEnumType)(n))return null!==(I=(0,x.createEnumType)(e,g,t))&&void 0!==I?I:G.UnknownType.create();if("TypedDict"===n)return(0,U.createTypedDictType)(gi,e,g,t);if("auto"===n&&0===t.length)return(0,x.getEnumAutoValueType)(gi,e)}if(G.ClassType.supportsAbstractMethods(g)){const t=ai(g);if(t.length>0&&!g.includeSubclasses&&!(0,G.isTypeVar)(h)){const n=new c.DiagnosticAddendum,s=2;t.forEach(((e,i)=>{if(i===s)n.addMessage(m.Localizer.DiagnosticAddendum.memberIsAbstractMore().format({count:t.length-s}));else if(i<s&&(0,G.isInstantiableClass)(e.classType)){const t=e.classType.details.name;n.addMessage(m.Localizer.DiagnosticAddendum.memberIsAbstract().format({type:t,name:e.symbolName}))}})),ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.instantiateAbstract().format({type:g.details.name})+n.getString(),e)}}G.ClassType.isProtocolClass(g)&&!g.includeSubclasses&&ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.instantiateProtocol().format({type:g.details.name}),e);const n=jt(e,t,g,i,r);y.push(...n.overloadsUsedForCall),n.argumentErrors&&(d=!0),n.isTypeIncomplete&&(u=!0);let s=n.returnType;if((0,G.isTypeVar)(h)&&(s=(0,W.convertToInstance)(h)),s&&(0,G.isClassInstance)(s)&&s.details.mro.some((e=>(0,G.isInstantiableClass)(e)&&G.ClassType.isBuiltIn(e,"type")))){let n="__class_"+s.details.name;if(3===t.length){const e=bs(t[0]).type;(0,G.isClassInstance)(e)&&G.ClassType.isBuiltIn(e,"str")&&"string"==typeof e.literalValue&&(n=e.literalValue)}const i=G.ClassType.createInstantiable(n,"","",T.getFileInfo(e).filePath,0,P.getTypeSourceId(e),G.ClassType.cloneAsInstantiable(s),G.ClassType.cloneAsInstantiable(s));return i.details.baseClasses.push(xs(e,"object")),i.details.effectiveMetaclass=g,(0,W.computeMroLinearization)(i),i}return s}{const n=null===(b=je(e,g,"__call__",void 0,void 0,64))||void 0===b?void 0:b.type;if(n){const a=Ht(e,t,{type:n},s,i,r,o);return y.push(...a.overloadsUsedForCall),a.argumentErrors&&(d=!0),(0,G.isTypeVar)(h)&&G.TypeBase.isInstantiable(h)&&(0,G.isClass)(g)&&G.ClassType.isBuiltIn(g,"type")?(0,W.convertToInstance)(h):null!==(C=a.returnType)&&void 0!==C?C:G.UnknownType.create()}return n&&(0,G.isAnyOrUnknown)(n)||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.objectNotCallable().format({type:mi(g)}),e),G.UnknownType.create()}case 3:if(G.TypeBase.isInstantiable(g)){if(Q&&(0,G.isInstantiableClass)(Q)){const n=Ht(e,t,{type:Q},s,i,r,o);n.isTypeIncomplete&&(u=!0),n.argumentErrors&&(d=!0)}return G.NoneType.createInstance()}return void ct(T.getFileInfo(e).diagnosticRuleSet.reportOptionalCall,p.DiagnosticRule.reportOptionalCall,m.Localizer.Diagnostic.noneNotCallable(),e);case 10:{g=(0,W.transformPossibleRecursiveTypeAlias)(g);const n=Ht(e,t,{type:g},s,i,r,o);return y.push(...n.overloadsUsedForCall),n.argumentErrors&&(d=!0),null!==(S=n.returnType)&&void 0!==S?S:G.UnknownType.create()}case 8:return void ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.moduleNotCallable(),e)}}));return d&&(0,G.isNever)(g)&&!g.isNoReturn&&(g=G.UnknownType.create()),{argumentErrors:d,returnType:g,isTypeIncomplete:u,specializedInitSelfType:l,overloadsUsedForCall:y}}function Yt(e,t,n,s){var i,r,o,d,u,y,g,h,f;const v=(0,E.getParameterListDetails)(n.type);let _=0,I=!1,b=!1,C=!!n.isIncomplete,S=!1;t=function(e){var t;const n=[];for(const s of e){if(1===s.argumentCategory){const e=bs(s).type,i=(0,W.combineSameSizedTuples)(mt(e),ne);if((0,G.isClassInstance)(i)&&(0,W.isTupleClass)(i)){const e=null!==(t=i.tupleTypeArguments)&&void 0!==t?t:[];if(1!==e.length){for(const t of e)t.isUnbounded?n.push({...s,argumentCategory:1,valueExpression:void 0,typeResult:{type:(0,W.specializeTupleClass)(i,[t])}}):n.push({...s,argumentCategory:0,valueExpression:void 0,typeResult:{type:t.type}});continue}}}n.push(s)}return n}(t);const x=new Map;v.params.forEach((e=>{const t=e.param;t.name&&0===t.category&&x.set(t.name,{argsNeeded:0!==t.category||t.hasDefault?0:1,argsReceived:0,isPositionalOnly:e.source===E.ParameterSource.PositionOnly})}));let D=v.positionOnlyParamCount,F=null!==(i=v.firstKeywordOnlyIndex)&&void 0!==i?i:v.params.length;const P=v.argsIndex,A=v.kwargsIndex;let N,k,w=!1;if(void 0!==P&&void 0!==A){(0,l.assert)(v.params[P],"varArgListParamIndex params entry is undefined");const e=v.params[P].param;(0,l.assert)(v.params[A],"varArgDictParamIndex params entry is undefined");const t=v.params[A].param;(0,G.isParamSpec)(e.type)&&"args"===e.type.paramSpecAccess&&(0,G.isParamSpec)(t.type)&&"kwargs"===t.type.paramSpecAccess&&e.type.details.name===t.type.details.name&&(w=!0,e.type.scopeId===n.type.details.typeVarScopeId||e.type.scopeId===n.type.details.constructorTypeVarScopeId?(N=[],k=G.TypeVarType.cloneForParamSpecAccess(e.type,void 0)):D=P)}t.some((e=>1===e.argumentCategory))&&t.forEach((e=>{if(e.name){const t=v.params.findIndex((t=>t.param.name===e.name.value&&0===t.param.category));t>=0&&t>=D&&(F<0||t<F)&&(F=t)}})),F<0&&(F=v.params.length);let M=t.findIndex((e=>2===e.argumentCategory||void 0!==e.name));M<0&&(M=t.length);let R,O=[];function L(e,t){e.active&&(R=t)}const V=void 0!==t.find((e=>1===e.argumentCategory));let z=0;for(;_<M;){_<D&&t[_].name&&(ct(T.getFileInfo(t[_].name).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.argPositional(),t[_].name),b=!0);const s=M-_,i=F-z-1;if(z>=F){if(!n.type.details.paramSpec){let n=!1;if(V&&1===t[_].argumentCategory){const e=bs(t[_]).type;(0,G.isClassInstance)(e)&&(0,W.isTupleClass)(e)&&!(0,W.isUnboundedTupleClass)(e)&&void 0!==e.tupleTypeArguments&&e.tupleTypeArguments.length>0&&(n=!0)}else n=!0;n&&(lt(e)||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,1===F?m.Localizer.Diagnostic.argPositionalExpectedOne():m.Localizer.Diagnostic.argPositionalExpectedCount().format({expected:F}),null!==(r=t[_].valueExpression)&&void 0!==r?r:e),b=!0)}break}if(z>=v.params.length)break;(0,l.assert)(v.params[z],"paramIndex params entry is undefined");const a=v.params[z].type,c=v.params[z].param.name,g=1===v.params[z].param.category&&(0,G.isVariadicTypeVar)(a);if(1===t[_].argumentCategory){let r=!1;const l=bs(t[_]);let h,f=!1;n.type.details.paramSpec&&z<F&&(lt(e)||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,1===F?m.Localizer.Diagnostic.argPositionalExpectedOne():m.Localizer.Diagnostic.argPositionalExpectedCount().format({expected:F}),null!==(o=t[_].valueExpression)&&void 0!==o?o:e),b=!0);const D=l.type;g&&(0,G.isUnpackedVariadicTypeVar)(D)?(h=D,r=!0,f=!0,S=!0):(0,G.isClassInstance)(D)&&(0,W.isTupleClass)(D)&&D.tupleTypeArguments&&1===D.tupleTypeArguments.length&&(0,G.isUnpackedVariadicTypeVar)(D.tupleTypeArguments[0].type)?(h=D.tupleTypeArguments[0].type,r=!0,f=!0,S=!0):g&&(0,G.isClassInstance)(D)&&(0,W.isTupleClass)(D)?(r=!0,f=!0,s<i&&(S=!0),h=G.ClassType.cloneForUnpacked(D)):(0,G.isParamSpec)(D)&&"args"===D.paramSpecAccess?h=void 0:(h=null!==(u=null===(d=Ze({type:D,isIncomplete:l.isIncomplete},!1,t[_].valueExpression))||void 0===d?void 0:d.type)&&void 0!==u?u:G.UnknownType.create(),1!==v.params[z].param.category&&(I=!0));const E=h?{argumentCategory:0,typeResult:{type:h,isIncomplete:l.isIncomplete}}:void 0;E&&l.isIncomplete&&(C=!0),g&&!r?(lt(e)||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.unpackedArgWithVariadicParam(),t[_].valueExpression||e),b=!0):(N&&N.push(t[_]),E&&O.push({paramCategory:v.params[z].param.category,paramType:a,requiresTypeVarMatching:(0,W.requiresSpecialization)(a),argument:E,errorNode:null!==(y=t[_].valueExpression)&&void 0!==y?y:e,paramName:c,isParamNameSynthesized:v.params[z].param.isNameSynthesized,mapsToVarArgList:g&&s>i})),L(t[_],v.params[z].param),c&&0===v.params[z].param.category&&x.has(c)&&x.get(c).argsReceived++,(f||1===v.params[z].param.category)&&_++,(S||1!==v.params[z].param.category)&&z++}else if(1===v.params[z].param.category)if(L(t[_],v.params[z].param),N)N.push(t[_]),_++;else{let n=v.params[z].param.category,r=a;const o=v.params[z].param.name;(0,G.isUnpackedClass)(a)&&a.tupleTypeArguments&&a.tupleTypeArguments.length>0&&(r=a.tupleTypeArguments[0].type),n=(0,G.isVariadicTypeVar)(r)?1:0,s<=i?(s<i&&(lt(e)||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,1===s?m.Localizer.Diagnostic.argMorePositionalExpectedOne():m.Localizer.Diagnostic.argMorePositionalExpectedCount().format({expected:s}),t[_].valueExpression||e),b=!0),z++):(O.push({paramCategory:n,paramType:r,requiresTypeVarMatching:(0,W.requiresSpecialization)(a),argument:t[_],errorNode:t[_].valueExpression||e,paramName:o,isParamNameSynthesized:v.params[z].param.isNameSynthesized,mapsToVarArgList:!0}),_++)}else{const n=v.params[z].param.name;O.push({paramCategory:v.params[z].param.category,paramType:a,requiresTypeVarMatching:(0,W.requiresSpecialization)(a),argument:t[_],errorNode:t[_].valueExpression||e,paramName:n,isParamNameSynthesized:v.params[z].param.isNameSynthesized}),L(t[_],v.params[z].param),n&&x.has(n)&&x.get(n).argsReceived++,_++,z++}}let B=!1;if(D>=0&&z<D&&1===v.params[z].param.category&&!(0,G.isParamSpec)(v.params[z].param.type)&&(z++,B=!0),D>=0&&z<D&&(!V||w)){const n=v.params.findIndex((e=>e.param.hasDefault));let s=(n>=0&&n<D?n:D)-M;B&&s--;const i=v.params.findIndex((e=>1===e.param.category&&!(0,G.isParamSpec)(e.param.type)));i>=z&&i<D&&s--,s>0&&(lt(e)||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,1===s?m.Localizer.Diagnostic.argMorePositionalExpectedOne():m.Localizer.Diagnostic.argMorePositionalExpectedCount().format({expected:s}),t.length>M&&t[M].valueExpression||e),b=!0)}if(!b){let s;for(;_<t.length;){if(2===t[_].argumentCategory){const i=bs(t[_]).type;if((0,G.isAnyOrUnknown)(i))s=i;else if((0,G.isClassInstance)(i)&&G.ClassType.isTypedDictClass(i)){const n=(0,U.getTypedDictMembersForClass)(gi,i),s=new c.DiagnosticAddendum;n.forEach(((n,i)=>{const a=x.get(i);if(a&&!a.isPositionalOnly)if(a.argsReceived>0)s.addMessage(m.Localizer.Diagnostic.paramAlreadyAssigned().format({name:i}));else{a.argsReceived++;const s=v.params.findIndex((e=>e.param.name===i));(0,l.assert)(s>=0);const r=v.params[s].type;O.push({paramCategory:0,paramType:r,requiresTypeVarMatching:(0,W.requiresSpecialization)(r),argument:{argumentCategory:0,typeResult:{type:n.valueType}},errorNode:t[_].valueExpression||e,paramName:i})}else if(void 0!==v.kwargsIndex){const s=v.params[v.kwargsIndex].type;O.push({paramCategory:2,paramType:s,requiresTypeVarMatching:(0,W.requiresSpecialization)(s),argument:{argumentCategory:0,typeResult:{type:n.valueType}},errorNode:t[_].valueExpression||e,paramName:i}),x.set(i,{argsNeeded:1,argsReceived:1,isPositionalOnly:!1})}else v.hasUnpackedTypedDict||s.addMessage(m.Localizer.Diagnostic.paramNameMissing().format({name:i}))})),s.isEmpty()||(lt(e)||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.unpackedTypedDictArgument()+s.getString(),t[_].valueExpression||e),b=!0)}else if((0,G.isParamSpec)(i)&&"kwargs"===i.paramSpecAccess)s=G.AnyType.create(),n.type.details.paramSpec&&O.push({paramCategory:2,paramType:n.type.details.paramSpec,requiresTypeVarMatching:!1,argument:t[_],errorNode:t[_].valueExpression||e});else{let n=Xe(e,"SupportsKeysAndGetItem");n||(n=Je(e,"Mapping"));const a=Ds(e,"str");if(n&&(0,G.isInstantiableClass)(n)&&a&&(0,G.isClassInstance)(a)){const r=new j.TypeVarContext((0,W.getTypeVarScopeId)(n));let o=!1;if((0,G.isTypeVar)(i))o=!0;else if(Zs(G.ClassType.cloneAsInstance(n),i,void 0,r)){const e=(0,W.applySolvedTypeVars)(n,r).typeArguments;e&&e.length>=2?(Zs(a,e[0])&&(o=!0),s=e[1]):(o=!0,s=G.UnknownType.create())}o||(lt(e)||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.unpackedDictArgumentNotMapping(),t[_].valueExpression||e),b=!0)}}N&&N.push(t[_])}else{const s=t[_].name;if(s){const n=s.value,i=x.get(n);if(i&&!i.isPositionalOnly)if(i.argsReceived>0)ct(T.getFileInfo(s).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.paramAlreadyAssigned().format({name:n}),s),b=!0;else{i.argsReceived++;const s=v.params.findIndex((e=>e.param.name===n));(0,l.assert)(s>=0);const a=v.params[s].type;O.push({paramCategory:0,paramType:a,requiresTypeVarMatching:(0,W.requiresSpecialization)(a),argument:t[_],errorNode:null!==(g=t[_].valueExpression)&&void 0!==g?g:e,paramName:n}),L(t[_],v.params[s].param)}else if(void 0!==v.kwargsIndex){if(N)N.push(t[_]);else{const s=v.params[v.kwargsIndex].type;O.push({paramCategory:2,paramType:s,requiresTypeVarMatching:(0,W.requiresSpecialization)(s),argument:t[_],errorNode:null!==(h=t[_].valueExpression)&&void 0!==h?h:e,paramName:n}),x.set(n,{argsNeeded:1,argsReceived:1,isPositionalOnly:!1})}(0,l.assert)(v.params[v.kwargsIndex],"paramDetails.kwargsIndex params entry is undefined"),L(t[_],v.params[v.kwargsIndex].param)}else ct(T.getFileInfo(s).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.paramNameMissing().format({name:s.value}),s),b=!0}else if(0===t[_].argumentCategory)lt(e)||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,1===F?m.Localizer.Diagnostic.argPositionalExpectedOne():m.Localizer.Diagnostic.argPositionalExpectedCount().format({expected:F}),t[_].valueExpression||e),b=!0;else if(1===t[_].argumentCategory&&n.type.details.paramSpec){const s=bs(t[_]),i=s.type;s.isIncomplete&&(C=!0),(0,G.isParamSpec)(i)&&"args"===i.paramSpecAccess&&O.push({paramCategory:1,paramType:n.type.details.paramSpec,requiresTypeVarMatching:!1,argument:t[_],errorNode:null!==(f=t[_].valueExpression)&&void 0!==f?f:e})}}_++}if(!s||V&&void 0===v.argsIndex||v.params.forEach(((n,i)=>{var a,r;const o=n.param;if(i>=v.firstPositionOrKeywordIndex&&0===o.category&&o.name&&!o.hasDefault&&x.has(o.name)&&0===x.get(o.name).argsReceived){const n=v.params[i].type;O.push({paramCategory:0,paramType:n,requiresTypeVarMatching:(0,W.requiresSpecialization)(n),argument:{argumentCategory:0,typeResult:{type:s}},errorNode:null!==(r=null===(a=t.find((e=>2===e.argumentCategory)))||void 0===a?void 0:a.valueExpression)&&void 0!==r?r:e,paramName:o.name,isParamNameSynthesized:o.isNameSynthesized}),x.get(o.name).argsReceived=1}})),!s&&!G.FunctionType.isDefaultParameterCheckDisabled(n.type)){const t=[...x.keys()].filter((e=>{const t=x.get(e);return!t||t.argsReceived<t.argsNeeded}));if(t.length>0){if(!lt(e)){const n=t.map((e=>`"${e}"`)).join(", ");ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,1===t.length?m.Localizer.Diagnostic.argMissingForParam().format({name:n}):m.Localizer.Diagnostic.argMissingForParams().format({names:n}),e)}b=!0}v.params.forEach((t=>{var n;const s=t.param;if(0===s.category&&s.name){const i=x.get(s.name);if(0===i.argsNeeded&&0===i.argsReceived){const i=null!==(n=t.defaultArgType)&&void 0!==n?n:s.defaultType;i&&!(0,W.isEllipsisType)(i)&&(0,W.requiresSpecialization)(s.type)&&O.push({paramCategory:s.category,paramType:t.type,requiresTypeVarMatching:!0,argument:{argumentCategory:0,typeResult:{type:i}},errorNode:e,paramName:s.name,isParamNameSynthesized:s.isNameSynthesized})}}}))}}if((!b||!a.isSpeculative(void 0))&&void 0!==v.argsIndex&&v.argsIndex>=0&&v.params[v.argsIndex].param.hasDeclaredType&&!S){const t=v.params[v.argsIndex].type,n=O.filter((e=>e.mapsToVarArgList));if((0,G.isVariadicTypeVar)(t)&&!t.isVariadicInUnion&&ne&&(0,G.isInstantiableClass)(ne)){const s=n.map((t=>{var n;const s=bs(t.argument).type;return((0,G.isUnpackedVariadicTypeVar)(s)||(0,G.isClassInstance)(s)&&(0,W.isTupleClass)(s)&&s.tupleTypeArguments&&1===s.tupleTypeArguments.length&&(0,G.isUnpackedVariadicTypeVar)(s.tupleTypeArguments[0].type))&&1!==t.argument.argumentCategory&&!t.mapsToVarArgList&&(lt(e)||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeVarTupleMustBeUnpacked(),null!==(n=t.argument.valueExpression)&&void 0!==n?n:e),b=!0),{type:Oe(s),isUnbounded:1===t.argument.argumentCategory}}));let i;i=1!==s.length||s[0].isUnbounded||!(0,G.isUnpackedClass)(s[0].type)&&!(0,G.isVariadicTypeVar)(s[0].type)?G.ClassType.cloneAsInstance((0,W.specializeTupleClass)(ne,s,!0,!0)):s[0].type;const a={paramCategory:1,paramType:t,requiresTypeVarMatching:!0,argument:{argumentCategory:0,typeResult:{type:i}},errorNode:e,paramName:v.params[v.argsIndex].param.name,isParamNameSynthesized:v.params[v.argsIndex].param.isNameSynthesized,mapsToVarArgList:!0};O=[...O.filter((e=>!e.mapsToVarArgList)),a]}}let $=0;return I&&$--,["isinstance","issubclass"].some((e=>e===n.type.details.builtInName))&&2===O.length&&(O[1].expectingType=!0),{overload:n.type,overloadIndex:s,argumentErrors:b,isTypeIncomplete:C,argParams:O,paramSpecTarget:k,paramSpecArgList:N,activeParam:R,relevance:$}}function Zt(e,t,n,s=!1,i){var a;const r=t.overload;if(!i||(0,G.isAnyOrUnknown)(i.expectedType)||(0,G.isNever)(i.expectedType)||(0,W.requiresSpecialization)(i.expectedType)||!r.details.declaredReturnType||!(0,W.requiresSpecialization)(null!==(a=G.FunctionType.getSpecializedReturnType(r))&&void 0!==a?a:G.UnknownType.create()))return Qt(e,t,n,s);const o=Bs(r);let l=i.expectedType,c=0;if((0,W.containsLiteralType)(l,!0)&&(c|=128),(0,G.isUnion)(i.expectedType)){let i;Ps(e,(()=>{const a=n.clone();Zs(o,l,void 0,a,void 0,1024|c),i=Qt(e,t,a,s)})),i&&i.argumentErrors&&(l=void 0)}if(l){if((0,G.isClassInstance)(o)&&(0,G.isClassInstance)(l)&&!G.ClassType.isSameGenericClass(o,l)){const t=new j.TypeVarContext((0,W.getTypeVarScopeId)(o));(0,I.populateTypeVarContextBasedOnExpectedType)(gi,o,l,t,Ct(e));const n=G.ClassType.cloneForSpecialization(o,void 0,!1);l=(0,W.applySolvedTypeVars)(n,t)}Zs(o,l,void 0,n,void 0,1024|c)}return Qt(e,t,n,s)}function Qt(e,t,n,s=!1){const i=t.overload;let a,r=t.isTypeIncomplete,o=!1,l=!1;const c=(0,W.getTypeCondition)(i);if(i.boundTypeVarScopeId&&(void 0!==i.preBoundFlags&&i.boundToType&&(0,W.requiresSpecialization)(i.boundToType)&&6&i.preBoundFlags&&n.addSolveForScope(i.boundTypeVarScopeId),"__init__"===i.details.name&&G.FunctionType.isOverloaded(i)&&i.strippedFirstParamType&&i.boundToType&&(0,G.isClassInstance)(i.strippedFirstParamType)&&(0,G.isClassInstance)(i.boundToType)&&G.ClassType.isSameGenericClass(i.strippedFirstParamType,i.boundToType)&&i.strippedFirstParamType.typeArguments)){const e=i.strippedFirstParamType.details.typeParameters;a=i.strippedFirstParamType,i.strippedFirstParamType.typeArguments.forEach(((t,s)=>{if(s<e.length){const i=e[s];(0,G.isTypeSame)(i,t,{ignorePseudoGeneric:!0})||n.setTypeVarType(e[s],t)}}))}["cast","isinstance","issubclass"].some((e=>e===i.details.builtInName))&&(s=!0);const d=t.argParams.filter((e=>e.requiresTypeVarMatching)).length;if(d>0){let a=Math.min(d,2);for(let o=0;o<a;o++){const l=new W.UniqueSignatureTracker;Ps(e,(()=>{t.argParams.forEach((e=>{if(!e.requiresTypeVarMatching)return;const p=tn(e,n,l,{type:i,isIncomplete:t.isTypeIncomplete},s,0===o,a>1&&0===o,c);p.isTypeIncomplete&&(r=!0),0===o&&p.skippedOverloadArg&&a++}))}))}n.lock()}let u=!1,y=!1,g=[];const h=[],f=new W.UniqueSignatureTracker;t.argParams.forEach((e=>{var a;const p=tn(e,n,f,{type:i,isIncomplete:t.isTypeIncomplete},s,!1,!1,c);h.push(p),p.isCompatible||(o=!0),p.isTypeIncomplete&&(r=!0),p.condition&&(g=null!==(a=G.TypeCondition.combine(g,p.condition))&&void 0!==a?a:[]),(0,G.isAnyOrUnknown)(p.argType)&&(l=!0),i.details.paramSpec&&(1===e.argument.argumentCategory&&(0,G.isParamSpec)(p.argType)&&"args"===p.argType.paramSpecAccess&&(u=!0),2===e.argument.argumentCategory&&(0,G.isParamSpec)(p.argType)&&"kwargs"===p.argType.paramSpecAccess&&(y=!0))})),t.paramSpecArgList&&t.paramSpecTarget?function(e,t,n,s,i){const a=s.getSignatureContexts();if(1===a.length)return en(e,t,n,a[0],i);const r=[];return a.forEach((s=>{Ps(e,(()=>{en(e,t,n,s,i)&&r.push(s)}))})),r.length>0&&s.copySignatureContexts(r),en(e,t,n,r.length>0?r[0]:a[0],i)}(e,t.paramSpecArgList,t.paramSpecTarget,n,c)||(o=!0):i.details.paramSpec&&(u&&y||(r||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.paramSpecArgsMissing().format({type:mi(i.details.paramSpec)}),e),o=!0));let v=Bs(i,t.argParams);g.length>0&&(v=G.TypeBase.cloneForCondition(v,g));let _=!0,I=e;for(;I;){const e=P.getTypeVarScopeNode(I);if(!e)break;const t=bt(e);n.hasSolveForScope(t)&&(_=!1),I=e.parent}((0,G.isFunction)(v)||(0,G.isOverloadedFunction)(v)||i.details.typeVarScopeId===G.WildcardTypeVarScopeId)&&(_=!1);let b=!(0,G.isFunction)(v);Ct(e).some((e=>n.hasSolveForScope(e)))&&(b=!1);let C=(0,W.addConditionToType)((0,W.applySolvedTypeVars)(v,n,{unknownIfNotFound:b,useUnknownOverDefault:s,eliminateUnsolvedInUnions:_}),c);if((0,G.isUnpackedClass)(C)&&(C=G.ClassType.cloneForUnpacked(C,!1)),(0,G.isClassInstance)(C)&&G.ClassType.isBuiltIn(C,["TypeGuard","StrictTypeGuard"])&&C.typeArguments&&C.typeArguments.length>0&&se&&(0,G.isInstantiableClass)(se)){let e=C.typeArguments[0];if(h.length>0){const t=h[0].argType;(0,G.isTypeVar)(t)&&!t.details.isParamSpec&&0===t.details.constraints.length&&(e=(0,W.addConditionToType)(e,[{typeVarName:G.TypeVarType.getNameWithScope(t),constraintIndex:0,isConstrainedTypeVar:!1}]))}C=G.ClassType.cloneAsInstance(G.ClassType.cloneForTypeGuard(se,e,G.ClassType.isBuiltIn(C,"StrictTypeGuard")))}return C=Jt(C),a&&(a=(0,W.applySolvedTypeVars)(a,n)),{argumentErrors:o,argResults:h,isArgumentAnyOrUnknown:l,returnType:C,isTypeIncomplete:r,activeParam:t.activeParam,specializedInitSelfType:a,overloadsUsedForCall:o?[]:[i]}}function Jt(e){return(0,G.isFunction)(e)&&!e.details.name&&(e.details={...e.details,typeVarScopeId:G.WildcardTypeVarScopeId}),e}function Xt(e,t,n,s,i=!1,r){const o=Yt(e,t,n,0);return o.argumentErrors?(t.forEach((e=>{e.valueExpression&&!a.isSpeculative(e.valueExpression)&&Me(e.valueExpression)})),{argumentErrors:!0,activeParam:o.activeParam,overloadsUsedForCall:[]}):Zt(e,o,s,i,r)}function en(e,t,n,s,i){var a;const r=s.getParamSpecType(n);if(!r)return ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.paramSpecNotBound().format({type:mi(n)}),(null===(a=t[0])||void 0===a?void 0:a.valueExpression)||e),!1;const o=new j.TypeVarContext(r.details.typeVarScopeId);let l=!1;const c=new Map,d=r.details.parameters;d.forEach((e=>{e.name&&c.set(e.name,e)}));let u=0,y=d.findIndex((e=>0!==e.category));y<0&&(y=d.length);const g=d.find((e=>1===e.category)),h=d.find((e=>2===e.category)),f=new W.UniqueSignatureTracker;if(t.forEach((t=>{var n;if(0===t.argumentCategory){let s;if(t.name){const n=c.get(t.name.value);n?(s=n.type,c.delete(t.name.value)):h?s=h.type:(ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.paramNameMissing().format({name:t.name.value}),t.name||e),l=!0)}else{if(u<y){const e=d[u];s=e.type,e.name&&c.delete(e.name)}else g?s=g.type:(ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,1===d.length?m.Localizer.Diagnostic.argPositionalExpectedOne():m.Localizer.Diagnostic.argPositionalExpectedCount().format({expected:d.length}),null!==(n=t.valueExpression)&&void 0!==n?n:e),l=!0);u++}s&&(tn({paramCategory:0,paramType:s,requiresTypeVarMatching:!1,argument:t,errorNode:t.valueExpression||e},o,f,void 0,!1,!1,!1,i).isCompatible||(l=!0))}else c.clear()})),!l){let t=[...c.keys()];if(t=t.filter((e=>{const t=c.get(e);return 0===t.category&&!t.hasDefault})),t.length>0&&!r.details.paramSpec){const n=t.map((e=>`"${e}"`)).join(", ");ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,1===t.length?m.Localizer.Diagnostic.argMissingForParam().format({name:n}):m.Localizer.Diagnostic.argMissingForParams().format({names:n}),e),l=!0}}return l||s.applySourceContextTypeVars(o),!l}function tn(e,t,n,s,i,r,o,l){var d;let u,y,g=!!(null==s?void 0:s.isIncomplete),h=!0;const f=null==s?void 0:s.type.details.name;if(e.argument.valueExpression){let n;if((0,G.isTypeVar)(e.paramType)&&e.paramType.scopeId===(null==s?void 0:s.type.details.typeVarScopeId)||(n=(0,W.applySolvedTypeVars)(e.paramType,t,{useNarrowBoundOnly:o})),n&&(0,G.isUnknown)(n)&&(n=void 0),e.argType)u=e.argType;else{const i=e.expectingType?104:0,a=Me(e.argument.valueExpression,i,(0,W.makeInferenceContext)(n,t,!!(null==s?void 0:s.isIncomplete)));u=a.type,a.isIncomplete&&(g=!0),a.typeErrors&&(h=!1),y=a.expectedTypeDiagAddendum}e.argument&&e.argument.name&&!a.isSpeculative(e.errorNode)&&Ce(e.argument.name,{type:null!=n?n:u,isIncomplete:g},0)}else if(e.argType)u=e.argType;else if(e.expectingType&&!e.argument.typeResult&&e.argument.valueExpression){const t=Me(e.argument.valueExpression,104);u=t.type,t.isIncomplete&&(g=!0)}else{const t=bs(e.argument);u=t.type,t.isIncomplete&&(g=!0)}u=(0,W.ensureFunctionSignaturesAreUnique)(u,n),2===e.paramCategory&&(0,G.isTypeVar)(e.paramType)&&(u=Oe(u)),l&&(u=gt(u,l,(e=>e)));const v=u.condition;let _=new c.DiagnosticAddendum;if((0,G.isParamSpec)(e.paramType)&&void 0!==e.paramType.paramSpecAccess)return{isCompatible:h,argType:u,isTypeIncomplete:g,condition:v};if((0,G.isParamSpec)(u)&&void 0!==u.paramSpecAccess)return{isCompatible:h,argType:u,isTypeIncomplete:g,condition:v};if(r){if((0,G.isOverloadedFunction)(u))return{isCompatible:h,argType:u,isTypeIncomplete:g,skippedOverloadArg:!0,condition:v};const t=mt(e.paramType);if((0,G.isFunction)(t)||(0,G.isOverloadedFunction)(t)){if((0,G.isInstantiableClass)(u)){const e=Xs(u);if(e&&(0,G.isOverloadedFunction)(e))return{isCompatible:h,argType:u,isTypeIncomplete:g,skippedOverloadArg:!0,condition:v}}if((0,G.isClassInstance)(u)){const e=(0,W.lookUpObjectMember)(u,"__call__");if(e){const t=js(e);if((0,G.isOverloadedFunction)(t))return{isCompatible:h,argType:u,isTypeIncomplete:g,skippedOverloadArg:!0,condition:v}}}}}if(!Zs(e.paramType,u,_.createAddendum(),t)){if("none"!==T.getFileInfo(e.errorNode).diagnosticRuleSet.reportGeneralTypeIssues&&!lt(e.errorNode)&&!g){const t=T.getFileInfo(e.errorNode),n=mi(u),s=mi(e.paramType);let i;i=e.paramName&&!e.isParamNameSynthesized?f?m.Localizer.Diagnostic.argAssignmentParamFunction().format({argType:n,paramType:s,functionName:f,paramName:e.paramName}):m.Localizer.Diagnostic.argAssignmentParam().format({argType:n,paramType:s,paramName:e.paramName}):f?m.Localizer.Diagnostic.argAssignmentFunction().format({argType:n,paramType:s,functionName:f}):m.Localizer.Diagnostic.argAssignment().format({argType:n,paramType:s}),y&&(_=y),ct(t.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,i+_.getString(),e.errorNode,null!==(d=_.getEffectiveTextRange())&&void 0!==d?d:e.errorNode)}return{isCompatible:!1,argType:u,isTypeIncomplete:g,condition:v}}if(!i){const t=(0,G.removeUnbound)(u),n=T.getFileInfo(e.errorNode),s=()=>{const t=new c.DiagnosticAddendum;return e.paramName&&t.addMessage((f?m.Localizer.DiagnosticAddendum.argParamFunction().format({paramName:e.paramName,functionName:f}):m.Localizer.DiagnosticAddendum.argParam().format({paramName:e.paramName}))+t.getString()),t};if("none"!==n.diagnosticRuleSet.reportUnknownArgumentType&&!(0,G.isAny)(e.paramType)&&!g)if((0,G.isUnknown)(t)){const t=s();ct(n.diagnosticRuleSet.reportUnknownArgumentType,p.DiagnosticRule.reportUnknownArgumentType,m.Localizer.Diagnostic.argTypeUnknown()+t.getString(),e.errorNode)}else if((0,W.isPartlyUnknown)(t,!0)){let i=!1;if((0,G.isInstantiableClass)(t)&&(i=!0),(0,W.isPartlyUnknown)(e.paramType)&&(i=!0),(0,G.isClassInstance)(t)&&t.isEmptyContainer&&(i=!0),!i){const i=s();i.addMessage(m.Localizer.DiagnosticAddendum.argumentType().format({type:mi(t,{expandTypeAlias:!0})})),ct(n.diagnosticRuleSet.reportUnknownArgumentType,p.DiagnosticRule.reportUnknownArgumentType,m.Localizer.Diagnostic.argTypePartiallyUnknown()+i.getString(),e.errorNode)}}}return{isCompatible:h,argType:u,isTypeIncomplete:g,condition:v}}function nn(e){const t=Ss(e,{allowUnpackedTuple:!0}).type,n=(0,G.isClass)(t)&&(0,W.isTupleClass)(t)&&t.isUnpacked,s=(0,G.isUnpackedVariadicTypeVar)(t);if(n||s)return(0,W.convertToInstance)(t);ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeVarTupleDefaultNotUnpacked(),e)}function sn(e){const t=G.FunctionType.createSynthesizedInstance("",98304);if(G.TypeBase.setSpecialForm(t),18===e.nodeType)return G.FunctionType.addDefaultParameters(t),t;if(31===e.nodeType)return e.entries.forEach(((e,n)=>{const s=Ss(e);G.FunctionType.addParameter(t,{category:0,name:`__p${n}`,isNameSynthesized:!0,hasDeclaredType:!0,type:(0,W.convertToInstance)(s.type)})})),Ce(e,{type:G.AnyType.create()},void 0),t;{const n=Ss(e,{allowParamSpec:!0});if(n.typeErrors)return;if((0,G.isParamSpec)(n.type))return t.details.paramSpec=n.type,t}ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.paramSpecDefaultNotTuple(),e)}function an(e){if(11===e.nodeType){if(15===e.constType)return!1;if(33===e.constType)return!0}return rt(m.Localizer.Diagnostic.expectedBoolLiteral(),e),!1}function rn(e,t){var n;const s=T.getFileInfo(e);let i="";if(2!==t.length)return void ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.newTypeParamCount(),e);const a=t[0];if(0===a.argumentCategory&&a.valueExpression&&48===a.valueExpression.nodeType&&(i=a.valueExpression.strings.map((e=>e.value)).join("")),!i)return void ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.newTypeBadName(),null!==(n=t[0].node)&&void 0!==n?n:e);const r=Cs(t[1]).type;if((0,G.isInstantiableClass)(r)){G.ClassType.isProtocolClass(r)?rt(m.Localizer.Diagnostic.newTypeProtocolClass(),t[1].node||e):void 0!==r.literalValue&&rt(m.Localizer.Diagnostic.newTypeLiteral(),t[1].node||e);const n=-4&r.details.flags,a=G.ClassType.createInstantiable(i,P.getClassFullName(e,s.moduleName,i),s.moduleName,s.filePath,n,P.getTypeSourceId(e),void 0,r.details.effectiveMetaclass);a.details.baseClasses.push(r),(0,W.computeMroLinearization)(a);const o=G.FunctionType.createSynthesizedInstance("__init__");G.FunctionType.addParameter(o,{category:0,name:"self",type:G.ClassType.cloneAsInstance(a),hasDeclaredType:!0}),G.FunctionType.addParameter(o,{category:0,name:"_x",type:G.ClassType.cloneAsInstance(r),hasDeclaredType:!0}),o.details.declaredReturnType=G.NoneType.createInstance(),a.details.fields.set("__init__",R.Symbol.createWithType(4,o));const l=G.FunctionType.createSynthesizedInstance("__new__",1);return G.FunctionType.addParameter(l,{category:0,name:"cls",type:a,hasDeclaredType:!0}),G.FunctionType.addDefaultParameters(l),l.details.declaredReturnType=G.ClassType.cloneAsInstance(a),a.details.fields.set("__new__",R.Symbol.createWithType(4,l)),a}(0,G.isAnyOrUnknown)(r)||rt(m.Localizer.Diagnostic.newTypeNotAClass(),t[1].node||e)}function on(e,t,n){const s=e.leftExpression;let i=e.rightExpression,a=!1,r=!1;P.operatorSupportsChaining(e.operator)&&7===i.nodeType&&!i.parenthesized&&P.operatorSupportsChaining(i.operator)&&(on(i,t,n),i=i.leftExpression);let o,l=37===e.operator||36===e.operator?null==t?void 0:t.expectedType:void 0;26===e.operator&&t&&(0,G.isClassInstance)(t.expectedType)&&G.ClassType.isBuiltIn(t.expectedType,"list")&&t.expectedType.typeArguments&&t.expectedType.typeArguments.length>=1&&31===e.leftExpression.nodeType&&(o=t.expectedType);const d=null!=l?l:o,y=Me(s,n,(0,W.makeInferenceContext)(d));let g=y.type;l||(37===e.operator||36===e.operator||0===e.operator&&31===e.rightExpression.nodeType||6===e.operator&&(0,G.isClassInstance)(g)&&G.ClassType.isTypedDictClass(g))&&(l=g);const h=Me(i,n,(0,W.makeInferenceContext)(l));let f=h.type;if((y.isIncomplete||h.isIncomplete)&&(a=!0),6===e.operator&&!ln(g,"__or__")&&!ln(f,"__ror__")){let t=f,a=g;if(!(0,G.isNoneInstance)(g)&&(0,G.isNoneInstance)(f)?t=G.NoneType.createType():!(0,G.isNoneInstance)(f)&&(0,G.isNoneInstance)(g)&&(a=G.NoneType.createType()),(0,W.isUnionableType)([a,t])){const r=T.getFileInfo(e);if(r.isStubFile||0!=(4&n)||r.executionEnvironment.pythonVersion>=u.PythonVersion.V3_10||(0,G.isAnyOrUnknown)(a)||rt(m.Localizer.Diagnostic.unionSyntaxIllegal(),e,e.operatorToken),!Cn({...y,node:s},{allowVariadicTypeVar:!0,allowUnpackedTuples:!0})||!Cn({...h,node:i},{allowVariadicTypeVar:!0,allowUnpackedTuples:!0}))return{type:G.UnknownType.create()};const o=(0,G.combineTypes)([a,t]);if((0,G.isUnion)(o)&&G.TypeBase.setSpecialForm(o),!r.isStubFile){let e,t,n;if(48===s.nodeType?(e=s,t=i,n=f):48===i.nodeType&&(e=i,t=s,n=g),e&&t&&n){let t=!0;(0,G.isClass)(n)&&(n.isTypeArgumentExplicit&&!(0,G.isClassInstance)(n)||(t=!1)),t||ct(r.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.unionForwardReferenceNotAllowed(),e)}}return{type:o}}}let v=!1;void 0===q[e.operator]&&(12===e.operator||28===e.operator?g=(0,G.removeNoneFromUnion)(g):v=(0,W.isOptionalType)(g),12!==e.operator&&28!==e.operator||(f=(0,G.removeNoneFromUnion)(f)));const _=new c.DiagnosticAddendum,I=!P.isWithinLoop(e),b=!(0,G.isUnion)(g);let C=pn(e.operator,{type:g,isIncomplete:y.isIncomplete},{type:f,isIncomplete:h.isIncomplete},e,t,_,{isLiteralMathAllowed:I,isTupleAddAllowed:b});if(!_.isEmpty()||!C){if(r=!0,!a){const t=T.getFileInfo(e);v&&1===_.getMessages().length?ct(T.getFileInfo(e).diagnosticRuleSet.reportOptionalOperand,p.DiagnosticRule.reportOptionalOperand,m.Localizer.Diagnostic.noneOperator().format({operator:P.printOperator(e.operator)}),e.leftExpression):ct(t.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeNotSupportBinaryOperator().format({operator:P.printOperator(e.operator),leftType:mi(g),rightType:mi(f)})+_.getString(),e)}C=G.UnknownType.create()}return{type:C,isIncomplete:a,typeErrors:r}}function ln(e,t){if(!(0,G.isInstantiableClass)(e))return!1;const n=e.details.effectiveMetaclass;if(!n||!(0,G.isInstantiableClass)(n))return!1;if(G.ClassType.isBuiltIn(n,"type"))return!1;const s=(0,W.lookUpClassMember)(n,t);return!(!s||(0,G.isInstantiableClass)(s.classType)&&G.ClassType.isBuiltIn(s.classType,"type"))}function cn(e,t){const n={1:["__iadd__",0],34:["__isub__",33],27:["__imul__",26],14:["__ifloordiv__",13],11:["__itruediv__",10],25:["__imod__",24],30:["__ipow__",29],23:["__imatmul__",22],4:["__iand__",3],7:["__ior__",6],9:["__ixor__",8],18:["__ilshift__",17],32:["__irshift__",31]};let s,i;const a=new c.DiagnosticAddendum,r=Me(e.leftExpression),o=r.type;let l;7===e.operator&&(l=o);const d=Me(e.rightExpression,void 0,(0,W.makeInferenceContext)(l)),u=d.type,y=!!d.isIncomplete||!!r.isIncomplete;return(0,G.isNever)(o)||(0,G.isNever)(u)?i={type:G.NeverType.createNever(),isIncomplete:y}:(s=gt(o,void 0,((s,i)=>gt(u,(0,W.getTypeCondition)(s),((l,c)=>{if((0,G.isAnyOrUnknown)(i)||(0,G.isAnyOrUnknown)(c))return(0,W.preserveUnknown)(i,c);const p=n[e.operator][0];let y=dn(i,[{type:c,isIncomplete:d.isIncomplete}],p,e,t);if(y||i===s||(y=dn(s,[{type:c,isIncomplete:d.isIncomplete}],p,e,t)),y||c===l||(y=dn(s,[{type:l,isIncomplete:d.isIncomplete}],p,e,t)),!y){const s=n[e.operator][1],l=!P.isWithinLoop(e)&&(0,W.getUnionSubtypeCount)(o)*(0,W.getUnionSubtypeCount)(u)<64,p=!(0,G.isUnion)(o);y=pn(s,{type:i,isIncomplete:r.isIncomplete},{type:c,isIncomplete:d.isIncomplete},e,t,a,{isLiteralMathAllowed:l,isTupleAddAllowed:p})}return y})))),a.isEmpty()&&s&&!(0,G.isNever)(s)||(y||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeNotSupportBinaryOperator().format({operator:P.printOperator(e.operator),leftType:mi(o),rightType:mi(u)})+a.getString(),e),s=G.UnknownType.create()),i={type:s,isIncomplete:y}),ht(e.destExpression,i.type,!!i.isIncomplete,e.rightExpression),i}function pn(e,t,n,s,i,a,r){const o=t.type,l=n.type;let c,p=mt(o);if(void 0!==q[e]){if(36===e){if(!Be(p))return o;if(!ze(p))return l;if(p=Ge(p),(0,G.isNever)(l))return p}else if(37===e){if(!ze(p))return o;if(!Be(p))return l;if(p=We(p),(0,G.isNever)(l))return p}if((0,G.isNever)(o)||(0,G.isNever)(l))return G.NeverType.createNever();41===e||42===e?(c=gt(l,void 0,((i,r)=>gt(p,(0,W.getTypeCondition)(i),(o=>{var l;if((0,G.isAnyOrUnknown)(o)||(0,G.isAnyOrUnknown)(r))return(0,W.preserveUnknown)(o,i);let c=dn(i,[{type:o,isIncomplete:t.isIncomplete}],"__contains__",s,void 0);if(!c){const e=null===(l=Ze({type:i,isIncomplete:n.isIncomplete},!1,void 0))||void 0===l?void 0:l.type;e&&Zs(e,o)&&(c=Ds(s,"bool"))}return c||a.addMessage(m.Localizer.Diagnostic.typeNotSupportBinaryOperator().format({operator:P.printOperator(e),leftType:mi(o),rightType:mi(i)})),c})))),c&&!(0,G.isNever)(c)&&(c=Ds(s,"bool"))):c=gt(p,void 0,((t,n)=>gt(l,(0,W.getTypeCondition)(t),((t,i)=>36===e||37===e?(0,G.combineTypes)([n,i]):Ds(s,"bool")))))}else if($[e]){if((0,G.isNever)(o)||(0,G.isNever)(l))return G.NeverType.createNever();if(r.isLiteralMathAllowed){const t=(0,W.getLiteralTypeClassName)(o);if(t&&!(0,W.getTypeCondition)(o)&&t===(0,W.getLiteralTypeClassName)(l)&&!(0,W.getTypeCondition)(l)&&(0,W.getUnionSubtypeCount)(o)*(0,W.getUnionSubtypeCount)(l)<64)if("str"===t||"bytes"===t)0===e&&(c=(0,W.mapSubtypes)(o,(e=>(0,W.mapSubtypes)(l,(t=>{const n=e,s=t;return G.ClassType.cloneWithLiteral(n,n.literalValue+s.literalValue)})))));else if("int"===t&&(0===e||33===e||26===e||13===e||24===e)){let t=!0;c=(0,W.mapSubtypes)(o,(n=>(0,W.mapSubtypes)(l,(s=>{try{const i=n,a=s,r=BigInt(i.literalValue),o=BigInt(a.literalValue);let l;return 0===e?l=r+o:33===e?l=r-o:26===e?l=r*o:13===e?o!==BigInt(0)&&(l=r/o):24===e&&o!==BigInt(0)&&(l=r%o),void 0===l||"number"==typeof l&&isNaN(l)?void(t=!1):(l>=Number.MIN_SAFE_INTEGER&&l<=Number.MAX_SAFE_INTEGER&&(l=Number(l)),G.ClassType.cloneWithLiteral(i,l))}catch{return void(t=!1)}})))),t||(c=void 0)}}c||(c=gt(o,void 0,((o,c)=>gt(l,(0,W.getTypeCondition)(o),((l,p)=>{if((0,G.isAnyOrUnknown)(c)||(0,G.isAnyOrUnknown)(p))return(0,W.preserveUnknown)(c,p);if(r.isTupleAddAllowed&&0===e&&(0,G.isClassInstance)(o)&&(0,W.isTupleClass)(o)&&o.tupleTypeArguments&&!(0,W.isUnboundedTupleClass)(o)&&(0,G.isClassInstance)(l)&&(0,W.isTupleClass)(l)&&l.tupleTypeArguments&&!(0,W.isUnboundedTupleClass)(l)&&ne&&(0,G.isInstantiableClass)(ne))return G.ClassType.cloneAsInstance((0,W.specializeTupleClass)(ne,[...o.tupleTypeArguments,...l.tupleTypeArguments]));const d=$[e][0];let u=dn(un(c),[{type:p,isIncomplete:n.isIncomplete}],d,s,i);if(u||c===o||(u=dn(un(o),[{type:p,isIncomplete:n.isIncomplete}],d,s,i)),u||p===l||(u=dn(un(o),[{type:l,isIncomplete:n.isIncomplete}],d,s,i)),!u){const n=$[e][1];u=dn(un(p),[{type:c,isIncomplete:t.isIncomplete}],n,s,i),u||p===l||(u=dn(un(l),[{type:c,isIncomplete:t.isIncomplete}],n,s,i)),u||c===o||(u=dn(un(l),[{type:o,isIncomplete:t.isIncomplete}],n,s,i))}return u||(i?a.addMessage(m.Localizer.Diagnostic.typeNotSupportBinaryOperatorBidirectional().format({operator:P.printOperator(e),leftType:mi(o),rightType:mi(l),expectedType:mi(i.expectedType)})):a.addMessage(m.Localizer.Diagnostic.typeNotSupportBinaryOperator().format({operator:P.printOperator(e),leftType:mi(o),rightType:mi(l)}))),u})))))}return c&&(0,G.isNever)(c)?void 0:c}function dn(e,t,n,s,i){let a=!0;const r=e=>{var r,o;let l;const c=mt(e);if((0,G.isClassInstance)(c)?l=null===(r=je(s,c,n,void 0,void 0,65,e))||void 0===r?void 0:r.type:(0,G.isInstantiableClass)(c)&&(l=null===(o=$e(s,c,n,void 0,void 0,96))||void 0===o?void 0:o.type),l){const e=t.map((e=>({argumentCategory:0,typeResult:e})));let n;return Ps(s,(()=>{n=Ht(s,e,{type:l},void 0,!0,i)})),n.argumentErrors&&i&&Ps(s,(()=>{n=Ht(s,e,{type:l},void 0,!0)})),n.argumentErrors&&(a=!1),n.returnType}a=!1},o=(0,W.mapSubtypes)(e,(e=>(0,G.isAnyOrUnknown)(e)?e:(0,G.isClassInstance)(e)||(0,G.isInstantiableClass)(e)||(0,G.isTypeVar)(e)?r(e):(0,G.isNoneInstance)(e)&&X&&(0,G.isClassInstance)(X)?r(X):(0,G.isNoneTypeClass)(e)&&ee&&(0,G.isInstantiableClass)(ee)?r(G.ClassType.cloneAsInstance(ee)):void(a=!1)));if(a)return o}function un(e){return((0,G.isFunction)(e)||(0,G.isOverloadedFunction)(e))&&X?X:e}function yn(e,t,n){t.expectedType=(0,W.transformPossibleRecursiveTypeAlias)(t.expectedType);const s=mt(t.expectedType);if(!(0,G.isClassInstance)(s))return;const i=[],a=[];let r=!1;if(G.ClassType.isTypedDictClass(s)){if(gn(e,i,a,!0,void 0,void 0,(0,U.getTypedDictMembersForClass)(gi,s),n)&&(r=!0),G.ClassType.isTypedDictClass(s)){const e=(0,U.assignToTypedDict)(gi,s,i,a,(null==n?void 0:n.isEmpty())?n:void 0);if(e)return{type:e,isIncomplete:r}}return}const o=Ds(e,"dict");if(!(0,G.isClassInstance)(o))return;const l=new j.TypeVarContext((0,W.getTypeVarScopeId)(o));if(!(0,I.populateTypeVarContextBasedOnExpectedType)(gi,o,t.expectedType,l,Ct(e)))return;const c=(0,W.applySolvedTypeVars)(G.ClassType.cloneAsInstantiable(o),l);if(!c.typeArguments||2!==c.typeArguments.length)return;const p=c.typeArguments[0],d=c.typeArguments[1];gn(e,i,a,!0,p,d,void 0,n)&&(r=!0);const u=(0,G.isClassInstance)(t.expectedType)&&(G.ClassType.isBuiltIn(t.expectedType,"dict")||G.ClassType.isBuiltIn(t.expectedType,"MutableMapping")),y=vn(p,i.map((e=>e.type)),!1),m=vn(d,a.map((e=>e.type)),!u);return y&&m?{type:Ds(e,"dict",[y,m]),isIncomplete:r}:void 0}function mn(e,t){const n=t?G.AnyType.create():G.UnknownType.create();let s=n,i=n;const a=[],r=[];let o=!1,l=!1;gn(e,a,r,t)&&(l=!0);const c=a.map((e=>Oe(e.type))),p=r.map((e=>Oe(e.type)));s=c.length>0?(0,G.combineTypes)(c):n,p.length>0?i=T.getFileInfo(e).diagnosticRuleSet.strictDictionaryInference||t?(0,G.combineTypes)(p):(0,W.areTypesSame)(p,{ignorePseudoGeneric:!0})?p[0]:n:(i=n,o=!0);const d=xs(e,"dict"),u=(0,G.isInstantiableClass)(d)?G.ClassType.cloneAsInstance(G.ClassType.cloneForSpecialization(d,[s,i],!0,void 0,void 0,o)):G.UnknownType.create();return l&&(0,W.getContainerDepth)(u)>8?{type:G.UnknownType.create()}:{type:u,isIncomplete:l}}function gn(e,t,n,s,i,a,r,o){let l=!1;return e.entries.forEach(((c,d)=>{var u;let y=!0;if(17===c.nodeType){const e=Me(c.keyExpression,void 0,(0,W.makeInferenceContext)(null!=i?i:s?G.NeverType.createNever():void 0));e.isIncomplete&&(l=!0);const p=e.type;let u;if(e.isIncomplete||e.typeErrors||Tn(c.keyExpression,p,!0),o&&e.expectedTypeDiagAddendum&&o.addAddendum(e.expectedTypeDiagAddendum),r&&(0,G.isClassInstance)(p)&&G.ClassType.isBuiltIn(p,"str")&&(0,W.isLiteralType)(p)&&r.has(p.literalValue)){const e=r.get(p.literalValue).valueType;u=Me(c.valueExpression,void 0,(0,W.makeInferenceContext)(e))}else{const e=null!=a?a:s?G.NeverType.createNever():void 0;u=Me(c.valueExpression,void 0,(0,W.makeInferenceContext)(e))}o&&u.expectedTypeDiagAddendum&&o.addAddendum(u.expectedTypeDiagAddendum);const m=u.type;u.isIncomplete&&(l=!0),(s||d<64)&&(t.push({node:c.keyExpression,type:p}),n.push({node:c.valueExpression,type:m})),y=!1}else if(16===c.nodeType){let r,o=Xe(e,"SupportsKeysAndGetItem");o||(o=Je(e,"Mapping")),i&&a&&o&&(0,G.isInstantiableClass)(o)&&(r=G.ClassType.cloneAsInstance(G.ClassType.cloneForSpecialization(o,[i,a],!0)));const u=Me(c.expandExpression,void 0,(0,W.makeInferenceContext)(r));u.isIncomplete&&(l=!0);const g=u.type;if((0,G.isAnyOrUnknown)(g))y=!1;else if((0,G.isClassInstance)(g)&&G.ClassType.isTypedDictClass(g)){if(ae&&(0,G.isInstantiableClass)(ae)){const e=G.ClassType.cloneAsInstance(ae);(0,U.getTypedDictMembersForClass)(gi,g,!0).forEach(((s,i)=>{(s.isRequired||s.isProvided)&&(t.push({node:c,type:G.ClassType.cloneWithLiteral(e,i)}),n.push({node:c,type:s.valueType}))})),y=!1}}else if(o&&(0,G.isInstantiableClass)(o)){const i=new j.TypeVarContext((0,W.getTypeVarScopeId)(o));if(o=G.ClassType.cloneForSpecialization(o,o.details.typeParameters,!0),Zs(G.ClassType.cloneAsInstance(o),g,void 0,i,void 0,128)){const e=(0,W.applySolvedTypeVars)(o,i).typeArguments;e&&e.length>=2&&((s||d<64)&&(t.push({node:c,type:e[0]}),n.push({node:c,type:e[1]})),y=!1)}else ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.dictUnpackIsNotMapping(),c)}}else if(32===c.nodeType){const e=bn(c,a,i),r=e.type;if(e.isIncomplete&&(l=!0),(0,G.isClassInstance)(r)&&(0,W.isTupleClass)(r)){const e=null===(u=r.tupleTypeArguments)||void 0===u?void 0:u.map((e=>e.type));e&&2===e.length&&((s||d<64)&&(t.push({node:c,type:e[0]}),n.push({node:c,type:e[1]})),y=!1)}}y&&(s||d<64)&&(t.push({node:c,type:G.UnknownType.create()}),n.push({node:c,type:G.UnknownType.create()}))})),l}function hn(e,t){const n=31===e.nodeType?"list":"set";t.expectedType=(0,W.transformPossibleRecursiveTypeAlias)(t.expectedType);let s=!1,i=!1;const a=45===e.nodeType;if(!(0,G.isClassInstance)(t.expectedType))return;const r=Ds(e,n);if(!(0,G.isClassInstance)(r))return;const o=new j.TypeVarContext((0,W.getTypeVarScopeId)(r));if(!(0,I.populateTypeVarContextBasedOnExpectedType)(gi,r,t.expectedType,o,Ct(e)))return;const l=(0,W.applySolvedTypeVars)(G.ClassType.cloneAsInstantiable(r),o);if(!l.typeArguments||1!==l.typeArguments.length)return;const p=l.typeArguments[0],d=[],u=new c.DiagnosticAddendum;e.entries.forEach((e=>{let n;n=32===e.nodeType?bn(e,p):Me(e,void 0,(0,W.makeInferenceContext)(p,null==t?void 0:t.typeVarContext)),d.push(n.type),n.isIncomplete&&(s=!0),n.typeErrors&&(i=!0),n.expectedTypeDiagAddendum&&u.addAddendum(n.expectedTypeDiagAddendum),!a||n.isIncomplete||n.typeErrors||Tn(e,n.type,!1)}));const y=(0,G.isClassInstance)(t.expectedType)&&G.ClassType.isBuiltIn(t.expectedType,n),m=vn(p,d,!y);return m?{type:Ds(e,n,[m]),isIncomplete:s,typeErrors:i,expectedTypeDiagAddendum:u}:{type:G.UnknownType.create(),isIncomplete:s,typeErrors:!0,expectedTypeDiagAddendum:u}}function fn(e,t){const n=31===e.nodeType?"list":"set",s=45===e.nodeType;let i=!1,a=!1,r=!1,o=[];e.entries.forEach(((e,t)=>{let n;n=32===e.nodeType?bn(e):Me(e),n.isIncomplete&&(a=!0),n.typeErrors&&(r=!0),t<64&&o.push(n.type),!s||n.isIncomplete||n.typeErrors||Tn(e,n.type,!1)})),o=o.map((e=>Oe(e)));let l=t?G.AnyType.create():G.UnknownType.create();if(o.length>0){const s=T.getFileInfo(e);l="list"===n&&s.diagnosticRuleSet.strictListInference||"set"===n&&s.diagnosticRuleSet.strictSetInference||t?(0,G.combineTypes)(o,z.maxSubtypesForInferredType):(0,W.areTypesSame)(o,{ignorePseudoGeneric:!0})?o[0]:l}else i=!0;const c=xs(e,n),p=(0,G.isInstantiableClass)(c)?G.ClassType.cloneAsInstance(G.ClassType.cloneForSpecialization(c,[l],!0,void 0,void 0,i)):G.UnknownType.create();return a&&(0,W.getContainerDepth)(p)>8?{type:G.UnknownType.create()}:{type:p,isIncomplete:a,typeErrors:r}}function Tn(e,t,n){if(!function(e){let t=!0;return(0,W.doForEachSubtype)(mt(e),(e=>{if((0,G.isClassInstance)(e)){let n=!0;if(void 0!==e.details.isInstanceHashable)n=e.details.isInstanceHashable;else{const t=(0,W.lookUpObjectMember)(e,"__hash__",4);if(t&&t.isTypeDeclared){const e=t.symbol.getTypedDeclarations(),s=t.symbol.getSynthesizedType();s?n=!(0,G.isNoneInstance)(s):e.every((e=>1===e.type))&&(n=!1)}e.details.isInstanceHashable=n}n||(t=!1)}})),t}(t)){const s=T.getFileInfo(e),i=new c.DiagnosticAddendum;i.addMessage(m.Localizer.DiagnosticAddendum.unhashableType().format({type:mi(t)}));const a=n?m.Localizer.Diagnostic.unhashableDictKey():m.Localizer.Diagnostic.unhashableSetEntry();ct(s.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,a+i.getString(),e)}}function vn(e,t,n){let s,i=!1;if((0,G.isTypeVar)(e)){if(e.details.isParamSpec||e.details.isVariadic)return;s=e}else s=G.TypeVarType.createInstance("__typeArg"),s.details.isSynthesized=!0,s.details.boundType=mt(e),s.scopeId="__typeArgScopeId",i=!0;let a=new j.TypeVarContext(s.scopeId);return i&&a.setTypeVarType(s,n?void 0:e,void 0,e),t.every((e=>Zs(s,Oe(e),void 0,a)))?(0,W.applySolvedTypeVars)(s,a):(a=new j.TypeVarContext(s.scopeId),i&&a.setTypeVarType(s,n?void 0:e,void 0,e),t.every((e=>Zs(s,e,void 0,a)))?(0,W.applySolvedTypeVars)(s,a):void 0)}function _n(e,t,n,s,i,a){if("none"===e)return;const r=n.value,o=(0,G.removeUnbound)(s);if((0,G.isUnknown)(o))ct(e,t,m.Localizer.Diagnostic.typeUnknown().format({name:r}),i);else if((0,W.isPartlyUnknown)(o)&&(!a||!(0,G.isClassInstance)(s)||!s.isEmptyContainer)){const n=new c.DiagnosticAddendum;n.addMessage(m.Localizer.DiagnosticAddendum.typeOfSymbol().format({name:r,type:mi(o,{expandTypeAlias:!0})})),ct(e,t,m.Localizer.Diagnostic.typePartiallyUnknown().format({name:r})+n.getString(),i)}}function In(e){var t;let n=!1;if(33===e.nodeType){const s=Me(e.iterableExpression);s.isIncomplete&&(n=!0);const i=null!==(t=Ze({type:Oe(s.type),isIncomplete:s.isIncomplete},!!e.isAsync,e.iterableExpression))&&void 0!==t?t:{type:G.UnknownType.create(),isIncomplete:s.isIncomplete};ht(e.targetExpression,i.type,!!i.isIncomplete,e.iterableExpression)}else(0,l.assert)(34===e.nodeType),a.isSpeculative(e.testExpression)||Me(e.testExpression);return n}function bn(e,t,n){let s=!1,i=!1;for(const t of e.forIfNodes)In(t)&&(s=!0);let a=G.UnknownType.create();if(17===e.expression.nodeType){const r=Me(e.expression.keyExpression,void 0,(0,W.makeInferenceContext)(n));r.isIncomplete&&(s=!0),r.typeErrors&&(i=!0);let o=r.type;n&&(0,W.containsLiteralType)(n)||(o=Oe(o));const l=Me(e.expression.valueExpression,void 0,(0,W.makeInferenceContext)(t));l.isIncomplete&&(s=!0),l.typeErrors&&(i=!0);let c=l.type;t&&(0,W.containsLiteralType)(t)||(c=Oe(c)),a=Nt([o,c])}else if(16===e.expression.nodeType)Me(e.expression.expandExpression,void 0,(0,W.makeInferenceContext)(t));else if((0,g.isExpressionNode)(e)){const n=Me(e.expression,void 0,(0,W.makeInferenceContext)(t));n.isIncomplete&&(s=!0),n.typeErrors&&(i=!0),a=n.type}return{type:a,isIncomplete:s,typeErrors:i}}function Cn(e,t){if(e.typeList){if(!(null==t?void 0:t.allowTypeArgList))return rt(m.Localizer.Diagnostic.typeArgListNotAllowed(),e.node),!1;e.typeList.forEach((e=>{Cn(e)}))}if((0,W.isEllipsisType)(e.type)&&!(null==t?void 0:t.allowTypeArgList))return rt(m.Localizer.Diagnostic.ellipsisContext(),e.node),!1;if((0,G.isModule)(e.type))return rt(m.Localizer.Diagnostic.moduleAsType(),e.node),!1;if((0,G.isParamSpec)(e.type)&&!(null==t?void 0:t.allowParamSpec))return rt(m.Localizer.Diagnostic.paramSpecContext(),e.node),!1;if((0,G.isVariadicTypeVar)(e.type)&&!e.type.isVariadicInUnion){if(!(null==t?void 0:t.allowVariadicTypeVar))return rt(m.Localizer.Diagnostic.typeVarTupleContext(),e.node),!1;Ft(e.type,e.node)}return!(null==t?void 0:t.allowEmptyTuple)&&e.isEmptyTupleShorthand?(rt(m.Localizer.Diagnostic.zeroLengthTupleNotAllowed(),e.node),!1):!((0,G.isUnpackedClass)(e.type)&&!(null==t?void 0:t.allowUnpackedTuples)&&(rt(m.Localizer.Diagnostic.unpackedArgInTypeArgument(),e.node),1))}function Sn(e,t){const n=G.FunctionType.createInstantiable(0);if(G.TypeBase.setSpecialForm(n),n.details.declaredReturnType=G.UnknownType.create(),n.details.typeVarScopeId=bt(t),e&&e.length>0){if(e[0].typeList){const t=e[0].typeList;let s=!1,i=!1;const a=e=>{s&&(i||(rt(m.Localizer.Diagnostic.variadicTypeArgsTooMany(),e.node),i=!0)),s=!0};t.forEach(((e,t)=>{let s=e.type,i=0;const r=`__p${t.toString()}`;(0,G.isVariadicTypeVar)(s)?(Ft(s,e.node),i=1,a(e)):Cn(e,{allowUnpackedTuples:!0})?(0,G.isUnpackedClass)(s)&&(i=1,a(e)):s=G.UnknownType.create(),G.FunctionType.addParameter(n,{category:i,name:r,isNameSynthesized:!0,type:(0,W.convertToInstance)(s),hasDeclaredType:!0})})),G.FunctionType.addParameter(n,{category:0,isNameSynthesized:!1,type:G.UnknownType.create()})}else if((0,W.isEllipsisType)(e[0].type))G.FunctionType.addDefaultParameters(n),n.details.flags|=32768;else if((0,G.isParamSpec)(e[0].type))n.details.paramSpec=e[0].type;else if((0,G.isInstantiableClass)(e[0].type)&&G.ClassType.isBuiltIn(e[0].type,"Concatenate")){const t=e[0].type.typeArguments;t&&t.length>0&&t.forEach(((e,s)=>{s===t.length-1?(G.FunctionType.addParameter(n,{category:0,isNameSynthesized:!1,type:G.UnknownType.create()}),(0,G.isParamSpec)(e)&&(n.details.paramSpec=e)):G.FunctionType.addParameter(n,{category:0,name:`__p${s}`,isNameSynthesized:!0,hasDeclaredType:!0,type:e})}))}else rt(m.Localizer.Diagnostic.callableFirstArg(),e[0].node);if(e.length>1){let t=e[1].type;Cn(e[1])||(t=G.UnknownType.create()),n.details.declaredReturnType=(0,W.convertToInstance)(t)}else ct(T.getFileInfo(t).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.callableSecondArg(),t),n.details.declaredReturnType=G.UnknownType.create();e.length>2&&rt(m.Localizer.Diagnostic.callableExtraArgs(),e[2].node)}else G.FunctionType.addDefaultParameters(n,!0),n.details.flags|=32768;return n}function xn(e,t,n,s){if(!n)return 0!=(256&s)?(rt(m.Localizer.Diagnostic.optionalExtraArgs(),t),G.UnknownType.create()):e;if(n.length>1)return rt(m.Localizer.Diagnostic.optionalExtraArgs(),t),G.UnknownType.create();let i=n[0].type;Cn(n[0])?(0,W.isEffectivelyInstantiable)(i)||(dt(i,n[0].node),i=G.UnknownType.create()):i=G.UnknownType.create();const a=(0,G.combineTypes)([i,G.NoneType.createType()]);return(0,G.isUnion)(a)&&G.TypeBase.setSpecialForm(a),a}function Dn(e,t,n){const s=Ds(e,t);return(0,G.isClassInstance)(s)?G.ClassType.cloneWithLiteral(s,n):G.UnknownType.create()}function Fn(e,t,n){const s=xs(e,t);return(0,G.isInstantiableClass)(s)?G.ClassType.cloneWithLiteral(s,n):G.UnknownType.create()}function En(e,t,n,s){var i;if(131072&s)return rt(m.Localizer.Diagnostic.classVarNotAllowed(),t),G.AnyType.create();if(!n)return e;if(0===n.length)return rt(m.Localizer.Diagnostic.classVarFirstArgMissing(),t),G.UnknownType.create();if(n.length>1)return rt(m.Localizer.Diagnostic.classVarTooManyArgs(),n[1].node),G.UnknownType.create();const a=n[0].type;return(0,W.requiresSpecialization)(a,!0,!0)&&ct(T.getFileInfo(t).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.classVarWithTypeVar(),null!==(i=n[0].node)&&void 0!==i?i:t),a}function Pn(e,t,n,s){if(!n)return 0!=(256&s)&&rt(m.Localizer.Diagnostic.typeGuardArgCount(),e),t;if(1!==n.length)return rt(m.Localizer.Diagnostic.typeGuardArgCount(),e),G.UnknownType.create();const i=n.map((e=>(0,W.convertToInstance)(Cn(e)?e.type:G.UnknownType.create())));return G.ClassType.cloneForSpecialization(t,i,!0)}function An(e,t,n){var s;const i=T.getFileInfo(t);n&&ct(i.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeArgsExpectingNone().format({name:e.details.name}),null!==(s=n[0].node)&&void 0!==s?s:t);const a=P.getEnclosingClass(t),r=a?jn(a):void 0;if(!r)return ct(i.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.selfTypeContext(),t),G.UnknownType.create();const o=P.getEnclosingFunction(t);if(o){const e=ns(o,!0);if(!P.getEnclosingFunction(o)){if(4&e)return ct(i.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.selfTypeContext(),t),G.UnknownType.create();if(o.parameters.length>0){const e=P.getTypeAnnotationForParameter(o,0);if(e&&!P.isNodeContainedWithin(t,e)){const n=Ve(e,{associateTypeVarsWithScope:!0});(0,G.isTypeVar)(n)&&n.details.isSynthesizedSelf||ct(i.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.selfTypeWithTypedSelfOrCls(),t)}}}}return(0,W.synthesizeTypeVarForSelfCls)(r.classType,!0)}function Nn(e,t,n,s){if(!n&&0==(256&s))return e;if(!n||1!==n.length)return rt(m.Localizer.Diagnostic.unpackArgCount(),t),G.UnknownType.create();let i=n[0].type;(0,G.isUnion)(i)&&1===i.subtypes.length&&(i=i.subtypes[0]);const a=T.getFileInfo(t);return 0!=(2097152&s)?(0,G.isInstantiableClass)(i)&&!i.includeSubclasses&&(0,W.isTupleClass)(i)?G.ClassType.cloneForUnpacked(i):(0,G.isVariadicTypeVar)(i)&&!i.isVariadicUnpacked?G.TypeVarType.cloneForUnpacked(i):(ct(a.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.unpackExpectedTypeVarTuple(),t),G.UnknownType.create()):0!=(8388608&s)?(0,G.isInstantiableClass)(i)&&G.ClassType.isTypedDictClass(i)?G.ClassType.cloneForUnpacked(i):(ct(a.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.unpackExpectedTypedDict(),t),G.UnknownType.create()):(ct(a.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.unpackNotAllowed(),t),G.UnknownType.create())}function kn(e,t,n,s){return 16&s?(rt(m.Localizer.Diagnostic.finalContext(),t),G.AnyType.create()):n&&0!==n.length?(n.length>1&&rt(m.Localizer.Diagnostic.finalTooManyArgs(),t),n[0].type):e}function wn(e,t,n){return n&&0!==n.length?n.forEach(((e,t)=>{t===n.length-1?(0,G.isParamSpec)(e.type)||rt(m.Localizer.Diagnostic.concatenateParamSpecMissing(),e.node):(0,G.isParamSpec)(e.type)?rt(m.Localizer.Diagnostic.paramSpecContext(),e.node):(0,G.isUnpackedVariadicTypeVar)(e.type)?rt(m.Localizer.Diagnostic.typeVarTupleContext(),e.node):(0,G.isUnpackedClass)(e.type)&&rt(m.Localizer.Diagnostic.unpackedArgInTypeArgument(),e.node)})):rt(m.Localizer.Diagnostic.concatenateTypeArgsMissing(),e),Mn(t,n,void 0,!0)}function Mn(e,t,n,s=!1,i=!1){const a=G.ClassType.isTupleClass(e);if(t)if(a&&1===t.length&&t[0].isEmptyTupleShorthand)t=[];else{let e=!1;const i=t=>{e&&(r||(rt(m.Localizer.Diagnostic.variadicTypeArgsTooMany(),t.node),r=!0)),e=!0};let r=!1;t.forEach(((e,r)=>{(0,W.isEllipsisType)(e.type)?a?2!==t.length||1!==r?rt(m.Localizer.Diagnostic.ellipsisSecondArg(),e.node):(0,G.isTypeVar)(t[0].type)&&(0,G.isVariadicTypeVar)(t[0].type)&&!t[0].type.isVariadicInUnion&&rt(m.Localizer.Diagnostic.typeVarTupleContext(),t[0].node):rt(m.Localizer.Diagnostic.ellipsisContext(),e.node):(0,G.isParamSpec)(e.type)&&s||((0,G.isVariadicTypeVar)(e.type)&&void 0===n?(i(e),Ft(e.type,e.node)):void 0===n&&(0,G.isUnpacked)(e.type)?(i(e),Cn(e,{allowUnpackedTuples:!0})):Cn(e))}))}let r,l=t?t.map((e=>(0,W.convertToInstance)(e.type))):[];if(void 0!==n)if(t&&l.length>n)rt(m.Localizer.Diagnostic.typeArgsTooMany().format({name:e.aliasName||e.details.name,expected:n,received:l.length}),t[n].node),l=l.slice(0,n);else if(l.length<n)for(;l.length<n;)l.push(G.UnknownType.create());if(a){const n=[];t?t.forEach(((e,t)=>{1===t&&(0,W.isEllipsisType)(l[t])?1!==n.length||n[0].isUnbounded?rt(m.Localizer.Diagnostic.ellipsisSecondArg(),e.node):n[0]={type:n[0].type,isUnbounded:!0}:(0,G.isUnpackedClass)(e.type)&&e.type.tupleTypeArguments?(0,o.appendArray)(n,e.type.tupleTypeArguments):n.push({type:l[t],isUnbounded:!1})})):n.push({type:G.UnknownType.create(),isUnbounded:!0}),r=(0,W.specializeTupleClass)(e,n,void 0!==t)}else r=G.ClassType.cloneForSpecialization(e,l,void 0!==t);return i||G.TypeBase.setSpecialForm(r),r}function Rn(e,t,n,s){const i=[];if(!n)return 0!=(256&s)?(rt(m.Localizer.Diagnostic.unionTypeArgCount(),t),G.NeverType.createNever()):e;for(const e of n){let t=e.type;Cn(e,{allowVariadicTypeVar:!0,allowUnpackedTuples:!0})?(0,W.isEffectivelyInstantiable)(t)||(dt(t,e.node),t=G.UnknownType.create()):t=G.UnknownType.create(),(0,G.isUnpackedClass)(e.type)&&e.type.tupleTypeArguments?e.type.tupleTypeArguments.forEach((e=>{i.push((0,W.convertToInstantiable)(e.type))})):((0,G.isTypeVar)(t)&&(0,G.isUnpackedVariadicTypeVar)(t)&&(t=G.TypeVarType.cloneForUnpacked(t,!0)),i.push(t))}1===i.length&&((0,G.isVariadicTypeVar)(i[0])||(0,G.isUnpacked)(i[0])||(0,G.isNoneInstance)(i[0])||rt(m.Localizer.Diagnostic.unionTypeArgCount(),t));const a=(0,G.combineTypes)(i);return(0,G.isUnion)(a)&&G.TypeBase.setSpecialForm(a),a}function On(e,t,n,s){if(!n)return 0!=(262400&s)&&rt(m.Localizer.Diagnostic.genericTypeArgMissing(),t),e;const i=[];return n&&(0===n.length&&rt(m.Localizer.Diagnostic.genericTypeArgMissing(),t),n.forEach((e=>{(0,G.isTypeVar)(e.type)?(i.some((t=>(0,G.isTypeSame)(t,e.type)))&&rt(m.Localizer.Diagnostic.genericTypeArgUnique(),e.node),i.push(e.type)):rt(m.Localizer.Diagnostic.genericTypeArgTypeVar(),e.node)}))),Mn(e,n,void 0,!0)}function Ln(e,t,n,s,i){if(!G.TypeBase.isInstantiable(e))return e;if((0,W.isTypeAliasPlaceholder)(e))return e;s||(s=[],(0,G.isTypeVar)(e)&&!G.TypeBase.isAnnotated(e)||(0,W.doForEachSubtype)(e,(e=>{(0,W.addTypeVarsToListIfUnique)(s,(0,W.getTypeVarArgumentsRecursive)(e))})),s=s.filter((e=>!e.details.isSynthesized))),(s=s.map((e=>G.TypeBase.isInstance(e)?e:(0,W.convertToInstance)(e)))).forEach(((e,t)=>{var a;let r=n;i&&t<i.length&&(r=null!==(a=i[t].defaultExpression)&&void 0!==a?a:i[t].name),$n(r,e,s.slice(0,t))}));const a=s.filter((e=>(0,G.isVariadicTypeVar)(e)));a.length>1&&rt(m.Localizer.Diagnostic.variadicTypeParamTooManyAlias().format({names:a.map((e=>`"${e.details.name}"`)).join(", ")}),n);const r=T.getFileInfo(t),o=bt(t),l=s.filter((e=>e.scopeId!==o&&0===e.scopeType));return l.length>0&&rt(m.Localizer.Diagnostic.genericTypeAliasBoundTypeVar().format({names:l.map((e=>`${e.details.name}`)).join(", ")}),n),G.TypeBase.cloneForTypeAlias(e,t.value,`${r.moduleName}.${t.value}`,o,s.length>0?s:void 0)}function Vn(e,t,n){const s=T.getFileInfo(e);let i=G.ClassType.createInstantiable(t,P.getClassFullName(e,s.moduleName,t),s.moduleName,s.filePath,3,0,void 0,void 0);s.isTypingExtensionsStubFile&&(i.details.flags|=65536);const a=n.alias||"object";let r;if("builtins"===n.module)r=xs(e,a);else if("collections"===n.module)r=et(e,a,["collections"]);else if("self"===n.module){const t=Fs(e,a,!1);t&&(r=Ls(t.symbol),(0,G.isInstantiableClass)(r)&&G.ClassType.isBuiltIn(r,"_TypedDict")&&(r.details.flags&=-513))}return r&&(0,G.isInstantiableClass)(r)?n.alias?i=G.ClassType.cloneForTypingAlias(r,t):(i.details.baseClasses.push(r),i.details.effectiveMetaclass=r.details.effectiveMetaclass,(0,W.computeMroLinearization)(i)):(i.details.baseClasses.push(G.UnknownType.create()),i.details.effectiveMetaclass=G.UnknownType.create(),(0,W.computeMroLinearization)(i)),i}function Un(e){var t;const n=T.getFileInfo(e);if(Ie(e))return;let s=0;n.isStubFile&&(s|=512),38!==e.rightExpression.nodeType&&35!==e.rightExpression.nodeType||(s|=2),Ke(e.leftExpression)&&(s|=131560,s&=-3);let i,a=be(e.rightExpression,s),r=!1;if(!a&&((n.isTypingStubFile||n.isTypingExtensionsStubFile)&&(a=function(e){if(38!==e.leftExpression.nodeType)return;const t=e.leftExpression.value;if("Any"===t)return G.AnyType.create();const n=new Map([["overload",{alias:"",module:"builtins"}],["TypeVar",{alias:"",module:"builtins"}],["_promote",{alias:"",module:"builtins"}],["no_type_check",{alias:"",module:"builtins"}],["NoReturn",{alias:"",module:"builtins"}],["Never",{alias:"",module:"builtins"}],["Counter",{alias:"Counter",module:"collections"}],["List",{alias:"list",module:"builtins"}],["Dict",{alias:"dict",module:"builtins"}],["DefaultDict",{alias:"defaultdict",module:"collections"}],["Set",{alias:"set",module:"builtins"}],["FrozenSet",{alias:"frozenset",module:"builtins"}],["Deque",{alias:"deque",module:"collections"}],["ChainMap",{alias:"ChainMap",module:"collections"}],["OrderedDict",{alias:"OrderedDict",module:"collections"}]]).get(t);return n?(Me(e.rightExpression),Vn(e,t,n)):void 0}(e),a&&Ce(e.rightExpression,{type:a},0)),!a)){const o=He(e.leftExpression,{method:"set"});let l,c,d=!1;if(Ke(e.leftExpression))l=e.leftExpression.valueExpression,ui(e.rightExpression)||ct(n.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeAliasIllegalExpressionForm(),e.rightExpression);else if(38===e.leftExpression.nodeType){const t=Fs(e.leftExpression,e.leftExpression.value,!1);if(t){const n=t.symbol.getDeclarations();1===n.length&&zn(n[0])&&(l=e.leftExpression,d=!0)}}if(l){c=G.TypeVarType.createInstantiable(`__type_alias_${l.value}`),c.details.isSynthesized=!0,c.details.recursiveTypeAliasName=l.value;const t=bt(l);c.details.recursiveTypeAliasScopeId=t,c.scopeId=t,Ce(e,{type:c},void 0),Ce(e.leftExpression,{type:c},void 0),54===e.leftExpression.nodeType&&Ce(e.leftExpression.valueExpression,{type:c},void 0)}const u=Me(e.rightExpression,s,(0,W.makeInferenceContext)(o));let y=u.type;i=u.expectedTypeDiagAddendum,u.isIncomplete&&(r=!0);const g=(0,M.evaluateStaticBoolExpression)(e.rightExpression,n.executionEnvironment,n.definedConstants);if(void 0!==g){const t=Ds(e,"bool");(0,G.isClassInstance)(t)&&(y=G.ClassType.cloneWithLiteral(t,g))}o&&Zs(o,y)&&((0,G.isAnyOrUnknown)(y)||(y=si(o,y))),a=y,38!==e.leftExpression.nodeType||e.typeAnnotationComment||(a=(0,x.transformTypeForPossibleEnumClass)(gi,e.leftExpression,(()=>a))||a),l&&(!d||G.TypeBase.isInstantiable(a)&&!(0,G.isUnknown)(a))&&(a=Ln(a,l,e.rightExpression),(0,W.isTypeAliasRecursive)(c,a)&&(ct(n.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeAliasIsRecursiveDirect().format({name:l.value}),e.rightExpression),a=G.UnknownType.create()),c.details.boundType=a,c.details.recursiveTypeParameters=null===(t=a.typeAliasInfo)||void 0===t?void 0:t.typeParameters)}ht(e.leftExpression,a,r,e.rightExpression,!0,!0,i),Ce(e,{type:a,isIncomplete:r},0)}function zn(e){var t;if(di(e))return!0;if(1===e.type&&e.node.parent&&3===e.node.parent.nodeType&&9===(null===(t=e.node.parent.rightExpression)||void 0===t?void 0:t.nodeType)){const t=e.node.parent.rightExpression.leftExpression;if("TypedDict"===(38===t.nodeType&&t.value)||35===t.nodeType&&"TypedDict"===t.memberName.value&&38===t.leftExpression.nodeType){const e=Me(t,2).type;if((0,G.isInstantiableClass)(e)&&G.ClassType.isBuiltIn(e,"TypedDict"))return!0}}return!1}function Bn(e){var t;const n=be(e.name,0);if(n)return n;const s=G.TypeVarType.createInstantiable(`__type_alias_${e.name.value}`);s.details.isSynthesized=!0,s.details.recursiveTypeAliasName=e.name.value;const i=bt(e.name);s.details.recursiveTypeAliasScopeId=i,s.scopeId=i,Ce(e.name,{type:s},void 0);const a=w.getScopeForNode(e),r=null==a?void 0:a.lookUpSymbolRecursive(e.name.value),o=T.getDeclaration(e);o&&r&&Pe(r.symbol,o,s);let l=[];e.typeParameters&&(l=Kn(e.typeParameters),s.details.recursiveTypeParameters=l),ui(e.expression)||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeAliasIllegalExpressionForm(),e.expression);const c=Ss(e.expression);let d=!1,u=c.type;return c.isIncomplete&&(d=!0),u=Ln(u,e.name,e.expression,l,null===(t=e.typeParameters)||void 0===t?void 0:t.parameters),(0,W.isTypeAliasRecursive)(s,u)&&(ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeAliasIsRecursiveDirect().format({name:e.name.value}),e.expression),u=G.UnknownType.create()),s.details.boundType=u,Ce(e.name,{type:u,isIncomplete:d},0),u}function Gn(e){Ie(e)||Ce(e,cn(e,void 0),0)}function Wn(e){return`__type_of_${e}`}function jn(e){const t=be(e.name,0);if(t){if(!(0,G.isInstantiableClass)(t))return;return{classType:t,decoratedType:be(e,0)||G.UnknownType.create()}}const n=w.getScopeForNode(e),s=T.getFileInfo(e);let i=0;(4===(null==n?void 0:n.type)||s.isTypingStubFile||s.isTypingExtensionsStubFile||s.isBuiltInStubFile)&&(i|=1,s.isTypingExtensionsStubFile&&(i|=65536),"property"===e.name.value&&(i|=2048),"tuple"===e.name.value&&(i|=524288)),s.isStubFile&&(i|=8388608);const a=G.ClassType.createInstantiable(e.name.value,P.getClassFullName(e,s.moduleName,e.name.value),s.moduleName,s.filePath,i,0,void 0,void 0,P.getDocString(e.suite.statements));a.details.typeVarScopeId=bt(e);const r=null==n?void 0:n.lookUpSymbol(e.name.value);let d;const g=T.getDeclaration(e);g&&(d=g),d&&r&&Pe(r,d,a),a.details.flags|=131072,Ce(e,{type:a},void 0),Ce(e.name,{type:a},void 0);let h,f,v=[];e.typeParameters&&(v=Kn(e.typeParameters).map((e=>G.TypeVarType.cloneAsInstance(e))));const _=[];let I,b=!1,S=289920;if(s.isStubFile&&(S|=4),e.arguments.forEach((t=>{if(2!==t.argumentCategory)if(t.name)if("metaclass"===t.name.value)I?rt(m.Localizer.Diagnostic.metaclassDuplicate(),t):I=t.valueExpression;else if("total"===t.name.value&&G.ClassType.isTypedDictClass(a)){const e=(0,M.evaluateStaticBoolExpression)(t.valueExpression,s.executionEnvironment,s.definedConstants);void 0===e?rt(m.Localizer.Diagnostic.typedDictTotalParam(),t.valueExpression):e||(a.details.flags|=256)}else _.push({argumentCategory:0,node:t,name:t.name,valueExpression:t.valueExpression});else{let n;if(1===t.argumentCategory?(Me(t.valueExpression),n=G.UnknownType.create()):n=Me(t.valueExpression,S).type,(0,G.isUnion)(n)&&(n=(0,G.removeUnbound)(n)),(0,G.isAnyOrUnknown)(n)||(0,G.isUnbound)(n)||((0,W.isMetaclassInstance)(n)?((0,l.assert)((0,G.isClassInstance)(n)),n=n.typeArguments&&n.typeArguments.length>0?n.typeArguments[0]:G.UnknownType.create()):(0,G.isInstantiableClass)(n)?((G.ClassType.isPartiallyEvaluated(n)||n.details.mro.some((e=>(0,G.isClass)(e)&&G.ClassType.isPartiallyEvaluated(e))))&&(me.push({dependency:n,callback:()=>function(e,t,n){(0,W.computeMroLinearization)(e)||rt(m.Localizer.Diagnostic.methodOrdering(),n),Hn(e,n),Qn(t,e)}(a,e,e.name)}),b=!0),G.ClassType.isBuiltIn(n,"Protocol")&&(!s.isStubFile&&!G.ClassType.isTypingExtensionClass(n)&&s.executionEnvironment.pythonVersion<u.PythonVersion.V3_7&&rt(m.Localizer.Diagnostic.protocolIllegal(),t.valueExpression),a.details.flags|=8192),G.ClassType.isBuiltIn(n,"property")&&(a.details.flags|=2048),s.executionEnvironment.pythonVersion>=u.PythonVersion.V3_6&&G.ClassType.isBuiltIn(n,"NamedTuple")&&(a.details.flags|=16777252),G.ClassType.isBuiltIn(n,"TypedDict")||G.ClassType.isTypedDictClass(n)?a.details.flags|=128:G.ClassType.isTypedDictClass(a)&&!G.ClassType.isTypedDictClass(n)&&((0,G.isInstantiableClass)(n)&&G.ClassType.isBuiltIn(n,"Generic")||rt(m.Localizer.Diagnostic.typedDictBaseClass(),t)),(0,W.derivesFromClassRecursive)(n,a,!0)&&(rt(m.Localizer.Diagnostic.baseClassCircular(),t),n=G.UnknownType.create())):(ct(s.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.baseClassInvalid(),t),n=G.UnknownType.create())),(0,G.isUnknown)(n)&&ct(s.diagnosticRuleSet.reportUntypedBaseClass,p.DiagnosticRule.reportUntypedBaseClass,m.Localizer.Diagnostic.baseClassUnknown(),t),a.details.baseClasses.some((e=>(0,G.isInstantiableClass)(e)&&(0,G.isInstantiableClass)(n)&&G.ClassType.isSameGenericClass(n,e)))&&ct(s.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.duplicateBaseClass(),t.name||t),a.details.baseClasses.push(n),(0,G.isInstantiableClass)(n)&&(G.ClassType.isEnumClass(n)&&(a.details.flags|=1048576),(G.ClassType.supportsAbstractMethods(n)||G.ClassType.isProtocolClass(n)&&!G.ClassType.isBuiltIn(n))&&(a.details.flags|=512),G.ClassType.isPropertyClass(n)&&(a.details.flags|=2048),G.ClassType.isFinal(n))){const e=yi(n);rt(m.Localizer.Diagnostic.baseClassFinal().format({type:e}),t.valueExpression)}(0,W.addTypeVarsToListIfUnique)(v,(0,W.getTypeVarArgumentsRecursive)(n)),(0,G.isInstantiableClass)(n)&&(G.ClassType.isBuiltIn(n,"Generic")?e.typeParameters?ct(s.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.genericBaseClassNotAllowed(),t.valueExpression):h||(f&&ct(s.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.duplicateGenericAndProtocolBase(),t.valueExpression),h=[],(0,W.addTypeVarsToListIfUnique)(h,(0,W.getTypeVarArgumentsRecursive)(n))):G.ClassType.isBuiltIn(n,"Protocol")&&n.typeArguments&&n.typeArguments.length>0&&(f||(h&&ct(s.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.duplicateGenericAndProtocolBase(),t.valueExpression),f=[],(0,W.addTypeVarsToListIfUnique)(f,(0,W.getTypeVarArgumentsRecursive)(n)),e.typeParameters&&f.length>0&&(ct(s.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.protocolBaseClassWithTypeArgs(),t.valueExpression),f=[]))))}else Me(t.valueExpression)})),a.details.baseClasses.length>1){let t=!1,n=!1;a.details.baseClasses.forEach((e=>{(0,G.isInstantiableClass)(e)&&(G.ClassType.isBuiltIn(e,"NamedTuple")?t=!0:G.ClassType.isBuiltIn(e,"Generic")||(n=!0))})),t&&n&&ct(s.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.namedTupleMultipleInheritance(),e.name)}G.ClassType.isBuiltIn(a,"object")||0!==a.details.baseClasses.filter((e=>(0,G.isClass)(e))).length||a.details.baseClasses.push(xs(e,"object")),h=null!=h?h:f,h&&!e.typeParameters&&function(e,t,n){const s=t.filter((e=>!n.some((t=>t.details.name===e.details.name))));if(s.length>0){const t=new c.DiagnosticAddendum;t.addMessage(m.Localizer.DiagnosticAddendum.typeVarsMissing().format({names:s.map((e=>`"${e.details.name}"`)).join(", ")})),ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeVarsNotInGenericOrProtocol()+t.getString(),e)}}(e.name,v,h),a.details.typeParameters=null!=h?h:v,a.details.typeParameters.some((e=>0===e.details.declaredVariance&&void 0===e.computedVariance))&&(a.details.requiresVarianceInference=!0);const x=a.details.typeParameters.filter((e=>(0,G.isVariadicTypeVar)(e)));x.length>1&&rt(m.Localizer.Diagnostic.variadicTypeParamTooManyClass().format({names:x.map((e=>`"${e.details.name}"`)).join(", ")}),e.name,y.TextRange.combine(e.arguments)||e.name),a.details.typeParameters.forEach(((t,n)=>{var s;let i=e.name;if(e.typeParameters&&n<e.typeParameters.parameters.length){const t=e.typeParameters.parameters[n];i=null!==(s=t.defaultExpression)&&void 0!==s?s:t.name}$n(i,t,a.details.typeParameters.slice(0,n))})),(0,W.computeMroLinearization)(a)||rt(m.Localizer.Diagnostic.methodOrdering(),e.name);const D=w.getScopeForNode(e.suite);a.details.fields=(null==D?void 0:D.symbolTable)?new Map(D.symbolTable):new Map;const F=null==D?void 0:D.getSlotsNames();if(F&&(a.details.localSlotsNames=F),!s.isStubFile&&0===a.details.typeParameters.length){const t=a.details.fields.get("__init__");if(t){const n=t.getTypedDeclarations();if(1===n.length&&5===n[0].type){const t=n[0].node,s=t.parameters;if(s.length>1&&!s.some(((e,n)=>!!P.getTypeAnnotationForParameter(t,n)))){const n=s.filter(((e,t)=>t>0&&e.name&&0===e.category&&!e.defaultValue));n.length>0&&(a.details.flags|=16384,a.details.typeParameters=n.map((n=>{const s=G.TypeVarType.createInstance(Wn(n.name.value));return s.details.isSynthesized=!0,s.scopeId=bt(t),s.details.boundType=G.UnknownType.create(),G.TypeVarType.cloneForScopeId(s,bt(e),e.name.value,0)})))}}}}if(0!==a.details.typeParameters.length||G.ClassType.isBuiltIn(a,"type")||(a.details.baseClasses.some((e=>(0,G.isInstantiableClass)(e)&&G.ClassType.hasCustomClassGetItem(e)))||a.details.fields.has("__class_getitem__"))&&(a.details.flags|=262144),I){const e=Me(I,S).type;((0,G.isInstantiableClass)(e)||(0,G.isUnknown)(e))&&((0,W.requiresSpecialization)(e,!0)&&ct(s.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.metaclassIsGeneric(),I),a.details.declaredMetaclass=e,(0,G.isInstantiableClass)(e)&&(G.ClassType.isBuiltIn(e,"EnumMeta")?a.details.flags|=1048576:G.ClassType.isBuiltIn(e,"ABCMeta")&&(a.details.flags|=512)))}const E=Hn(a,e.name);a.details.flags&=-131073;let A,N=a,k=!1;for(let t=e.decorators.length-1;t>=0;t--){const n=e.decorators[t],i=Yn(N,a,n);(0,W.containsUnknown)(i)?k||(ct(s.diagnosticRuleSet.reportUntypedClassDecorator,p.DiagnosticRule.reportUntypedClassDecorator,m.Localizer.Diagnostic.classDecoratorTypeUnknown(),e.decorators[t].expression),k=!0):N=i}if((0,G.isInstantiableClass)(E)&&E.details.classDataClassTransform)A=E.details.classDataClassTransform;else{const e=a.details.mro.find((e=>(0,G.isClass)(e)&&void 0!==e.details.classDataClassTransform&&!G.ClassType.isSameGenericClass(e,a)));e&&(A=e.details.classDataClassTransform)}var R;if(A&&((0,C.applyDataClassDefaultBehaviors)(a,A),(0,C.applyDataClassClassBehaviorOverrides)(gi,e.name,a,_,A)),R=a,me.forEach((e=>{G.ClassType.isSameGenericClass(e.dependency,R)&&e.callback()})),me=me.filter((e=>!G.ClassType.isSameGenericClass(e.dependency,R))),G.ClassType.isTypedDictClass(a)&&(0,U.synthesizeTypedDictClassMethods)(gi,e,a,(0,G.isClass)(N)&&G.ClassType.isFinal(N)),G.ClassType.isDataClass(a)){const t=G.ClassType.isSkipSynthesizedDataClassInit(a);let n=t;t||(0,W.lookUpClassMember)(a,"__init__",2)&&(n=!0);let s=!1;(0,W.lookUpClassMember)(a,"__hash__",2)&&(s=!0),(0,C.synthesizeDataClassMethods)(gi,e,a,t,n,s)}if(a.details.localSlotsNames){let e=!0;const t=[...a.details.localSlotsNames];a.details.baseClasses.forEach((n=>{(0,G.isInstantiableClass)(n)?G.ClassType.isBuiltIn(n,"object")||G.ClassType.isBuiltIn(n,"type")||G.ClassType.isBuiltIn(n,"Generic")||(void 0===n.details.inheritedSlotsNames?e=!1:(0,o.appendArray)(t,n.details.inheritedSlotsNames)):e=!1})),e&&(a.details.inheritedSlotsNames=t)}return Ce(e.name,{type:a},0),Ce(e,{type:N},0),G.ClassType.isBuiltIn(a,"UnionType")&&(J=G.ClassType.cloneAsInstance(a)),b||Qn(e,a),{classType:a,decoratedType:N}}function $n(e,t,n){if(!t.details.defaultType&&!t.details.isSynthesized&&!t.details.isSynthesizedSelf){const s=n.find((e=>e.details.defaultType));return void(s&&ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeVarWithoutDefault().format({name:t.details.name,other:s.details.name}),e))}const s=new Set;if((0,W.validateTypeVarDefault)(t,n,s),s.size>0){const n=new c.DiagnosticAddendum;s.forEach((e=>{n.addMessage(m.Localizer.DiagnosticAddendum.typeVarDefaultOutOfScope().format({name:e}))})),ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeVarDefaultInvalidTypeVar().format({name:t.details.name})+n.getString(),e)}}function qn(e){if(!e.details.requiresVarianceInference)return;if(!X||!(0,G.isClassInstance)(X))return;e.details.requiresVarianceInference=!1,e.details.typeParameters.forEach((e=>{0===e.details.declaredVariance&&(e.computedVariance=1)}));const t=e.details.typeParameters.map((e=>G.TypeVarType.cloneAsInvariant(e))),n=G.ClassType.cloneWithNewTypeParameters(e,t),s=G.ClassType.createInstantiable("__varianceDummy","","","",0,0,void 0,void 0);t.forEach(((i,a)=>{if(i.details.isVariadic||i.details.isParamSpec)return;if(0!==i.details.declaredVariance)return;const r=t.map(((e,t)=>e.details.isVariadic?e:t===a?X:s)),o=t.map(((e,t)=>t===a||e.details.isVariadic?e:s)),l=G.ClassType.cloneForSpecialization(n,r,!0),c=G.ClassType.cloneForSpecialization(n,o,!0);let p;p=Ks(l,c,!1)?3:Ks(c,l,!1)?4:2,e.details.typeParameters[a].computedVariance=p}))}function Kn(e){const t=[];return e.parameters.forEach((e=>{var n;const s=T.getTypeParameterSymbol(e.name);(0,l.assert)(s);const i=null===(n=Us(s,e.name))||void 0===n?void 0:n.type;i&&(0,G.isTypeVar)(i)&&(Ce(e.name,{type:i},0),t.push(i))})),t}function Hn(e,t){let n=e.details.declaredMetaclass,s=!1;if(!n||(0,G.isInstantiableClass)(n))for(const i of e.details.baseClasses){if(!(0,G.isInstantiableClass)(i)){n=G.UnknownType.create();break}{const a=i.details.effectiveMetaclass||ee;if(!a||!(0,G.isInstantiableClass)(a)){n=a?G.UnknownType.create():void 0;break}n?(0,W.derivesFromClassRecursive)(a,n,!1)?n=a:(0,W.derivesFromClassRecursive)(n,a,!1)||s||(ct(T.getFileInfo(t).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.metaclassConflict(),t),s=!0):n=a,G.ClassType.isEnumClass(i)&&(e.details.flags|=1048576)}}if(!n){const e=xs(t,"type");n=e&&(0,G.isInstantiableClass)(e)?e:G.UnknownType.create()}return e.details.effectiveMetaclass=n,n}function Yn(e,t,n){let s=T.getFileInfo(n).isStubFile?4:0;9!==n.expression.nodeType&&(s|=2);const i=Me(n.expression,s).type;if(9===n.expression.nodeType){const i=Me(n.expression.leftExpression,2|s).type;if((0,G.isFunction)(i))if("__dataclass_transform__"===i.details.name||"dataclass_transform"===i.details.builtInName)t.details.classDataClassTransform=(0,C.validateDataClassTransformDecorator)(gi,n.expression);else if("deprecated"===i.details.name)return t.details.deprecatedMessage=Zn(n),e;if((0,G.isOverloadedFunction)(i)&&i.overloads.length>0&&"deprecated"===i.overloads[0].details.builtInName)return t.details.deprecatedMessage=Zn(n),e}if((0,G.isOverloadedFunction)(i)){const s=(0,C.getDataclassDecoratorBehaviors)(i);if(s)return(0,C.applyDataClassDecorator)(gi,n,t,s,void 0),e;if(i.overloads.length>0&&"deprecated"===i.overloads[0].details.builtInName)return t.details.deprecatedMessage=Zn(n),e}else if((0,G.isFunction)(i)){if("final"===i.details.builtInName)return t.details.flags|=4096,e;if("deprecated"===i.details.builtInName)return t.details.deprecatedMessage=Zn(n),e;if("runtime_checkable"===i.details.builtInName)return t.details.flags|=32768,e;let a,r;if(9===n.expression.nodeType){r=n.expression;const e=Me(r.leftExpression,2|s).type;a=(0,C.getDataclassDecoratorBehaviors)(e)}else{const e=Me(n.expression,s).type;a=(0,C.getDataclassDecoratorBehaviors)(e)}if(a)return(0,C.applyDataClassDecorator)(gi,n,t,a,r),e}return Ue(n,e)}function Zn(e){return 9===e.expression.nodeType&&e.expression.arguments.length>0&&0===e.expression.arguments[0].argumentCategory&&48===e.expression.arguments[0].valueExpression.nodeType&&1===e.expression.arguments[0].valueExpression.strings.length?e.expression.arguments[0].valueExpression.strings[0].value:""}function Qn(e,t){const n=[];e.arguments.forEach((e=>{e.name&&"metaclass"!==e.name.value&&n.push({argumentCategory:0,node:e,name:e.name,valueExpression:e.valueExpression})}));const s=n.length>0?n[0].node.name:e.name,i=xt(s,t,!1,"__init_subclass__",{method:"get"},void 0,133,t);if(i){const e=i.type;e&&Ht(s,n,{type:e},void 0,!1,(0,W.makeInferenceContext)(G.NoneType.createInstance()))}else if(t.details.effectiveMetaclass&&(0,G.isClass)(t.details.effectiveMetaclass)){const i=(0,W.lookUpClassMember)(t.details.effectiveMetaclass,"__new__",32);if(i){const t=js(i);if((0,G.isFunction)(t)){const i=(0,E.getParameterListDetails)(t);if(void 0!==i.firstKeywordOnlyIndex){const a=new Map;for(let e=i.firstKeywordOnlyIndex;e<i.params.length;e++){const t=i.params[e];0===t.param.category&&t.param.name&&a.set(t.param.name,e)}n.forEach((n=>{var r,o,l;const c=new W.UniqueSignatureTracker;if(0===n.argumentCategory&&n.name){const d=null!==(r=a.get(n.name.value))&&void 0!==r?r:i.kwargsIndex;if(void 0!==d){const e=i.params[d];tn({paramCategory:e.param.category,paramType:G.FunctionType.getEffectiveParameterType(t,e.index),requiresTypeVarMatching:!1,argument:n,errorNode:null!==(o=n.valueExpression)&&void 0!==o?o:s},new j.TypeVarContext,c,{type:t},!0,!0,!1,void 0),a.delete(n.name.value)}else ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.paramNameMissing().format({name:n.name.value}),null!==(l=n.name)&&void 0!==l?l:s)}}));const r=[];if(a.forEach(((e,t)=>{i.params[e].param.hasDefault||r.push(t)})),r.length>0){const e=r.map((e=>`"${e}"`)).join(", ");ct(T.getFileInfo(s).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,1===r.length?m.Localizer.Diagnostic.argMissingForParam().format({name:e}):m.Localizer.Diagnostic.argMissingForParams().format({names:e}),s)}}}}}n.forEach((e=>{e.valueExpression&&Me(e.valueExpression)}))}function Jn(e){var t,n;const s=T.getFileInfo(e),i=be(e.name,0);if(i){if(!(0,G.isFunction)(i))return;return{functionType:i,decoratedType:be(e,0)||G.UnknownType.create()}}let a;const r=T.getDeclaration(e);r&&(a=r);const l=P.getEnclosingClass(e,!0);let d;if(l){const e=jn(l);if(!e)return;d=e.classType}let u=ns(e,!!l);(null==a?void 0:a.isGenerator)&&(u|=16),s.isStubFile?u|=2048:s.isInPyTypedPackage&&(u|=4096),e.isAsync&&(u|=512);const y=G.FunctionType.createInstance(e.name.value,function(e,t,n){const s=[n];let i=e;for(;i;)i=P.getEnclosingClassOrFunction(i),i&&s.push(i.name.value);return s.push(t),s.reverse().join(".")}(e,s.moduleName,e.name.value),s.moduleName,131072|u,P.getDocString(e.suite.statements));y.details.typeVarScopeId=bt(e),"__init__"!==e.name.value&&"__new__"!==e.name.value||l&&(y.details.constructorTypeVarScopeId=bt(l)),(s.isBuiltInStubFile||s.isTypingStubFile||s.isTypingExtensionsStubFile)&&(y.details.builtInName=e.name.value),y.details.declaration=a;const g=w.getScopeForNode(e),h=null==g?void 0:g.lookUpSymbolRecursive(e.name.value);a&&h&&Pe(h.symbol,a,y),Ce(e,{type:y},void 0),Ce(e.name,{type:y},void 0);const f=d&&G.ClassType.isPseudoGenericClass(d)&&"__init__"===e.name.value,v=[];let _=0;if(d&&0==(4&y.details.flags)&&(_=1),e.functionAnnotationComment&&!e.functionAnnotationComment.isParamListEllipsis){const t=e.parameters.length-_,n=e.functionAnnotationComment.paramTypeAnnotations.length;_>0&&n===e.parameters.length?_=0:n!==t&&rt(m.Localizer.Diagnostic.annotatedParamCountMismatch().format({expected:t,received:n}),e.functionAnnotationComment)}const I=[];e.typeParameters?y.details.typeParameters=Kn(e.typeParameters):y.details.typeParameters=I;const b=e=>{if(e.name){const t=Fs(e.name,e.name.value,!1);t&&Tt(s,t.symbol,e.name)}};let C=!0;const S=d&&(G.FunctionType.isClassMethod(y)||G.FunctionType.isInstanceMethod(y)||G.FunctionType.isConstructorMethod(y)),x=S?1:0;if(e.parameters.forEach(((t,n)=>{let i,a,r,o,l=!1;if(t.name&&(0===n&&S||G.FunctionType.isAbstractMethod(y)||d&&G.ClassType.isProtocolClass(d))&&b(t),t.typeAnnotation)r=t.typeAnnotation;else if(t.typeAnnotationComment)r=t.typeAnnotationComment;else if(e.functionAnnotationComment&&!e.functionAnnotationComment.isParamListEllipsis){const t=n-_;t>=0&&t<e.functionAnnotationComment.paramTypeAnnotations.length&&(r=e.functionAnnotationComment.paramTypeAnnotations[t])}if(r&&(a=Le(r,t.category),(0,G.isVariadicTypeVar)(a)&&!a.isVariadicUnpacked&&(rt(m.Localizer.Diagnostic.unpackedTypeVarTupleExpected().format({name1:a.details.name,name2:a.details.name}),r),a=G.UnknownType.create())),!a&&f&&n>0&&0===t.category&&t.name&&!t.defaultValue){const e=Wn(t.name.value);a=d.details.typeParameters.find((t=>t.details.name===e))}if(a){const e=Xn(t,a);e!==a&&(a=e,l=!0)}if(t.defaultValue&&(o=Me(t.defaultValue,1,(0,W.makeInferenceContext)(a)).type),a){if(t.defaultValue&&o){const n=new c.DiagnosticAddendum,i=new j.TypeVarContext(y.details.typeVarScopeId);if(d&&void 0!==d.details.typeVarScopeId&&("__init__"!==e.name.value&&"__new__"!==e.name.value||i.addSolveForScope(d.details.typeVarScopeId)),!Zs(a,o,n,i)){const e=ct(s.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.paramAssignmentMismatch().format({sourceType:mi(o),paramType:mi(a)})+n.getString(),t.defaultValue);if(l&&r){const t={action:"pyright.addoptionalforparam",offsetOfTypeNode:r.start+1};null==e||e.addAction(t)}}}i=a}if(n>=x){let e=!1;0===t.category&&t.name?(0,O.isPrivateName)(t.name.value)&&(e=!0):C=!1,C&&!e&&y.details.parameters.length>x&&G.FunctionType.addParameter(y,{category:0,type:G.UnknownType.create()}),e||(C=!1)}let u=!1;if(!r){u=!0;const t=es(e,y.details.flags,n,d);t&&(i=t)}const g={category:t.category,name:t.name?t.name.value:void 0,hasDefault:!!t.defaultValue,defaultValueExpression:t.defaultValue,defaultType:o,type:null!=i?i:G.UnknownType.create(),typeAnnotation:r,hasDeclaredType:!!r,isTypeInferred:u};if(G.FunctionType.addParameter(y,g),g.hasDeclaredType&&(0,W.addTypeVarsToListIfUnique)(I,(0,W.getTypeVarArgumentsRecursive)(g.type)),t.name){const n=ts(e,t.category,g.type);v.push(n)}else v.push(g.type)})),C&&y.details.parameters.length>x&&G.FunctionType.addParameter(y,{category:0,type:G.UnknownType.create()}),v.forEach(((t,n)=>{const s=e.parameters[n].name;s&&((0,G.isUnknown)(t)&&(y.details.flags|=16384),Ce(s,{type:t},0))})),v.length>=2){const e=v[v.length-2],t=v[v.length-1];(0,G.isParamSpec)(e)&&"args"===e.paramSpecAccess&&(0,G.isParamSpec)(t)&&"kwargs"===t.paramSpecAccess&&(y.details.flags|=32768)}const D=null!==(t=e.returnTypeAnnotation)&&void 0!==t?t:null===(n=e.functionAnnotationComment)||void 0===n?void 0:n.returnTypeAnnotation;if(D){y.details.declaredReturnType=G.UnknownType.create();const e=Ve(D,{associateTypeVarsWithScope:!0});y.details.declaredReturnType=e}else s.isStubFile&&("__init__"===e.name.value?y.details.declaredReturnType=G.NoneType.createInstance():y.details.declaredReturnType=G.UnknownType.create());y.details.declaredReturnType&&D&&function(e,t,n){const s=(0,W.getTypeVarArgumentsRecursive)(e),i=[];s.forEach((s=>{G.TypeBase.isInstantiable(s)&&(s=G.TypeVarType.cloneAsInstance(s)),s.scopeId===t.details.typeVarScopeId&&(n.some((e=>(0,G.isTypeSame)((0,W.convertToInstance)(e),s)))||(0,W.isTypeVarLimitedToCallable)(e,s)&&i.push(s))})),(0,W.addTypeVarsToListIfUnique)(n,s),t.details.rescopedTypeParameters=i}(y.details.declaredReturnType,y,I),(s.isStubFile||P.isSuiteEmpty(e.suite))&&y.details.declaredReturnType&&(0,G.isClassInstance)(y.details.declaredReturnType)&&G.ClassType.isBuiltIn(y.details.declaredReturnType,["Generator","AsyncGenerator","AwaitableGenerator"])&&(y.details.flags|=16),y.details.typeParameters.forEach(((t,n)=>{var s;let i=e.name;if(e.typeParameters&&n<e.typeParameters.parameters.length){const t=e.typeParameters.parameters[n];i=null!==(s=t.defaultExpression)&&void 0!==s?s:t.name}$n(i,t,y.details.typeParameters.slice(0,n))})),y.details.flags&=-131073;const F=e.isAsync?function(e,t){const n=G.FunctionType.clone(t);return t.details.declaredReturnType&&(n.details.declaredReturnType=is(e,t.details.declaredReturnType,G.FunctionType.isGenerator(t))),n.details.flags|=1024,n}(e,y):y;let E=F,A=!1;for(let t=e.decorators.length-1;t>=0;t--){const n=e.decorators[t],i=ss(E,y,n,e);(0,W.containsUnknown)(i)?A||(ct(s.diagnosticRuleSet.reportUntypedFunctionDecorator,p.DiagnosticRule.reportUntypedFunctionDecorator,m.Localizer.Diagnostic.functionDecoratorTypeUnknown(),e.decorators[t].expression),A=!0):E=i}return(0,G.isFunction)(E)&&(G.FunctionType.isOverloaded(E)&&e.parameters.forEach((e=>{b(e)})),E=function(e,t){let n;const s=T.getDeclaration(e);s&&(n=s);const i=Fs(e,e.name.value,!1);if(i){const s=i.symbol.getDeclarations(),a=s.findIndex((e=>e===n));if(a>0){for(let e=0;e<a;e++){const t=s[e];5===t.type&&Jn(t.node)}let n=[];const i=s[a-1];if(5===i.type){const e=Jn(i.node);e&&((0,G.isFunction)(e.decoratedType)?G.FunctionType.isOverloaded(e.decoratedType)&&n.push(e.decoratedType):(0,G.isOverloadedFunction)(e.decoratedType)&&(0,o.appendArray)(n,e.decoratedType.overloads))}if(n.push(t),1===n.length)return n[0];const r=n.find((e=>!G.FunctionType.isOverloaded(e)));(null==r?void 0:r.details.docString)&&(n=n.map((e=>G.FunctionType.isOverloaded(e)&&!e.details.docString?G.FunctionType.cloneWithDocString(e,r.details.docString):e)));const l=G.OverloadedFunctionType.create(n),c=n[n.length-2];return G.FunctionType.isAbstractMethod(c)!==G.FunctionType.isAbstractMethod(t)&&ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.overloadAbstractMismatch().format({name:e.name.value}),e.name),l}}return t}(e,E)),Ce(e.name,{type:y},0),Ce(e,{type:E},0),{functionType:y,decoratedType:E}}function Xn(e,t){var n;if(11!==(null===(n=e.defaultValue)||void 0===n?void 0:n.nodeType)||26!==e.defaultValue.constType||(0,W.isOptionalType)(t)||T.getFileInfo(e).diagnosticRuleSet.strictParameterNoneValue){if((0,G.isTypeVar)(t)&&e.defaultValue&&1===t.scopeType){const n=Me(e.defaultValue,1,(0,W.makeInferenceContext)(t)).type;(0,G.isAny)(n)||(t=(0,G.combineTypes)([t,n]))}}else t=(0,G.combineTypes)([t,G.NoneType.createInstance()]);return t}function es(e,t,n,s){var i;if(s){if(0===n&&0==(4&t)){const e=0!=(3&t);return(0,W.synthesizeTypeVarForSelfCls)(s,e)}const a=e.name.value,r=(0,W.lookUpClassMember)(s,a,1);if(r){const t=r.symbol.getDeclarations();if(1===t.length&&5===t[0].type){const s=t[0].node;if(s.parameters.length===e.parameters.length&&s.parameters.every(((t,n)=>{var s,i;const a=e.parameters[n];return(null===(s=a.name)||void 0===s?void 0:s.value)===(null===(i=t.name)||void 0===i?void 0:i.value)&&a.category===t.category}))){const t=s.parameters[n],a=null!==(i=t.typeAnnotation)&&void 0!==i?i:t.typeAnnotationComment;if(a){let t=Le(a,e.parameters[n].category);const s=T.getFileInfo(e);return s.isInPyTypedPackage&&!s.isStubFile&&(t=G.TypeBase.cloneForAmbiguousType(t)),t}}}}}const a=e.parameters[n].defaultValue;if(a){const t=Me(a,1).type;let n;if((0,G.isNoneInstance)(t)||(0,G.isClassInstance)(t)&&(0,O.isPrivateOrProtectedName)(t.details.name)?n=(0,G.combineTypes)([t,G.UnknownType.create()]):(0,G.isClassInstance)(t)&&G.ClassType.isBuiltIn(t,["tuple","list","set","dict"])||(n=Oe(t)),n){const t=T.getFileInfo(e);t.isInPyTypedPackage&&!t.isStubFile&&(n=G.TypeBase.cloneForAmbiguousType(n))}return n}}function ts(e,t,n){switch(t){case 0:return n;case 1:return(0,G.isTypeVar)(n)&&n.paramSpecAccess?n:(0,G.isUnpackedClass)(n)?G.ClassType.cloneForUnpacked(n,!1):ne&&(0,G.isInstantiableClass)(ne)?G.ClassType.cloneAsInstance((0,W.specializeTupleClass)(ne,[{type:n,isUnbounded:!(0,G.isVariadicTypeVar)(n)}],!0)):G.UnknownType.create();case 2:{if((0,G.isTypeVar)(n)&&n.paramSpecAccess)return n;if((0,G.isClassInstance)(n)&&G.ClassType.isTypedDictClass(n)&&n.isUnpacked)return n;const t=xs(e,"dict"),s=Ds(e,"str");return(0,G.isInstantiableClass)(t)&&(0,G.isClassInstance)(s)?G.ClassType.cloneAsInstance(G.ClassType.cloneForSpecialization(t,[s,n],!0)):G.UnknownType.create()}}}function ns(e,t){const n=T.getFileInfo(e);let s=0;t&&("__new__"===e.name.value&&(s|=1),["__init_subclass__","__class_getitem__"].some((t=>e.name.value===t))&&(s|=2));for(const i of e.decorators){let e=n.isStubFile?4:0;9!==i.expression.nodeType&&(e|=2);const a=Me(i.expression,e).type;(0,G.isFunction)(a)?"abstractmethod"===a.details.builtInName?t&&(s|=8):"final"===a.details.builtInName?s|=8192:"override"===a.details.builtInName&&(s|=262144):(0,G.isInstantiableClass)(a)&&(G.ClassType.isBuiltIn(a,"staticmethod")?t&&(s|=4):G.ClassType.isBuiltIn(a,"classmethod")&&t&&(s|=2))}return s}function ss(e,t,n,s){let i=T.getFileInfo(n).isStubFile?4:0;9!==n.expression.nodeType&&(i|=2);const a=Me(n.expression,i).type;if(((0,G.isInstantiableClass)(a)&&G.ClassType.isSpecialBuiltIn(a,"overload")||(0,G.isFunction)(a)&&"overload"===a.details.builtInName)&&(0,G.isFunction)(e))return e.details.flags|=256,t.details.flags|=256,e;if(9===n.expression.nodeType){const s=Me(n.expression.leftExpression,2|i).type;if((0,G.isFunction)(s)){if("__dataclass_transform__"===s.details.name||"dataclass_transform"===s.details.builtInName)return t.details.decoratorDataClassBehaviors=(0,C.validateDataClassTransformDecorator)(gi,n.expression),e;if("deprecated"===s.details.name)return t.details.deprecatedMessage=Zn(n),e}if((0,G.isOverloadedFunction)(s)&&s.overloads.length>0&&"deprecated"===s.overloads[0].details.builtInName)return t.details.deprecatedMessage=Zn(n),e}let r=Ue(n,e);if((0,G.isFunction)(a)){if("abstractmethod"===a.details.builtInName)return e;if("deprecated"===a.details.builtInName)return t.details.deprecatedMessage=Zn(n),e;if(35===n.expression.nodeType){const t=Me(n.expression.leftExpression,2|i).type;if((0,W.isProperty)(t)){const i=n.expression.memberName.value;if("setter"===i)return(0,G.isFunction)(e)?((0,N.validatePropertyMethod)(gi,e,n),(0,N.clonePropertyWithSetter)(gi,t,e,s)):e;if("deleter"===i)return(0,G.isFunction)(e)?((0,N.validatePropertyMethod)(gi,e,n),(0,N.clonePropertyWithDeleter)(gi,t,e,s)):e}}}else if((0,G.isOverloadedFunction)(a)){if(a.overloads.length>0&&"deprecated"===a.overloads[0].details.builtInName)return t.details.deprecatedMessage=Zn(n),e}else if((0,G.isInstantiableClass)(a)){if(G.ClassType.isBuiltIn(a))switch(a.details.name){case"classmethod":case"staticmethod":{const t="classmethod"===a.details.name?2:4;if((0,G.isFunction)(e)&&0==(e.details.flags&t)){const n=G.FunctionType.clone(e);return n.details.flags&=-8,n.details.flags|=t,n}return e}}if(G.ClassType.isPropertyClass(a)){if((0,G.isFunction)(e))return(0,N.validatePropertyMethod)(gi,e,n),(0,N.createProperty)(gi,n,a,e);if((0,G.isClassInstance)(e)){const t=qe(e,"__call__");return t&&(0,G.isFunction)(t)?(0,N.createProperty)(gi,n,a,t):G.UnknownType.create()}}}return(0,G.isFunction)(e)&&(0,G.isFunction)(r)&&(r=G.FunctionType.clone(r),G.FunctionType.isOverloaded(e)&&(r.details.flags|=256),r.details.docString||(r.details.docString=e.details.docString)),r}function is(e,t,n){let s;if((0,G.isClassInstance)(t)&&G.ClassType.isBuiltIn(t))if("Generator"===t.details.name){const n=Je(e,"AsyncGenerator");if(n&&(0,G.isInstantiableClass)(n)){const e=[],i=t.typeArguments;i&&i.length>0&&e.push(i[0]),i&&i.length>1&&e.push(i[1]),s=G.ClassType.cloneAsInstance(G.ClassType.cloneForSpecialization(n,e,!0))}}else["AsyncGenerator","AsyncIterator","AsyncIterable"].some((e=>e===t.details.name))&&(s=t);if(!s||!n){const n=Je(e,"Coroutine");s=n&&(0,G.isInstantiableClass)(n)?G.ClassType.cloneAsInstance(G.ClassType.cloneForSpecialization(n,[G.AnyType.create(),G.AnyType.create(),t],!0)):G.UnknownType.create()}return s}function as(e,t){var n;if(e.returnTypeAnnotation||(null===(n=e.functionAnnotationComment)||void 0===n?void 0:n.returnTypeAnnotation))return;let s=be(e.suite,0),i=!1;if(s)return{type:s,isIncomplete:i};if(ce.has(e.id)||ce.size>=12)s=G.UnknownType.create(),i=!0;else{ce.add(e.id);try{let n;const a=T.getDeclaration(e);a&&(n=a);const r=!st(e),o=st(e.suite);if(T.getFileInfo(e).isStubFile)s=G.UnknownType.create();else{if(r)s=t||function(e){if(!e||!e.isMethod||e.returnStatements||e.yieldStatements||!e.raiseStatements)return!1;for(const t of e.raiseStatements){if(!t.typeExpression||t.valueExpression)return!1;const e=Me(t.typeExpression).type,n=(0,G.isInstantiableClass)(e)||(0,G.isClassInstance)(e)?e:void 0;if(!n||!G.ClassType.isBuiltIn(n,"NotImplementedError"))return!1}return!0}(n)?G.UnknownType.create():G.NeverType.createNoReturn();else{const e=[];(null==n?void 0:n.returnStatements)&&n.returnStatements.forEach((t=>{if(nt(t))if(t.returnExpression){const n=Me(t.returnExpression);n.isIncomplete&&(i=!0);let s=n.type;s=(0,W.mapSubtypes)(s,(e=>(0,G.isClassInstance)(e)&&e.isEmptyContainer?G.ClassType.cloneForSpecialization(e,e.typeArguments,!!e.isTypeArgumentExplicit,e.includeSubclasses,e.tupleTypeArguments,!1):e)),e.push(s)}else e.push(G.NoneType.createInstance())})),!r&&o&&e.push(G.NoneType.createInstance()),s=(0,G.combineTypes)(e),s=(0,G.removeUnbound)(s)}if(null==n?void 0:n.isGenerator){const t=[];let i=!1;n.yieldStatements&&n.yieldStatements.forEach((e=>{var n;if(nt(e))if(61===e.nodeType){const s=Me(e.expression);if((0,G.isClassInstance)(s.type)&&G.ClassType.isBuiltIn(s.type,"Coroutine"))t.push(),i=!0;else{const i=null===(n=Ze(s,!1,e))||void 0===n?void 0:n.type;t.push(null!=i?i:G.UnknownType.create())}}else if(e.expression){const n=Me(e.expression).type;t.push(null!=n?n:G.UnknownType.create())}else t.push(G.NoneType.createInstance())})),0===t.length&&t.push(G.NoneType.createInstance());const a=(0,G.combineTypes)(t),r=Je(e,i?"AwaitableGenerator":"Generator");if(r&&(0,G.isInstantiableClass)(r)){const e=[];i&&e.push(G.AnyType.create()),e.push(a,G.NoneType.createInstance(),(0,G.isNever)(s)?G.NoneType.createInstance():s),s=G.ClassType.cloneAsInstance(G.ClassType.cloneForSpecialization(r,e,!0))}else s=G.UnknownType.create()}}Ce(e.suite,{type:s,isIncomplete:i},0)}finally{ce.delete(e.id)}}return s?{type:s,isIncomplete:i}:void 0}function rs(e){var t,n;if(Ie(e))return;const s=Me(e.iterableExpression),i=null!==(n=null===(t=Ze(s,!!e.isAsync,e.iterableExpression))||void 0===t?void 0:t.type)&&void 0!==n?n:G.UnknownType.create();ht(e.targetExpression,i,!!s.isIncomplete,e.targetExpression),Ce(e,{type:i,isIncomplete:!!s.isIncomplete},0)}function os(e){if((0,l.assert)(void 0!==e.typeExpression),Ie(e))return;const t=Me(e.typeExpression),n=t.type;function s(e,n){var s,i;if(e=mt(e),(0,G.isAnyOrUnknown)(e))return e;if((0,G.isInstantiableClass)(e))return G.ClassType.cloneAsInstance(e);if((0,G.isClassInstance)(e)){const a=null!==(i=null===(s=Ze({type:e,isIncomplete:t.isIncomplete},!1,n))||void 0===s?void 0:s.type)&&void 0!==i?i:G.UnknownType.create();return(0,W.mapSubtypes)(a,(e=>(0,G.isAnyOrUnknown)(e)?e:G.UnknownType.create()))}return G.UnknownType.create()}let i=(0,W.mapSubtypes)(n,(t=>{const n=(0,W.getSpecializedTupleType)(t);if(n&&n.tupleTypeArguments){const t=n.tupleTypeArguments.map((t=>s(t.type,e.typeExpression)));return(0,G.combineTypes)(t)}return s(t,e.typeExpression)}));e.isExceptGroup&&(i=Ds(e,"BaseExceptionGroup",[i])),e.name&&ht(e.name,i,!1,e.name),Ce(e,{type:i},0)}function ls(e){if(Ie(e))return;const t=Me(e.expression);let n=t.type;const s=e.parent&&58===e.parent.nodeType&&!!e.parent.isAsync;(0,W.isOptionalType)(n)&&(ct(T.getFileInfo(e).diagnosticRuleSet.reportOptionalContextManager,p.DiagnosticRule.reportOptionalContextManager,m.Localizer.Diagnostic.noneNotUsableWith(),e.expression),n=(0,G.removeNoneFromUnion)(n));const i=s?"__aenter__":"__enter__",a=(0,W.mapSubtypes)(n,(t=>{if(t=mt(t),(0,G.isAnyOrUnknown)(t))return t;const n=new c.DiagnosticAddendum;if((0,G.isClass)(t)){let a=dn(t,[],i,e.expression,void 0);if(a)return s&&(a=Ye(a,e.expression)),a;s||dn(t,[],"__aenter__",e.expression,void 0)&&n.addMessage(m.Localizer.DiagnosticAddendum.asyncHelp())}return ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeNotUsableWith().format({type:mi(t),method:i})+n.getString(),e.expression),G.UnknownType.create()})),r=s?"__aexit__":"__exit__";(0,W.doForEachSubtype)(n,(t=>{if(t=mt(t),!(0,G.isAnyOrUnknown)(t)){if((0,G.isClass)(t)){const n={type:G.AnyType.create()};if(dn(t,[n,n,n],r,e.expression,void 0))return}ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeNotUsableWith().format({type:mi(t),method:r}),e.expression)}})),e.target&&ht(e.target,a,!!t.isIncomplete,e.target),Ce(e,{type:a,isIncomplete:!!t.isIncomplete},0)}function cs(e){var t;if(Ie(e))return;let n;if(n=e.alias?e.alias:e.module.nameParts[0],!n)return;let s=null!==(t=ms(e,n.value))&&void 0!==t?t:G.UnknownType.create();const i=be(e,0);i&&(0,G.isModule)(i)&&s&&(0,G.isTypeSame)(s,i)&&(s=i),ut(n,s,!1,!1),Ce(e,{type:s},0)}function ps(t){var n;if(Ie(t))return;const s=t.alias||t.name,i=T.getFileInfo(t);if((null===(n=t.alias)||void 0===n?void 0:n.value)===t.name.value){const e=Fs(t,t.name.value,!0);e&&Tt(i,e.symbol,t)}let a=ms(t,s.value);if(!a){const n=t.parent;(0,l.assert)(n&&22===n.nodeType),(0,l.assert)(!n.isWildcardImport);const s=T.getImportInfo(n.module);if(s&&s.isImportFound&&!s.isNativeLib){const n=s.resolvedPaths[s.resolvedPaths.length-1],r=e(n);let o=!1;if(r){if(o=!0,i.executionEnvironment.pythonVersion>=u.PythonVersion.V3_7||i.isStubFile){const e=r.symbolTable.get("__getattr__");if(e){const t=Ls(e);(0,G.isFunction)(t)&&(a=Bs(t),o=!1)}}}else n||(o=!0);o&&ct(i.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.importSymbolUnknown().format({name:t.name.value}),t.name)}a||(a=G.UnknownType.create())}ut(s,a,!1,!1),Ce(t,{type:a},0)}function ds(e){if(Ie(e))return;if(!e.parent||63!==e.parent.nodeType)return void(0,l.fail)("Expected parent of case statement to be match statement");const t=T.getFileInfo(e),n=Me(e.parent.subjectExpression);let s=n.type;for(const n of e.parent.cases){if(n===e){"none"!==t.diagnosticRuleSet.reportUnnecessaryComparison&&(0,A.checkForUnusedPattern)(gi,e.pattern,s);break}n.guardExpression||(s=(0,A.narrowTypeBasedOnPattern)(gi,s,n.pattern,!1))}let i=!1;(0,W.doForEachSubtype)(mt(s),(e=>{(0,G.isClassInstance)(e)&&G.ClassType.isBuiltIn(e,"object")&&(i=!0)})),s=(0,A.narrowTypeBasedOnPattern)(gi,s,e.pattern,!0),(0,A.assignTypeToPatternTargets)(gi,s,!!n.isIncomplete,i,e.pattern),Ce(e,{type:s,isIncomplete:!!n.isIncomplete},0)}function us(e){if(Ie(e))return;const t=e.module.nameParts[0];let n=ms(e,t.value);if(!n)return;const s=be(e,0);s&&(0,G.isModule)(s)&&n&&(0,G.isTypeSame)(n,s)&&(n=s),ut(t,n,!1,!1),Ce(e,{type:n},0)}function ys(e){var t;if(3===(null===(t=e.parent)||void 0===t?void 0:t.nodeType))Un(e.parent);else{const t=Ve(e.typeAnnotation,{isVariableAnnotation:!0,allowFinal:P.isFinalAllowedForAssignmentTarget(e.valueExpression),allowClassVar:P.isClassVarAllowedForAssignmentTarget(e.valueExpression)});Ce(e.valueExpression,{type:t},0)}}function ms(e,t){const s=Fs(e,t,!0);if(!s)return;const i=s.symbol.getDeclarations().filter((t=>P.isNodeContainedWithin(e,t.node)&&8===t.type));let a=i.length>0?i[i.length-1]:void 0;if(a||(a=s.symbol.getDeclarations().find((e=>8===e.type))),!a)return;(0,l.assert)(8===a.type);const r=T.getFileInfo(e),o=Os(a,!0,r.isStubFile);if(o){if(!o.declaration)return n.evaluateUnknownImportsAsAny?G.AnyType.create():G.UnknownType.create();if(23===e.nodeType&&(o.isPrivate&&ct(r.diagnosticRuleSet.reportPrivateUsage,p.DiagnosticRule.reportPrivateUsage,m.Localizer.Diagnostic.privateUsedOutsideOfModule().format({name:e.name.value}),e.name),o.privatePyTypedImporter)){const t=new c.DiagnosticAddendum;o.privatePyTypedImported&&t.addMessage(m.Localizer.DiagnosticAddendum.privateImportFromPyTypedSource().format({module:o.privatePyTypedImported})),ct(r.diagnosticRuleSet.reportPrivateImportUsage,p.DiagnosticRule.reportPrivateImportUsage,m.Localizer.Diagnostic.privateImportFromPyTypedModule().format({name:e.name.value,module:o.privatePyTypedImporter})+t.getString(),e.name)}return Ms(s.symbol,a)}}function gs(e){var t,n,s,i,a,r;if(38===e.nodeType&&e.parent){if(28===e.parent.nodeType&&e.parent.name===e)return void Jn(e.parent);if(10===e.parent.nodeType&&e.parent.name===e)return void jn(e.parent);if(23===e.parent.nodeType)return void ps(e.parent);if(21===e.parent.nodeType)return void cs(e.parent);if(77===e.parent.nodeType&&e.parent.name===e)return void Bn(e.parent);if(29===e.parent.nodeType||39===e.parent.nodeType)return void Me(e,4);if(37===e.parent.nodeType)return}const o=P.getParentAnnotationNode(e);if(o){const e=o.parent;return(0,l.assert)(void 0!==e),3===e.nodeType?void(o===e.typeAnnotationComment?Ve(o,{isVariableAnnotation:!0,allowFinal:P.isFinalAllowedForAssignmentTarget(e.leftExpression),allowClassVar:P.isClassVarAllowedForAssignmentTarget(e.leftExpression)}):Un(e)):54===e.nodeType?void ys(e):28===e.nodeType&&o===e.returnTypeAnnotation?void Ve(o,{associateTypeVarsWithScope:!0}):void Ve(o,{isVariableAnnotation:54===(null===(t=o.parent)||void 0===t?void 0:t.nodeType),allowUnpackedTuple:41===e.nodeType&&1===e.category,allowUnpackedTypedDict:41===e.nodeType&&2===e.category})}const c=P.getParentNodeOfType(e,64);if(c){const t=c;if(P.isNodeContainedWithin(e,t.pattern))return void ds(t)}let p=e,d=0;for(;;){const e=P.getParentNodeOfType(p,1);if(e&&e!==p){if((0,l.assert)(void 0!==e.parent),9===e.parent.nodeType||24===e.parent.nodeType){p=e.parent;continue}if(10===e.parent.nodeType)return void jn(e.parent)}let t=p.parent;if(!t)break;if(4!==t.nodeType||p!==t.name){if(9===t.nodeType||35===t.nodeType){if(p===t.leftExpression){if(9===p.nodeType&&38===p.leftExpression.nodeType&&"super"===p.leftExpression.value){p=t;continue}d=2;break}}else if(24===t.nodeType){if(p===t.baseExpression){d=2;break}}else if(48===t.nodeType&&p===t.typeAnnotation){p=t;continue}if(!(0,g.isExpressionNode)(t))if(17===t.nodeType||16===t.nodeType||33===t.nodeType||34===t.nodeType)(0,l.assert)(void 0!==t.parent&&(0,g.isExpressionNode)(t.parent)),t=t.parent;else{if(41!==t.nodeType)break;if((0,l.assert)(void 0!==t.parent),30!==t.parent.nodeType)break;t=t.parent}p=t}else p=t}const u=p.parent;switch((0,l.assert)(void 0!==u),u.nodeType){case 14:return void ft(p);case 75:if(p===u.name&&76===(null===(n=u.parent)||void 0===n?void 0:n.nodeType)&&77===(null===(s=u.parent.parent)||void 0===s?void 0:s.nodeType))return void Bn(u.parent.parent);break;case 77:return void Bn(u);case 13:return void(10===(null===(i=u.parent)||void 0===i?void 0:i.nodeType)?jn(u.parent):28===(null===(a=u.parent)||void 0===a?void 0:a.nodeType)&&Jn(u.parent));case 41:if(p!==u.defaultValue)return void hs(u);break;case 1:if(p===u.name)return;if(10===(null===(r=u.parent)||void 0===r?void 0:r.nodeType))return void jn(u.parent);break;case 44:if(u.returnExpression){const t=P.getEnclosingFunction(e),n=t?Ws(t):void 0;return void Me(u.returnExpression,0,(0,W.makeInferenceContext)(n))}break;case 54:return void ys(u);case 3:return void Un(u)}54!==p.nodeType?Me(p,d):ys(p)}function hs(e){if(!e.name)return;const t=e.parent;if(30===t.nodeType)return void gs(t);(0,l.assert)(28===t.nodeType);const n=t,s=n.parameters.findIndex((t=>t===e)),i=P.getTypeAnnotationForParameter(n,s);if(i){const t=n.parameters[s],a=Le(i,n.parameters[s].category),r=ts(e,e.category,Xn(t,a));return void Ce(e.name,{type:r},0)}const a=P.getEnclosingClass(n,!0),r=a?jn(a):void 0;if(r&&G.ClassType.isPseudoGenericClass(null==r?void 0:r.classType)&&"__init__"===n.name.value){const t=Wn(e.name.value),n=r.classType.details.typeParameters.find((e=>e.details.name===t));if(n)return void Ce(e.name,{type:n},0)}const o=es(n,ns(n,!0),s,null==r?void 0:r.classType);Ce(e.name,{type:ts(e,e.category,null!=o?o:G.UnknownType.create())},0)}function fs(e){we(e);let t=e;for(;t;){switch(t.nodeType){case 3:if(!t.parent||3!==t.parent.nodeType&&4!==t.parent.nodeType&&5!==t.parent.nodeType||t.parent.rightExpression!==t)return void Un(t);break;case 77:return void Bn(t);case 4:return void Me(t);case 5:return void Gn(t);case 10:return void jn(t);case 41:return void hs(t);case 30:return void gs(t);case 28:return void Jn(t);case 26:return void rs(t);case 25:return void os(t);case 59:return void ls(t);case 33:{const e=t.parent;if((0,l.assert)(32===e.nodeType),t===e.expression)gs(e);else for(const n of e.forIfNodes)if(In(n),n===t)break;return}case 21:return void cs(t);case 23:return void ps(t);case 22:return void us(t);case 64:return void ds(t)}t=t.parent}(0,l.fail)("Unexpected statement")}function Ts(e,t){let n=_e(e);return n&&!n.typeResult.isIncomplete?n.typeResult:(t(),n=_e(e),n?n.typeResult:void 0)}function vs(e){let t=pe.get(e);return t||(t=hi.createCodeFlowAnalyzer(),pe.set(e,t)),t}function _s(e,t,n,s,i){var a;const r=(0,_.createKeyForReference)(e),o=P.getExecutionScopeNode(null!==(a=null==s?void 0:s.parent)&&void 0!==a?a:e),c=T.getCodeFlowExpressions(o);if(!c||!c.has(r)&&!c.has(_.wildcardImportReferenceKey))return{type:void 0,isIncomplete:!1};if(tt(e))return{type:void 0,isIncomplete:!0};let p;p=xe(o)?function(){const e=fe.length;return(0,l.assert)(e>0),fe[e-1].codeFlowAnalyzer}():vs(o.id);const d=T.getFlowNode(null!=s?s:e);return void 0===d?{type:void 0,isIncomplete:!1}:p.getTypeFromCodeFlow(d,e,t,n,i)}function Is(e,t,n,s){if(G.ClassType.isSpecialBuiltIn(e)){const i=e.aliasName||e.details.name;switch(i){case"Callable":return{type:Sn(t,s)};case"Never":return t&&t.length>0&&rt(m.Localizer.Diagnostic.typeArgsExpectingNone().format({name:"Never"}),t[0].node),{type:G.NeverType.createNever()};case"NoReturn":return t&&t.length>0&&rt(m.Localizer.Diagnostic.typeArgsExpectingNone().format({name:"NoReturn"}),t[0].node),{type:G.NeverType.createNoReturn()};case"Optional":return{type:xn(e,s,t,n)};case"Type":{if(1===(null==t?void 0:t.length)&&(0,G.isAnyOrUnknown)(t[0].type)&&ee&&(0,G.isInstantiableClass)(ee))return{type:ee};let n=Mn(e,t,1);return(0,G.isInstantiableClass)(n)&&(n=(0,W.explodeGenericClass)(n)),{type:n}}case"ClassVar":return{type:En(e,s,t,n)};case"Protocol":return{type:Mn(e,t,void 0,!0)};case"Tuple":return{type:Mn(e,t,void 0)};case"Union":return{type:Rn(e,s,t,n)};case"Generic":return{type:On(e,s,t,n)};case"Final":return{type:kn(e,s,t,n)};case"Annotated":return function(e,t){return t&&t.length<2&&rt(m.Localizer.Diagnostic.annotatedTypeArgMissing(),e),t&&0!==t.length?{type:G.TypeBase.cloneForAnnotated(t[0].type),isRequired:t[0].isRequired,isNotRequired:t[0].isNotRequired}:{type:G.AnyType.create()}}(s,t);case"Concatenate":return{type:wn(s,e,t)};case"TypeGuard":case"StrictTypeGuard":return{type:Pn(s,e,t,n)};case"Unpack":return{type:Nn(e,s,t,n)};case"Required":case"NotRequired":return function(e,t,n,s,i){if(!s&&0==(256&i))return{type:e};if(!s||1!==s.length)return rt(n?m.Localizer.Diagnostic.requiredArgCount():m.Localizer.Diagnostic.notRequiredArgCount(),t),{type:e};const a=s[0].type,r=P.getEnclosingClass(t,!0),o=r?jn(r):void 0;let l=!1;return o&&(0,G.isInstantiableClass)(o.classType)&&G.ClassType.isTypedDictClass(o.classType)&&P.isNodeContainedWithinNodeType(t,54)&&(l=!0),0!=(1048576&i)&&(l=!0),(s[0].isRequired||s[0].isNotRequired)&&(l=!1),l?{type:a,isRequired:n,isNotRequired:!n}:(rt(n?m.Localizer.Diagnostic.requiredNotInTypedDict():m.Localizer.Diagnostic.notRequiredNotInTypedDict(),t),{type:G.ClassType.cloneForSpecialization(e,[(0,W.convertToInstance)(a)],!!s)})}(e,s,"Required"===i,t,n);case"Self":return{type:An(e,s,t)};case"LiteralString":return{type:Mn(e,t,0)}}}const i=T.getFileInfo(s);if(i.isStubFile||i.executionEnvironment.pythonVersion>=u.PythonVersion.V3_9||(0,f.isAnnotationEvaluationPostponed)(T.getFileInfo(s))||0!=(4&n)){if(G.ClassType.isBuiltIn(e,"type")&&t){if(1===t.length&&(0,G.isAnyOrUnknown)(t[0].type))return{type:e};const n=Je(s,"Type");if(n&&(0,G.isInstantiableClass)(n)){let e=Mn(n,t,1,void 0,!0);return(0,G.isInstantiableClass)(e)&&(e=(0,W.explodeGenericClass)(e)),{type:e}}}if((0,W.isTupleClass)(e))return{type:Mn(e,t,void 0,void 0,!0)}}let a=t?t.length:0;const r=G.ClassType.isPseudoGenericClass(e)?[]:G.ClassType.getTypeParameters(e);if(0===r.length&&0===a)return{type:e};const o=r.findIndex((e=>(0,G.isVariadicTypeVar)(e)));if(t){let n=r.length;const l=r.findIndex((e=>!!e.details.defaultType));if(l>=0&&(n=l),t[0].inlinedTypeDict)return t.length>1&&ct(i.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeArgsTooMany().format({name:e.aliasName||e.details.name,expected:1,received:a}),t[1].node),{type:t[0].inlinedTypeDict};if(a>r.length){if(!G.ClassType.isPartiallyEvaluated(e)&&!G.ClassType.isTupleClass(e)){const n=T.getFileInfo(s);0===r.length?ct(n.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeArgsExpectingNone().format({name:e.aliasName||e.details.name}),t[r.length].node):1===r.length&&(0,G.isParamSpec)(r[0])||ct(n.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeArgsTooMany().format({name:e.aliasName||e.details.name,expected:r.length,received:a}),t[r.length].node),a=r.length}}else a<n&&ct(T.getFileInfo(s).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeArgsTooFew().format({name:e.aliasName||e.details.name,expected:n,received:a}),t.length>0?t[0].node.parent:s);t.forEach(((e,t)=>{if(t===o){if((0,G.isClassInstance)(e.type)&&(0,W.isTupleClass)(e.type))return;if((0,G.isVariadicTypeVar)(e.type))return void Ft(e.type,e.node)}const n=t<r.length?r[t]:void 0;Cn(e,{allowParamSpec:!0,allowTypeArgList:null==n?void 0:n.details.isParamSpec})}))}let l=[];const d=G.ClassType.getTypeParameters(e);if(1===d.length&&d[0].details.isParamSpec&&t)if(t.every((e=>!(0,W.isEllipsisType)(e.type)&&!e.typeList&&!(0,G.isParamSpec)(e.type))))1===t.length&&(0,G.isInstantiableClass)(t[0].type)&&G.ClassType.isBuiltIn(t[0].type,"Concatenate")||(t=[{type:G.UnknownType.create(),node:t[0].node,typeList:t}]);else if(t.length>1){const e=t.find((e=>(0,G.isParamSpec)(e.type)));e&&rt(m.Localizer.Diagnostic.paramSpecContext(),e.node);const n=t.find((e=>!!e.typeList));n&&rt(m.Localizer.Diagnostic.typeArgListNotAllowed(),n.node)}const y=new j.TypeVarContext(e.details.typeVarScopeId);return d.forEach(((e,n)=>{if(t&&n<t.length){if(e.details.isParamSpec){const s=t[n],i=G.FunctionType.createSynthesizedInstance("",65536);if(G.TypeBase.setSpecialForm(i),(0,W.isEllipsisType)(s.type))return G.FunctionType.addDefaultParameters(i),i.details.flags|=32768,l.push(i),void y.setTypeVarType(e,(0,W.convertTypeToParamSpecValue)(i));if(s.typeList)return s.typeList.forEach(((e,t)=>{G.FunctionType.addParameter(i,{category:0,name:`__p${t}`,isNameSynthesized:!0,type:(0,W.convertToInstance)(e.type),hasDeclaredType:!0})})),l.push(i),void y.setTypeVarType(e,(0,W.convertTypeToParamSpecValue)(i));if((0,G.isInstantiableClass)(s.type)&&G.ClassType.isBuiltIn(s.type,"Concatenate")){const e=s.type.typeArguments;return e&&e.length>0&&e.forEach(((t,n)=>{n===e.length-1?(0,G.isParamSpec)(t)&&(i.details.paramSpec=t):G.FunctionType.addParameter(i,{category:0,name:`__p${n}`,isNameSynthesized:!0,hasDeclaredType:!0,type:t})})),void l.push(i)}}const s=(0,W.convertToInstance)(t[n].type);return l.push(s),void y.setTypeVarType(e,s)}const s=(0,W.applySolvedTypeVars)(e,y,{unknownIfNotFound:!0});l.push(s),(0,G.isParamSpec)(e)?y.setTypeVarType(e,(0,W.convertTypeToParamSpecValue)(s)):y.setTypeVarType(e,s)})),l=l.map(((s,i)=>{if(i<a){const a=new c.DiagnosticAddendum;let o=function(e,t,n){if((0,G.isAnyOrUnknown)(t))return t;let s=(0,W.transformPossibleRecursiveTypeAlias)(t);if((0,G.isTypeVar)(t)){if((0,G.isTypeSame)(t,e))return t;s=mt(t)}if((0,G.isClass)(s)&&G.ClassType.isPartiallyEvaluated(s))return t;if(e.details.boundType&&!(0,W.isTypeAliasPlaceholder)(s)&&!Zs(e.details.boundType,s,n.createAddendum(),void 0,void 0))return void(e.details.isSynthesized||n.addMessage(m.Localizer.DiagnosticAddendum.typeBound().format({sourceType:mi(s),destType:mi(e.details.boundType),name:G.TypeVarType.getReadableName(e)})));if(e.details.isParamSpec)return(0,G.isParamSpec)(t)||(0,G.isFunction)(t)&&G.FunctionType.isParamSpecValue(t)||(0,G.isClassInstance)(t)&&G.ClassType.isBuiltIn(t,"Concatenate")?t:void n.addMessage(m.Localizer.DiagnosticAddendum.typeParamSpec().format({type:mi(t),name:G.TypeVarType.getReadableName(e)}));if((0,G.isTypeVar)(t)&&t.details.isParamSpec)return void n.addMessage(m.Localizer.Diagnostic.paramSpecContext());const i=e.details.constraints;if(0===i.length)return t;if((0,W.isTypeAliasPlaceholder)(t))return t;if((0,G.isTypeVar)(t)&&t.details.constraints.length>0){if(t.details.constraints.every((e=>i.some((t=>Zs(t,e))))))return t}else{let e;for(const t of i)Zs(t,s)&&(e&&!Zs(e,t)||(e=t));if(e)return e}n.addMessage(m.Localizer.DiagnosticAddendum.typeConstrainedTypeVar().format({type:mi(t),name:G.TypeVarType.getReadableName(e)}))}(r[i],s,a);if(o&&0!=(16384&n)){const t=r[i].details.declaredVariance;(0,W.isVarianceOfTypeArgumentCompatible)(o,t)||(a.addMessage(m.Localizer.DiagnosticAddendum.varianceMismatchForClass().format({typeVarName:mi(o),className:e.details.name})),o=void 0)}o?s=o:(0,G.isClassInstance)(s)&&G.ClassType.isPartiallyEvaluated(s)||ct(T.getFileInfo(t[i].node).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeVarAssignmentMismatch().format({type:mi(s),name:G.TypeVarType.getReadableName(r[i])})+a.getString(),t[i].node)}return s})),t&&0===e.details.typeParameters.length&&G.ClassType.isPartiallyEvaluated(e)&&(l=t.map((e=>(0,W.convertToInstance)(e.type)))),{type:G.ClassType.cloneForSpecialization(e,l,void 0!==t)}}function bs(e){return e.typeResult?{type:e.typeResult.type,isIncomplete:e.typeResult.isIncomplete}:e.valueExpression?Me(e.valueExpression):{type:G.UnknownType.create()}}function Cs(e){return e.typeResult?{type:e.typeResult.type,isIncomplete:e.typeResult.isIncomplete}:Ss(e.valueExpression)}function Ss(e,t){let n=131208;return T.getFileInfo(e).isStubFile?n|=4:n|=4194304,(null==t?void 0:t.allowFinal)||(n|=16),(null==t?void 0:t.allowRequired)&&(n|=1048832),(null==t?void 0:t.allowUnpackedTuple)?n|=2097152:n|=64,(null==t?void 0:t.allowParamSpec)||(n|=32),Me(e,n)}function xs(e,t){const n=w.getScopeForNode(e);if(n){const e=w.getBuiltInScope(n).lookUpSymbol(t);if(e)return Ls(e)}return G.UnknownType.create()}function Ds(e,t,n){const s=xs(e,t);if((0,G.isInstantiableClass)(s)){let e=s;return n&&(e=G.ClassType.cloneForSpecialization(e,n,void 0!==n)),G.ClassType.cloneAsInstance(e)}return s}function Fs(e,t,n,s=!1){var i;const a=w.getScopeForNode(e);let r=null==a?void 0:a.lookUpSymbolRecursive(t);const o=null!==(i=null==a?void 0:a.type)&&void 0!==i?i:3;if(r&&n&&1!==o&&0!==o&&!r.symbol.getDeclarations().find((t=>{if(8!==t.type&&0!==t.type){const n=P.getExecutionScopeNode(e),s=6===t.type||5===t.type||4===t.type?t.node.name:t.node;if(n===P.getExecutionScopeNode(s)&&!it(s,e)){const t=T.getFlowNode(e);return!(t&&hi.isFlowNodeReachable(t,void 0,!0))}}return!0})))if(1!==r.scope.type){let e=r.scope.parent;const n=r.isOutsideCallerModule||3===r.scope.type;let s=r.isBeyondExecutionScope||r.scope.isIndependentlyExecutable();if(2===r.scope.type){const t=r.scope.getGlobalScope();e=t.scope,t.isBeyondExecutionScope&&(s=!0)}r=e?e.lookUpSymbolRecursive(t,n,s):void 0}else r=void 0;if(r&&s){let e=r;for(;3!==e.scope.type&&4!==e.scope.type&&e.scope.parent&&(e=e.scope.parent.lookUpSymbolRecursive(t,e.isOutsideCallerModule,e.isBeyondExecutionScope||e.scope.isIndependentlyExecutable()),e););3!==(null==e?void 0:e.scope.type)&&4!==(null==e?void 0:e.scope.type)||(r=e)}return r}function Es(e,t){Y.push(e);try{const e=t();return Y.pop(),e}catch(e){throw Y.pop(),e}}function Ps(e,t,n=!0){a.enterSpeculativeContext(e,n);try{const e=t();return a.leaveSpeculativeContext(),e}catch(e){throw a.leaveSpeculativeContext(),e}}function As(e,t){if((0,G.isFunction)(e)&&e.details.declaration){const n=e.details.declaration;if(5===n.type){const e=n.node,s=T.getScope(e);if(s){const e=s.lookUpSymbol(t);if(e)return e.getDeclarations().find((e=>2===e.type))}}}}function Ns(e){if(e.parent&&23===e.parent.nodeType&&e.parent.alias&&e===e.parent.name)return e.parent.alias}function ks(e){var t,n,s;switch(e.type){case 0:{if("Any"===e.intrinsicType)return{type:G.AnyType.create()};if("class"===e.intrinsicType){const t=jn(P.getEnclosingClass(e.node));return{type:null==t?void 0:t.classType}}const t=Ds(e.node,"str"),n=Ds(e.node,"int");if((0,G.isClassInstance)(n)&&(0,G.isClassInstance)(t)){if("str"===e.intrinsicType)return{type:t};if("str | None"===e.intrinsicType)return{type:(0,G.combineTypes)([t,G.NoneType.createInstance()])};if("int"===e.intrinsicType)return{type:n};if("Iterable[str]"===e.intrinsicType){const n=xs(e.node,"Iterable");if((0,G.isInstantiableClass)(n))return{type:G.ClassType.cloneAsInstance(G.ClassType.cloneForSpecialization(n,[t],!0))}}if("Dict[str, Any]"===e.intrinsicType){const n=xs(e.node,"dict");if((0,G.isInstantiableClass)(n))return{type:G.ClassType.cloneAsInstance(G.ClassType.cloneForSpecialization(n,[t,G.AnyType.create()],!0))}}}return{type:G.UnknownType.create()}}case 6:{const t=jn(e.node);return{type:null==t?void 0:t.decoratedType}}case 7:return{type:Ve(e.node.typeAnnotation)};case 5:{const t=Jn(e.node);return{type:null==t?void 0:t.decoratedType}}case 4:return{type:Bn(e.node)};case 2:{let n=e.node.typeAnnotation||e.node.typeAnnotationComment;if(!n&&28===(null===(t=e.node.parent)||void 0===t?void 0:t.nodeType)){const t=e.node.parent;if(t.functionAnnotationComment&&!t.functionAnnotationComment.isParamListEllipsis){const s=t.parameters.findIndex((t=>t===e.node));n=P.getTypeAnnotationForParameter(t,s)}}if(n){const t=Le(n,e.node.category);return{type:ts(e.node,e.node.category,Xn(e.node,t))}}return{type:void 0}}case 3:return{type:ws(e.node)};case 1:{const t=e.typeAnnotationNode;if(t){let i;if(e.isRuntimeTypeExpression)i=(0,W.convertToInstance)(Ss(t,{allowFinal:!0,allowRequired:!0}).type);else{const s=e.isDefinedByMemberAccess&&35===(null===(n=e.node.parent)||void 0===n?void 0:n.nodeType)?e.node.parent:e.node;i=Ve(t,{isVariableAnnotation:!0,allowClassVar:P.isClassVarAllowedForAssignmentTarget(s),allowFinal:P.isFinalAllowedForAssignmentTarget(s),allowRequired:P.isRequiredAllowedForAssignmentTarget(s)})}if(i)return 38===e.node.nodeType&&(i=null!==(s=(0,x.transformTypeForPossibleEnumClass)(gi,e.node,(()=>i)))&&void 0!==s?s:i),(0,G.isClassInstance)(i)&&G.ClassType.isBuiltIn(i,"TypeAlias")?{type:void 0,isTypeAlias:!0}:{type:i}}return{type:void 0}}case 8:return{type:void 0}}}function ws(e){const t=be(e.name,0);if(t&&(0,G.isTypeVar)(t))return t;let n=G.TypeVarType.createInstantiable(e.name.value);if(n.details.isTypeParamSyntax=!0,e.typeParamCategory===g.TypeParameterCategory.TypeVarTuple?n.details.isVariadic=!0:e.typeParamCategory===g.TypeParameterCategory.ParamSpec&&(n.details.isParamSpec=!0),Ce(e,{type:n},void 0),Ce(e.name,{type:n},void 0),e.boundExpression)if(52===e.boundExpression.nodeType){const t=e.boundExpression.expressions.map((e=>{const t=Ss(e).type;return(0,W.requiresSpecialization)(t,!0)&&rt(m.Localizer.Diagnostic.typeVarBoundGeneric(),e),(0,W.convertToInstance)(t)}));t.length<2?ct(T.getFileInfo(e.boundExpression).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeVarSingleConstraint(),e.boundExpression):e.typeParamCategory===g.TypeParameterCategory.TypeVar&&(n.details.constraints=t)}else{const t=Ss(e.boundExpression).type;(0,W.requiresSpecialization)(t,!0)&&rt(m.Localizer.Diagnostic.typeVarConstraintGeneric(),e.boundExpression),e.typeParamCategory===g.TypeParameterCategory.TypeVar&&(n.details.boundType=(0,W.convertToInstance)(t))}if(e.defaultExpression&&(e.typeParamCategory===g.TypeParameterCategory.ParamSpec?n.details.defaultType=sn(e.defaultExpression):e.typeParamCategory===g.TypeParameterCategory.TypeVarTuple?n.details.defaultType=nn(e.defaultExpression):n.details.defaultType=(0,W.convertToInstance)(Ss(e.defaultExpression).type)),n.details.defaultType&&e.defaultExpression){const t=new j.TypeVarContext(G.WildcardTypeVarScopeId),s=(0,W.applySolvedTypeVars)(n.details.defaultType,t,{unknownIfNotFound:!0});n.details.boundType?Zs(n.details.boundType,s)||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeVarDefaultBoundMismatch(),e.defaultExpression):n.details.constraints.length>0&&(n.details.constraints.some((e=>(0,G.isTypeSame)(e,s)))||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeVarDefaultConstraintMismatch(),e.defaultExpression))}const s=P.getTypeVarScopeNode(e);if(s){let e;10===s.nodeType?(e=0,n.details.declaredVariance=0):28===s.nodeType?e=1:((0,l.assert)(77===s.nodeType),e=2),n=G.TypeVarType.cloneForScopeId(n,bt(77===s.nodeType?s.name:s),s.name.value,e)}return n}function Ms(t,s){var i,a,r;const o=Rs(s,!0,T.getFileInfo(s.node).isStubFile);if(!o)return n.evaluateUnknownImportsAsAny?G.AnyType.create():G.UnknownType.create();function l(e,t,s){if(t.path&&t.loadSymbolsFromPath){const i=s(t.path);i?(e.fields=i.symbolTable,e.docString=i.docString):e.notPresentFieldType=n.evaluateUnknownImportsAsAny?G.AnyType.create():G.UnknownType.create()}return t.implicitImports&&t.implicitImports.forEach(((t,n)=>{let i;if(t.isUnresolved)i=G.UnknownType.create();else{const a=e.moduleName?e.moduleName+"."+n:"";i=l(G.ModuleType.create(a,t.path),t,s)}const a=R.Symbol.createWithType(0,i);e.loaderFields.set(n,a)})),e}if(8===o.type){let t=o.moduleName;if(8===s.type&&(s.symbolName&&(t+="."+s.symbolName),t.startsWith("."))){const e=T.getFileInfo(s.node).moduleName.split(".");for(t=t.substr(1);t.startsWith(".")&&e.length>0;)t=t.substr(1),e.pop();t=e.join(".")+"."+t}const n=G.ModuleType.create(t,o.path);return o.symbolName&&o.submoduleFallback?l(n,o.submoduleFallback,e):l(n,o,e)}const c=ks(o);if(c.type)return c.type;const p=T.getFileInfo(o.node);let d=!p.isInPyTypedPackage||p.isStubFile;if(!d&&1===o.type){const e=P.getEnclosingClass(o.node,!0);if(e){const t=jn(e);t&&G.ClassType.isEnumClass(t.classType)&&(d=!0)}if((ci(o)||o.isConstant)&&(d=!0),9===(null===(i=o.inferredTypeSource)||void 0===i?void 0:i.nodeType)){const e=Me(o.inferredTypeSource.leftExpression,2).type,t=["TypeVar","ParamSpec","TypeVarTuple","TypedDict","NamedTuple","NewType"];((0,G.isInstantiableClass)(e)&&G.ClassType.isBuiltIn(e,t)||(0,G.isFunction)(e)&&t.some((t=>e.details.builtInName===t)))&&(d=!0)}}if(2===o.type)return null===(a=Ts(o.node.name,(()=>{hs(o.node)})))||void 0===a?void 0:a.type;if(1===o.type&&o.inferredTypeSource){const e=pi(o)||zn(o),n=e&&o.inferredTypeSource.parent?o.inferredTypeSource.parent:o.inferredTypeSource;let i=null===(r=Ts(o.node,(()=>{fs(n)})))||void 0===r?void 0:r.type;if(i&&38===o.node.nodeType){const e=(0,x.transformTypeForPossibleEnumClass)(gi,o.node,(()=>{var e,t;return null!==(t=null===(e=Ts(o.inferredTypeSource,(()=>{fs(o.inferredTypeSource)})))||void 0===e?void 0:e.type)&&void 0!==t?t:G.UnknownType.create()}));e&&(i=e)}return i&&e&&o.typeAliasName&&(!G.TypeBase.isInstantiable(i)||(0,G.isUnknown)(i)||(0,W.isEllipsisType)(i)||(i=Ln(i,o.typeAliasName,o.node),d=!0)),i&&p.isInPyTypedPackage&&!p.isStubFile&&(d||function(e,t,n){var s;const i=e.getDeclarations().filter((e=>1!==e.type||!e.isInferenceAllowedInPyTyped));if(i.length>1)return!1;if(1!==t.type)return!1;if(0===i.length)return!0;if((0,G.isTypeVar)(n))return!0;let a;const r=t.node.parent;if(r&&(3===r.nodeType?a=r:35===r.nodeType&&3===(null===(s=r.parent)||void 0===s?void 0:s.nodeType)&&(a=r.parent)),!a)return!1;const o=Me(a.rightExpression).type;return!(!(0,G.isClassInstance)(o)||!(0,W.isLiteralType)(o))||38===a.rightExpression.nodeType&&!G.TypeBase.isAmbiguous(o)}(t,s,i)&&(d=!0),d||(i=G.TypeBase.cloneForAmbiguousType(i))),i}}function Rs(t,n,s=!1){var i;return null===(i=(0,S.resolveAliasDeclaration)(e,t,n,s))||void 0===i?void 0:i.declaration}function Os(t,n,s=!1){return(0,S.resolveAliasDeclaration)(e,t,n,s)}function Ls(e){return Vs(e).type}function Vs(e,t,n=!1){var s,i;let r;if(e.hasTypedDeclarations()){r=Us(e,t);const n=null==r?void 0:r.type,s=!!r.isTypeAlias;if(n||!s){let t=!1;n&&((0,G.isFunction)(n)&&G.FunctionType.isPartiallyEvaluated(n)||(0,G.isClass)(n)&&G.ClassType.isPartiallyEvaluated(n))&&(t=!0);const s=e.getTypedDeclarations();return{type:null!=n?n:G.UnknownType.create(),isIncomplete:t,includesVariableDecl:s.some((e=>1===e.type)),includesIllegalTypeAliasDecl:!s.every((e=>di(e))),isRecursiveDefinition:!n}}}let o=ue.get(e.id);const l=t?t.id:void 0,c=`${void 0===l?".":l.toString()}${n?"*":""}`;if(o){const e=o.get(c);if(e&&!e.isIncomplete)return e}const p=[],d=e.getDeclarations();let u,y=!1,m=!1,g=!1,h=!1;if(d.length>64){const e={type:G.UnknownType.create(),isIncomplete:!1,includesVariableDecl:!1,includesIllegalTypeAliasDecl:!d.every((e=>di(e))),isRecursiveDefinition:!1};return v(e),e}if(n)d.forEach(((e,t)=>{e.isInExceptSuite||(u=t)}));else if(d.length>1&&d.every((e=>8===e.type))){const e=d.filter((e=>8===e.type&&!e.isInExceptSuite));1===e.length&&(u=d.findIndex((t=>t===e[0])))}let f=!1;if(d.forEach(((n,s)=>{var i,r,o;let l=void 0===u||s===u;if(f&&(l=!1),e.isClassVar()&&1===n.type&&n.isDefinedByMemberAccess&&(l=!1),void 0!==t&&8!==n.type&&P.getExecutionScopeNode(t)===P.getExecutionScopeNode(n.node)&&(it(n.node,t)||(l=!1)),l){const t=null!==(i=Rs(n,!0,T.getFileInfo(n.node).isStubFile))&&void 0!==i?i:n,s=pi(n),l=s||zn(n);if(s&&(f=!0),l&&1===t.type&&3===(null===(o=null===(r=t.inferredTypeSource)||void 0===r?void 0:r.parent)||void 0===o?void 0:o.nodeType)&&Un(t.inferredTypeSource.parent),Fe(e,n))try{let i=Ms(e,n);if(Ee(e)||(y=!0),i){if(1===t.type){T.getFileInfo(t.node).isTypingStubFile||(g=!0);let e=!1;1===t.type&&(t.isConstant||ci(t))&&(e=!0),(0,G.isClassInstance)(i)&&G.ClassType.isEnumClass(i)&&(0,x.isDeclInEnumClass)(gi,t)&&(e=!0),!G.TypeBase.isInstance(i)||s||e||(i=Oe(i))}p.push(i),a.isSpeculative(n.node)&&(h=!0)}else y=!0}catch(t){throw Ee(e),t}else{if(6===t.type){const e=jn(t.node);(null==e?void 0:e.decoratedType)&&p.push(e.decoratedType)}y=!0,m=!0}}})),p.length>0){const e=(null!==(i=null===(s=null==o?void 0:o.get(c))||void 0===s?void 0:s.evaluationAttempts)&&void 0!==i?i:0)+1;y=m&&e<16;const t={type:(0,G.combineTypes)(p),isIncomplete:y,includesVariableDecl:g,includesIllegalTypeAliasDecl:!d.every((e=>di(e))),isRecursiveDefinition:!1,evaluationAttempts:e};return h||v(t),t}return{type:G.UnboundType.create(),isIncomplete:y,includesVariableDecl:g,includesIllegalTypeAliasDecl:!d.every((e=>di(e))),isRecursiveDefinition:!1};function v(t){o||(o=new Map,ue.set(e.id,o)),o.set(c,t)}}function Us(e,t){const n=e.getSynthesizedType();if(n)return{type:n};let s=e.getTypedDeclarations();if(0===s.length)return{type:void 0};if(t&&s.length>1){const e=s.filter((e=>!(8!==e.type&&P.getExecutionScopeNode(t)===P.getExecutionScopeNode(e.node)&&!it(e.node,t,!1))));if(0===e.length)return{type:G.UnboundType.create()};s=e}let i=s.length-1;for(;i>=0;){const t=s[i],n=Ae(e,t);if(n)return{type:n};if(De(e,t)<0&&Fe(e,t))try{const n=ks(t);if(Ee(e)||6===t.type)return n}catch(t){throw Ee(e),t}i--}return{type:void 0}}function zs(e){(0,G.isFunction)(e)?Bs(e):(0,G.isOverloadedFunction)(e)&&e.overloads.forEach((e=>{Bs(e)}))}function Bs(e,t,n=!0){const s=G.FunctionType.getSpecializedReturnType(e);return s?Jt(s):n?Gs(e,t):G.UnknownType.create()}function Gs(e,t){var n;let s,i=!1,r=!0;if(G.FunctionType.isStubDefinition(e))return G.UnknownType.create();if(G.FunctionType.isOverloaded(e)&&!G.FunctionType.isSynthesizedMethod(e))return G.UnknownType.create();if(e.inferredReturnType)s=e.inferredReturnType;else{if(G.FunctionType.isInstanceMethod(e)&&"__init__"===e.details.name)s=G.NoneType.createInstance();else if(e.details.declaration){const t=e.details.declaration.node;if(r=T.getFileInfo(t).diagnosticRuleSet.analyzeUnannotatedFunctions,r&&!tt(t.suite)){const r=T.getCodeFlowComplexity(t);if(e.details.parameters.length<=1||e.details.parameters.some((e=>e.hasDeclaredType))||r<32){let r;!function(n){const s=a.disableSpeculativeMode();try{r=as(t,G.FunctionType.isAbstractMethod(e)),a.enableSpeculativeMode(s)}catch(e){throw a.enableSpeculativeMode(s),e}}(),s=null==r?void 0:r.type,(null==r?void 0:r.isIncomplete)&&(i=!0),s&&G.FunctionType.isWrapReturnTypeInAwait(e)&&(s=is(t,s,!!(null===(n=e.details.declaration)||void 0===n?void 0:n.isGenerator)))}}}s||(s=G.UnknownType.create()),i||(e.inferredReturnType=s)}if(!i&&r&&(0,W.isPartlyUnknown)(s)&&G.FunctionType.hasUnannotatedParams(e)&&!G.FunctionType.isStubDefinition(e)&&!G.FunctionType.isPyTypedDefinition(e)&&t){const n=function(e,t){var n;let s;if(!e.details.declaration)return;const i=e.details.declaration.node;if(T.getCodeFlowComplexity(i)>=8)return;if(t.some((e=>!e.paramName)))return;if(fe.some((e=>e.functionNode===i)))return;const a=Jn(i);if(!a)return;if(t.length>6)return;if(fe.length>=2)return;const r=[];let o=!1;return Es(i,(()=>{var n,l;const c=Te;fe.push({functionNode:i,codeFlowAnalyzer:hi.createCodeFlowAnalyzer()});try{Te=new Map;let p=!0;if(i.parameters.forEach(((e,n)=>{if(e.name){let s;const o=t.find((t=>e.name.value===t.paramName));o&&o.argument.valueExpression?(s=Me(o.argument.valueExpression).type,(0,G.isUnknown)(s)||(p=!1)):e.defaultValue?(s=Me(e.defaultValue).type,(0,G.isUnknown)(s)||(p=!1)):0===n&&(G.FunctionType.isInstanceMethod(a.functionType)||G.FunctionType.isClassMethod(a.functionType))&&a.functionType.details.parameters.length>0&&i.parameters[0].name&&(s=a.functionType.details.parameters[0].type),s||(s=G.UnknownType.create()),r.push(s),Ce(e.name,{type:s},0)}})),!p){const t=null===(n=a.functionType.callSiteReturnTypeCache)||void 0===n?void 0:n.find((e=>e.paramTypes.length===r.length&&e.paramTypes.every(((e,t)=>(0,G.isTypeSame)(e,r[t])))));t?(s=t.returnType,o=!0):s=null===(l=as(i,G.FunctionType.isAbstractMethod(e)))||void 0===l?void 0:l.type}}finally{fe.pop(),Te=c}})),s?(s=(0,G.removeUnbound)(s),G.FunctionType.isWrapReturnTypeInAwait(e)&&!(0,G.isNever)(s)&&(s=is(i,s,!!(null===(n=e.details.declaration)||void 0===n?void 0:n.isGenerator))),o||(a.functionType.callSiteReturnTypeCache||(a.functionType.callSiteReturnTypeCache=[]),a.functionType.callSiteReturnTypeCache.length>=8&&(a.functionType.callSiteReturnTypeCache=a.functionType.callSiteReturnTypeCache.slice(1)),a.functionType.callSiteReturnTypeCache.push({paramTypes:r,returnType:s})),s):void 0}(e,t);n&&(s=n)}return s}function Ws(e){const t=Jn(e);return t?G.FunctionType.isAbstractMethod(t.functionType)?G.AnyType.create():G.FunctionType.isGenerator(t.functionType)?(0,W.getDeclaredGeneratorReturnType)(t.functionType):t.functionType.details.declaredReturnType:G.AnyType.create()}function js(e){return(0,G.isInstantiableClass)(e.classType)?(0,W.partiallySpecializeType)(Ls(e.symbol),e.classType,void 0,null!=ee?ee:G.UnknownType.create()):G.UnknownType.create()}function $s(e,t){if((0,G.isInstantiableClass)(e.classType)){const n=Vs(e.symbol);if(n)return zs(n.type),{type:(0,W.partiallySpecializeType)(n.type,e.classType,t),isIncomplete:!!n.isIncomplete}}}function qs(e,t,n,s,i,a,r,o){if(G.ClassType.isHierarchyPartiallyEvaluated(e)||G.ClassType.isHierarchyPartiallyEvaluated(t))return!0;if(G.ClassType.isTypedDictClass(e)&&G.ClassType.isTypedDictClass(t)&&!G.ClassType.isSameGenericClass(e,t))return!!(0,U.assignTypedDictToTypedDict)(gi,e,t,n,s,a,r)&&(G.ClassType.isFinal(e)!==G.ClassType.isFinal(t)?(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.typedDictFinalMismatch().format({sourceType:mi((0,W.convertToInstance)(t)),destType:mi((0,W.convertToInstance)(e))})),!1):0==(1&a)||(0,U.assignTypedDictToTypedDict)(gi,t,e,void 0,void 0,a,r));const c=H.get(e.details.fullName);if(c&&c.some((e=>t.details.mro.some((t=>(0,G.isClass)(t)&&e===t.details.fullName))))&&0==(1&a))return!0;const p=[],d=G.ClassType.isDerivedFrom(t,e,p);if(G.ClassType.isProtocolClass(e)&&!d)return!!(0,k.assignClassToProtocol)(gi,e,t,null==n?void 0:n.createAddendum(),s,i,a,!1,r)||(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.protocolIncompatible().format({sourceType:mi((0,W.convertToInstance)(t)),destType:mi((0,W.convertToInstance)(e))})),!1);if((0==(1&a)||G.ClassType.isSameGenericClass(t,e))&&d&&((0,l.assert)(p.length>0),function(e,t,n,s,i,a,r,o){let l=t,c=i,p=r;qn(e),p|=8,i?p|=8:(c=new j.TypeVarContext((0,W.getTypeVarScopeId)(e)),p&=-9);for(let t=n.length-1;t>=0;t--){const i=n[t],a=new j.TypeVarContext((0,W.getTypeVarScopeId)(l));if((0,G.isUnknown)(i))return!0;if(G.ClassType.isBuiltIn(i,"object"))return!0;if(t<n.length-1&&(l=(0,W.specializeForBaseClass)(l,i)),0===t&&e.tupleTypeArguments&&l.tupleTypeArguments)return Hs(e,l,s,c,r,o);if(0!==G.ClassType.getTypeParameters(i).length){if(!i.typeArguments)return!0;if(!Ys(i,l,s,c,a,p,o))return!1;c=new j.TypeVarContext((0,W.getTypeVarScopeId)(i)),p&=-9}}if(e.typeArguments){if(!Ys(e,l,s,i,a,r,o))return!1}else if(i&&e.details.typeParameters.length>0&&l.typeArguments&&!i.isLocked()){const t=l.typeArguments;for(let n=0;n<e.details.typeParameters.length;n++){const s=n<t.length?t[n]:G.UnknownType.create();i.setTypeVarType(e.details.typeParameters[n],void 0,void 0,s)}}return!0}(e,t,p,null==n?void 0:n.createAddendum(),s,i,a,r)))return!0;if(G.ClassType.isBuiltIn(e,"object")&&0==(1&a))return!0;const u=o?G.ClassType.cloneAsInstance(e):e,y=o?G.ClassType.cloneAsInstance(t):t;let g=mi(u),h=mi(y);return g===h&&e.details.fullName&&t.details.fullName&&(g=e.details.fullName,h=t.details.fullName),null==n||n.addMessage(m.Localizer.DiagnosticAddendum.typeIncompatible().format({sourceType:h,destType:g})),!1}function Ks(e,t,n=!0,s=0){(0,l.assert)(G.ClassType.isSameGenericClass(e,t)),(0,l.assert)(e.details.typeParameters.length>0);const i=new c.DiagnosticAddendum,a=new j.TypeVarContext;let r=!0;return e.details.fields.forEach(((n,o)=>{var c;if(r&&n.isClassMember()&&!n.isIgnoredForProtocolMatch()){const p=(0,W.lookUpClassMember)(t,o);(0,l.assert)(void 0!==p);let d=null===(c=Us(n))||void 0===c?void 0:c.type;if(d){const o=js(p);if(d=(0,W.partiallySpecializeType)(d,e),(0,G.isClassInstance)(d)&&G.ClassType.isPropertyClass(d)&&(0,G.isClassInstance)(o)&&G.ClassType.isPropertyClass(o))(0,N.assignProperty)(gi,G.ClassType.cloneAsInstantiable(d),G.ClassType.cloneAsInstantiable(o),e,t,i,a,void 0,s)||(r=!1);else{const e=n.getDeclarations()[0],t=1!==(null==e?void 0:e.type)||ci(e)?0:1;Zs(d,o,i,a,void 0,t,s)||(r=!1)}}}})),e.details.baseClasses.forEach((i=>{if((0,G.isInstantiableClass)(i)&&!G.ClassType.isBuiltIn(i,"object")&&!G.ClassType.isBuiltIn(i,"Protocol")&&!G.ClassType.isBuiltIn(i,"Generic")&&i.details.typeParameters.length>0){const a=(0,W.specializeForBaseClass)(e,i),o=(0,W.specializeForBaseClass)(t,i);n||a.details.typeParameters.forEach(((e,t)=>{if(!e.details.isParamSpec&&!e.details.isVariadic&&!e.details.isSynthesized&&o.typeArguments&&t<o.typeArguments.length&&a.typeArguments&&t<a.typeArguments.length){const n=e.details.declaredVariance;(0,G.isTypeVar)(o.typeArguments[t])?2!==n&&4!==n||(r=!1):(0,G.isTypeVar)(a.typeArguments[t])&&(2!==n&&3!==n||(r=!1))}})),r&&!Ks(a,o,n,s)&&(r=!1)}})),r}function Hs(e,t,n,s,i,a){var r,o;const l=[...null!==(r=e.tupleTypeArguments)&&void 0!==r?r:[]],c=[...null!==(o=t.tupleTypeArguments)&&void 0!==o?o:[]],p=l.findIndex((e=>(0,G.isVariadicTypeVar)(e.type))),d=l.findIndex((e=>e.isUnbounded)),u=c.findIndex((e=>e.isUnbounded));if(u>=0){const e=c.length>0?c[u].type:G.AnyType.create();for(;c.length<l.length;)c.splice(u,0,{type:e,isUnbounded:!0})}if(d>=0||p>=0){const e=c.length-l.length+1;if(e>=0)if(p>=0){if(ne&&(0,G.isInstantiableClass)(ne)){const t=c.splice(p,e),n=(0,W.convertToInstance)((0,W.specializeTupleClass)(ne,t.map((e=>({type:e.type,isUnbounded:e.isUnbounded}))),!0,!0));c.splice(p,0,{type:n,isUnbounded:!1})}}else{const t=c.splice(d,e).map((e=>(0,G.isTypeVar)(e.type)&&(0,G.isUnpackedVariadicTypeVar)(e.type)&&!e.type.isVariadicInUnion?G.TypeVarType.cloneForUnpacked(e.type,!0):e.type));c.splice(d,0,{type:t.length>0?(0,G.combineTypes)(t):G.AnyType.create(),isUnbounded:!1})}}if(c.length===l.length)for(let e=0;e<c.length;e++){const t=null==n?void 0:n.createAddendum();if(!Zs(l[e].type,c[e].type,null==t?void 0:t.createAddendum(),s,void 0,i,a))return t&&t.addMessage(m.Localizer.DiagnosticAddendum.tupleEntryTypeMismatch().format({entry:e+1})),!1}else if(u<0)return null==n||n.addMessage(m.Localizer.DiagnosticAddendum.tupleSizeMismatch().format({expected:l.length,received:c.length})),!1;return!0}function Ys(e,t,n,s,i,a,r){var o,p,d;(0,l.assert)(G.ClassType.isSameGenericClass(e,t)),qn(e);const u=G.ClassType.getTypeParameters(e);let y,g;if(!e.typeArguments||!t.typeArguments)return!0;if(G.ClassType.isTupleClass(e)?(y=null!==(p=null===(o=e.tupleTypeArguments)||void 0===o?void 0:o.map((e=>e.type)))&&void 0!==p?p:[],g=null===(d=t.tupleTypeArguments)||void 0===d?void 0:d.map((e=>e.type))):(y=e.typeArguments,g=t.typeArguments),g)for(let t=0;t<g.length;t++){const o=g[t],l=t>=y.length?y.length-1:t,p=l>=0?y[l]:G.UnknownType.create(),d=l<u.length?u[l]:void 0,h=new c.DiagnosticAddendum;if(d&&3!==G.TypeVarType.getVariance(d)){if(4===G.TypeVarType.getVariance(d)){if(!Zs(o,p,h,i,s,2^a|128,r)){if(n){const e=n.createAddendum();e.addMessage(m.Localizer.DiagnosticAddendum.typeVarIsContravariant().format({name:G.TypeVarType.getReadableName(d)})),e.addAddendum(h)}return!1}}else if(!Zs(p,o,h,s,i,1|a,r)&&!G.ClassType.isPseudoGenericClass(e)){if(n){const e=n.createAddendum();e.addMessage(m.Localizer.DiagnosticAddendum.typeVarIsInvariant().format({name:G.TypeVarType.getReadableName(d)})),e.addAddendum(h)}return!1}}else if(!Zs(p,o,h,s,i,128|a,r)){if(n)if(d){const e=n.createAddendum();e.addMessage(m.Localizer.DiagnosticAddendum.typeVarIsCovariant().format({name:G.TypeVarType.getReadableName(d)})),e.addAddendum(h)}else n.addAddendum(h);return!1}}return!0}function Zs(e,t,n,s,i,a=0,r=0){var c,p;if(e===t&&!(0,W.requiresSpecialization)(e))return!0;if(r>G.maxTypeRecursionCount)return!0;if(r++,(0,G.isTypeVar)(e)&&e.details.recursiveTypeAliasScopeId&&(0,G.isTypeVar)(t)&&t.details.recursiveTypeAliasScopeId){if((null===(c=e.typeAliasInfo)||void 0===c?void 0:c.typeArguments)&&(null===(p=t.typeAliasInfo)||void 0===p?void 0:p.typeArguments)&&e.details.recursiveTypeAliasScopeId===t.details.recursiveTypeAliasScopeId){let o=!0;const l=t.typeAliasInfo.typeArguments;return e.typeAliasInfo.typeArguments.forEach(((e,t)=>{Zs(e,t<l.length?l[t]:G.UnknownType.create(),n,s,i,a,r)||(o=!1)})),o}if(0!=(4&a))return!0;a|=4}const d=(0,W.transformPossibleRecursiveTypeAlias)(e),u=(0,W.transformPossibleRecursiveTypeAlias)(t);if((d!==e&&(0,G.isUnion)(d)||u!==t&&(0,G.isUnion)(u))&&r>10)return!0;if(e=d,t=u,(0,G.isUnbound)(e)||(0,G.isUnbound)(t))return!0;0!=(16&a)&&(t=mt(t));const y=a;if(a&=-65,(0,G.isTypeVar)(e)){if((0,W.isTypeVarSame)(e,t))return!e.scopeId||!(null==s?void 0:s.hasSolveForScope(e.scopeId))||(0,I.assignTypeToTypeVar)(gi,e,t,n,s,a,r);if(function(e,t,n){return!(0,G.findSubtype)(t,(t=>{var s;if((0,G.isTypeSame)(e,t,{ignorePseudoGeneric:!0},n))return!1;const i=G.TypeVarType.getNameWithScope(e),a=(null!==(s=(0,W.getTypeCondition)(t))&&void 0!==s?s:[]).filter((e=>e.typeVarName===i));return 0===a.length||!a.some((s=>s.typeVarName===G.TypeVarType.getNameWithScope(e)&&(e.details.boundType?((0,l.assert)(0===s.constraintIndex,"Expected constraint for bound TypeVar to have index of 0"),Zs(e.details.boundType,t,void 0,void 0,void 0,0,n)):!(e.details.constraints.length>0)||((0,l.assert)(s.constraintIndex<e.details.constraints.length,"Constraint for constrained TypeVar is out of bounds"),Zs(e.details.constraints[s.constraintIndex],t,void 0,void 0,void 0,0,n)))))}))}(e,t,r))return!0;const o=e;if(G.TypeBase.isInstantiable(e)===G.TypeBase.isInstantiable(t)&&t.condition&&t.condition.some((e=>!e.isConstrainedTypeVar&&e.typeVarName===o.nameWithScope)))return!0;if((0,G.isUnion)(t)){const n=(0,G.removeFromUnion)(t,(e=>(0,G.isAnyOrUnknown)(e)));if((0,G.isTypeSame)(e,n))return!0}if((0,G.isTypeVar)(t)&&t.details.isSynthesizedSelf&&t.details.boundType&&e.details.isSynthesizedSelf&&e.details.boundType&&G.TypeBase.isInstance(t)===G.TypeBase.isInstance(e))return 0==(2&a)&&s&&(0,I.assignTypeToTypeVar)(gi,e,t,n,s,y,r),!0;if((0,G.isVariadicTypeVar)(e)&&(0,G.isClassInstance)(t)&&(0,W.isTupleClass)(t)&&t.tupleTypeArguments&&1===t.tupleTypeArguments.length&&(0,G.isTypeSame)(e,t.tupleTypeArguments[0].type,{},r))return!0;if(0==(2&a)||!(0,G.isTypeVar)(t)){const o=0==(2&a)?s:i;return!(!(0,I.assignTypeToTypeVar)(gi,e,t,n,null!=o?o:new j.TypeVarContext,y,r)||(0,G.isAnyOrUnknown)(t)&&0!=(16&a))}}if((0,G.isTypeVar)(t)){if(0!=(2&a)){if(i&&i.hasSolveForScope((0,W.getTypeVarScopeId)(t))){if((0,I.assignTypeToTypeVar)(gi,t,e,n,i,y,r))return!0;let s=!1;return(0,G.isUnion)(e)&&(0,W.doForEachSubtype)(e,(e=>{(0,I.assignTypeToTypeVar)(gi,t,e,n,i,y,r)&&(s=!0)})),s}return Zs(mt(e),mt(t),n,void 0,void 0,y,r)}if(0!=(1&a))return!!(0,G.isAnyOrUnknown)(e)||!!((0,G.isParamSpec)(t)&&(0,G.isFunction)(e)&&G.FunctionType.shouldSkipArgsKwargsCompatibilityCheck(e)&&e.details.parameters.length<=2)||(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:mi(t),destType:mi(e)})),!1)}if((0,G.isAnyOrUnknown)(e))return!0;if((0,G.isAnyOrUnknown)(t)){const n=0==(2&a)?s:i;if(n){const s=(0,W.isEllipsisType)(t)?G.AnyType.create():t;(0,W.setTypeArgumentsRecursive)(e,s,n,r)}if(0==(16&a))return!0}if((0,G.isNever)(t)){if(0!=(1&a))return(0,G.isNever)(e);const t=0==(2&a)?s:i;return t&&(0,W.setTypeArgumentsRecursive)(e,G.UnknownType.create(),t,r),!0}if((0,G.isUnion)(t)&&G.TypeBase.isSpecialForm(t)&&(t=J||X||G.AnyType.create()),(0,G.isUnion)(e))if((0,G.isUnion)(t)){if(Qs(e,t,void 0,s,i,y,r))return!0}else{const n=null==s?void 0:s.clone(),a=null==i?void 0:i.clone();if(Js(e,t,void 0,n,a,y,r))return s&&n&&s.copyFromClone(n),i&&a&&i.copyFromClone(a),!0}const g=mt(t);if((0,G.isUnion)(g))return Qs(e,g,n,s,i,y,r);if((0,G.isUnion)(e))return Js(e,t,n,s,i,y,r);if((0,G.isNoneInstance)(e)){if((0,G.isNoneInstance)(t))return!0;if((0,G.isClassInstance)(t)&&G.ClassType.isBuiltIn(t,"NoneType"))return!0}if((0,G.isNoneTypeClass)(e)){if((0,G.isNoneTypeClass)(t))return!0;if((0,G.isInstantiableClass)(t)&&G.ClassType.isBuiltIn(t,"NoneType"))return!0}if((0,G.isClassInstance)(g)&&G.ClassType.isBuiltIn(g,"type")){const o=g.typeArguments;let l,c;if(o&&o.length>=1){if(l=o[0],(0,G.isAnyOrUnknown)(l))return!(!(0,G.isClassInstance)(e)||!G.ClassType.isBuiltIn(g,"type"))||G.TypeBase.isInstantiable(e);c=(0,W.convertToInstantiable)(l)}else G.TypeBase.isInstantiable(e)&&(l=null!=X?X:G.AnyType.create(),c=g);if(c&&l&&((0,G.isClassInstance)(l)||(0,G.isTypeVar)(l)))return!!Zs(e,c,null==n?void 0:n.createAddendum(),s,i,a,r)||(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:mi(t),destType:mi(e)})),!1)}if((0,G.isInstantiableClass)(e)&&(0,G.isInstantiableClass)(g))return G.ClassType.isProtocolClass(e)&&G.ClassType.isProtocolClass(g)&&(0,G.isInstantiableClass)(t)&&!t.includeSubclasses?(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.protocolSourceIsNotConcrete().format({sourceType:mi((0,W.convertToInstance)(t)),destType:mi(e)})),!1):!!qs(e,g,n,s,i,a,r,!1)||(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:mi(t),destType:mi(e)})),!1);if((0,G.isClassInstance)(e)){if(G.ClassType.isBuiltIn(e,"Type")){const o=e.typeArguments;if(o&&o.length>=1&&G.TypeBase.isInstance(o[0])&&G.TypeBase.isInstantiable(t))return Zs(o[0],(0,W.convertToInstance)(t),n,s,i,a,r)}else if(G.ClassType.isBuiltIn(e,"type")){if((0,G.isAnyOrUnknown)(t)&&0!=(16&a))return!1;if(G.TypeBase.isInstantiable(t))return!((0,G.isClass)(t)&&void 0!==t.literalValue)}else if(G.ClassType.isBuiltIn(e,["TypeGuard","StrictTypeGuard"])&&0!=(64&y)&&(0,G.isClassInstance)(t)&&G.ClassType.isBuiltIn(t,"bool"))return!0;let o=mt(t);if((0,G.isClass)(o)&&G.TypeBase.isInstance(o)){if(void 0!==e.literalValue&&(void 0===o.literalValue||!G.ClassType.isLiteralValueSame(o,e)))return null==n||n.addMessage(m.Localizer.DiagnosticAddendum.literalAssignmentMismatch().format({sourceType:mi(t),destType:mi(e)})),!1;if(G.ClassType.isBuiltIn(e,"LiteralString")){if(G.ClassType.isBuiltIn(o,"str")&&void 0!==o.literalValue)return!0;if(G.ClassType.isBuiltIn(o,"LiteralString"))return!0}else G.ClassType.isBuiltIn(o,"LiteralString")&&ae&&(0,G.isInstantiableClass)(ae)&&(o=G.ClassType.cloneAsInstance(ae));return!!qs(G.ClassType.cloneAsInstantiable(e),G.ClassType.cloneAsInstantiable(o),n,s,i,a,r,!0)}if((0,G.isFunction)(o)||(0,G.isOverloadedFunction)(o)){const t=ei(e,r);if(t)return Zs(t,o,n,s,i,a,r);if(X&&(0,G.isClassInstance)(X))return Zs(e,X,n,s,i,a,r)}else if((0,G.isModule)(o)){if(G.ClassType.isBuiltIn(e,"ModuleType"))return!0;if(G.ClassType.isProtocolClass(e))return(0,k.assignModuleToProtocol)(gi,G.ClassType.cloneAsInstantiable(e),o,n,s,a,r)}else if((0,G.isInstantiableClass)(o)){const t=ei(e,r);if(t)return Zs(t,o,n,s,i,a,r);if(G.ClassType.isProtocolClass(e))return(0,k.assignClassToProtocol)(gi,G.ClassType.cloneAsInstantiable(e),o,n,s,i,a,!0,r);const l=o.details.effectiveMetaclass;if(l)return!!(0,G.isAnyOrUnknown)(l)||qs(G.ClassType.cloneAsInstantiable(e),l,n,s,i,a,r,!1)}else{if((0,G.isAnyOrUnknown)(o))return 0==(16&a);if((0,G.isUnion)(o))return Zs(e,o,n,s,i,a,r)}}if((0,G.isFunction)(e)){let l=mt(t);if((0,G.isClassInstance)(l)){const e=qe(l,"__call__",r);e&&(l=(0,W.removeParamSpecVariadicsFromSignature)(e))}if((0,G.isInstantiableClass)(l)&&void 0===l.literalValue){const e=Xs(l,r);e&&(l=e)}if((0,G.isAnyOrUnknown)(l))return 0==(16&a);if((0,G.isOverloadedFunction)(l)){const t=G.OverloadedFunctionType.getOverloads(l),o=[],c=[],p=[];return t.forEach((t=>{var n;const l=null!==(n=(0,W.getTypeVarScopeId)(t))&&void 0!==n?n:"",d=null==s?void 0:s.cloneWithSignatureSource(l),u=null==i?void 0:i.cloneWithSignatureSource(l);Zs(e,t,void 0,d,u,a,r)&&(o.push(t),d&&c.push(...d.getSignatureContexts()),u&&p.push(...u.getSignatureContexts()))})),0===o.length?(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.noOverloadAssignable().format({type:mi(e)})),!1):(s&&s.copySignatureContexts(c),i&&i.copySignatureContexts(p),!0)}if((0,G.isFunction)(l)&&function(e,t,n,s,i,a,r){var l,c,p,d,u,y,g,h,f,T;let v=!0;const _=0==(32&a);a&=-33,e=(0,W.removeParamSpecVariadicsFromFunction)(e),t=(0,W.removeParamSpecVariadicsFromFunction)(t);const b=(0,E.getParameterListDetails)(e),C=(0,E.getParameterListDetails)(t);!function(e,t){var n;if(void 0===t.argsIndex)return;if(!(0,G.isUnpacked)(t.params[t.argsIndex].type))return;if(e.params.length<t.argsIndex)return;let s=e.params.findIndex(((e,n)=>n>=t.argsIndex&&e.source===E.ParameterSource.KeywordOnly));s<0&&(s=e.params.length);const i=(null!==(n=t.firstKeywordOnlyIndex)&&void 0!==n?n:t.params.length)-t.argsIndex-1,a=e.params.slice(t.argsIndex,s-i),r=[];if(a.forEach((e=>{1===e.param.category?(0,G.isUnpackedVariadicTypeVar)(e.type)?r.push({type:e.type,isUnbounded:!1}):(0,G.isUnpackedClass)(e.type)&&e.type.tupleTypeArguments?(0,o.appendArray)(r,e.type.tupleTypeArguments):r.push({type:e.type,isUnbounded:!0}):r.push({type:e.type,isUnbounded:!1})})),1!==r.length||!(0,G.isVariadicTypeVar)(r[0].type)){let n;n=ne&&(0,G.isInstantiableClass)(ne)?(0,W.convertToInstance)((0,W.specializeTupleClass)(ne,r,!0,!0)):G.UnknownType.create(),e.params=[...e.params.slice(0,t.argsIndex),{param:{category:1,name:"_arg_combined",isNameSynthesized:!0,hasDeclaredType:!0,type:n},type:n,index:-1,source:E.ParameterSource.PositionOnly},...e.params.slice(t.argsIndex+a.length,e.params.length)];const s=e.params.findIndex((e=>1===e.param.category));e.argsIndex=s>=0?s:void 0;const i=e.params.findIndex((e=>2===e.param.category));e.kwargsIndex=i>=0?i:void 0;const o=e.params.findIndex((e=>e.source===E.ParameterSource.KeywordOnly));e.firstKeywordOnlyIndex=o>=0?o:void 0,e.positionOnlyParamCount=Math.max(0,e.params.findIndex((e=>e.source!==E.ParameterSource.PositionOnly||0!==e.param.category||e.param.hasDefault)))}}(C,b);const S=0!=(2&a)?!!t.details.paramSpec:!!e.details.paramSpec,x=null!==(c=null!==(l=b.argsIndex)&&void 0!==l?l:b.firstKeywordOnlyIndex)&&void 0!==c?c:b.params.length,D=null!==(d=null!==(p=C.argsIndex)&&void 0!==p?p:C.firstKeywordOnlyIndex)&&void 0!==d?d:C.params.length,F=Math.min(x,D);for(let o=0;o<F;o++){const l=b.params[o],c=C.params[o],p=c.type,d=l.type,g=null!==(u=l.param.name)&&void 0!==u?u:"",h=null!==(y=c.param.name)&&void 0!==y?y:"";!g||(0,O.isPrivateOrProtectedName)(g)||(0,O.isPrivateOrProtectedName)(h)||l.source===E.ParameterSource.PositionOnly||1===l.param.category||1===c.param.category||g===h||(null==n||n.createAddendum().addMessage(m.Localizer.DiagnosticAddendum.functionParamName().format({srcName:h,destName:g})),v=!1),l.param.hasDefault&&!c.param.hasDefault&&(null==n||n.createAddendum().addMessage(m.Localizer.DiagnosticAddendum.functionParamDefaultMissing().format({name:h})),v=!1),0===o&&"__init__"===t.details.name&&G.FunctionType.isInstanceMethod(t)&&"__init__"===e.details.name&&G.FunctionType.isInstanceMethod(e)&&G.FunctionType.isOverloaded(e)&&l.param.hasDeclaredType||ti(d,p,o,null==n?void 0:n.createAddendum(),s,i,a,r)||0!=(256&a)&&(0,G.isTypeVar)(p)&&p.details.isSynthesized||(v=!1)}if(!G.FunctionType.shouldSkipArgsKwargsCompatibilityCheck(e)&&b.firstPositionOrKeywordIndex<C.positionOnlyParamCount&&!S&&(null==n||n.createAddendum().addMessage(m.Localizer.DiagnosticAddendum.argsPositionOnly().format({expected:C.positionOnlyParamCount,received:b.firstPositionOrKeywordIndex})),v=!1),x<D){if(!S){const e=C.params.filter((e=>!!e.param.name&&!e.param.hasDefault&&0===e.param.category)).length;if(void 0===b.argsIndex)x<e&&b.firstPositionOrKeywordIndex>0&&b.firstPositionOrKeywordIndex<D&&(null==n||n.createAddendum().addMessage(m.Localizer.DiagnosticAddendum.functionTooFewParams().format({expected:e,received:x})),v=!1);else{const e=b.params[b.argsIndex].type;if(!(0,G.isAnyOrUnknown)(e))for(let t=x;t<D;t++)ti(e,C.params[t].type,t,null==n?void 0:n.createAddendum(),s,i,a,r)||(v=!1)}}}else if(D<x)if(void 0!==C.argsIndex){const e=C.params[C.argsIndex].type;for(let t=D;t<x;t++){const o=b.params[t].type;(0,G.isVariadicTypeVar)(o)&&!(0,G.isVariadicTypeVar)(e)?(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.typeVarTupleRequiresKnownLength()),v=!1):(ti(o,e,t,null==n?void 0:n.createAddendum(),s,i,a,r)||(v=!1),b.params[t].source!==E.ParameterSource.PositionOnly&&void 0===C.kwargsIndex&&(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.namedParamMissingInSource().format({name:null!==(g=b.params[t].param.name)&&void 0!==g?g:""})),v=!1))}}else null==n||n.addMessage(m.Localizer.DiagnosticAddendum.functionTooManyParams().format({expected:D,received:x})),v=!1;if(void 0!==C.argsIndex&&void 0!==b.argsIndex&&!G.FunctionType.shouldSkipArgsKwargsCompatibilityCheck(e)){let e=b.params[b.argsIndex].type,t=C.params[C.argsIndex].type;ne&&(0,G.isInstantiableClass)(ne)&&((0,G.isUnpacked)(e)||(e=G.ClassType.cloneForUnpacked(G.ClassType.cloneAsInstance((0,W.specializeTupleClass)(ne,[{type:e,isUnbounded:!0}],!0)))),(0,G.isUnpacked)(t)||(t=G.ClassType.cloneForUnpacked(G.ClassType.cloneAsInstance((0,W.specializeTupleClass)(ne,[{type:t,isUnbounded:!0}],!0))))),ti(e,t,b.params[b.argsIndex].index,null==n?void 0:n.createAddendum(),s,i,a,r)||(v=!1)}if(G.FunctionType.shouldSkipArgsKwargsCompatibilityCheck(e)||void 0!==C.argsIndex||void 0!==t.details.paramSpec||void 0===b.argsIndex||b.hasUnpackedVariadicTypeVar||(null==n||n.createAddendum().addMessage(m.Localizer.DiagnosticAddendum.argsParamMissing().format({paramName:null!==(h=b.params[b.argsIndex].param.name)&&void 0!==h?h:""})),v=!1),!S){const o=new Map;void 0!==b.firstKeywordOnlyIndex&&b.params.forEach(((e,t)=>{t>=b.firstKeywordOnlyIndex&&e.param.name&&0===e.param.category&&o.set(e.param.name,e)}));let l=void 0!==C.firstKeywordOnlyIndex?C.firstKeywordOnlyIndex:C.params.length;x<D&&void 0===b.argsIndex&&(l=x),l>=0&&C.params.forEach(((e,t)=>{if(t>=l&&e.param.name&&0===e.param.category){const t=o.get(e.param.name),l=null==n?void 0:n.createAddendum(),c=e.type;if(t){const p=t.type,d=s?(0,W.applySolvedTypeVars)(p,s):p;ti(t.type,c,void 0,null==l?void 0:l.createAddendum(),s,i,a,r)||(l&&l.addMessage(m.Localizer.DiagnosticAddendum.namedParamTypeMismatch().format({name:e.param.name,sourceType:mi(d),destType:mi(c)})),v=!1),t.param.hasDefault&&!e.param.hasDefault&&(null==n||n.createAddendum().addMessage(m.Localizer.DiagnosticAddendum.functionParamDefaultMissing().format({name:e.param.name})),v=!1),o.delete(e.param.name)}else void 0!==b.kwargsIndex||e.param.hasDefault?void 0!==b.kwargsIndex&&(ti(b.params[b.kwargsIndex].type,c,b.params[b.kwargsIndex].index,null==n?void 0:n.createAddendum(),s,i,a,r)||(v=!1)):(l&&l.addMessage(m.Localizer.DiagnosticAddendum.namedParamMissingInDest().format({name:e.param.name})),v=!1)}})),o.forEach(((e,t)=>{void 0!==C.kwargsIndex&&e.param.name?(ti(e.param.type,C.params[C.kwargsIndex].type,e.index,null==n?void 0:n.createAddendum(),s,i,a,r)||(v=!1),o.delete(t)):(null==n||n.createAddendum().addMessage(m.Localizer.DiagnosticAddendum.namedParamMissingInSource().format({name:t})),v=!1)})),void 0!==C.kwargsIndex&&void 0!==b.kwargsIndex&&(ti(b.params[b.kwargsIndex].type,C.params[C.kwargsIndex].type,b.params[b.kwargsIndex].index,null==n?void 0:n.createAddendum(),s,i,a,r)||(v=!1)),G.FunctionType.shouldSkipArgsKwargsCompatibilityCheck(e)||void 0!==C.kwargsIndex||void 0!==t.details.paramSpec||void 0===b.kwargsIndex||(null==n||n.createAddendum().addMessage(m.Localizer.DiagnosticAddendum.kwargsParamMissing().format({paramName:b.params[b.kwargsIndex].param.name})),v=!1)}if(S&&(null===(f=t.details.paramSpec)||void 0===f?void 0:f.nameWithScope)===(null===(T=e.details.paramSpec)||void 0===T?void 0:T.nameWithScope)){const n=t.details.parameters.length,s=e.details.parameters.length;n!==s&&(n!==s-1||0!==e.details.parameters[s-1].category||e.details.parameters[s-1].name)&&(v=!1)}const P=(0==(2&a)?i:s).getPrimarySignature();if(P.getTypeVars().forEach((e=>{Zs(e.typeVar,P.getTypeVarType(e.typeVar),void 0,s,i,0,r)})),S){const n=0==(2&a)?e:t,r=0==(2&a)?t:e;if(n.details.paramSpec){const e=n.details.parameters.filter((e=>!(!e.name||0===e.category&&(0,G.isParamSpec)(e.type)))).length;let t=0;const o=[];r.details.parameters.forEach(((n,s)=>{t<e?n.name&&t++:(n.name||0!==n.category||0!==o.length)&&o.push({category:n.category,name:n.name,isNameSynthesized:n.isNameSynthesized,hasDefault:!!n.hasDefault,defaultValueExpression:n.defaultValueExpression,type:G.FunctionType.getEffectiveParameterType(r,s)})}));const l=r.details.paramSpec,c=n.details.paramSpec,p=0==(2&a)?s:i;if(p.hasSolveForScope(c.scopeId)){const e=G.FunctionType.createInstance("","","",64|r.details.flags,r.details.docString);e.details.typeVarScopeId=r.details.typeVarScopeId,o.forEach((t=>{G.FunctionType.addParameter(e,t)})),e.details.paramSpec=l?(0,W.convertToInstance)(l):void 0,(0,I.assignTypeToTypeVar)(gi,c,e,void 0,p)||(o.length>0||!l||!(0,I.assignTypeToTypeVar)(gi,c,(0,W.convertToInstance)(l),void 0,p))&&(v=!1)}else(!l||!(0,G.isTypeSame)(l,c,{ignoreTypeFlags:!0})||o.length>0)&&(v=!1)}}if(_){const o=Bs(e);if(!(0,G.isAnyOrUnknown)(o)){const e=(0,W.applySolvedTypeVars)(Bs(t),i),l=null==n?void 0:n.createAddendum();let c=!1,p=a;t.details.declaredReturnType&&(0,W.containsLiteralType)(t.details.declaredReturnType,!0)&&(p|=128),((0,G.isNever)(e)||Zs(o,e,null==l?void 0:l.createAddendum(),s,i,p,r)||(0,G.isClassInstance)(e)&&G.ClassType.isBuiltIn(e,["TypeGuard","StrictTypeGuard"])&&se&&(0,G.isInstantiableClass)(se)&&Zs(o,G.ClassType.cloneAsInstance(se),null==l?void 0:l.createAddendum(),s,i,a,r))&&(c=!0),c||(l&&l.addMessage(m.Localizer.DiagnosticAddendum.functionReturnTypeMismatch().format({sourceType:mi(e),destType:mi(o)})),v=!1)}}return s.applySourceContextTypeVars(i),v}(e,l,null==n?void 0:n.createAddendum(),null!=s?s:new j.TypeVarContext((0,W.getTypeVarScopeId)(e)),null!=i?i:new j.TypeVarContext((0,W.getTypeVarScopeId)(l)),a,r))return!0}if((0,G.isOverloadedFunction)(e)){const o=null==n?void 0:n.createAddendum(),l=G.OverloadedFunctionType.getOverloads(e);if((0,G.isOverloadedFunction)(t)){const e=G.OverloadedFunctionType.getOverloads(t);if(l.length===e.length&&l.every(((t,n)=>Zs(t,e[n],void 0,null!=s?s:new j.TypeVarContext((0,W.getTypeVarScopeId)(t)),i,a,r))))return!0}return!!l.every((e=>(s&&s.addSolveForScope((0,W.getTypeVarScopeId)(e)),Zs(e,t,null==o?void 0:o.createAddendum(),null!=s?s:new j.TypeVarContext((0,W.getTypeVarScopeId)(e)),i,a,r))))||(o&&o.addMessage(m.Localizer.DiagnosticAddendum.overloadNotAssignable().format({name:e.overloads[0].details.name})),!1)}return!!((0,G.isClass)(e)&&G.ClassType.isBuiltIn(e,"object")&&((0,G.isInstantiableClass)(e)&&G.TypeBase.isInstantiable(t)||(0,G.isClassInstance)(e))&&0==(1&a))||((0,G.isNoneInstance)(t)&&(0,G.isClassInstance)(e)&&G.ClassType.isProtocolClass(e)&&Q&&(0,G.isInstantiableClass)(Q)?(0,k.assignClassToProtocol)(gi,G.ClassType.cloneAsInstantiable(e),Q,n,s,i,a,!1,r):(0,G.isNoneInstance)(e)?(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.assignToNone()),!1):(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:mi(t),destType:mi(e)})),!1))}function Qs(e,t,n,s,i,a,r){if((0,G.isTypeSame)(t,e,{},r))return!0;let o=(0,W.sortTypes)(t.subtypes);if((0,G.isUnion)(e)){const l=e.subtypes.filter((e=>!(0,G.isAnyOrUnknown)(e)));if(1===l.length&&(0,G.isTypeVar)(l[0]))return Zs(l[0],t,void 0,s,i,a,r),!0;const c=[];let p=o,d=!0;if(e.subtypes.forEach((e=>{if((0,W.requiresSpecialization)(e))c.push(e);else{const t=p.findIndex((t=>(0,G.isTypeSame)(t,e,{},r)));t>=0?p.splice(t,1):c.push(e)}})),p.forEach((e=>{const t=c.findIndex((t=>!!((0,G.isClass)(e)&&(0,G.isClass)(t)&&G.TypeBase.isInstance(e)===G.TypeBase.isInstance(t)&&G.ClassType.isSameGenericClass(e,t))||!(!(0,G.isFunction)(e)&&!(0,G.isOverloadedFunction)(e)||!(0,G.isFunction)(t)&&!(0,G.isOverloadedFunction)(t))));t>=0&&(Zs(c[t],e,null==n?void 0:n.createAddendum(),s,i,a,r)||(d=!1),c.splice(t,1),p=p.filter((t=>t!==e)))})),d&&(0!==c.length||0!==p.length)){const e=0!=(2&a),l=e?p:c;0===l.length||l.some((e=>!(0,G.isTypeVar)(e)))?(d=!1,o=p):c.length===p.length?(c.forEach(((e,t)=>{Zs(e,p[t],null==n?void 0:n.createAddendum(),s,i,a,r)||(d=!1)})),o=p):0===p.length?0!=(1024&a)&&c.forEach((e=>{Zs(e,t,void 0,s,i,a,r)})):Zs(e?(0,G.combineTypes)(c):c[0],e?p[0]:(0,G.combineTypes)(p),null==n?void 0:n.createAddendum(),s,i,a,r)||(d=!1)}if(d)return!0}let l=!1;return o.forEach((o=>{if(!l&&!Zs(e,o,void 0,s,i,a,r)){const c=mt(o);let p=!1;t.subtypes.forEach((e=>{p||(0,G.isTypeSame)(e,o)||(0,G.isAnyOrUnknown)(e)||!function(e,t,n){return!e.condition&&(!(!(0,G.isAnyOrUnknown)(e)&&!(0,G.isAnyOrUnknown)(t))||(!(!(0,G.isClass)(e)||!e.details.mro.some((e=>(0,G.isAnyOrUnknown)(e))))||(!(!(0,G.isClass)(t)||!t.details.mro.some((e=>(0,G.isAnyOrUnknown)(e))))||Zs(e,t,void 0,void 0,void 0,0,n)&&!Zs(t,e,void 0,void 0,void 0,0,n))))}(e,c,r)||(p=!0)})),p||Zs(e,c,null==n?void 0:n.createAddendum(),s,i,a,r)||(l=!0)}}),!0),!l||(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:mi(t),destType:mi(e)})),!1)}function Js(e,t,n,s,i,a,r){if(1&a){let o=!1;return(0,W.doForEachSubtype)(e,((l,c)=>{if(!o&&!Zs(l,t,null==n?void 0:n.createAddendum(),s,i,a,r)){let t=!1;(0,G.isAnyOrUnknown)(l)||(0,W.doForEachSubtype)(e,((e,n)=>{c===n||t||Zs(e,l,void 0,void 0,void 0,0,r)&&(t=!0)})),t||(o=!0)}})),!o||(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:mi(t),destType:mi(e)})),!1)}const o=n?new c.DiagnosticAddendum:void 0;let l=!1;if((0,W.requiresSpecialization)(e))if((0,G.isNoneInstance)(t)&&(0,W.isOptionalType)(e))l=!0;else{let n,c,p;if((0,G.isClassInstance)(t)&&(0,W.isLiteralType)(t)&&G.UnionType.containsType(e,t,void 0,r))return!0;(0,W.doForEachSubtype)(e,(e=>{const d=null==s?void 0:s.clone(),u=null==i?void 0:i.clone();if(Zs(e,t,null==o?void 0:o.createAddendum(),d,u,a,r)&&(l=!0,d)){let s=d.getScore();(0,G.isTypeSame)(e,Oe(t))&&(s=Number.POSITIVE_INFINITY),(void 0===p||p<=s)&&(p=s,n=d,c=u)}})),s&&n&&s.copyFromClone(n),i&&c&&i.copyFromClone(c)}else for(const n of e.subtypes)if(Zs(n,t,null==o?void 0:o.createAddendum(),s,i,a,r)){l=!0;break}return l||(0,G.isTypeVar)(t)&&t.details.constraints.length>0&&(l=Zs(e,mt(t),null==o?void 0:o.createAddendum(),s,i,a,r)),!!l||(n&&o&&(n.addMessage(m.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:mi(t),destType:mi(e)})),n.addAddendum(o)),!1)}function Xs(e,t=0){const n=(0,W.lookUpClassMember)(e,"__init__",12);if(n){const s=js(n),i=G.ClassType.cloneAsInstance(e),a=n=>{let s=ri(i,n,void 0,void 0,t);return s&&(s=G.FunctionType.clone(s),s.details.declaredReturnType=i,s.specializedTypes&&(s.specializedTypes.returnType=i),!s.details.docString&&e.details.docString&&(s.details.docString=e.details.docString),s.details.flags&=-5),s};if((0,G.isFunction)(s))return a(s);if((0,G.isOverloadedFunction)(s)){const e=[];if(s.overloads.forEach((t=>{const n=a(t);n&&e.push(n)})),0===e.length)return;return 1===e.length?e[0]:G.OverloadedFunctionType.create(e)}}const s=(0,W.lookUpClassMember)(e,"__new__",12);if(s){const n=js(s),i=n=>{let s=ri(e,n,void 0,void 0,t,!0);return s&&(s=G.FunctionType.clone(s),!s.details.docString&&e.details.docString&&(s.details.docString=e.details.docString),s.details.flags&=-6),s};if((0,G.isFunction)(n))return i(n);if((0,G.isOverloadedFunction)(n)){const e=[];if(n.overloads.forEach((t=>{const n=i(t);n&&e.push(n)})),0===e.length)return;return 1===e.length?e[0]:G.OverloadedFunctionType.create(e)}}const i=G.FunctionType.createSynthesizedInstance("__new__",0);return i.details.declaredReturnType=G.ClassType.cloneAsInstance(e),G.FunctionType.addDefaultParameters(i),!i.details.docString&&e.details.docString&&(i.details.docString=e.details.docString),i}function ei(e,t=0){if(!(0,G.isClassInstance)(e)||!G.ClassType.isProtocolClass(e))return;for(const t of e.details.mro)if((0,G.isClass)(t)&&G.ClassType.isProtocolClass(t))for(const e of t.details.fields)if("__call__"!==e[0]&&!e[1].isIgnoredForProtocolMatch()){let t=!1;if(te&&(0,G.isClass)(te)&&te.details.fields.has(e[0])&&(t=!0),!t)return}const n=qe(e,"__call__",t);return n?(0,W.removeParamSpecVariadicsFromSignature)(n):void 0}function ti(e,t,n,s,i,a,r,o){if((0,G.isTypeVar)(e)&&e.details.isSynthesized&&e.details.boundType&&(0,G.isClassInstance)(e.details.boundType)&&G.ClassType.isProtocolClass(e.details.boundType))return!0;if((0,G.isVariadicTypeVar)(e)&&!(0,G.isUnpacked)(t))return!1;let l=t,c=e,p=!1;if(0==(2&r))c=(0,W.applySolvedTypeVars)(e,i,{useNarrowBoundOnly:!0}),(0,W.requiresSpecialization)(c)&&(p=!Zs(l,c,void 0,a,i,640|2^r,o),c=(0,W.applySolvedTypeVars)(e,i));else if(l=(0,W.applySolvedTypeVars)(t,a,{useNarrowBoundOnly:!0}),(0,W.requiresSpecialization)(l)&&(p=!Zs(l,c,void 0,a,i,640|2^r,o),l=(0,W.applySolvedTypeVars)(t,a)),p)return s&&void 0!==n&&s.addMessage(m.Localizer.DiagnosticAddendum.paramAssignment().format({index:n+1,sourceType:mi(e),destType:mi(t)})),!1;return(0,G.isTypeVar)(c)&&c.details.isSynthesizedSelf||(0,G.isTypeVar)(l)&&l.details.isSynthesizedSelf&&l.details.boundType&&(l=(0,W.applySolvedTypeVars)(l.details.boundType,new j.TypeVarContext((0,W.getTypeVarScopeId)(l)),{unknownIfNotFound:!0})),!(!Zs(l,c,null==s?void 0:s.createAddendum(),a,i,r,o)&&!(0,G.isTypeSame)(e,t)&&(s&&void 0!==n&&s.addMessage(m.Localizer.DiagnosticAddendum.paramAssignment().format({index:n+1,sourceType:mi(e),destType:mi(t)})),1))}function ni(e,t,n=0){if(!(n>G.maxTypeRecursionCount)&&(n++,!t.tupleTypeArguments&&t.details.typeParameters.length>0&&t.typeArguments&&t.typeArguments.length<=t.details.typeParameters.length)){const s=new j.TypeVarContext((0,W.getTypeVarScopeId)(t));(0,I.populateTypeVarContextBasedOnExpectedType)(gi,G.ClassType.cloneForSpecialization(t,void 0,!1),e,s,[]);let i=!1;const a=t.typeArguments.map(((e,a)=>{const r=t.details.typeParameters[a],o=s.getPrimarySignature().getTypeVarType(r);if(o){if((0,G.isAny)(o)||(0,G.isAnyOrUnknown)(e))return i=!0,o;if((0,G.isClassInstance)(o)&&(0,G.isClassInstance)(e)){const t=ni(o,e,n);if(t)return i=!0,t}}return e}));if(i)return G.ClassType.cloneForSpecialization(t,a,!0)}}function si(e,t){const n=(0,W.mapSubtypes)(t,(t=>{const n=(0,W.mapSubtypes)(e,(n=>{if((0,G.isAnyOrUnknown)(e))return e;if(Zs(n,t)){if((0,G.isInstantiableClass)(n)&&(0,G.isInstantiableClass)(t)){const e=ni(n,t);e&&(t=e)}else if((0,G.isClassInstance)(n)&&(0,G.isClassInstance)(t)){const e=ni(G.ClassType.cloneAsInstantiable(n),G.ClassType.cloneAsInstantiable(t));e&&(t=G.ClassType.cloneAsInstance(e))}else if(!(0,G.isTypeVar)(n)&&(0,G.isTypeVar)(t))return n;return t}}));return(0,G.isNever)(n)?t:n}));return(0,G.isAny)(n)?e:(0,W.isIncompleteUnknown)(n)?n:(0,G.isUnknown)(n)?(0,G.combineTypes)([n,e]):n}function ii(e,t,n,s){var i,a;const r=(0,E.getParameterListDetails)(e),o=(0,E.getParameterListDetails)(t);let l=!0;G.FunctionType.isStaticMethod(e)?G.FunctionType.isStaticMethod(t)||(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.overrideNotStaticMethod()),l=!1):G.FunctionType.isClassMethod(e)&&(G.FunctionType.isClassMethod(t)||(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.overrideNotClassMethod()),l=!1)),G.FunctionType.isInstanceMethod(e)&&(G.FunctionType.isInstanceMethod(t)||(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.overrideNotInstanceMethod()),l=!1));let c=!1;if(o.positionParamCount<r.positionParamCount)if(void 0===o.argsIndex)c=!0;else{const s=o.params[o.argsIndex].type;for(let i=o.positionParamCount;i<r.positionParamCount;i++)Zs(s,r.params[i].type,null==n?void 0:n.createAddendum(),new j.TypeVarContext((0,W.getTypeVarScopeId)(t)),new j.TypeVarContext((0,W.getTypeVarScopeId)(e)),8)||(m.Localizer.DiagnosticAddendum.overrideParamType().format({index:i+1,baseType:mi(r.params[i].type),overrideType:mi(s)}),l=!1)}else if(o.positionParamCount>r.positionParamCount)for(let e=r.positionParamCount;e<o.positionParamCount;e++){const t=o.params[e].param;0===t.category&&t.name&&!t.hasDefault&&(c=!0)}c&&(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.overridePositionalParamCount().format({baseCount:r.params.length,overrideCount:o.params.length})),l=!1);const p=Math.min(r.positionParamCount,o.positionParamCount);for(let i=0;i<p;i++){if(0===i&&(G.FunctionType.isInstanceMethod(t)||G.FunctionType.isClassMethod(t)||G.FunctionType.isConstructorMethod(t)))continue;const a=r.params[i].param,c=o.params[i].param;if(i>=r.positionOnlyParamCount&&!(0,O.isPrivateOrProtectedName)(a.name||"")&&r.params[i].source!==E.ParameterSource.PositionOnly&&0===a.category&&a.name!==c.name)0===c.category&&s&&(o.params[i].source===E.ParameterSource.PositionOnly?null==n||n.addMessage(m.Localizer.DiagnosticAddendum.overrideParamNamePositionOnly().format({index:i+1,baseName:a.name||"*"})):null==n||n.addMessage(m.Localizer.DiagnosticAddendum.overrideParamName().format({index:i+1,baseName:a.name||"*",overrideName:c.name||"*"})),l=!1);else if(i<o.positionOnlyParamCount&&i>=r.positionOnlyParamCount)null==n||n.addMessage(m.Localizer.DiagnosticAddendum.overrideParamNamePositionOnly().format({index:i+1,baseName:a.name||"*"})),l=!1;else{const s=r.params[i].type,p=o.params[i].type,d=(0,G.isTypeVar)(s)&&s.details.isSynthesized,u=(0,G.isTypeVar)(p)&&p.details.isSynthesized;d||u||a.category===c.category&&Zs(p,s,null==n?void 0:n.createAddendum(),new j.TypeVarContext((0,W.getTypeVarScopeId)(t)),new j.TypeVarContext((0,W.getTypeVarScopeId)(e)),8)||(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.overrideParamType().format({index:i+1,baseType:mi(s),overrideType:mi(p)})),l=!1),r.params[i].param.hasDefault&&!o.params[i].param.hasDefault&&(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.overrideParamNoDefault().format({index:i+1})),l=!1)}}if(void 0!==r.argsIndex)if(void 0===o.argsIndex)null==n||n.addMessage(m.Localizer.DiagnosticAddendum.overrideParamNameMissing().format({name:null!==(i=r.params[r.argsIndex].param.name)&&void 0!==i?i:"?"})),l=!1;else{const e=o.params[o.argsIndex].type,s=r.params[r.argsIndex].type;Zs(e,s,null==n?void 0:n.createAddendum(),new j.TypeVarContext((0,W.getTypeVarScopeId)(t)),void 0,8)||(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.overrideParamKeywordType().format({name:null!==(a=o.params[o.argsIndex].param.name)&&void 0!==a?a:"?",baseType:mi(s),overrideType:mi(e)})),l=!1)}const d=r.params.filter((e=>e.source===E.ParameterSource.KeywordOnly&&0===e.param.category)),u=o.params.filter((e=>e.source===E.ParameterSource.KeywordOnly&&0===e.param.category));d.forEach((e=>{var s,i,a;const r=u.find((t=>e.param.name===t.param.name));if(r||void 0!==o.kwargsIndex){let s=null==r?void 0:r.type;s||(s=o.params[o.kwargsIndex].type),Zs(s,e.type,null==n?void 0:n.createAddendum(),new j.TypeVarContext((0,W.getTypeVarScopeId)(t)),void 0,8)||(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.overrideParamKeywordType().format({name:null!==(i=e.param.name)&&void 0!==i?i:"?",baseType:mi(e.type),overrideType:mi(s)})),l=!1),r&&e.param.hasDefault&&!r.param.hasDefault&&(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.overrideParamKeywordNoDefault().format({name:null!==(a=r.param.name)&&void 0!==a?a:"?"})),l=!1)}else null==n||n.addMessage(m.Localizer.DiagnosticAddendum.overrideParamNameMissing().format({name:null!==(s=e.param.name)&&void 0!==s?s:"?"})),l=!1})),u.forEach((e=>{var t;d.find((t=>e.param.name===t.param.name))||void 0===r.kwargsIndex&&(e.param.hasDefault||(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.overrideParamNameExtra().format({name:null!==(t=e.param.name)&&void 0!==t?t:"?"})),l=!1))}));const y=Bs(e),g=Bs(t);return Zs(y,g,null==n?void 0:n.createAddendum(),new j.TypeVarContext((0,W.getTypeVarScopeId)(e)),void 0,8)||(null==n||n.addMessage(m.Localizer.DiagnosticAddendum.overrideReturnType().format({baseType:mi(y),overrideType:mi(g)})),l=!1),l}function ai(e){const t=new Map;G.ClassType.getReverseMro(e).forEach((e=>{(0,G.isInstantiableClass)(e)&&e.details.fields.forEach(((n,s)=>{if(n.isClassMember()||n.isNamedTupleMemberMember()){let i;const a=(0,L.getLastTypedDeclaredForSymbol)(n);i=!(!a||5!==a.type)&&!!(8&ns(a.node,!0)),i?t.set(s,{symbol:n,symbolName:s,classType:e}):t.delete(s)}}))}));const n=[];return t.forEach((e=>{n.push(e)})),n}function ri(e,t,n,s,i=0,a=!1,r){if((0,G.isFunction)(t)){if(!e)return G.FunctionType.clone(t,!0);if(G.FunctionType.isInstanceMethod(t)){const a=(0,G.isClassInstance)(e)?e:G.ClassType.cloneAsInstance((0,W.specializeClassType)(e));return oi(e,t,n||G.ClassType.cloneAsInstantiable(a),s,i,r||a,(0,G.isClassInstance)(e))}if(G.FunctionType.isClassMethod(t)||a&&G.FunctionType.isConstructorMethod(t)){const a=(0,G.isInstantiableClass)(e)?e:G.ClassType.cloneAsInstantiable(e),o=r?(0,G.isInstantiableClass)(e)?r:(0,W.convertToInstantiable)(r):a;return oi(G.TypeBase.isInstance(e)?G.ClassType.cloneAsInstantiable(e):e,t,n||a,s,i,o,!0)}if(G.FunctionType.isStaticMethod(t)){const a=(0,G.isInstantiableClass)(e)?e:G.ClassType.cloneAsInstantiable(e);return oi(G.TypeBase.isInstance(e)?G.ClassType.cloneAsInstantiable(e):e,t,n||a,s,i,void 0,!1)}}else if((0,G.isOverloadedFunction)(t)){const o=G.OverloadedFunctionType.create([]);return G.OverloadedFunctionType.getOverloads(t).forEach((t=>{const s=ri(e,t,n,void 0,i,a,r);s&&G.OverloadedFunctionType.addOverload(o,s)})),0===G.OverloadedFunctionType.getOverloads(o).length?void(s&&t.overloads.forEach((t=>{ri(e,t,n,s,i,a,r)}))):1===o.overloads.length?o.overloads[0]:o}return t}function oi(e,t,n,s,i,a,r=!0){const o=new j.TypeVarContext((0,W.getTypeVarScopeId)(n));if(a&&t.details.parameters.length>0){const n=t.details.parameters[0],r=G.FunctionType.getEffectiveParameterType(t,0);o.addSolveForScope((0,W.getTypeVarScopeId)(t));const l=s?new c.DiagnosticAddendum:void 0;if((0,G.isTypeVar)(r)&&r.details.boundType&&(0,G.isClassInstance)(r.details.boundType)&&G.ClassType.isProtocolClass(r.details.boundType))o.isLocked()||o.setTypeVarType(r,G.TypeBase.isInstantiable(r)?(0,W.convertToInstance)(a):a);else if(!Zs(r,a,l,o,void 0,0,i)&&n.name&&!n.isNameSynthesized&&n.hasDeclaredType){if(!s)return;{const i=t.details.name||"(unnamed)";ct(T.getFileInfo(s).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.bindTypeMismatch().format({type:mi(e),methodName:i,paramName:n.name})+(null==l?void 0:l.getString()),s)}}}Bs(t);const l=(0,W.applySolvedTypeVars)(t,o);return G.FunctionType.clone(l,r,e,(0,W.getTypeVarScopeId)(e))}function li(e){return e.getDeclarations().some((e=>ci(e)))}function ci(e){return 1===e.type&&!!e.isFinal}function pi(e){if(1!==e.type||!e.typeAnnotationNode)return!1;if(38!==e.typeAnnotationNode.nodeType&&35!==e.typeAnnotationNode.nodeType&&48!==e.typeAnnotationNode.nodeType)return!1;const t=Ve(e.typeAnnotationNode,{isVariableAnnotation:!0,allowClassVar:!0});return(0,G.isClassInstance)(t)&&G.ClassType.isBuiltIn(t,"TypeAlias")}function di(e){var t;return!(1!==e.type||!e.typeAliasName||e.typeAnnotationNode)&&3===(null===(t=e.node.parent)||void 0===t?void 0:t.nodeType)&&ui(e.node.parent.rightExpression)}function ui(e){switch(e.nodeType){case 0:case 55:case 4:case 54:case 6:case 51:case 56:case 52:case 9:case 32:case 46:case 60:case 61:case 30:case 40:case 15:case 31:case 45:return!1}return!0}function yi(e){return B.printObjectTypeForClass(e,n.printTypeFlags,Bs)}function mi(e,t){let s=n.printTypeFlags;return(null==t?void 0:t.expandTypeAlias)&&(s|=32),(null==t?void 0:t.enforcePythonSyntax)&&(s|=256),(null==t?void 0:t.useTypingUnpack)&&(s|=512),B.printType(e,s,Bs)}const gi={runWithCancellationToken:function(e,t){try{return Z=e,t()}finally{Z=void 0}},getType:Ne,getTypeResult:function(e){return Ts(e,(()=>{gs(e)}))},getCachedType:function(e){return be(e,0)},getTypeOfExpression:Me,getTypeOfAnnotation:Ve,getTypeOfClass:jn,getTypeOfFunction:Jn,getTypeOfExpressionExpectingType:Ss,getExpectedType:ke,evaluateTypeForSubnode:Ts,evaluateTypesForStatement:fs,evaluateTypesForMatchStatement:function(e){if(Ie(e))return;const t=Me(e.subjectExpression);let n=t.type;for(const t of e.cases)t.guardExpression||(n=(0,A.narrowTypeBasedOnPattern)(gi,n,t.pattern,!1));Ce(e,{type:n,isIncomplete:!!t.isIncomplete},0)},evaluateTypesForCaseStatement:ds,evaluateTypeOfParameter:hs,canBeTruthy:Be,canBeFalsy:ze,stripLiteralValue:Oe,removeTruthinessFromType:Ge,removeFalsinessFromType:We,verifyRaiseExceptionType:function(e){const t=xs(e,"BaseException");if(e.typeExpression){const n=Me(e.typeExpression).type;if(n&&t&&(0,G.isInstantiableClass)(t)){const s=new c.DiagnosticAddendum;(0,W.doForEachSubtype)(n,(n=>{const i=mt(n);if(!(0,G.isAnyOrUnknown)(i))if((0,G.isInstantiableClass)(i)&&void 0===i.literalValue)if((0,W.derivesFromClassRecursive)(i,t,!1)){let t;Es(e.typeExpression,(()=>{t=jt(e.typeExpression,[],i,!1,void 0)})),t&&t.argumentErrors&&s.addMessage(m.Localizer.Diagnostic.exceptionTypeNotInstantiable().format({type:mi(n)}))}else s.addMessage(m.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:mi(n)}));else(0,G.isClassInstance)(i)&&(0,W.derivesFromClassRecursive)(G.ClassType.cloneAsInstantiable(i),t,!1)||s.addMessage(m.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:mi(n)}))})),s.isEmpty()||ct(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.expectedExceptionClass()+s.getString(),e.typeExpression)}}},verifyDeleteExpression:ft,validateOverloadedFunctionArguments:Gt,isAfterNodeReachable:st,isNodeReachable:nt,isAsymmetricDescriptorAssignment:function(e){return i.has(e.id)},suppressDiagnostics:Es,getDeclarationsForStringNode:function(e){var t;const n=[],s=null===(t=ke(e))||void 0===t?void 0:t.type;return s&&(0,W.doForEachSubtype)(s,(t=>{var s,i;if((0,G.isClassInstance)(t)&&G.ClassType.isTypedDictClass(t)&&(null===(s=t.details.typedDictEntries)||void 0===s?void 0:s.get(e.value))){const s=null===(i=(0,W.lookUpObjectMember)(t,e.value))||void 0===i?void 0:i.symbol;s&&(0,o.appendArray)(n,s.getDeclarations())}})),0===n.length?void 0:n},getDeclarationsForNameNode:function(e,t=!0){var n;if(t&&T.isCodeUnreachable(e))return;const s=[],i=Ns(e);if(i){const t=w.getScopeForNode(e);if(t){const n=t.lookUpSymbolRecursive(i.value);if(n){const t=n.symbol.getDeclarations().filter((t=>8===t.type&&t.node===e.parent));(0,o.appendArray)(s,(0,S.getDeclarationsWithUsesLocalNameRemoved)(t))}}}else if(e.parent&&35===e.parent.nodeType&&e===e.parent.memberName){let t=Ne(e.parent.leftExpression);if(t){t=mt(t);const n=e.parent.memberName.value;(0,W.doForEachSubtype)(t,(e=>{let t;if(e=mt(e),(0,G.isInstantiableClass)(e)){let s=(0,W.lookUpClassMember)(e,n,16);if(s||(s=(0,W.lookUpClassMember)(e,n)),!s){const t=e.details.effectiveMetaclass;t&&(0,G.isInstantiableClass)(t)&&(s=(0,W.lookUpClassMember)(t,n))}s&&(t=s.symbol)}else if((0,G.isClassInstance)(e)){let s=(0,W.lookUpObjectMember)(e,n,16);s||(s=(0,W.lookUpObjectMember)(e,n)),s&&(t=s.symbol)}else(0,G.isModule)(e)&&(t=G.ModuleType.getField(e,n));if(t){const e=t.getTypedDeclarations();e.length>0?(0,o.appendArray)(s,e):(0,o.appendArray)(s,t.getDeclarations())}}))}}else if(e.parent&&37===e.parent.nodeType){const t=e.parent.nameParts.findIndex((t=>t===e)),n=T.getImportInfo(e.parent);t>=0&&n&&!n.isNativeLib&&t<n.resolvedPaths.length&&n.resolvedPaths[t]&&(fs(e),s.push((0,S.createSynthesizedAliasDeclaration)(n.resolvedPaths[t])))}else if(e.parent&&1===e.parent.nodeType&&e===e.parent.name){const t=e.parent,i=e.value;if(t.parent&&9===t.parent.nodeType){const e=Ne(t.parent.leftExpression);if(e)if((0,G.isFunction)(e)&&e.details.declaration){const t=As(e,i);t&&s.push(t)}else if((0,G.isOverloadedFunction)(e))e.overloads.forEach((e=>{const t=As(e,i);t&&s.push(t)}));else if((0,G.isInstantiableClass)(e)){const a=null===(n=je(t.parent.leftExpression,G.ClassType.cloneAsInstance(e),"__init__",{method:"get"},void 0,4))||void 0===n?void 0:n.type;if(a&&(0,G.isFunction)(a)){const t=As(a,i);if(t)s.push(t);else if(G.ClassType.isDataClass(e)||G.ClassType.isTypedDictClass(e)){const t=(0,W.lookUpClassMember)(e,i);t&&(0,o.appendArray)(s,t.symbol.getDeclarations())}}}}}else{const t=T.getFileInfo(e),n=P.isWithinTypeAnnotation(e,!(0,f.isAnnotationEvaluationPostponed)(T.getFileInfo(e))),i=n||t.isStubFile;let a;const r=T.getTypeParameterSymbol(e);if(r)a=r;else{const t=Fs(e,e.value,!i,n);a=null==t?void 0:t.symbol}a&&(0,o.appendArray)(s,a.getDeclarations())}return s},getTypeForDeclaration:ks,resolveAliasDeclaration:Rs,resolveAliasDeclarationWithInfo:Os,getTypeOfIterable:Qe,getTypeOfIterator:Ze,getGetterTypeFromProperty:function(e,t){var n;if(!G.ClassType.isPropertyClass(e))return;const s=e.details.fields.get("fget");if(s){const e=null===(n=Us(s))||void 0===n?void 0:n.type;if(e&&(0,G.isFunction)(e))return Bs(e,void 0,t)}},getTypeOfArgument:bs,markNamesAccessed:function(e,t){const n=T.getFileInfo(e),s=w.getScopeForNode(e);s&&t.forEach((t=>{const i=s.lookUpSymbolRecursive(t);i&&Tt(n,i.symbol,e)}))},getScopeIdForNode:bt,makeTopLevelTypeVarsConcrete:mt,mapSubtypesExpandTypeVars:gt,lookUpSymbolRecursive:Fs,getDeclaredTypeOfSymbol:Us,getEffectiveTypeOfSymbol:Ls,getEffectiveTypeOfSymbolForUsage:Vs,getInferredTypeOfDeclaration:Ms,getDeclaredTypeForExpression:He,getFunctionDeclaredReturnType:Ws,getFunctionInferredReturnType:Gs,getBestOverloadForArguments:zt,getBuiltInType:xs,getTypeOfMember:js,getTypeOfObjectMember:je,getBoundMethod:qe,getTypeOfMagicMethodReturn:dn,bindFunctionToClassOrObject:ri,getCallSignatureInfo:function(e,t,n){const s=e.leftExpression,i=Ne(s);if(void 0===i)return;const a=[];let r=0;function o(){a.push({argumentCategory:r,typeResult:{type:G.UnknownType.create()},active:!0})}e.arguments.forEach(((e,s)=>{let i=!1;s===t&&(n?i=!0:o()),r=e.argumentCategory,a.push({valueExpression:e.valueExpression,argumentCategory:e.argumentCategory,name:e.name,active:i})})),e.arguments.length<t&&o();const l=[];function c(t){let n;Ps(e,(()=>{n=Xt(s,a,{type:t},new j.TypeVarContext((0,W.getTypeVarScopeId)(t)),!0)})),l.push({type:t,activeParam:null==n?void 0:n.activeParam})}function p(e){(0,G.isFunction)(e)?c(e):G.OverloadedFunctionType.getOverloads(e).forEach((e=>{c(e)}))}return(0,W.doForEachSubtype)(i,(e=>{switch(e.category){case 5:case 6:p(e);break;case 7:if(G.TypeBase.isInstantiable(e)){let t;t=qe(e,"__init__");const n=!!t&&(0,G.isFunction)(t)&&"builtins.object.__init__"===t.details.fullName,s=!!t&&(0,G.isFunction)(t)&&G.FunctionType.isSkipConstructorCheck(t),i=t&&(0,G.isFunction)(t)&&G.FunctionType.hasDefaultParameters(t);if(!t||n||s||i){const n=qe(e,"__new__",void 0,!0);n&&((0,G.isFunction)(n)&&"builtins.object.__new__"===n.details.fullName||(t=n))}t&&p(t)}else{const t=qe(e,"__call__");t&&p(t)}}})),0!==l.length?{callNode:e,signatures:l}:void 0},getAbstractMethods:ai,narrowConstrainedTypeVar:function(e,t){const n=T.getFlowNode(e);if(n)return hi.narrowConstrainedTypeVar(n,t)},assignType:Zs,validateOverrideMethod:function(e,t,n,s=!0){if(!(0,G.isFunction)(e)&&!(0,G.isOverloadedFunction)(e))return n.addMessage(m.Localizer.DiagnosticAddendum.overrideType().format({type:mi(e)})),!1;if((0,G.isFunction)(e)){if((0,G.isFunction)(t))return ii(e,t,n,s);if(G.OverloadedFunctionType.getOverloads(t).some((t=>ii(e,t,void 0,s))))return!0;const i=G.OverloadedFunctionType.getImplementation(t);return!(!i||!ii(e,i,void 0,s))||(n.addMessage(m.Localizer.DiagnosticAddendum.overrideNoOverloadMatches()),!1)}return!0},assignTypeToExpression:ht,assignClassToSelf:Ks,getTypedDictClassType:function(){return le},getTupleClassType:function(){return ne},getObjectType:function(){return X},getBuiltInObject:Ds,getTypingType:Je,verifyTypeArgumentsAssignable:Ys,inferReturnTypeIfNecessary:zs,inferTypeParameterVarianceForClass:qn,isFinalVariable:li,isFinalVariableDeclaration:ci,isExplicitTypeAliasDeclaration:pi,addError:rt,addWarning:function(e,t,n){return ot("warning",e,t,n)},addInformation:at,addUnusedCode:function(e,t){lt(e)||T.getFileInfo(e).diagnosticSink.addUnusedCodeWithTextRange(m.Localizer.Diagnostic.unreachableCode(),t)},addUnreachableCode:function(e,t){lt(e)||T.getFileInfo(e).diagnosticSink.addUnreachableCodeWithTextRange(m.Localizer.Diagnostic.unreachableCode(),t)},addDeprecated:function(e,t){lt(t)||T.getFileInfo(t).diagnosticSink.addDeprecatedWithTextRange(e,t)},addDiagnostic:ct,addDiagnosticForTextRange:pt,printType:mi,printFunctionParts:function(e,t){const s=t?n.printTypeFlags|t:n.printTypeFlags;return B.printFunctionParts(e,s,Bs)},getTypeCacheEntryCount:function(){return de.size},disposeEvaluator:function(){ce=new Set,pe=new Map,de=new Map,ue=new Map,ye=new Map},useSpeculativeMode:Ps,setTypeForNode:Se,checkForCancellation:ve,printControlFlowGraph:function(e,t,n,s){return hi.printControlFlowGraph(e,t,n,s)}},hi=(0,v.getCodeFlowEngine)(gi,a);return gi}},503:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.maxSubtypesForInferredType=void 0,t.maxSubtypesForInferredType=64},558:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTypeEvaluatorWithTracker=void 0;const s=n(2211),i=n(2489),a=n(8718),r=n(7887);t.createTypeEvaluatorWithTracker=function(e,t,n,o){function l(e){return t.logCalls&&n.logLevel===s.LogLevel.Log?(...s)=>n.log(e.name,(t=>("importLookup"===e.name&&s.length>0?t.add(null==o?void 0:o.printFileOrModuleName(s[0])):s.forEach((e=>{t.add(null==o?void 0:o.print(e))})),a.timingStats.typeEvaluationTime.timeOperation(e,...s))),t.minimumLoggingThreshold,!0):(0,i.isDebugMode)()?e:a.timingStats.typeEvaluationTime.timeOperation.bind(a.timingStats.typeEvaluationTime,e)}e=l(e);const c=(0,r.createTypeEvaluator)(e,t);return Object.keys(c).forEach((e=>{const t=c[e];"function"==typeof t&&(c[e]=l(t))})),c}},4610:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateLiteralsForType=t.narrowTypeForContainerElementType=t.getElementTypeForContainerNarrowing=t.isIsinstanceFilterSubclass=t.isIsinstanceFilterSuperclass=t.getTypeNarrowingCallback=void 0;const r=n(5275),o=n(563),l=n(2044),c=a(n(8494)),p=n(5083),d=n(817),u=n(9453),y=n(1133),m=n(1133),g=n(5168),h=n(4447);function f(e,t,n){const s=(0,p.getScopeForNode)(t);if(1!==(null==s?void 0:s.type)&&3!==(null==s?void 0:s.type))return;const i=s.lookUpSymbol(t.value);if(!i)return;const a=i.getDeclarations();if(0===a.length||a.some((e=>1!==e.type&&2!==e.type)))return;let r;if(a.some((e=>{const t=2===e.type?e.node.name:e.node,n=c.getExecutionScopeNode(t);return!(!r||n===r)||(r=n,!1)})))return;const o=a.filter((t=>e.isNodeReachable(n,t.node)));return o.length>0?o:void 0}function T(e,t,n,s,i){return i?(0,g.mapSubtypes)(t,(t=>(0,g.mapSubtypes)(n,(i=>{const a=e.assignType(n,t),r=e.assignType(t,i);if(s){if(a)return t;if(r)return i}else if(!a&&!a)return t})))):s?n:t}function v(e,t,n){return(0,g.mapSubtypes)(t,(t=>{if(n){if(e.canBeTruthy(t))return e.removeFalsinessFromType(t)}else if(e.canBeFalsy(t))return e.removeTruthinessFromType(t)}))}function _(e,t,n,s){return e.mapSubtypesExpandTypeVars(t,void 0,(t=>{const i=(0,g.getSpecializedTupleType)(t);if(!i||(0,g.isUnboundedTupleClass)(i)||!i.tupleTypeArguments)return t;const a=i.tupleTypeArguments.length;if(s<0||s>=a)return t;const r=e.makeTopLevelTypeVarsConcrete(i.tupleTypeArguments[s].type);if(n){if(!e.assignType(r,m.NoneType.createInstance()))return}else if((0,m.isNoneInstance)(r))return;return t}))}function I(e,t,n){const s=(0,g.mapSubtypes)(t,(e=>(0,g.transformPossibleRecursiveTypeAlias)(e)));return e.mapSubtypesExpandTypeVars(s,void 0,((e,t)=>{if((0,m.isAnyOrUnknown)(e))return e;const s=(0,m.isTypeVar)(t)&&0===t.details.constraints.length?t:e;return(0,m.isClassInstance)(e)&&m.ClassType.isBuiltIn(e,"object")?n?(0,g.addConditionToType)(m.NoneType.createInstance(),e.condition):s:(0,m.isNoneInstance)(e)===n?e:void 0}))}function b(e,t,n){const s=(0,g.mapSubtypes)(t,(e=>(0,g.transformPossibleRecursiveTypeAlias)(e)));return e.mapSubtypesExpandTypeVars(s,void 0,((e,t)=>{if((0,m.isAnyOrUnknown)(e))return e;const s=(0,m.isTypeVar)(t)&&0===t.details.constraints.length?t:e;return(0,m.isClassInstance)(e)&&m.ClassType.isBuiltIn(e,"object")?n?(0,g.addConditionToType)(m.NoneType.createInstance(),e.condition):s:((0,m.isClassInstance)(e)&&m.ClassType.isBuiltIn(e,"ellipsis"))===n?e:void 0}))}function C(e,t,n,s,i){return!(s.includeSubclasses||(0,m.isTypeVar)(n)||!m.ClassType.isDerivedFrom(t,s)&&!(i&&m.ClassType.isProtocolClass(s)&&e.assignType(s,t))&&(!m.ClassType.isBuiltIn(s,"dict")||!m.ClassType.isTypedDictClass(t)))}function S(e,t,n,s,i){return!!m.ClassType.isDerivedFrom(s,t)||!!(i&&m.ClassType.isProtocolClass(t)&&e.assignType(t,s))}function x(e,t,n,s,i,a,r){const p=(0,g.mapSubtypes)(t,(e=>(0,g.transformPossibleRecursiveTypeAlias)(e))),d=(t,p,d,u)=>{const y=[];let f=!1,T=!1;for(const u of n){const n=e.makeTopLevelTypeVarsConcrete(u);if((0,m.isInstantiableClass)(n)){const v=C(e,t,u,n,s),_=S(e,t,0,n,s);if(v&&(f=!0),_&&v&&!m.ClassType.isSameGenericClass(t,n)&&(T=!0),i)if(v)y.push((0,g.addConditionToType)(t,d));else if(_){let n=u;if((0,m.isClass)(u)&&(m.ClassType.isSpecialBuiltIn(u)||u.details.typeParameters.length>0)){const s=new h.TypeVarContext((0,g.getTypeVarScopeId)(u)),i=m.ClassType.cloneForSpecialization(u,void 0,!1);(0,l.populateTypeVarContextBasedOnExpectedType)(e,i,t,s,void 0)&&(n=(0,g.applySolvedTypeVars)(i,s,{unknownIfNotFound:!0}))}y.push((0,g.addConditionToType)(n,d))}else if(a){const e=`<subclass of ${t.details.name} and ${n.details.name}>`,i=(0,o.getFileInfo)(r);let a=m.ClassType.createInstantiable(e,c.getClassFullName(r,i.moduleName,e),i.moduleName,i.filePath,0,c.getTypeSourceId(r),void 0,t.details.effectiveMetaclass,t.details.docString);a.details.baseClasses=[m.ClassType.cloneAsInstantiable(t),n],(0,g.computeMroLinearization)(a),a=(0,g.addConditionToType)(a,n.condition),(0,m.isTypeVar)(p)&&!p.details.isParamSpec&&0===p.details.constraints.length&&(a=(0,g.addConditionToType)(a,[{typeVarName:m.TypeVarType.getNameWithScope(p),constraintIndex:0,isConstrainedTypeVar:!1}]));let l=m.ClassType.cloneAsInstance(a);t.condition&&(l=(0,g.addConditionToType)(l,t.condition)),y.push(s?l:m.ClassType.cloneAsInstantiable(l))}}else if((0,m.isTypeVar)(u)&&m.TypeBase.isInstantiable(u))s&&m.TypeBase.isInstance(p)?(0,m.isTypeVar)(p)&&(0,m.isTypeSame)((0,g.convertToInstance)(u),p)?i&&y.push(p):i?y.push((0,g.convertToInstance)(u)):(y.push(p),T=!0):!s&&m.TypeBase.isInstantiable(p)&&((0,m.isTypeVar)(p)&&(0,m.isTypeSame)(u,p)?i&&y.push(p):i?y.push(u):(y.push(p),T=!0));else if((0,m.isFunction)(u)&&s){let e=!1;(0,m.isClass)(t)&&(e=!!m.TypeBase.isInstantiable(p)||!!(0,g.lookUpClassMember)(t,"__call__")),e&&(i?y.push(p):f=!0)}}return i||f&&!T||y.push(u),s?y.map((e=>(0,g.convertToInstance)(e))):y.map((e=>(0,m.isInstantiableClass)(e)?(0,g.convertToInstantiable)((0,g.convertToInstance)(e)):e))},u=[],y=[],f=e.mapSubtypesExpandTypeVars(p,void 0,((t,a)=>{const o=(0,g.getTypeCondition)(t)?t:a,l=(0,m.isClassInstance)(t)&&m.ClassType.isBuiltIn(t,"type");if(i&&(0,m.isAnyOrUnknown)(t))return s?u.push((0,m.combineTypes)(n.map((e=>(0,g.convertToInstance)(e))))):u.push((0,m.combineTypes)(n.map((e=>(0,g.convertToInstantiable)((0,g.convertToInstance)(e)))))),void y.push(t);if(s){if((0,m.isNoneInstance)(t)){const e=n.some((e=>!!(0,m.isNoneTypeClass)(e)||(0,m.isInstantiableClass)(e)&&m.ClassType.isBuiltIn(e,"NoneType")));return i?e?t:void 0:e?void 0:t}if(((0,m.isModule)(t)||(0,m.isClassInstance)(t)&&m.ClassType.isBuiltIn(t,"ModuleType"))&&i){const t=n.filter((t=>{const n=e.makeTopLevelTypeVarsConcrete(t);return(0,m.isInstantiableClass)(n)&&m.ClassType.isProtocolClass(n)}));if(t.length>0)return(0,g.convertToInstance)((0,m.combineTypes)(t))}if((0,m.isClassInstance)(t)&&!l)return(0,m.combineTypes)(d(m.ClassType.cloneAsInstantiable(t),(0,g.convertToInstance)(a),(0,g.getTypeCondition)(t),o));if(((0,m.isFunction)(t)||(0,m.isOverloadedFunction)(t))&&s)return(0,m.combineTypes)(((t,s)=>{const a=[];if(i)for(const i of n){const n=e.makeTopLevelTypeVarsConcrete(i);e.assignType(t,(0,g.convertToInstance)(n))&&((0,m.isFunction)(i)?a.push(s):a.push((0,g.convertToInstance)(i)))}else n.some((n=>{const s=e.makeTopLevelTypeVarsConcrete(n);return!((0,m.isClass)(s)&&!m.ClassType.isProtocolClass(s))&&e.assignType(t,(0,g.convertToInstance)(s))}))||a.push(s);return a})(t,(0,g.convertToInstance)(a)));if((0,m.isInstantiableClass)(t)||l){const e=n.some((e=>(0,m.isInstantiableClass)(e)&&m.ClassType.isBuiltIn(e,"type")));return i?e?o:void 0:e?void 0:o}}else{if((0,m.isInstantiableClass)(t))return(0,m.combineTypes)(d(t,a,(0,g.getTypeCondition)(t),o));if(l){const n=e.getBuiltInObject(r,"object");if(n&&(0,m.isClassInstance)(n))return(0,m.combineTypes)(d(m.ClassType.cloneAsInstantiable(n),(0,g.convertToInstantiable)(a),(0,g.getTypeCondition)(t),o))}}return i?void 0:o}));return(0,m.isNever)(f)&&u.length>0?(0,m.combineTypes)(u):(0,m.isNever)(f)&&y.length>0?(0,m.combineTypes)(y):f}function D(e,t,n,s){return(0,g.mapSubtypes)(t,(t=>{const i=e.makeTopLevelTypeVarsConcrete(t);return(0,m.isClassInstance)(i)&&(0,g.isTupleClass)(i)&&!(0,g.isUnboundedTupleClass)(i)&&i.tupleTypeArguments?i.tupleTypeArguments.length===n===s?t:void 0:t}))}function F(e,t,n,s){if(s){const s=E(n);return s?P(e,t,e.makeTopLevelTypeVarsConcrete(s)):t}if(!(0,m.isClassInstance)(n)||!m.ClassType.isBuiltIn(n,"tuple")||!n.tupleTypeArguments)return t;const i=[];return n.tupleTypeArguments.forEach((e=>{e.isUnbounded||((0,m.isNoneInstance)(e.type)||(0,m.isClassInstance)(e.type)&&(0,g.isLiteralType)(e.type))&&i.push(e.type)})),0===i.length?t:(0,g.mapSubtypes)(t,(t=>{if(t=e.makeTopLevelTypeVarsConcrete(t),(0,m.isClassInstance)(t)&&void 0===t.literalValue){const n=L(e,t);if(n&&n.length>0)return(0,m.combineTypes)(n.filter((e=>!i.some((t=>(0,m.isTypeSame)(t,e))))))}if(!i.some((e=>(0,m.isTypeSame)(e,t))))return t}))}function E(e){if(!(0,m.isClassInstance)(e)||!m.ClassType.isBuiltIn(e,["list","set","frozenset","deque","tuple","dict","defaultdict","OrderedDict"]))return;if(!e.typeArguments||e.typeArguments.length<1)return;let t=e.typeArguments[0];return(0,g.isTupleClass)(e)&&e.tupleTypeArguments&&(t=(0,m.combineTypes)(e.tupleTypeArguments.map((e=>e.type)))),t}function P(e,t,n){let s=!0;const i=e.stripLiteralValue(n),a=(0,g.mapSubtypes)(t,(t=>{const a=e.makeTopLevelTypeVarsConcrete(t);return(0,m.isAnyOrUnknown)(a)||(0,m.isClassInstance)(a)&&m.ClassType.isBuiltIn(a,"type")?(s=!1,t):e.assignType(n,a)?t:e.assignType(i,a)?(0,g.mapSubtypes)(n,(e=>{if((0,m.isClassInstance)(e)&&(0,m.isSameWithoutLiteralValue)(t,e))return e})):void 0})),r=(0,g.mapSubtypes)(n,(n=>{const i=e.makeTopLevelTypeVarsConcrete(n);return(0,m.isAnyOrUnknown)(i)?(s=!1,t):e.assignType(t,i)?i:void 0}));return s?(0,m.combineTypes)([a,r]):t}function A(e,t,n,s){return(0,g.mapSubtypes)(t,(t=>{if((0,m.isClassInstance)(t)&&m.ClassType.isTypedDictClass(t)){const i=(0,u.getTypedDictMembersForClass)(e,t,!0).get(n.literalValue);if(s){if(!i)return m.ClassType.isFinal(t)?void 0:t;if(i.isRequired||i.isProvided)return t;const e=t.typedDictNarrowedEntries,s=new Map;return e&&e.forEach(((e,t)=>{s.set(t,e)})),s.set(n.literalValue,{valueType:i.valueType,isRequired:!1,isProvided:!0}),m.ClassType.cloneAsInstance(m.ClassType.cloneForNarrowedTypedDictEntries(m.ClassType.cloneAsInstantiable(t),s))}return void 0!==i&&(i.isRequired||i.isProvided)?void 0:t}return t}))}function N(e,t,n,s,i){let a=!0;const r=(0,g.mapSubtypes)(t,(t=>{if((0,m.isClassInstance)(t)&&m.ClassType.isTypedDictClass(t)){const a=(0,u.getTypedDictMembersForClass)(e,t).get(n.literalValue);if(a&&(0,g.isLiteralTypeOrUnion)(a.valueType))return i?e.assignType(a.valueType,s)?t:void 0:e.assignType(s,a.valueType)?void 0:t}return a=!1,t}));return a?r:t}function k(e,t,n,s,i){let a=!0;const r=(0,g.mapSubtypes)(t,(t=>{var r;if((0,m.isClassInstance)(t)&&m.ClassType.isTupleClass(t)&&!(0,g.isUnboundedTupleClass)(t)&&"number"==typeof n.literalValue){const a=n.literalValue;if(t.tupleTypeArguments&&a>=0&&a<t.tupleTypeArguments.length){const n=null===(r=t.tupleTypeArguments[a])||void 0===r?void 0:r.type;if(n&&(0,g.isLiteralTypeOrUnion)(n))return i?e.assignType(n,s)?t:void 0:e.assignType(s,n)?void 0:t}}return a=!1,t}));return a?r:t}function w(e,t,n,s,i){return(0,g.mapSubtypes)(t,(t=>{let a;if((0,m.isClassInstance)(t)?a=(0,g.lookUpObjectMember)(t,n):(0,m.isInstantiableClass)(t)&&(a=(0,g.lookUpClassMember)(t,n)),a&&a.isTypeDeclared){let n=e.getTypeOfMember(a);if((0,m.isClassInstance)(t)&&(0,g.isProperty)(n)){const t=(0,g.lookUpObjectMember)(n,"fget");if(t&&t.isTypeDeclared){const s=e.getTypeOfMember(t);if((0,m.isFunction)(s)&&s.details.declaredReturnType){const e=m.FunctionType.getSpecializedReturnType(s);e&&(n=e)}}}if((0,g.isLiteralTypeOrUnion)(n))return i?e.assignType(n,s)?t:void 0:e.assignType(s,n)?void 0:t}return t}))}function M(e,t,n,s){return(0,g.mapSubtypes)(t,(t=>{let i;if((0,m.isClassInstance)(t)?i=(0,g.lookUpObjectMember)(t,n):(0,m.isInstantiableClass)(t)&&(i=(0,g.lookUpClassMember)(t,n)),i&&i.isTypeDeclared){const t=e.makeTopLevelTypeVarsConcrete(e.getTypeOfMember(i));let n=!0;if(s?(0,g.doForEachSubtype)(t,(t=>{t=e.makeTopLevelTypeVarsConcrete(t),((0,g.isProperty)(t)||(0,g.isMaybeDescriptorInstance)(t))&&(n=!1),((0,m.isAnyOrUnknown)(t)||(0,m.isNoneInstance)(t)||(0,m.isNever)(t))&&(n=!1)})):n=(0,m.isNoneInstance)(t),n)return}return t}))}function R(e,t,n,s){return e.mapSubtypesExpandTypeVars(t,void 0,((e,t)=>{if((0,m.isClassInstance)(e)){const t=m.ClassType.isDerivedFrom(n,m.ClassType.cloneAsInstantiable(e));if(s)return t?m.ClassType.isSameGenericClass(e,n)?e:(0,g.addConditionToType)(m.ClassType.cloneAsInstance(n),e.condition):void 0;if(t&&m.ClassType.isFinal(e))return;return e}return(0,m.isNoneInstance)(e)?s?void 0:e:(0,m.isAnyOrUnknown)(e)?s?m.ClassType.cloneAsInstance(n):e:t}))}function O(e,t,n,s,i){return(0,g.mapSubtypes)(t,(t=>{if(t=e.makeTopLevelTypeVarsConcrete(t),(0,m.isClassInstance)(t)&&m.ClassType.isSameGenericClass(n,t)){if(void 0!==t.literalValue){const e=m.ClassType.isLiteralValueSame(t,n);if(e&&!s||!e&&s)return;return t}if(s)return n;{const s=L(e,t);if(s&&s.length>0)return(0,m.combineTypes)(s.filter((e=>!m.ClassType.isLiteralValueSame(e,n))))}}else if(s&&(i||(0,m.isNoneInstance)(t)))return;return t}))}function L(e,t){if(m.ClassType.isBuiltIn(t,"bool"))return[m.ClassType.cloneWithLiteral(t,!0),m.ClassType.cloneWithLiteral(t,!1)];if(m.ClassType.isEnumClass(t)){const n=[];return t.details.fields.forEach((s=>{if(!s.isIgnoredForProtocolMatch()){const i=e.getEffectiveTypeOfSymbol(s);(0,m.isClassInstance)(i)&&m.ClassType.isSameGenericClass(t,i)&&void 0!==i.literalValue&&n.push(i)}})),n}}function V(e,t,n,s,i){return e.mapSubtypesExpandTypeVars(t,void 0,(e=>{switch(e.category){case 5:case 6:return n?e:void 0;case 3:case 8:return n?void 0:e;case 7:if(m.TypeBase.isInstantiable(e))return n?e:void 0;if((0,g.lookUpClassMember)(e,"__call__"))return n?e:void 0;if(!n)return e;if(i){const t=`<callable subtype of ${e.details.name}>`,n=(0,o.getFileInfo)(s);let i=m.ClassType.createInstantiable(t,c.getClassFullName(s,n.moduleName,t),n.moduleName,n.filePath,0,c.getTypeSourceId(s),void 0,e.details.effectiveMetaclass,e.details.docString);i.details.baseClasses=[m.ClassType.cloneAsInstantiable(e)],(0,g.computeMroLinearization)(i),i=(0,g.addConditionToType)(i,e.condition);const a=m.FunctionType.createSynthesizedInstance("__call__"),r={category:0,name:"self",type:m.ClassType.cloneAsInstance(i),hasDeclaredType:!0};return m.FunctionType.addParameter(a,r),m.FunctionType.addDefaultParameters(a),a.details.declaredReturnType=m.UnknownType.create(),i.details.fields.set("__call__",d.Symbol.createWithType(4,a)),m.ClassType.cloneAsInstance(i)}return;default:return e}}))}t.getTypeNarrowingCallback=function e(t,n,s,i,a=0){if(a>m.maxTypeRecursionCount)return;if(a++,4===s.nodeType)return function(t,n,s,i,a){var r;return null!==(r=e(t,n,s.rightExpression,i,a))&&void 0!==r?r:e(t,n,s.name,i,a)}(t,n,s,i,a);if(7===s.nodeType){const e=39===s.operator||40===s.operator,a=12===s.operator||28===s.operator;if(e||a){const r=39===s.operator||12===s.operator?i:!i;if(11===s.rightExpression.nodeType&&26===s.rightExpression.constType){let e=s.leftExpression;if(4===e.nodeType&&(e=e.name),c.isMatchingExpression(n,e))return e=>({type:I(t,e,r),isIncomplete:!1});if(24===e.nodeType&&c.isMatchingExpression(n,e.baseExpression)&&1===e.items.length&&!e.trailingComma&&0===e.items[0].argumentCategory&&!e.items[0].name&&40===e.items[0].valueExpression.nodeType&&e.items[0].valueExpression.isInteger&&!e.items[0].valueExpression.isImaginary){const n=e.items[0].valueExpression.value;if("number"==typeof n)return e=>({type:_(t,e,r,n),isIncomplete:!1})}}if(18===s.rightExpression.nodeType){let e=s.leftExpression;if(4===e.nodeType&&(e=e.name),c.isMatchingExpression(n,e))return e=>({type:b(t,e,r),isIncomplete:!1})}if(9===s.leftExpression.nodeType&&1===s.leftExpression.arguments.length&&0===s.leftExpression.arguments[0].argumentCategory){const e=s.leftExpression.arguments[0].valueExpression;if(c.isMatchingExpression(n,e)){const e=t.getTypeOfExpression(s.leftExpression.leftExpression,2).type;if((0,m.isInstantiableClass)(e)&&m.ClassType.isBuiltIn(e,"type")){const e=t.getTypeOfExpression(s.rightExpression),n=t.makeTopLevelTypeVarsConcrete(e.type);if((0,m.isInstantiableClass)(n))return s=>({type:R(t,s,n,r),isIncomplete:!!e.isIncomplete})}}}if(e){if(c.isMatchingExpression(n,s.leftExpression)){const e=t.getTypeOfExpression(s.rightExpression),n=e.type;if((0,m.isClassInstance)(n)&&(m.ClassType.isEnumClass(n)||m.ClassType.isBuiltIn(n,"bool"))&&void 0!==n.literalValue)return s=>({type:O(t,s,n,r,!0),isIncomplete:!!e.isIncomplete})}if(24===s.leftExpression.nodeType&&1===s.leftExpression.items.length&&!s.leftExpression.trailingComma&&0===s.leftExpression.items[0].argumentCategory&&c.isMatchingExpression(n,s.leftExpression.baseExpression)){const e=t.getTypeOfExpression(s.leftExpression.items[0].valueExpression),n=e.type;if((0,m.isClassInstance)(n)&&(0,g.isLiteralType)(n))if(m.ClassType.isBuiltIn(n,"str")){const i=t.getTypeOfExpression(s.rightExpression).type;if((0,m.isClassInstance)(i)&&void 0!==i.literalValue)return s=>({type:N(t,s,n,i,r),isIncomplete:!!e.isIncomplete})}else if(m.ClassType.isBuiltIn(n,"int")){const e=t.getTypeOfExpression(s.rightExpression),i=e.type;if((0,m.isClassInstance)(i)&&void 0!==i.literalValue){let s=!1;if((m.ClassType.isBuiltIn(i,"bool")||i.literalValue instanceof y.EnumLiteral)&&(s=!0),s)return s=>({type:k(t,s,n,i,r),isIncomplete:!!e.isIncomplete})}}}}if(a){const e=12===s.operator?i:!i;if(c.isMatchingExpression(n,s.leftExpression)){const n=t.getTypeOfExpression(s.rightExpression),i=n.type;if((0,m.isClassInstance)(i)&&void 0!==i.literalValue)return s=>({type:O(t,s,i,e,!1),isIncomplete:!!n.isIncomplete})}if(24===s.leftExpression.nodeType&&1===s.leftExpression.items.length&&!s.leftExpression.trailingComma&&0===s.leftExpression.items[0].argumentCategory&&c.isMatchingExpression(n,s.leftExpression.baseExpression)){const n=t.getTypeOfExpression(s.leftExpression.items[0].valueExpression),i=n.type;if((0,m.isClassInstance)(i)&&(0,g.isLiteralType)(i))if(m.ClassType.isBuiltIn(i,"str")){const a=t.getTypeOfExpression(s.rightExpression).type;if((0,m.isClassInstance)(a)&&void 0!==a.literalValue)return s=>({type:N(t,s,i,a,e),isIncomplete:!!n.isIncomplete})}else if(m.ClassType.isBuiltIn(i,"int")){const n=t.getTypeOfExpression(s.rightExpression),a=n.type;if((0,m.isClassInstance)(a)&&void 0!==a.literalValue)return s=>({type:k(t,s,i,a,e),isIncomplete:!!n.isIncomplete})}}}if(a&&9===s.leftExpression.nodeType&&1===s.leftExpression.arguments.length&&40===s.rightExpression.nodeType&&s.rightExpression.isInteger){const e=s.leftExpression.arguments[0].valueExpression;if(c.isMatchingExpression(n,e)){const e=t.getTypeOfExpression(s.leftExpression.leftExpression,2),n=e.type;if((0,m.isFunction)(n)&&"builtins.len"===n.details.fullName){const n=s.rightExpression.value;if("number"==typeof n)return s=>({type:D(t,s,n,r),isIncomplete:!!e.isIncomplete})}}}if(a&&35===s.leftExpression.nodeType&&c.isMatchingExpression(n,s.leftExpression.leftExpression)){const e=t.getTypeOfExpression(s.rightExpression),n=e.type,i=s.leftExpression.memberName;if((0,m.isClassInstance)(n)&&void 0!==n.literalValue)return s=>({type:w(t,s,i.value,n,r),isIncomplete:!!e.isIncomplete})}if(35===s.leftExpression.nodeType&&c.isMatchingExpression(n,s.leftExpression.leftExpression)){const e=t.getTypeOfExpression(s.rightExpression),n=e.type,i=s.leftExpression.memberName;if((0,m.isClassInstance)(n)&&(m.ClassType.isEnumClass(n)||m.ClassType.isBuiltIn(n,"bool"))&&void 0!==n.literalValue)return s=>({type:w(t,s,i.value,n,r),isIncomplete:!!e.isIncomplete})}if(35===s.leftExpression.nodeType&&c.isMatchingExpression(n,s.leftExpression.leftExpression)&&11===s.rightExpression.nodeType&&26===s.rightExpression.constType){const e=s.leftExpression.memberName;return n=>({type:M(t,n,e.value,r),isIncomplete:!1})}}if(41===s.operator||42===s.operator){if(c.isMatchingExpression(n,s.leftExpression)){const e=t.getTypeOfExpression(s.rightExpression),n=e.type,a=41===s.operator?i:!i;return s=>({type:F(t,s,n,a),isIncomplete:!!e.isIncomplete})}if(c.isMatchingExpression(n,s.rightExpression)){const e=t.getTypeOfExpression(s.leftExpression),n=e.type;if((0,m.isClassInstance)(n)&&m.ClassType.isBuiltIn(n,"str")&&(0,g.isLiteralType)(n)){const a=41===s.operator?i:!i;return s=>({type:A(t,s,m.ClassType.cloneAsInstantiable(n),a),isIncomplete:!!e.isIncomplete})}}}}if(9===s.nodeType){if(2===s.arguments.length){const e=s.arguments[0].valueExpression,a=s.arguments[1].valueExpression;if(c.isMatchingExpression(n,e)){const e=t.getTypeOfExpression(s.leftExpression,2),n=e.type;if((0,m.isFunction)(n)&&("isinstance"===n.details.builtInName||"issubclass"===n.details.builtInName)){const r="isinstance"===n.details.builtInName,o=t.getTypeOfExpression(a,104),l=function(e){let t=!1;const n=[],s=(e,i=0)=>{i>m.maxTypeRecursionCount||((0,m.isClass)(e)&&m.TypeBase.isInstance(e)&&(0,g.isTupleClass)(e)?e.tupleTypeArguments&&e.tupleTypeArguments.forEach((e=>{s(e.type,i+1)})):[e].forEach((e=>{(0,m.isInstantiableClass)(e)||(0,m.isTypeVar)(e)&&m.TypeBase.isInstantiable(e)||(0,m.isNoneTypeClass)(e)||(0,m.isFunction)(e)&&2===e.details.parameters.length&&1===e.details.parameters[0].category&&2===e.details.parameters[1].category?n.push(e):t=!0})))};return(0,g.doForEachSubtype)(e,(e=>{s(e)})),t?void 0:n}(o.type),c=!!e.isIncomplete||!!o.isIncomplete;if(l)return e=>{const n=x(t,e,l,r,i,!1,s);return(0,m.isNever)(n)?{type:x(t,e,l,r,i,!0,s),isIncomplete:c}:{type:n,isIncomplete:c}};if(c)return e=>({type:e,isIncomplete:!0})}}}if(1===s.arguments.length){const e=s.arguments[0].valueExpression;if(c.isMatchingExpression(n,e)){const e=t.getTypeOfExpression(s.leftExpression,2),n=e.type;if((0,m.isFunction)(n)&&"callable"===n.details.builtInName)return n=>{let a=V(t,n,i,s,!1);return i&&(0,m.isNever)(a)&&(a=V(t,n,i,s,!0)),{type:a,isIncomplete:!!e.isIncomplete}}}}if(1===s.arguments.length&&!s.arguments[0].name&&c.isMatchingExpression(n,s.arguments[0].valueExpression)){const e=t.getTypeOfExpression(s.leftExpression,2),n=e.type;if((0,m.isInstantiableClass)(n)&&m.ClassType.isBuiltIn(n,"bool"))return n=>({type:v(t,n,i),isIncomplete:!!e.isIncomplete})}if(s.arguments.length>=1){const e=s.arguments[0].valueExpression;if(c.isMatchingExpression(n,e)){let e=!1;const n=e=>e.details.declaredReturnType&&(0,m.isClassInstance)(e.details.declaredReturnType)&&m.ClassType.isBuiltIn(e.details.declaredReturnType,["TypeGuard","StrictTypeGuard"]),a=t.getTypeOfExpression(s.leftExpression,2),r=a.type;if(((0,m.isFunction)(r)&&n(r)||(0,m.isOverloadedFunction)(r)&&m.OverloadedFunctionType.getOverloads(r).some((e=>n(e)))||(0,m.isClassInstance)(r))&&(e=!0),e){const e=t.getTypeOfExpression(s),n=e.type;if((0,m.isClassInstance)(n)&&m.ClassType.isBuiltIn(n,"bool")&&n.typeGuardType){const s=!!n.isStrictTypeGuard,r=n.typeGuardType,o=!!a.isIncomplete||!!e.isIncomplete;return e=>({type:T(t,e,r,i,s),isIncomplete:o})}}}}}if(c.isMatchingExpression(n,s))return e=>({type:v(t,e,i),isIncomplete:!1});const o=function(t,n,s,i,a){if(38!==s.nodeType||38!==n.nodeType||s===n)return;const o=f(t,s,s);if(!o||1!==o.length||1!==o[0].type)return;const l=f(t,n,s);if(!l)return;let p=[];if(l.length>1&&(p=l.filter((e=>t.isNodeReachable(s,e.node)&&t.isNodeReachable(e.node,o[0].node)))),0!==p.length)return;const d=o[0].inferredTypeSource;return d&&!c.isNodeContainedWithin(s,d)&&(0,r.isExpressionNode)(d)?e(t,n,d,i,a):void 0}(t,n,s,i,a);return o||(38===n.nodeType&&55===s.nodeType&&38===s.operator?e(t,n,s.expression,!i,a):void 0)},t.isIsinstanceFilterSuperclass=C,t.isIsinstanceFilterSubclass=S,t.getElementTypeForContainerNarrowing=E,t.narrowTypeForContainerElementType=P,t.enumerateLiteralsForType=L},3843:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.printFunctionParts=t.printObjectTypeForClass=t.printLiteralValue=t.printType=void 0;const r=n(7848),o=a(n(8494)),l=n(1133),c=n(5168),p=/'/g,d=/\\"/g;function u(e,t,n,s=[],i=0){const a=t,r=0!=(16&t);if(t&=-145,i>l.maxTypeRecursionCount)return 256&t?"Any":"<Recursive>";if(i++,e.typeAliasInfo){let a=!0;if((0==(32&t)||s.find((t=>t===e)))&&(a=!1),!a)try{s.push(e);let a=e.typeAliasInfo.name;const r=e.typeAliasInfo.typeParameters;if(r){let o;e.typeAliasInfo.typeArguments?(0==(2&t)||e.typeAliasInfo.typeArguments.some((e=>!(0,l.isAnyOrUnknown)(e))))&&(o=[],e.typeAliasInfo.typeArguments.forEach(((e,a)=>{const p=a<r.length?r[a]:r[r.length-1];(0,l.isVariadicTypeVar)(p)&&(0,l.isClassInstance)(e)&&(0,c.isTupleClass)(e)&&e.tupleTypeArguments?e.tupleTypeArguments.forEach((e=>{o.push(u(e.type,t,n,s,i))})):o.push(u(e,t,n,s,i))}))):(0==(2&t)||r.some((e=>!(0,l.isAnyOrUnknown)(e))))&&(o=[],r.forEach((e=>{o.push(u(e,t,n,s,i))}))),o&&(0===o.length?a+="[()]":a+=`[${o.join(", ")}]`)}if(10!==e.category)return a}finally{s.pop()}}if(s.find((t=>{var n;return t===e||void 0!==t.typeAliasInfo&&t.typeAliasInfo.fullName===(null===(n=e.typeAliasInfo)||void 0===n?void 0:n.fullName)}))||s.length>l.maxTypeRecursionCount){if((0,l.isTypeVar)(e)&&e.details.isSynthesized&&e.details.recursiveTypeAliasName)return e.details.recursiveTypeAliasName;if(e.typeAliasInfo){if(!e.typeAliasInfo.typeParameters)return e.typeAliasInfo.name;try{return s.push(e),u(e,-33&t,n,s,i)}finally{s.pop()}}return"..."}try{s.push(e);const o=0==(320&t),p=e=>void 0!==e.condition&&o?"*":"";switch(e.category){case 0:return 256&t?"Any":"Unbound";case 1:return 257&t?"Any":"Unknown";case 8:return 256&t?"Any":`Module("${e.moduleName}")`;case 7:if(l.TypeBase.isInstance(e))return void 0!==e.literalValue?`Literal[${m(e)}]`:`${g(e,t,n,s)}${p(e)}`;{let i;return i=void 0!==e.literalValue?`Literal[${m(e)}]`:`${g(e,t,n,s)}`,`${T(e,i)}${p(e)}`}case 5:return l.TypeBase.isInstantiable(e)?`Type[${y(l.TypeBase.cloneTypeAsInstance(e),t,n,s,i)}]`:y(e,a,n,s,i);case 6:{const a=e.overloads.map((e=>u(e,t,n,s,i)));return 256&t?"Callable[..., Any]":`Overload[${a.join(", ")}]`}case 9:{const a=new Set,o=new Set,p=8&t?128|t:t;if(0==(32&t)&&e.typeAliasSources)for(const t of e.typeAliasSources){let r=!0,c=!0;const d=new Set;for(const n of t.subtypes){let t=0,s=!1;for(const i of e.subtypes){if((0,l.isTypeSame)(n,i,{ignoreTypeFlags:!0})){a.has(t)||(c=!1),d.add(t),s=!0;break}t++}if(!s){r=!1;break}}r&&!c&&(o.add(u(t,p,n,s,i)),d.forEach((e=>a.add(e))))}const d=e.subtypes.findIndex((e=>(0,l.isNoneInstance)(e)));if(d>=0&&!a.has(d)){const a=(0,l.removeNoneFromUnion)(e);if((0,l.isNever)(a))return"None";const o=u(a,p,n,s,i);if(8&t){const e=o+" | None";return r?`(${e})`:e}return"Optional["+o+"]"}const y=new Set,g=new Set;(0,c.doForEachSubtype)(e,((e,t)=>{a.has(t)||((0,l.isClassInstance)(e)&&void 0!==e.literalValue?y.add(m(e)):(0,l.isInstantiableClass)(e)&&void 0!==e.literalValue?g.add(m(e)):o.add(u(e,p,n,s,i)))}));const h=[];if(o.forEach((e=>h.push(e))),y.size>0){const e=[];y.forEach((t=>e.push(t))),h.push(`Literal[${e.join(", ")}]`)}if(g.size>0){const e=[];g.forEach((t=>e.push(t))),h.push(`Type[Literal[${e.join(", ")}]]`)}if(1===h.length)return h[0];if(8&t){const e=h.join(" | ");return r?`(${e})`:e}return`Union[${h.join(", ")}]`}case 10:{if(e.details.isSynthesized){if(e.details.recursiveTypeAliasName)return 0!=(32&t)&&e.details.boundType?u(l.TypeBase.isInstance(e)?(0,c.convertToInstance)(e.details.boundType):e.details.boundType,t,n,s,i):e.details.recursiveTypeAliasName;if(e.details.isSynthesizedSelf&&e.details.boundType){let a=u(e.details.boundType,-33&t,n,s,i);return(0,l.isAnyOrUnknown)(e.details.boundType)||(a=256&t?"Self":`Self@${a}`),l.TypeBase.isInstantiable(e)?`${T(e,a)}`:a}return 0!=(257&t)?"Any":"Unknown"}if(e.details.isParamSpec)return e.paramSpecAccess?`${e.details.name}.${e.paramSpecAccess}`:`${v(e,0!=(256&t))}`;let a=v(e,0!=(256&t));return e.isVariadicUnpacked&&(a=f(a,t)),e.isVariadicInUnion&&(a=`Union[${a}]`),l.TypeBase.isInstantiable(e)?`${T(e,a)}`:a}case 3:return`${l.TypeBase.isInstantiable(e)?`${T(e,"None")}`:"None"}${p(e)}`;case 4:return e.isNoReturn?"NoReturn":"Never";case 2:return e.isEllipsis?"...":"Any"}return""}finally{s.pop()}}function y(e,t,n,s=[],i=0){if(256&t){let a=!1;0===e.details.parameters.length?a=!0:e.details.parameters.every((e=>0===e.category))&&(e.details.parameters[e.details.parameters.length-1].name||(a=!0));const r=n(e);let o="Any";if(r&&(o=u(r,t,n,s,i)),a){const a=[];return e.details.parameters.forEach(((r,o)=>{if(r.name){const r=l.FunctionType.getEffectiveParameterType(e,o);s.length<l.maxTypeRecursionCount?a.push(u(r,t,n,s,i)):a.push("Any")}})),e.details.paramSpec?`Callable[Concatenate[${a.join(", ")}, ${e.details.paramSpec.details.name}], ${o}]`:`Callable[[${a.join(", ")}], ${o}]`}return`Callable[..., ${o}]`}{const i=h(e,t,n,s),a=`(${i[0].join(", ")})`;if(l.FunctionType.isParamSpecValue(e))return a;const r=`${a} -> ${i[1]}`;return 0!=(128&t)?`(${r})`:r}}function m(e,t="'"){const n=e.literalValue;if(void 0===n)return"";let s;if("string"==typeof n){let i=n;const a=50;if(n.length>a&&(i=n.substring(0,a)+""),"bytes"===e.details.name){let e="";for(let t=0;t<i.length;t++){const n=i.substring(t,t+1),s=n.charCodeAt(0);e+=s>=20&&s<=126?34===s?"\\"+n:n:`\\x${(s>>4&15).toString(16)}${(15&s).toString(16)}`}s=`b"${e}"`}else s=JSON.stringify(i).toString(),'"'!==t&&(s=`'${s.substring(1,s.length-1).replace(d,'"').replace(p,"\\'")}'`)}else"boolean"==typeof n?s=n?"True":"False":n instanceof l.EnumLiteral?s=`${n.className}.${n.itemName}`:"bigint"==typeof n?(s=n.toString(),s.endsWith("n")&&(s=s.substring(0,s.length-1))):s=n.toString();return s}function g(e,t,n,s=[],i=0){var a,r;let o=e.aliasName||e.details.name;if(!l.ClassType.isPseudoGenericClass(e)){const c=l.ClassType.getTypeParameters(e),p=c.length>0?c[c.length-1]:void 0,d=!!p&&p.details.isVariadic,y=null!==(a=e.tupleTypeArguments)&&void 0!==a?a:null===(r=e.typeArguments)||void 0===r?void 0:r.map((e=>({type:e,isUnbounded:!1})));if(y)if(y.length>0){const a=[];let r=!0;y.forEach(((e,o)=>{const p=o<c.length?c[o]:void 0;if(p&&p.details.isVariadic&&(0,l.isClassInstance)(e.type)&&l.ClassType.isBuiltIn(e.type,"tuple")&&e.type.tupleTypeArguments)0===e.type.tupleTypeArguments.length?((0,l.isAnyOrUnknown)(e.type)||(r=!1),0===o&&a.push(f("tuple[()]",t))):a.push(...e.type.tupleTypeArguments.map((e=>{(0,l.isAnyOrUnknown)(e.type)||(r=!1);const a=u(e.type,t,n,s,i);return e.isUnbounded?f(`tuple[${a}, ...]`,t):a})));else{(0,l.isAnyOrUnknown)(e.type)||(r=!1);const o=u(e.type,t,n,s,i);e.isUnbounded?1===y.length?a.push(o,"..."):a.push(f(`tuple[${o}, ...]`,t)):a.push(o)}})),e.isUnpacked&&(o=f(o,t)),0!=(2&t)&&r||(o+="["+a.join(", ")+"]")}else e.isUnpacked&&(o=f(o,t)),(l.ClassType.isTupleClass(e)||d)&&(o+="[()]");else e.isUnpacked&&(o=f(o,t)),c.length>0&&(0==(2&t)||c.some((e=>!(0,l.isAnyOrUnknown)(e))))&&(o+="["+c.map((e=>u(e,t,n,s,i))).join(", ")+"]")}return o}function h(e,t,n,s=[],i=0){const a=[];let c=!1;e.details.parameters.forEach(((p,d)=>{if(d===e.details.parameters.length-1&&1===p.category&&(0,l.isVariadicTypeVar)(p.type)){const r=l.FunctionType.getEffectiveParameterType(e,d);if((0,l.isClassInstance)(r)&&l.ClassType.isBuiltIn(r,"tuple")&&r.tupleTypeArguments)return void r.tupleTypeArguments.forEach((e=>{const r=u(e.type,t,n,s,i);a.push(r)}))}if((0,r.isTypedKwargs)(p)&&1024&t&&7===p.type.category)return void p.type.details.typedDictEntries.forEach(((e,r)=>{const o=u(e.valueType,t,n,s,i);a.push(`${r}: ${o}`)}));let y="";1===p.category?p.name&&p.isNameSynthesized||(y+="*"):2===p.category&&(y+="**");let m=!1;p.name&&!p.isNameSynthesized?(y+=p.name,c=!0,m=!0):256&t&&(y+=`__p${d}`,c=!0,m=!0);let g="=",h=!1;if(p.name)if(p.hasDeclaredType||p.isTypeInferred){const a=l.FunctionType.getEffectiveParameterType(e,d);let r=s.length<l.maxTypeRecursionCount?u(a,t,n,s,i):"";m?y+=": ":1!==p.category||(0,l.isUnpacked)(a)||(y+="*"),2===p.category&&(0,l.isUnpacked)(a)&&(r=256&t?`Unpack[${r.substring(1)}]`:"*"+r),y+=r,(0,l.isParamSpec)(a)&&(1!==p.category&&2!==p.category||(h=!0)),g=" = "}else 0==(2&t)&&(p.isNameSynthesized||(y+=": "),y+=257&t?"Any":"Unknown",g=" = ");else if(0===p.category){if(!c)return;y+="/"}if(p.hasDefault&&(p.defaultValueExpression?y+=g+o.printExpression(p.defaultValueExpression):y+=g+"..."),l.FunctionType.shouldSkipArgsKwargsCompatibilityCheck(e)&&!h)if(1===p.category)y="...";else if(2===p.category)return;a.push(y)})),e.details.paramSpec&&(256&t?(a.push(`*args: ${e.details.paramSpec}.args`),a.push(`**kwargs: ${e.details.paramSpec}.kwargs`)):a.push(`**${u(e.details.paramSpec,t,n,s,i)}`));const p=n(e),d=s.length<l.maxTypeRecursionCount?u(p,144|t,n,s,i):"";return[a,d]}function f(e,t){return 512&t?`Unpack[${e}]`:`*${e}`}function T(e,t){var n;const s=(null!==(n=e.instantiableNestingLevel)&&void 0!==n?n:0)+1;for(let e=0;e<s;e++)t=`Type[${t}]`;return t}function v(e,t){return t?e.details.name:l.TypeVarType.getReadableName(e)}t.printType=u,t.printLiteralValue=m,t.printObjectTypeForClass=g,t.printFunctionParts=h},2590:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.TypeStubWriter=void 0;const r=n(5275),o=a(n(563)),l=a(n(8494)),c=n(427),p=n(5083),d=a(n(1766)),u=n(1133);class y{constructor(e){this.importName=e,this.isAccessed=!1}}class m extends y{constructor(e,t,n){super(e),this.alias=t,this.symbol=n}}class g extends y{constructor(e,t,n){super(e),this.isWildcardImport=t,this.node=n,this.symbols=[]}addSymbol(e,t,n,s=!1){this.symbols.find((e=>e.name===t))||this.symbols.push({symbol:e,name:t,alias:n,isAccessed:s})}}class h extends c.ParseTreeWalker{constructor(e,t){super(),this._accessedImportedSymbols=e,this._treatStringsAsSymbols=t}analyze(e){this.walk(e)}walk(e){o.isCodeUnreachable(e)||super.walk(e)}visitName(e){return this._accessedImportedSymbols.add(e.value),!0}visitMemberAccess(e){const t=this._getRecursiveModuleAccessExpression(e.leftExpression);return t&&this._accessedImportedSymbols.add(`${t}.${e.memberName.value}`),!0}visitString(e){return this._treatStringsAsSymbols&&this._accessedImportedSymbols.add(e.value),!0}_getRecursiveModuleAccessExpression(e){if(38===e.nodeType)return e.value;if(35===e.nodeType){const t=this._getRecursiveModuleAccessExpression(e.leftExpression);if(!t)return;return`${t}.${e.memberName.value}`}}}class f extends c.ParseTreeWalker{constructor(e,t,n){super(),this._stubPath=e,this._sourceFile=t,this._evaluator=n,this._indentAmount=0,this._includeAllImports=!1,this._typeStubText="",this._lineEnd="\n",this._tab="    ",this._classNestCount=0,this._functionNestCount=0,this._ifNestCount=0,this._emittedSuite=!1,this._emitDocString=!0,this._trackedImportAs=new Map,this._trackedImportFrom=new Map,this._accessedImportedSymbols=new Set,this._stubPath.endsWith("__init__.pyi")&&(this._includeAllImports=!0)}write(){const e=this._sourceFile.getParseResults();this._lineEnd=e.tokenizerOutput.predominantEndOfLineSequence,this._tab=e.tokenizerOutput.predominantTabSequence,this.walk(e.parseTree),this._writeFile()}walk(e){o.isCodeUnreachable(e)||super.walk(e)}visitClass(e){const t=e.name.value;this._emittedSuite=!0,this._emitDocString=!0,this._emitDecorators(e.decorators);let n=`class ${t}`;e.typeParameters&&(n+=this._printTypeParameters(e.typeParameters));const s=e.arguments.filter((e=>void 0!==e.name||0!==e.argumentCategory||38!==e.valueExpression.nodeType||"object"!==e.valueExpression.value));return s.length>0&&(n+=`(${s.map((e=>{let t="";return e.name&&(t=e.name.value+"="),t+=this._printExpression(e.valueExpression),t})).join(", ")})`),n+=":",this._emitLine(n),this._emitSuite((()=>{this._classNestCount++,this.walk(e.suite),this._classNestCount--})),this._emitLine(""),this._emitLine(""),!1}visitFunction(e){const t=e.name.value;if(0===this._functionNestCount&&!d.isPrivateOrProtectedName(t)){this._emittedSuite=!0,this._emitDocString=!0,this._emitDecorators(e.decorators);let n,s=e.isAsync?"async ":"";if(s+=`def ${t}`,e.typeParameters&&(s+=this._printTypeParameters(e.typeParameters)),s+=`(${e.parameters.map(((t,n)=>this._printParameter(t,e,n))).join(", ")})`,e.returnTypeAnnotation?n=this._printExpression(e.returnTypeAnnotation,!0):e.functionAnnotationComment?n=this._printExpression(e.functionAnnotationComment.returnTypeAnnotation,!0):"__init__"===e.name.value?n="None":"__str__"===e.name.value?n="str":["__int__","__hash__"].some((t=>t===e.name.value))?n="int":["__eq__","__ne__","__gt__","__lt__","__ge__","__le__"].some((t=>t===e.name.value))&&(n="bool"),n&&(s+=" -> "+n),s+=":",!n){const t=this._evaluator.getTypeOfFunction(e);if(t&&(0,u.isFunction)(t.functionType)){let e=this._evaluator.getFunctionInferredReturnType(t.functionType);e=(0,u.removeUnknownFromUnion)(e),(0,u.isNever)(e)||(0,u.isUnknown)(e)||(s+=` # -> ${this._evaluator.printType(e)}:`)}}this._emitLine(s),this._emitSuite((()=>{this._functionNestCount++,this.walk(e.suite),this._functionNestCount--})),this._emitLine("")}return!1}visitWhile(e){return this._emitDocString=!1,!1}visitFor(e){return this._emitDocString=!1,!1}visitTry(e){return this._emitDocString=!1,this.walk(e.trySuite),!1}visitWith(e){return this._emitDocString=!1,!1}visitIf(e){if(this._emitDocString=!1,0===this._functionNestCount&&0===this._ifNestCount){this._ifNestCount++,this._emittedSuite=!0,this._emitLine("if "+this._printExpression(e.testExpression)+":"),this._emitSuite((()=>{this.walkMultiple(e.ifSuite.statements)}));const t=e.elseSuite;t&&(this._emitLine("else:"),this._emitSuite((()=>{19===t.nodeType?this.walkMultiple([t.testExpression,t.ifSuite,t.elseSuite]):this.walkMultiple(t.statements)}))),this._ifNestCount--}return!1}visitTypeAlias(e){let t="";return t=this._printExpression(e.name),e.typeParameters&&(t+=this._printTypeParameters(e.typeParameters)),t+=" = ",t+=this._printExpression(e.expression),this._emitLine(t),!1}visitAssignment(e){let t=!1,n="";if(38===e.leftExpression.nodeType){if("__all__"===e.leftExpression.value)return 0===this._functionNestCount&&0===this._ifNestCount&&(this._emittedSuite=!0,n=this._printExpression(e.leftExpression),n+=" = ",n+=this._printExpression(e.rightExpression),this._emitLine(n)),!1;if(0===this._functionNestCount){n=this._printExpression(e.leftExpression),e.typeAnnotationComment&&(n+=": "+this._printExpression(e.typeAnnotationComment,!0));const s=this._evaluator.getType(e.leftExpression);if(null==s?void 0:s.typeAliasInfo)t=!0;else if(9===e.rightExpression.nodeType){const n=this._evaluator.getType(e.rightExpression.leftExpression);n&&(0,u.isInstantiableClass)(n)&&u.ClassType.isBuiltIn(n,["TypeVar","TypeVarTuple","ParamSpec","NewType"])&&(t=!0)}}}else if(54===e.leftExpression.nodeType){const t=e.leftExpression.valueExpression;38===t.nodeType&&0===this._functionNestCount&&(n=`${this._printExpression(t)}: ${this._printExpression(e.leftExpression.typeAnnotation,!0)}`)}return n&&(this._emittedSuite=!0,n+=" = ",n+=t?this._printExpression(e.rightExpression):"...",this._emitLine(n)),!1}visitAugmentedAssignment(e){if(38===e.leftExpression.nodeType&&"__all__"===e.leftExpression.value&&1===e.operator&&0===this._functionNestCount&&0===this._ifNestCount){let t=this._printExpression(e.leftExpression);t+=" += ",t+=this._printExpression(e.rightExpression),this._emitLine(t)}return!1}visitTypeAnnotation(e){if(0===this._functionNestCount){let t="";if(38===e.valueExpression.nodeType)t=this._printExpression(e.valueExpression);else if(35===e.valueExpression.nodeType){const n=e.valueExpression.leftExpression;if(38===n.nodeType&&"self"===n.value){const n=e.valueExpression.memberName.value;d.isPrivateOrProtectedName(n)||(t=this._printExpression(e.valueExpression))}}t&&(t+=": "+this._printExpression(e.typeAnnotation,!0),this._emitLine(t))}return!1}visitImport(e){if(this._functionNestCount>0||this._classNestCount>0)return!1;const t=(0,p.getScopeForNode)(e);return t&&e.list.forEach((e=>{const n=this._printModuleName(e.module);if(!this._trackedImportAs.has(n)){const s=e.alias?e.alias.value:e.module.nameParts.length>0?e.module.nameParts[0].value:"",i=t.lookUpSymbolRecursive(s);if(i){const t=new m(n,e.alias?e.alias.value:void 0,i.symbol);this._trackedImportAs.set(n,t)}}})),!1}visitImportFrom(e){if(this._functionNestCount>0||this._classNestCount>0)return!1;const t=(0,p.getScopeForNode)(e);if(t){const n=this._printModuleName(e.module);let s=this._trackedImportFrom.get(n);s||(s=new g(n,e.isWildcardImport,e),this._trackedImportFrom.set(n,s)),e.imports.forEach((e=>{const n=e.alias?e.alias.value:e.name.value,i=t.lookUpSymbolRecursive(n);i&&s.addSymbol(i.symbol,e.name.value,e.alias?e.alias.value:void 0,!1)}))}return!1}visitStatementList(e){return e.statements.length>0&&48===e.statements[0].nodeType&&!this._emittedSuite&&this._emitDocString&&this._emitLine(this._printExpression(e.statements[0])),this._emitDocString=!1,this.walkMultiple(e.statements),!1}_emitSuite(e){this._increaseIndent((()=>{const t=this._emittedSuite;this._emittedSuite=!1,e(),this._emittedSuite||this._emitLine("..."),this._emittedSuite=t}))}_increaseIndent(e){this._indentAmount++,e(),this._indentAmount--}_emitDecorators(e){e.forEach((e=>{this._emitLine("@"+this._printExpression(e.expression))}))}_printHeaderDocString(){return'"""'+this._lineEnd+"This type stub file was generated by pyright."+this._lineEnd+'"""'+this._lineEnd+this._lineEnd}_emitLine(e){for(let e=0;e<this._indentAmount;e++)this._typeStubText+=this._tab;this._typeStubText+=e+this._lineEnd}_printTypeParameters(e){return`[${e.parameters.map((e=>this._printTypeParameter(e))).join(",")}]`}_printTypeParameter(e){let t="";return e.typeParamCategory===r.TypeParameterCategory.TypeVarTuple?t+="*":e.typeParamCategory===r.TypeParameterCategory.ParamSpec&&(t+="**"),t+=e.name.value,e.boundExpression&&(t+=": ",t+=this._printExpression(e.boundExpression)),e.defaultExpression&&(t+=" = ",t+=this._printExpression(e.defaultExpression)),t}_printModuleName(e){let t="";for(let n=0;n<e.leadingDots;n++)t+=".";return t+=e.nameParts.map((e=>e.value)).join("."),t}_printParameter(e,t,n){let s="";1===e.category?s+="*":2===e.category&&(s+="**"),e.name?s+=e.name.value:0===e.category&&(s+="/");const i=l.getTypeAnnotationForParameter(t,n);let a="";return i&&(a=this._printExpression(i,!0)),a&&(s+=": "+a),e.defaultValue&&(s+=a?" = ...":"=..."),s}_printExpression(e,t=!1,n=!1){new h(this._accessedImportedSymbols,n).analyze(e);let s=t?1:0;return s|=2,l.printExpression(e,s)}_printTrackedImports(){let e="",t=!1;return this._trackedImportAs.forEach((n=>{this._accessedImportedSymbols.has(n.alias||n.importName)&&(n.isAccessed=!0),(n.isAccessed||this._includeAllImports)&&(e+=`import ${n.importName}`,n.alias&&(e+=` as ${n.alias}`),e+=this._lineEnd,t=!0)})),this._trackedImportFrom.forEach((n=>{n.symbols.forEach((e=>{this._accessedImportedSymbols.has(e.alias||e.name)&&(e.isAccessed=!0)})),n.isWildcardImport&&(e+=`from ${n.importName} import *`+this._lineEnd,t=!0);const s=n.symbols.filter((e=>e.isAccessed||this._includeAllImports)).sort(((e,t)=>e.name<t.name?-1:e.name>t.name?1:0));s.length>0&&(e+=`from ${n.importName} import `,e+=s.map((e=>{let t=e.name;return e.alias&&(t+=" as "+e.alias),t})).join(", "),e+=this._lineEnd,t=!0)})),t&&(e+=this._lineEnd),e}_writeFile(){let e=this._printHeaderDocString();e+=this._printTrackedImports(),e+=this._typeStubText,this._sourceFile.fileSystem.writeFileSync(this._stubPath,e,"utf8")}}t.TypeStubWriter=f},5168:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setTypeArgumentsRecursive=t.specializeClassType=t.isTypeVarLimitedToCallable=t.getTypeVarArgumentsRecursive=t.addTypeVarsToListIfUnique=t.getClassFieldsRecursive=t.getClassIterator=t.getClassMemberIterator=t.lookUpClassMember=t.lookUpObjectMember=t.getContainerDepth=t.getProtocolSymbols=t.transformExpectedTypeForConstructor=t.validateTypeVarDefault=t.applySolvedTypeVars=t.ensureFunctionSignaturesAreUnique=t.populateTypeVarContextForSelfType=t.partiallySpecializeType=t.isUnboundedTupleClass=t.isTupleClass=t.isMaybeDescriptorInstance=t.isDescriptorInstance=t.isProperty=t.isEllipsisType=t.getUnionSubtypeCount=t.getLiteralTypeClassName=t.containsLiteralType=t.containsType=t.isLiteralTypeOrUnion=t.isLiteralType=t.getSpecializedTupleType=t.getTypeVarScopeId=t.transformPossibleRecursiveTypeAlias=t.isTypeAliasRecursive=t.isTypeAliasPlaceholder=t.getTypeCondition=t.addConditionToType=t.getFullNameOfType=t.derivesFromAnyOrUnknown=t.isUnionableType=t.preserveUnknown=t.areTypesSame=t.doForEachSubtype=t.sortTypes=t.mapSubtypes=t.makeInferenceContext=t.isTypeVarSame=t.isIncompleteUnknown=t.isOptionalType=t.UniqueSignatureTracker=void 0,t.convertParamSpecValueToType=t.convertTypeToParamSpecValue=t.getDeclaringModulesForType=t.computeMroLinearization=t.isVarianceOfTypeArgumentCompatible=t.combineVariances=t.requiresSpecialization=t.requiresTypeArguments=t.getGeneratorTypeArgs=t.removeParamSpecVariadicsFromFunction=t.removeParamSpecVariadicsFromSignature=t.specializeTupleClass=t.combineSameSizedTuples=t.explodeGenericClass=t.isPartlyUnknown=t.containsUnknown=t.getMembersForModule=t.getMembersForClass=t.convertToInstantiable=t.convertToInstance=t.isEffectivelyInstantiable=t.isMetaclassInstance=t.getGeneratorYieldType=t.getDeclaredGeneratorReturnType=t.synthesizeTypeVarForSelfCls=t.derivesFromClassRecursive=t.specializeForBaseClass=t.buildTypeVarContext=t.buildTypeVarContextFromSpecializedClass=void 0;const s=n(9489),i=n(5839),a=n(817),r=n(2917),o=n(1133),l=n(4447);function c(e,t){if((0,o.isUnion)(e)){const n=[];let s=!1;if(e.subtypes.forEach((i=>{const a=t(i);a?a!==i?(n.push(y(a,m(e))),s=!0):n.push(i):s=!0})),!s)return e;const i=(0,o.combineTypes)(n);return 9===i.category&&o.UnionType.addTypeAliasSource(i,e),i}return t(e)||o.NeverType.createNever()}function p(e){return e.slice(0).sort(((e,t)=>d(e,t)))}function d(e,t){var n,s;if(e.category!==t.category)return t.category-e.category;switch(e.category){case 0:case 1:case 2:case 3:case 4:case 9:return 0;case 5:{const i=t,a=e.details.parameters.length,r=i.details.parameters.length;if(a!==r)return r-a;for(let t=0;t<a;t++){const n=e.details.parameters[t],s=i.details.parameters[t];if(n.category!==s.category)return s.category-n.category;const a=d(n.type,s.type);if(0!==a)return a}const l=d(null!==(n=e.details.declaredReturnType)&&void 0!==n?n:o.UnknownType.create(),null!==(s=i.details.declaredReturnType)&&void 0!==s?s:o.UnknownType.create());if(0!==l)return l;const c=e.details.name,p=i.details.name;return c<p?-1:c>p?1:0}case 6:{const n=t,s=e.overloads.length,i=n.overloads.length;if(s!==i)return i-s;for(let t=0;t<s;t++){const s=d(e.overloads[t],n.overloads[t]);if(0!==s)return s}return 0}case 7:{const n=t;if((0,o.isClassInstance)(e)&&(0,o.isInstantiableClass)(n))return-1;if((0,o.isInstantiableClass)(e)&&(0,o.isClassInstance)(n))return 1;if(h(e)){if(!h(n))return-1}else if(h(n))return 1;if(e.details.typeParameters.length>0||_(e)){if(0===n.details.typeParameters.length)return 1}else if(n.details.typeParameters.length>0||_(n))return-1;const s=e.details.name,i=t.details.name;return s<i?-1:s===i?0:1}case 8:{const n=e.moduleName,s=t.moduleName;return n<s?-1:n===s?0:1}case 10:{const n=e.details.name,s=t.details.name;return n<s?-1:n===s?0:1}}return 1}function u(e,t,n=!1){if((0,o.isUnion)(e)){const s=n?p(e.subtypes):e.subtypes;s.forEach(((e,n)=>{t(e,n,s)}))}else t(e,0,[e])}function y(e,t){if(!t)return e;switch(e.category){case 0:case 1:case 2:case 4:case 8:case 10:return e;case 3:case 5:case 7:return o.TypeBase.cloneForCondition(e,o.TypeCondition.combine(e.condition,t));case 6:return o.OverloadedFunctionType.create(e.overloads.map((e=>y(e,t))));case 9:return(0,o.combineTypes)(e.subtypes.map((e=>y(e,t))))}}function m(e){switch(e.category){case 0:case 1:case 2:case 4:case 8:case 10:case 6:case 9:return;case 3:case 7:case 5:return e.condition}}function g(e){return(0,o.isClass)(e)||(0,o.isFunction)(e)?e.details.typeVarScopeId:(0,o.isTypeVar)(e)?e.scopeId:void 0}function h(e){return o.TypeBase.isInstance(e)&&void 0!==e.literalValue}function f(e,t,n=!1,s=0){var i;if(s>o.maxTypeRecursionCount)return!1;if(s++,t(e))return!0;if(n&&(0,o.isClass)(e)){const a=(null===(i=e.tupleTypeArguments)||void 0===i?void 0:i.map((e=>e.type)))||e.typeArguments;if(a)return a.some((e=>f(e,t,n,s)))}if((0,o.isUnion)(e))return e.subtypes.some((e=>f(e,t,n,s)));if((0,o.isOverloadedFunction)(e))return e.overloads.some((e=>f(e,t,n,s)));if((0,o.isFunction)(e)){const i=o.FunctionType.getSpecializedReturnType(e);if(i&&f(i,t,n,s))return!0;for(let i=0;i<e.details.parameters.length;i++)if(f(o.FunctionType.getEffectiveParameterType(e,i),t,n,s))return!0}return!1}function T(e,t=!1,n=0){return f(e,(e=>!!(0,o.isClassInstance)(e)&&(h(e)||o.ClassType.isBuiltIn(e,"LiteralString"))),t,n)}function v(e,t=!1){return(0,o.isUnion)(e)?e.subtypes.some((e=>v(e,t))):!(!(0,o.isClassInstance)(e)||!e.details.fields.has("__get__")||t&&!e.details.fields.has("__set__"))}function _(e){return o.ClassType.isBuiltIn(e,"tuple")}function I(e){return e.tupleTypeArguments&&e.tupleTypeArguments.some((e=>e.isUnbounded||(0,o.isUnpackedVariadicTypeVar)(e.type)))}function b(e,t,n,s){if(o.ClassType.isUnspecialized(t))return e;const i=N(t,void 0);return n&&C(i,t,n),S(e,i,{typeClassType:s})}function C(e,t,n){const s=w(t,!1);e.setTypeVarType(s,R(n))}function S(e,t,n={}){return!t.isEmpty()||n.unknownIfNotFound||n.eliminateUnsolvedInUnions?new H(t,n).apply(e,0):e}function x(e,t,n=0){n>o.maxTypeRecursionCount||(e.details.baseClasses.forEach((e=>{(0,o.isClass)(e)&&o.ClassType.isProtocolClass(e)&&x(e,t,n+1)})),e.details.fields.forEach(((n,s)=>{n.isIgnoredForProtocolMatch()||t.set(s,{symbol:n,classType:e,isInstanceMember:n.isInstanceMember(),isClassMember:n.isClassMember(),isClassVar:n.isClassVar(),isTypeDeclared:n.hasTypedDeclarations(),skippedUndeclaredType:!1})})))}function D(e,t,n=0){var s;return null===(s=F(e,t,n).next())||void 0===s?void 0:s.value}function*F(e,t,n=0){const s=0!=(16&n);let i=!1;if((0,o.isClass)(e)){let r=0;1&n&&(r|=1),2&n&&(r|=2),4&n&&(r|=4),32&n&&(r|=8);const l=E(e,r);for(const[e,r]of l){if(!(0,o.isInstantiableClass)(e)){if(!s){const e={symbol:a.Symbol.createWithType(0,o.UnknownType.create()),isInstanceMember:!1,isClassMember:!0,isClassVar:!1,classType:o.UnknownType.create(),isTypeDeclared:!1,skippedUndeclaredType:!1};yield e}continue}if(!(0,o.isInstantiableClass)(r))continue;const l=r.details.fields;if(0==(8&n)){const e=l.get(t);if(e&&e.isInstanceMember()){const t=e.hasTypedDeclarations();if(!s||t){const n={symbol:e,isInstanceMember:!0,isClassMember:e.isClassMember(),isClassVar:e.isClassVar(),classType:r,isTypeDeclared:t,skippedUndeclaredType:i};yield n}else i=!0}}const c=l.get(t);if(c&&c.isClassMember()){const e=c.hasTypedDeclarations();if(!s||e){let t=c.isInstanceMember(),n=!0;const s=o.ClassType.isDataClass(r),a=o.ClassType.isTypedDictClass(r);if(e&&(s||a)){const e=c.getDeclarations();e.length>0&&1===e[0].type&&(t=!0,n=s)}const l={symbol:c,isInstanceMember:t,isClassMember:n,isClassVar:c.isClassVar(),classType:r,isTypeDeclared:e,skippedUndeclaredType:i};yield l}else i=!0}}}else if((0,o.isAnyOrUnknown)(e)){const e={symbol:a.Symbol.createWithType(0,o.UnknownType.create()),isInstanceMember:!1,isClassMember:!0,isClassVar:!1,classType:o.UnknownType.create(),isTypeDeclared:!1,skippedUndeclaredType:!1};yield e}}function*E(e,t=0){if((0,o.isClass)(e)){let n=0!=(1&t);for(const s of e.details.mro){if(n){n=!1;continue}const i=b(s,e);if(4&t&&(0,o.isInstantiableClass)(i)&&o.ClassType.isBuiltIn(i,"object"))break;if(8&t&&(0,o.isInstantiableClass)(i)&&o.ClassType.isBuiltIn(i,"type"))break;if(yield[s,i],0!=(2&t))break}}}function P(e,t){for(const n of t)e.find((e=>(0,o.isTypeSame)(R(e),R(n))))||e.push(n)}function A(e,t,n=0){if(n>o.maxTypeRecursionCount)return{isTypeVarUsed:!1,isUsedInCallable:!1};n++;let s=0,i=0;if((0,o.isTypeVar)(e))(0,o.isParamSpec)(e)&&e.paramSpecAccess||(0,o.isTypeSame)(t,R(e))&&s++;else if((0,o.isClass)(e))e.typeArguments&&e.typeArguments.forEach((e=>{const a=A(e,t,n);a.isTypeVarUsed&&s++,a.isUsedInCallable&&i++}));else if((0,o.isUnion)(e))u(e,(e=>{const a=A(e,t,n);a.isTypeVarUsed&&s++,a.isUsedInCallable&&i++}));else if((0,o.isFunction)(e)){for(let i=0;i<e.details.parameters.length;i++)A(o.FunctionType.getEffectiveParameterType(e,i),t,n).isTypeVarUsed&&s++;e.details.paramSpec&&(0,o.isTypeSame)(t,R(e.details.paramSpec))&&s++;const a=o.FunctionType.getSpecializedReturnType(e);a&&A(a,t,n).isTypeVarUsed&&s++,s>0&&(s=1,i=1)}return{isTypeVarUsed:s>0,isUsedInCallable:1===i&&1===s}}function N(e,t=!0){const n=o.ClassType.getTypeParameters(e);let s=e.typeArguments;s||t||(s=n);const i=k(n,s,g(e));return o.ClassType.isTupleClass(e)&&e.tupleTypeArguments&&n.length>=1&&i.setTupleTypeVar(n[0],e.tupleTypeArguments),i}function k(e,t,n){const s=new l.TypeVarContext(n);return e.forEach(((e,n)=>{let i;if(t)if((0,o.isParamSpec)(e)){if(n<t.length)if(i=t[n],(0,o.isFunction)(i)&&o.FunctionType.isParamSpecValue(i)){const t=[],n=i;i.details.parameters.forEach(((e,s)=>{t.push({category:e.category,name:e.name,hasDefault:!!e.hasDefault,defaultValueExpression:e.defaultValueExpression,isNameSynthesized:e.isNameSynthesized,type:o.FunctionType.getEffectiveParameterType(n,s)})})),s.setTypeVarType(e,W(i))}else((0,o.isParamSpec)(i)||(0,o.isAnyOrUnknown)(i))&&s.setTypeVarType(e,W(i))}else i=n>=t.length?o.AnyType.create():t[n],s.setTypeVarType(e,i,void 0,i)})),s}function w(e,t){var n;const s=o.TypeVarType.createInstance("__type_of_self__"),i=null!==(n=g(e))&&void 0!==n?n:"";s.details.isSynthesized=!0,s.details.isSynthesizedSelf=!0,s.nameWithScope=o.TypeVarType.makeNameWithScope(s.details.name,i),s.scopeId=i;const a=o.ClassType.cloneForSpecialization(e,o.ClassType.getTypeParameters(e),!1,!0);return s.details.boundType=o.ClassType.cloneAsInstance(a),t?o.TypeVarType.cloneAsInstantiable(s):s}function M(e){return(0,o.isClassInstance)(e)&&e.details.mro.some((e=>(0,o.isClass)(e)&&o.ClassType.isBuiltIn(e,"type")))}function R(e,t=!0){var n;if(null===(n=e.cached)||void 0===n?void 0:n.instanceType)return e.cached.instanceType;let s=c(e,(e=>{switch(e.category){case 7:return o.ClassType.isBuiltIn(e,"Type")?!e.typeArguments||e.typeArguments.length<1?o.UnknownType.create():O(e.typeArguments[0]):o.TypeBase.isInstantiable(e)&&o.ClassType.isBuiltIn(e,"NoneType")?o.NoneType.createInstance():o.ClassType.cloneAsInstance(e,t);case 3:return o.NoneType.createInstance();case 5:if(o.TypeBase.isInstantiable(e))return o.FunctionType.cloneAsInstance(e);break;case 10:if(o.TypeBase.isInstantiable(e))return o.TypeVarType.cloneAsInstance(e)}return e}));return e.typeAliasInfo&&e!==s&&(s=o.TypeBase.cloneForTypeAlias(s,e.typeAliasInfo.name,e.typeAliasInfo.fullName,e.typeAliasInfo.typeVarScopeId,e.typeAliasInfo.typeParameters,e.typeAliasInfo.typeArguments)),e!==s&&(e.cached||(e.cached={}),e.cached.instanceType=s),s}function O(e){var t;if(null===(t=e.cached)||void 0===t?void 0:t.instantiableType)return e.cached.instantiableType;let n=c(e,(e=>{switch(e.category){case 7:return o.ClassType.cloneAsInstantiable(e);case 3:return o.NoneType.createType();case 5:return o.FunctionType.cloneAsInstantiable(e);case 10:return o.TypeVarType.cloneAsInstantiable(e)}return e}));return e.typeAliasInfo&&e!==n&&(n=o.TypeBase.cloneForTypeAlias(n,e.typeAliasInfo.name,e.typeAliasInfo.fullName,e.typeAliasInfo.typeVarScopeId,e.typeAliasInfo.typeParameters,e.typeAliasInfo.typeArguments)),e.cached||(e.cached={}),e.cached.instantiableType=n,n}function L(e,t,n=!0,s=!1){let i=(0,o.combineTypes)(t.map((e=>(0,o.isTypeVar)(e.type)&&(0,o.isUnpackedVariadicTypeVar)(e.type)?o.TypeVarType.cloneForUnpacked(e.type,!0):e.type)));(0,o.isNever)(i)&&(i=o.AnyType.create());const a=o.ClassType.cloneForSpecialization(e,[i],n,void 0,t);return s&&(a.isUnpacked=!0),a}function V(e){const t=e.details.parameters.length;if(t<2)return e;const n=e.details.parameters[t-2],s=e.details.parameters[t-1];return 1===n.category&&2===s.category&&(0,o.isParamSpec)(n.type)&&(0,o.isParamSpec)(s.type)&&(0,o.isTypeSame)(n.type,s.type)?o.FunctionType.cloneRemoveParamSpecVariadics(e,n.type):e}function U(e){return(0,o.isClassInstance)(e)&&_(e)&&e.tupleTypeArguments&&e.isUnpacked?(0,o.combineTypes)(e.tupleTypeArguments.map((e=>e.type))):e}function z(e){var t;if((0,o.isClassInstance)(e)){if(o.ClassType.isBuiltIn(e,["Generator","AsyncGenerator"]))return e.typeArguments;if(o.ClassType.isBuiltIn(e,"AwaitableGenerator"))return null===(t=e.typeArguments)||void 0===t?void 0:t.slice(1)}}function B(e,t=!1,n=!1,s=0){var i;if(s>o.maxTypeRecursionCount)return!1;switch(s++,e.category){case 7:return(!o.ClassType.isPseudoGenericClass(e)||!t)&&(e.typeArguments?void 0!==e.typeArguments.find((e=>B(e,t,n,s))):o.ClassType.getTypeParameters(e).length>0);case 5:{if(e.details.paramSpec)return!0;for(let i=0;i<e.details.parameters.length;i++)if(B(o.FunctionType.getEffectiveParameterType(e,i),t,n,s))return!0;const i=e.specializedTypes&&e.specializedTypes.returnType?e.specializedTypes.returnType:e.details.declaredReturnType;if(i){if(B(i,t,n,s))return!0}else if(e.inferredReturnType&&B(e.inferredReturnType,t,n,s))return!0;return!1}case 6:return void 0!==e.overloads.find((e=>B(e,t,n,s)));case 9:return void 0!==(0,o.findSubtype)(e,(e=>B(e,t,n,s)));case 10:if(!e.details.recursiveTypeAliasName)return!e.details.isSynthesizedSelf||!n;if(null===(i=e.typeAliasInfo)||void 0===i?void 0:i.typeArguments)return e.typeAliasInfo.typeArguments.some((e=>B(e,t,n,s)))}return!1}function G(e,t,n=0){if(n>o.maxTypeRecursionCount)return;n++;const s=e=>{e&&!t.some((t=>t===e))&&t.push(e)};switch(e.category){case 7:case 5:s(e.details.moduleName);break;case 6:e.overloads.forEach((e=>{G(e,t,n)}));break;case 9:u(e,(e=>{G(e,t,n)}));break;case 8:s(e.moduleName)}}function W(e){if((0,o.isParamSpec)(e)){const t=o.FunctionType.createInstance("","","",65536);return t.details.paramSpec=e,t.details.typeVarScopeId=g(e),t}if((0,o.isFunction)(e)){const t=o.FunctionType.createInstance("","","",65536|e.details.flags,e.details.docString);return e.details.parameters.forEach(((n,s)=>{o.FunctionType.addParameter(t,{category:n.category,name:n.name,hasDefault:n.hasDefault,defaultValueExpression:n.defaultValueExpression,isNameSynthesized:n.isNameSynthesized,type:o.FunctionType.getEffectiveParameterType(e,s)})})),t.details.typeVarScopeId=g(e),t.details.paramSpec=e.details.paramSpec,t}const t=o.FunctionType.createInstance("","","",98304);return o.FunctionType.addDefaultParameters(t),t}function j(e,t=!1){let n=e.details.parameters.length>0;if(1===e.details.parameters.length){const t=e.details.parameters[0];0!==t.category||t.name||(n=!1)}if(n||!e.details.paramSpec||t){const n=o.FunctionType.createInstance("","","",65536|e.details.flags);return e.details.parameters.forEach((e=>{o.FunctionType.addParameter(n,{category:e.category,name:e.name,hasDefault:e.hasDefault,defaultValueExpression:e.defaultValueExpression,isNameSynthesized:e.isNameSynthesized,hasDeclaredType:!0,type:e.type})})),t||(n.details.paramSpec=e.details.paramSpec),n.details.docString=e.details.docString,n}return e.details.paramSpec}t.UniqueSignatureTracker=class{constructor(){this.signaturesSeen=[]}findSignature(e){return this.signaturesSeen.find((t=>(0,o.isTypeSame)(e,t.type)))}addSignature(e){const t=this.findSignature(e);t?t.count++:this.signaturesSeen.push({type:e,count:1})}},t.isOptionalType=function(e){return!!(0,o.isUnion)(e)&&void 0!==(0,o.findSubtype)(e,(e=>(0,o.isNoneInstance)(e)))},t.isIncompleteUnknown=function(e){return(0,o.isUnknown)(e)&&e.isIncomplete},t.isTypeVarSame=function(e,t){if((0,o.isTypeSame)(e,t))return!0;if(e.details.isParamSpec||e.details.isVariadic||!e.details.boundType)return!1;if(!(0,o.isUnion)(t))return!1;let n=!0;return u(t,(t=>{if(n&&!(0,o.isTypeSame)(e,t)){const s=m(t);s&&s.some((t=>t.typeVarName===e.nameWithScope))||(n=!1)}})),n},t.makeInferenceContext=function(e,t,n){if(e)return{expectedType:e,isTypeIncomplete:n,typeVarContext:t}},t.mapSubtypes=c,t.sortTypes=p,t.doForEachSubtype=u,t.areTypesSame=function(e,t){if(e.length<2)return!0;for(let n=1;n<e.length;n++)if(!(0,o.isTypeSame)(e[0],e[n],t))return!1;return!0},t.preserveUnknown=function(e,t){return(0,o.isUnknown)(e)&&e.isIncomplete?e:(0,o.isUnknown)(t)&&t.isIncomplete?t:(0,o.isUnknown)(e)||(0,o.isUnknown)(t)?o.UnknownType.create():o.AnyType.create()},t.isUnionableType=function(e){let t=3;for(const n of e)t&=n.flags;return 0!=(1&t)&&0==(2&t)},t.derivesFromAnyOrUnknown=function(e){let t=!1;return u(e,(n=>{(0,o.isAnyOrUnknown)(e)?t=!0:(0,o.isInstantiableClass)(n)?o.ClassType.hasUnknownBaseClass(n)&&(t=!0):(0,o.isClassInstance)(n)&&o.ClassType.hasUnknownBaseClass(n)&&(t=!0)})),t},t.getFullNameOfType=function(e){var t;if(null===(t=e.typeAliasInfo)||void 0===t?void 0:t.fullName)return e.typeAliasInfo.fullName;switch(e.category){case 2:case 1:return"typing.Any";case 3:return"builtins.None";case 7:case 5:return e.details.fullName;case 8:return e.moduleName;case 6:return e.overloads[0].details.fullName}},t.addConditionToType=y,t.getTypeCondition=m,t.isTypeAliasPlaceholder=function(e){return(0,o.isTypeVar)(e)&&o.TypeVarType.isTypeAliasPlaceholder(e)},t.isTypeAliasRecursive=function(e,t){return 9!==t.category?t===e||(0,o.isUnbound)(t)&&t.typeAliasInfo&&t.typeAliasInfo.name===e.details.recursiveTypeAliasName:void 0!==(0,o.findSubtype)(t,(t=>(0,o.isTypeVar)(t)&&t.details===e.details))},t.transformPossibleRecursiveTypeAlias=function e(t){var n;if(t){if((0,o.isTypeVar)(t)&&t.details.recursiveTypeAliasName&&t.details.boundType){const e=o.TypeBase.isInstance(t)?R(t.details.boundType):t.details.boundType;return(null===(n=t.typeAliasInfo)||void 0===n?void 0:n.typeArguments)&&t.details.recursiveTypeParameters?S(e,k(t.details.recursiveTypeParameters,t.typeAliasInfo.typeArguments,g(t))):e}if((0,o.isUnion)(t)&&t.includesRecursiveTypeAlias){let n=c(t,(t=>e(t)));return n!==t&&t.typeAliasInfo&&(n=o.TypeBase.cloneForTypeAlias(n,t.typeAliasInfo.name,t.typeAliasInfo.fullName,t.typeAliasInfo.typeVarScopeId,t.typeAliasInfo.typeParameters,t.typeAliasInfo.typeArguments)),n}}return t},t.getTypeVarScopeId=g,t.getSpecializedTupleType=function(e){let t;if((0,o.isInstantiableClass)(e)?t=e:(0,o.isClassInstance)(e)&&(t=o.ClassType.cloneAsInstantiable(e)),!t)return;const n=t.details.mro.find((e=>(0,o.isInstantiableClass)(e)&&_(e)));return n&&(0,o.isInstantiableClass)(n)?o.ClassType.isSameGenericClass(t,n)?t:S(n,N(t)):void 0},t.isLiteralType=h,t.isLiteralTypeOrUnion=function(e){return(0,o.isClassInstance)(e)?void 0!==e.literalValue:!!(0,o.isUnion)(e)&&!(0,o.findSubtype)(e,(e=>!(0,o.isClassInstance)(e)||void 0===e.literalValue))},t.containsType=f,t.containsLiteralType=T,t.getLiteralTypeClassName=function e(t){if((0,o.isClassInstance)(t))return void 0!==t.literalValue&&o.ClassType.isBuiltIn(t)?t.details.name:void 0;if((0,o.isUnion)(t)){let n,s=!1;return u(t,(t=>{const i=e(t);i?n||(n=i):s=!0})),s?void 0:n}},t.getUnionSubtypeCount=function(e){return(0,o.isUnion)(e)?e.subtypes.length:1},t.isEllipsisType=function(e){return(0,o.isAny)(e)&&e.isEllipsis},t.isProperty=function(e){return(0,o.isClassInstance)(e)&&o.ClassType.isPropertyClass(e)},t.isDescriptorInstance=function(e,t=!1){return(0,o.isUnion)(e)?e.subtypes.every((e=>v(e,t))):v(e,t)},t.isMaybeDescriptorInstance=v,t.isTupleClass=_,t.isUnboundedTupleClass=I,t.partiallySpecializeType=b,t.populateTypeVarContextForSelfType=C,t.ensureFunctionSignaturesAreUnique=function(e,t){return new K(t).apply(e,0)},t.applySolvedTypeVars=S,t.validateTypeVarDefault=function(e,t,n){e.details.defaultType&&B(e.details.defaultType)&&new q(t,n).apply(e.details.defaultType,0)},t.transformExpectedTypeForConstructor=function(e,t){return(0,o.isTypeVar)(e)?(n=e,t.some((e=>n.scopeId===e))?e:void 0):new Y(t).apply(e,0);var n},t.getProtocolSymbols=function(e){const t=new Map;return o.ClassType.isProtocolClass(e)&&x(e,t),t},t.getContainerDepth=function e(t,n=0){if(n>o.maxTypeRecursionCount)return 1;if(n++,!(0,o.isClassInstance)(t))return 0;let s=0;if(t.tupleTypeArguments)t.tupleTypeArguments.forEach((t=>{u(t.type,(t=>{const i=e(t,n);s=Math.max(i,s)}))}));else{if(!t.typeArguments)return 0;t.typeArguments.forEach((t=>{u(t,(t=>{const i=e(t,n);s=Math.max(i,s)}))}))}return 1+s},t.lookUpObjectMember=function(e,t,n=0){if((0,o.isClassInstance)(e))return D(e,t,n)},t.lookUpClassMember=D,t.getClassMemberIterator=F,t.getClassIterator=E,t.getClassFieldsRecursive=function(e){const t=new Map;return o.ClassType.getReverseMro(e).forEach((n=>{const s=b(n,e);(0,o.isClass)(s)?s.details.fields.forEach(((e,n)=>{!e.isIgnoredForProtocolMatch()&&e.hasTypedDeclarations()&&t.set(n,{classType:s,symbol:e,isInstanceMember:e.isInstanceMember(),isClassMember:e.isClassMember(),isClassVar:e.isClassVar(),isTypeDeclared:!0,skippedUndeclaredType:!1})})):t.clear()})),t},t.addTypeVarsToListIfUnique=P,t.getTypeVarArgumentsRecursive=function e(t,n=0){var s,i;if(n>o.maxTypeRecursionCount)return[];if(n++,null===(s=t.typeAliasInfo)||void 0===s?void 0:s.typeArguments){const s=[];return null===(i=t.typeAliasInfo)||void 0===i||i.typeArguments.forEach((t=>{P(s,e(t,n))})),s}if((0,o.isTypeVar)(t))return t.details.recursiveTypeAliasName||(0,o.isParamSpec)(t)&&t.paramSpecAccess?[]:[o.TypeBase.isInstantiable(t)?o.TypeVarType.cloneAsInstance(t):t];if((0,o.isClass)(t)){const s=[],i=t.tupleTypeArguments?t.tupleTypeArguments.map((e=>e.type)):t.typeArguments;return i&&i.forEach((t=>{P(s,e(t,n))})),s}if((0,o.isUnion)(t)){const s=[];return u(t,(t=>{P(s,e(t,n))})),s}if((0,o.isFunction)(t)){const s=[];for(let i=0;i<t.details.parameters.length;i++)P(s,e(o.FunctionType.getEffectiveParameterType(t,i),n));t.details.paramSpec&&P(s,[t.details.paramSpec]);const i=o.FunctionType.getSpecializedReturnType(t);return i&&P(s,e(i,n)),s}return[]},t.isTypeVarLimitedToCallable=function(e,t){const n=A(e,t);return n.isTypeVarUsed&&n.isUsedInCallable},t.specializeClassType=function(e){const t=new l.TypeVarContext(g(e));return o.ClassType.getTypeParameters(e).forEach((e=>{t.setTypeVarType(e,o.UnknownType.create())})),S(e,t)},t.setTypeArgumentsRecursive=function e(t,n,s,i=0){if(!(i>o.maxTypeRecursionCount||(i++,s.isLocked())))switch(t.category){case 9:u(t,(t=>{e(t,n,s,i)}));break;case 7:t.typeArguments&&t.typeArguments.forEach((t=>{e(t,n,s,i)})),t.tupleTypeArguments&&t.tupleTypeArguments.forEach((t=>{e(t.type,n,s,i)}));break;case 5:if(t.specializedTypes)t.specializedTypes.parameterTypes.forEach((t=>{e(t,n,s,i)})),t.specializedTypes.returnType&&e(t.specializedTypes.returnType,n,s,i);else if(t.details.parameters.forEach((t=>{e(t.type,n,s,i)})),t.details.declaredReturnType&&e(t.details.declaredReturnType,n,s,i),t.details.paramSpec&&!s.getPrimarySignature().getTypeVar(t.details.paramSpec)){const e=o.FunctionType.createInstance("","","",98304);o.FunctionType.addDefaultParameters(e),s.setTypeVarType(t.details.paramSpec,e)}break;case 6:t.overloads.forEach((t=>{e(t,n,s,i)}));break;case 10:s.getPrimarySignature().getTypeVar(t)||s.setTypeVarType(t,n)}},t.buildTypeVarContextFromSpecializedClass=N,t.buildTypeVarContext=k,t.specializeForBaseClass=function(e,t){if(0===o.ClassType.getTypeParameters(t).length)return t;const n=S(t,N(e));return(0,i.assert)((0,o.isInstantiableClass)(n)),n},t.derivesFromClassRecursive=function e(t,n,s){if(o.ClassType.isSameGenericClass(t,n))return!0;for(const i of t.details.baseClasses)if((0,o.isInstantiableClass)(i)){if(e(i,n,s))return!0}else if(!s&&(0,o.isAnyOrUnknown)(i))return!0;return!1},t.synthesizeTypeVarForSelfCls=w,t.getDeclaredGeneratorReturnType=function(e){const t=o.FunctionType.getSpecializedReturnType(e);if(t){const e=z(t);if(e)return e.length>=3?e[2]:o.UnknownType.create()}},t.getGeneratorYieldType=function(e,t){let n=!0;const s=c(e,(e=>(0,o.isAnyOrUnknown)(e)?e:(0,o.isClassInstance)(e)&&[["AsyncIterable","Iterable"],["AsyncIterator","Iterator"],["AsyncGenerator","Generator"],["","AwaitableGenerator"]].some((n=>o.ClassType.isBuiltIn(e,t?n[0]:n[1])))?e.typeArguments&&e.typeArguments.length>=1?e.typeArguments[0]:o.UnknownType.create():void(n=!1)));return n?s:void 0},t.isMetaclassInstance=M,t.isEffectivelyInstantiable=function e(t){return!!o.TypeBase.isInstantiable(t)||!!M(t)||!!(0,o.isUnion)(t)&&t.subtypes.every((t=>e(t)))},t.convertToInstance=R,t.convertToInstantiable=O,t.getMembersForClass=function(e,t,n){if(e.details.mro.forEach((e=>{if((0,o.isInstantiableClass)(e)){const s=o.ClassType.isTypedDictClass(e);e.details.fields.forEach(((e,i)=>{if((e.isClassMember()||n&&e.isInstanceMember())&&!(s&&(0,r.isTypedDictMemberAccessedThroughIndex)(e)||e.isInitVar())){const n=t.get(i);n?!n.hasTypedDeclarations()&&e.hasTypedDeclarations()&&t.set(i,e):t.set(i,e)}}))}})),!n){const n=e.details.effectiveMetaclass;if(n&&(0,o.isInstantiableClass)(n))for(const e of n.details.mro){if(!(0,o.isInstantiableClass)(e))break;e.details.fields.forEach(((e,n)=>{const s=t.get(n);s?!s.hasTypedDeclarations()&&e.hasTypedDeclarations()&&t.set(n,e):t.set(n,e)}))}}},t.getMembersForModule=function(e,t){e.loaderFields&&e.loaderFields.forEach(((e,n)=>{t.set(n,e)})),e.fields.forEach(((e,n)=>{t.set(n,e)}))},t.containsUnknown=function(e){let t=!1;return u(e,(e=>{(0,o.isUnknown)(e)&&(t=!0)})),t},t.isPartlyUnknown=function e(t,n=!1,s=0){var i,a;if(s>o.maxTypeRecursionCount)return!1;if(s++,(0,o.isUnknown)(t))return!0;if((null===(i=t.typeAliasInfo)||void 0===i?void 0:i.typeArguments)&&t.typeAliasInfo.typeArguments.some((t=>e(t,n,s))))return!0;if((0,o.isUnion)(t))return void 0!==(0,o.findSubtype)(t,(t=>e(t,n,s)));if((0,o.isClass)(t)){if(o.TypeBase.isInstance(t)&&(n=!1),!n&&!o.ClassType.isPseudoGenericClass(t)){const i=(null===(a=t.tupleTypeArguments)||void 0===a?void 0:a.map((e=>e.type)))||t.typeArguments;if(i)for(const t of i)if(e(t,n,s))return!0}return!1}if((0,o.isOverloadedFunction)(t))return t.overloads.some((t=>e(t,!1,s)));if((0,o.isFunction)(t)){for(let n=0;n<t.details.parameters.length;n++)if(t.details.parameters[n].name&&e(o.FunctionType.getEffectiveParameterType(t,n),!1,s))return!0;return!(!t.details.declaredReturnType||o.FunctionType.isParamSpecValue(t)||!e(t.details.declaredReturnType,!1,s))}return!1},t.explodeGenericClass=function(e){return e.typeArguments&&1===e.typeArguments.length&&(0,o.isUnion)(e.typeArguments[0])?(0,o.combineTypes)(e.typeArguments[0].subtypes.map((t=>o.ClassType.cloneForSpecialization(e,[t],!0)))):e},t.combineSameSizedTuples=function(e,t){if(!t||!(0,o.isInstantiableClass)(t)||I(t))return e;let n,s=!0;return u(e,(e=>{if((0,o.isClassInstance)(e)){let t;(0,o.isClass)(e)&&_(e)&&!I(e)&&(t=e),t||(t=e.details.mro.find((e=>(0,o.isClass)(e)&&_(e)&&!I(e)))),t&&(0,o.isClass)(t)&&t.tupleTypeArguments?n?n.length===t.tupleTypeArguments.length?t.tupleTypeArguments.forEach(((e,t)=>{n[t].push(e.type)})):s=!1:n=t.tupleTypeArguments.map((e=>[e.type])):s=!1}else s=!1})),s&&n?R(L(t,n.map((e=>({type:(0,o.combineTypes)(e),isUnbounded:!1}))))):e},t.specializeTupleClass=L,t.removeParamSpecVariadicsFromSignature=function(e){if((0,o.isFunction)(e))return V(e);const t=[];let n=!1;for(const s of e.overloads){const e=V(s);t.push(e),e!==s&&(n=!0)}return n?o.OverloadedFunctionType.create(t):e},t.removeParamSpecVariadicsFromFunction=V,t.getGeneratorTypeArgs=z,t.requiresTypeArguments=function(e){if(e.details.typeParameters.length>0){const t=e.details.typeParameters[0];return!t.details.isSynthesized&&!t.details.defaultType}return!(!o.ClassType.isSpecialBuiltIn(e)||!["Tuple","Callable","Generic","Type","Optional","Union","Literal","Annotated","TypeGuard","StrictTypeGuard"].some((t=>t===(e.aliasName||e.details.name))))},t.requiresSpecialization=B,t.combineVariances=function(e,t){return 1===e?t:2===t||3===t&&4===e||4===t&&3===e?2:e},t.isVarianceOfTypeArgumentCompatible=function e(t,n){if(1===n||0===n)return!0;if(!(0,o.isTypeVar)(t)||t.details.isParamSpec||t.details.isVariadic){if((0,o.isClassInstance)(t)&&t.details.typeParameters&&t.details.typeParameters.length>0)return t.details.typeParameters.every(((s,i)=>{let a;if(s.details.isParamSpec||s.details.isVariadic)return!0;t.typeArguments&&i<t.typeArguments.length&&(a=t.typeArguments[i]);const r=s.details.declaredVariance;if(0===r)return!0;let l=2;return 3===r?l=n:4===r&&(3===n?l=4:4===n&&(l=3)),e(null!=a?a:o.UnknownType.create(),l)}))}else{const e=t.details.declaredVariance;if(4===e||3===e)return e===n}return!0},t.computeMroLinearization=function(e){let t=!0;e.details.mro=[];const n=e.details.baseClasses.filter(((t,n)=>{if((0,o.isInstantiableClass)(t)&&o.ClassType.isBuiltIn(t,"Generic")){if(o.ClassType.isProtocolClass(e))return!1;if(e.details.baseClasses.some(((e,t)=>t>n&&(0,o.isInstantiableClass)(e)&&e.typeArguments&&e.isTypeArgumentExplicit)))return!1}return!0})),s=[];n.forEach((e=>{if((0,o.isInstantiableClass)(e)){const t=N(e,!1);s.push(e.details.mro.map((e=>S(e,t))))}else s.push([e])})),s.push(n.map((t=>S(t,N(e,!1)))));const i=N(e,!1);e.details.mro.push(S(e,i));const a=(e,t)=>t.some((t=>t.findIndex((t=>(0,o.isInstantiableClass)(t)&&o.ClassType.isSameGenericClass(t,e)))>0)),r=(e,t)=>{for(let n=0;n<t.length;n++)t[n]=t[n].filter((t=>!(0,o.isInstantiableClass)(t)||!o.ClassType.isSameGenericClass(t,e)))};for(;;){let n,i=!1;for(let t=0;t<s.length;t++){const l=s[t];if(l.length>0){if(void 0===n&&(n=l),!(0,o.isInstantiableClass)(l[0])){i=!0,e.details.mro.push(l[0]),l.shift();break}if(!a(l[0],s)){i=!0,e.details.mro.push(l[0]),r(l[0],s);break}}}if(!n)break;i||(t=!1,(0,o.isInstantiableClass)(n[0])?(e.details.mro.push(n[0]),r(n[0],s)):(e.details.mro.push(n[0]),n.shift()))}return t},t.getDeclaringModulesForType=function(e){const t=[];return G(e,t),t},t.convertTypeToParamSpecValue=W,t.convertParamSpecValueToType=j;class ${constructor(){this._isTransformingTypeArg=!1,this._pendingTypeVarTransformations=new Set,this._pendingFunctionTransformations=[]}apply(e,t){var n,s;if(t>o.maxTypeRecursionCount)return e;if(t++,!B(e=this.transformGenericTypeAlias(e,t)))return e;if((0,o.isAnyOrUnknown)(e))return e;if((0,o.isNoneInstance)(e))return e;if((0,o.isTypeVar)(e)){if(e.details.recursiveTypeAliasName){if(!(null===(n=e.typeAliasInfo)||void 0===n?void 0:n.typeArguments))return e;let s=!1;const i=e.typeAliasInfo.typeArguments.map((e=>{const n=this.apply(e,t);return n!==e&&(s=!0),n}));return s?o.TypeBase.cloneForTypeAlias(e,e.typeAliasInfo.name,e.typeAliasInfo.fullName,e.typeAliasInfo.typeVarScopeId,e.typeAliasInfo.typeParameters,i):e}let i=e;const a=o.TypeVarType.getNameWithScope(e);if(!this._pendingTypeVarTransformations.has(a))if(e.details.isParamSpec){if(!e.paramSpecAccess){const n=this.transformParamSpec(e,t);n&&(i=j(n))}}else i=null!==(s=this.transformTypeVar(e,t))&&void 0!==s?s:e,this._isTransformingTypeArg||(this._pendingTypeVarTransformations.add(a),i=this.apply(i,t),this._pendingTypeVarTransformations.delete(a)),(0,o.isVariadicTypeVar)(e)&&e.isVariadicInUnion&&(i=U(i));return i}if((0,o.isUnion)(e)){const n=c(e,(e=>{let n=this.apply(e,t);if((0,o.isVariadicTypeVar)(e)&&!(0,o.isVariadicTypeVar)(n)){const e=[];u(n,(t=>{e.push(U(t))})),n=(0,o.combineTypes)(e)}return this.transformUnionSubtype?this.transformUnionSubtype(e,n,t):n}));return(0,o.isNever)(n)?o.UnknownType.create():n}if((0,o.isClass)(e))return this.transformTypeVarsInClassType(e,t);if((0,o.isFunction)(e)){if(this._pendingFunctionTransformations.some((t=>t===e)))return e;this._pendingFunctionTransformations.push(e);const n=this.transformTypeVarsInFunctionType(e,t);return this._pendingFunctionTransformations.pop(),n}if((0,o.isOverloadedFunction)(e)){if(this._pendingFunctionTransformations.some((t=>t===e)))return e;this._pendingFunctionTransformations.push(e);let n=!1;const s=[];return e.overloads.forEach((e=>{const i=this.transformTypeVarsInFunctionType(e,t);(0,o.isFunction)(i)?s.push(i):s.push(...i.overloads),i!==e&&(n=!0)})),this._pendingFunctionTransformations.pop(),n?o.OverloadedFunctionType.create(s):e}return e}transformTypeVar(e,t){}transformTupleTypeVar(e,t){}transformParamSpec(e,t){}transformUnionSubtype(e,t,n){return t}doForEachSignatureContext(e){return e()}transformGenericTypeAlias(e,t){if(!e.typeAliasInfo||!e.typeAliasInfo.typeParameters||!e.typeAliasInfo.typeArguments)return e;let n=!1;const s=e.typeAliasInfo.typeArguments.map((s=>{const i=this.apply(s,t);return e!==i&&(n=!0),i}));return n?o.TypeBase.cloneForTypeAlias(e,e.typeAliasInfo.name,e.typeAliasInfo.fullName,e.typeAliasInfo.typeVarScopeId,e.typeAliasInfo.typeParameters,s):e}transformTypeVarsInClassType(e,t){if(0===o.ClassType.getTypeParameters(e).length&&!o.ClassType.isSpecialBuiltIn(e))return e;let n,i=[],a=!1;const r=o.ClassType.getTypeParameters(e),l=e=>{const n=this.transformParamSpec(e,t);return n?(a=!0,j(n)):e},c=this._isTransformingTypeArg;return this._isTransformingTypeArg=!0,e.typeArguments?i=e.typeArguments.map((e=>{if((0,o.isTypeVar)(e)&&e.details.isParamSpec)return l(e);let n=this.apply(e,t);return n!==e&&(a=!0,(0,o.isTypeVar)(e)&&(0,o.isVariadicTypeVar)(e)&&e.isVariadicInUnion&&(n=U(n))),n})):r.forEach((n=>{let s=n;if(n.details.isParamSpec)s=l(n),s!==n&&(a=!0);else{const i=o.TypeVarType.getNameWithScope(n);if(!this._pendingTypeVarTransformations.has(i)){const i=this.transformTypeVar(n,t);s=null!=i?i:n,s!==n?a=!0:void 0===i||e.typeArguments||(a=!0)}}i.push(s)})),o.ClassType.isTupleClass(e)&&(e.tupleTypeArguments?(n=[],e.tupleTypeArguments.forEach((e=>{const i=this.apply(e.type,t);i!==e.type&&(a=!0),(0,o.isUnpackedVariadicTypeVar)(e.type)&&(0,o.isClassInstance)(i)&&_(i)&&i.tupleTypeArguments?(0,s.appendArray)(n,i.tupleTypeArguments):n.push({type:i,isUnbounded:e.isUnbounded})}))):r.length>0&&(n=this.transformTupleTypeVar(r[0],t),n&&(a=!0))),this._isTransformingTypeArg=c,a?o.ClassType.cloneForSpecialization(e,i,!0,void 0,n):e}transformTypeVarsInFunctionType(e,t){return this.doForEachSignatureContext((()=>{let n=e;if(n.details.paramSpec){const e=this.transformParamSpec(n.details.paramSpec,t);e&&(n=o.FunctionType.cloneForParamSpec(n,e))}const s=o.FunctionType.getSpecializedReturnType(n),i=s?this.apply(s,t):void 0;let a=s!==i;const r={parameterTypes:[],returnType:i};if(n.details.parameters.length>=2){const e=n.details.parameters[n.details.parameters.length-2],s=n.details.parameters[n.details.parameters.length-1],i=o.FunctionType.getEffectiveParameterType(n,n.details.parameters.length-2),a=o.FunctionType.getEffectiveParameterType(n,n.details.parameters.length-1);if(1===e.category&&2===s.category&&(0,o.isParamSpec)(i)&&(0,o.isParamSpec)(a)&&(0,o.isTypeSame)(i,a)){const e=this.transformParamSpec(i,t);e&&(e.details.parameters.length>0||void 0===e.details.paramSpec||!(0,o.isTypeSame)(i,e.details.paramSpec))&&(n=o.FunctionType.cloneForParamSpecApplication(n,e))}}let l,c;const p=[],d=this._isTransformingTypeArg;this._isTransformingTypeArg=!0;for(let e=0;e<n.details.parameters.length;e++){const s=o.FunctionType.getEffectiveParameterType(n,e),i=this.apply(s,t);r.parameterTypes.push(i);let d=o.FunctionType.getEffectiveParameterDefaultArgType(n,e);if(d){const e=this.apply(d,t);e!==d&&(d=e,a=!0)}p.push(d),void 0===l&&(0,o.isVariadicTypeVar)(s)&&1===n.details.parameters[e].category&&(l=e,(0,o.isClassInstance)(i)&&_(i)&&i.isUnpacked&&(c=i.tupleTypeArguments)),s!==i&&(a=!0)}let u;if(n.inferredReturnType&&(u=this.apply(n.inferredReturnType,t),u!==n.inferredReturnType&&(a=!0)),this._isTransformingTypeArg=d,!a)return n;if(p.some((e=>void 0!==e))&&(r.parameterDefaultArgs=p),!c)return o.FunctionType.cloneForSpecialization(n,r,u);const y=o.FunctionType.createSynthesizedInstance("",n.details.flags);let m=!1,g=!1;return r.parameterTypes.forEach(((e,t)=>{if(t===l){let e=!1;c.forEach((t=>{o.FunctionType.addParameter(y,{category:t.isUnbounded?1:0,name:`__p${y.details.parameters.length}`,isNameSynthesized:!0,type:t.type,hasDeclaredType:!0}),t.isUnbounded&&(e=!0)})),e?g=!0:m=!0}else{const s={...n.details.parameters[t]};1!==s.category||s.name?2===s.category&&(m=!1):m=!1,0===s.category&&s.name&&m&&(o.FunctionType.addParameter(y,{category:1,type:o.UnknownType.create()}),m=!1),s.type=e,s.name&&s.isNameSynthesized&&(s.name=`__p${y.details.parameters.length}`),0===s.category&&!s.name&&g||o.FunctionType.addParameter(y,s)}})),y.details.declaredReturnType=r.returnType,y}))}}class q extends ${constructor(e,t){super(),this._liveTypeParams=e,this._invalidTypeVars=t}transformTypeVar(e){const t=this._liveTypeParams.find((t=>t.details.name===e.details.name));return t&&!(0,o.isParamSpec)(t)||this._invalidTypeVars.add(e.details.name),o.UnknownType.create()}transformParamSpec(e){const t=this._liveTypeParams.find((t=>t.details.name===e.details.name));t&&(0,o.isParamSpec)(t)||this._invalidTypeVars.add(e.details.name)}}class K extends ${constructor(e){super(),this._signatureTracker=e}transformTypeVarsInFunctionType(e,t){if(e.specializedTypes||0===e.details.typeParameters.length)return super.transformTypeVarsInFunctionType(e,t);let n=e;const s=this._signatureTracker.findSignature(e);if(s){const t=new l.TypeVarContext(g(e));e.details.typeParameters.forEach((i=>{const a=o.TypeVarType.cloneForNewName(i,`${i.details.name}(${s.count})`);t.setTypeVarType(i,a),n=S(e,t)}))}return this._signatureTracker.addSignature(e),n}}class H extends ${constructor(e,t){super(),this._typeVarContext=e,this._options=t,this._isSolvingDefaultType=!1}transformTypeVar(e,t){var n;const s=this._typeVarContext.getSignatureContext(null!==(n=this._activeTypeVarSignatureContextIndex)&&void 0!==n?n:0);if(e.scopeId&&this._typeVarContext.hasSolveForScope(e.scopeId)){let n=s.getTypeVarType(e,!!this._options.useNarrowBoundOnly);if(!n&&this._options.useNarrowBoundOnly){const t=s.getTypeVarType(e);t&&T(t,!0)&&(n=t)}if(n)return o.TypeBase.isInstantiable(e)&&(n=(0,o.isAnyOrUnknown)(n)&&this._options.typeClassType&&(0,o.isInstantiableClass)(this._options.typeClassType)?o.ClassType.cloneForSpecialization(o.ClassType.cloneAsInstance(this._options.typeClassType),[n],!0):O(n)),n;if(this._options.unknownIfNotFound&&!this._typeVarContext.hasSolveForScope(o.WildcardTypeVarScopeId))return e.details.defaultType&&!this._options.useUnknownOverDefault?this._solveDefaultType(e.details.defaultType,t):o.UnknownType.create()}if(this._isSolvingDefaultType&&!e.scopeId){const n=s.getTypeVars().find((t=>t.typeVar.details.name===e.details.name));return n?s.getTypeVarType(n.typeVar):e.details.defaultType?this.apply(e.details.defaultType,t):o.UnknownType.create()}if(this._isSolvingDefaultType&&!e.scopeId){const n=s.getTypeVars().find((t=>t.typeVar.details.name===e.details.name));return n?s.getTypeVarType(n.typeVar):e.details.defaultType?this.apply(e.details.defaultType,t):o.UnknownType.create()}}transformUnionSubtype(e,t){if(this._options.eliminateUnsolvedInUnions&&(0,o.isTypeVar)(e)&&void 0!==e.scopeId&&this._typeVarContext.hasSolveForScope(e.scopeId)){if(e===t)return;if((0,o.isUnknown)(t)&&this._options.unknownIfNotFound)return}return t}transformTupleTypeVar(e){var t;if(!e.scopeId||!this._typeVarContext.hasSolveForScope(e.scopeId)){const t=e.details.defaultType;return t&&(0,o.isClassInstance)(t)&&t.tupleTypeArguments?t.tupleTypeArguments:void 0}return this._typeVarContext.getSignatureContext(null!==(t=this._activeTypeVarSignatureContextIndex)&&void 0!==t?t:0).getTupleTypeVar(e)}transformParamSpec(e,t){var n;const s=this._typeVarContext.getSignatureContext(null!==(n=this._activeTypeVarSignatureContextIndex)&&void 0!==n?n:0);if(this._isSolvingDefaultType&&!e.scopeId){const n=s.getTypeVars().find((t=>t.typeVar.details.name===e.details.name));return n?s.getParamSpecType(n.typeVar):e.details.defaultType?W(this.apply(e.details.defaultType,t)):this._getUnknownParamSpec()}if(!e.scopeId||!this._typeVarContext.hasSolveForScope(e.scopeId))return;return s.getParamSpecType(e)||(this._options.unknownIfNotFound&&!this._typeVarContext.hasSolveForScope(o.WildcardTypeVarScopeId)?e.details.defaultType?W(this._solveDefaultType(e.details.defaultType,t)):this._getUnknownParamSpec():void 0)}doForEachSignatureContext(e){const t=this._typeVarContext.getSignatureContexts();if(t.length<=1)return e();const n=t.map(((t,n)=>(this._activeTypeVarSignatureContextIndex=n,e())));this._activeTypeVarSignatureContextIndex=void 0;const s=[];return u((0,o.combineTypes)(n),(e=>{(0,i.assert)((0,o.isFunction)(e)),s.push(e)})),1===s.length?s[0]:o.OverloadedFunctionType.create(s)}_solveDefaultType(e,t){const n=this._isSolvingDefaultType;this._isSolvingDefaultType=!0;const s=this.apply(e,t);return this._isSolvingDefaultType=n,s}_getUnknownParamSpec(){const e=o.FunctionType.createInstance("","","",98304);return o.FunctionType.addDefaultParameters(e),e}}class Y extends ${constructor(e){super(),this._liveTypeVarScopes=e}_isTypeVarLive(e){return this._liveTypeVarScopes.some((t=>e.scopeId===t))}transformTypeVar(e){return this._isTypeVarLive(e)?e:o.AnyType.create()}}},4447:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TypeVarContext=t.TypeVarSignatureContext=void 0;const s=n(5839),i=n(1133),a=n(5168);class r{constructor(){this._typeVarMap=new Map}clone(){const e=new r;return this._typeVarMap.forEach((t=>{e.setTypeVarType(t.typeVar,t.narrowBound,t.narrowBoundNoLiterals,t.wideBound),t.tupleTypes&&e.setTupleTypeVar(t.typeVar,t.tupleTypes)})),this._sourceTypeVarScopeId&&this._sourceTypeVarScopeId.forEach((t=>e.addSourceTypeVarScopeId(t))),e}isEmpty(){return 0===this._typeVarMap.size}getScore(){let e=0;return this._typeVarMap.forEach((t=>{e+=1;const n=this.getTypeVarType(t.typeVar);e+=1-this._getComplexityScoreForType(n)})),e}getTypeVarType(e,t=!1){var n,s;const i=this.getTypeVar(e);if(i)return t?i.narrowBound:null!==(s=null!==(n=i.narrowBoundNoLiterals)&&void 0!==n?n:i.narrowBound)&&void 0!==s?s:i.wideBound}getParamSpecType(e){const t=this.getTypeVar(e);if(null==t?void 0:t.narrowBound)return(0,i.isFunction)(t.narrowBound)?t.narrowBound:void 0}setTypeVarType(e,t,n,s){const a=i.TypeVarType.getNameWithScope(e);this._typeVarMap.set(a,{typeVar:e,narrowBound:t,narrowBoundNoLiterals:n,wideBound:s})}getTupleTypeVar(e){var t;return null===(t=this.getTypeVar(e))||void 0===t?void 0:t.tupleTypes}setTupleTypeVar(e,t){const n=this.getTypeVar(e);(0,s.assert)(n),n.tupleTypes=t}getTypeVar(e){const t=i.TypeVarType.getNameWithScope(e);return this._typeVarMap.get(t)}getTypeVars(){const e=[];return this._typeVarMap.forEach((t=>{e.push(t)})),e}applySourceContextTypeVars(e){this._typeVarMap.forEach((t=>{const n=t.narrowBound?(0,a.applySolvedTypeVars)(t.narrowBound,e):void 0,s=t.narrowBoundNoLiterals?(0,a.applySolvedTypeVars)(t.narrowBoundNoLiterals,e):void 0,i=t.wideBound?(0,a.applySolvedTypeVars)(t.wideBound,e):void 0;this.setTypeVarType(t.typeVar,n,s,i),t.tupleTypes&&this.setTupleTypeVar(t.typeVar,t.tupleTypes.map((t=>({isUnbounded:t.isUnbounded,type:(0,a.applySolvedTypeVars)(t.type,e)}))))}))}getTypeVarCount(){return this._typeVarMap.size}getWideTypeBound(e){const t=this.getTypeVar(e);if(t)return t.wideBound}addSourceTypeVarScopeId(e){this._sourceTypeVarScopeId||(this._sourceTypeVarScopeId=new Set),this._sourceTypeVarScopeId.add(e)}hasSourceTypeVarScopeId(e){return!!this._sourceTypeVarScopeId&&this._sourceTypeVarScopeId.has(e)}_getComplexityScoreForType(e,t=0){if(t>i.maxTypeRecursionCount)return 1;switch(t++,e.category){case 1:case 2:case 3:case 10:return.5;case 5:case 6:return.8;case 0:case 4:return 1;case 9:{let n=0;return e.subtypes.length<16?(0,a.doForEachSubtype)(e,(e=>{const s=this._getComplexityScoreForType(e,t);n=Math.max(n,s)})):n=.5,n}case 7:return this._getComplexityScoreForClass(e,t)}return 0}_getComplexityScoreForClass(e,t){let n=0,s=0;return e.tupleTypeArguments?e.tupleTypeArguments.forEach((e=>{n+=this._getComplexityScoreForType(e.type,t),s++})):e.typeArguments?e.typeArguments.forEach((e=>{n+=this._getComplexityScoreForType(e,t),s++})):e.details.typeParameters&&e.details.typeParameters.forEach((e=>{n+=this._getComplexityScoreForType(i.AnyType.create(),t),s++})),.5+.25*(s>0?n/s:0)}}t.TypeVarSignatureContext=r;class o{constructor(e){this._isLocked=!1,Array.isArray(e)?this._solveForScopes=e:this._solveForScopes=void 0!==e?[e]:void 0,this._signatureContexts=[new r]}clone(){const e=new o;return this._solveForScopes&&(e._solveForScopes=[...this._solveForScopes]),e._signatureContexts=this._signatureContexts.map((e=>e.clone())),e._isLocked=this._isLocked,e}cloneWithSignatureSource(e){const t=this.clone();if(e){const n=this._signatureContexts.filter((t=>t.hasSourceTypeVarScopeId(e)));n.length>0?t._signatureContexts=n:t._signatureContexts.forEach((t=>{t.addSourceTypeVarScopeId(e)}))}return t}copyFromClone(e){this._signatureContexts=e._signatureContexts.map((e=>e.clone())),this._isLocked=e._isLocked}copySignatureContexts(e){(0,s.assert)(e.length>0),this._signatureContexts=[...e]}getSolveForScopes(){return this._solveForScopes}hasSolveForScope(e){return void 0!==e&&void 0!==this._solveForScopes&&this._solveForScopes.some((t=>t===e||t===i.WildcardTypeVarScopeId))}setSolveForScopes(e){this._solveForScopes=e}addSolveForScope(e){void 0===e||this.hasSolveForScope(e)||(this._solveForScopes||(this._solveForScopes=[]),this._solveForScopes.push(e))}lock(){(0,s.assert)(!this._isLocked),this._isLocked=!0}unlock(){this._isLocked=!1}isLocked(){return this._isLocked}isEmpty(){return this._signatureContexts.every((e=>e.isEmpty()))}applySourceContextTypeVars(e){if(e.isEmpty())return;const t=this.isLocked();this.unlock(),this._signatureContexts.forEach((t=>t.applySourceContextTypeVars(e))),t&&this.lock()}setTypeVarType(e,t,n,i){return(0,s.assert)(!this._isLocked),this._signatureContexts.forEach((s=>{s.setTypeVarType(e,t,n,i)}))}setTupleTypeVar(e,t){return(0,s.assert)(!this._isLocked),this._signatureContexts.forEach((n=>{n.setTupleTypeVar(e,t)}))}getScore(){let e=0;return this._signatureContexts.forEach((t=>{e+=t.getScore()})),e/this._signatureContexts.length}getPrimarySignature(){return this._signatureContexts[0]}getSignatureContexts(){return this._signatureContexts}getSignatureContext(e){return(0,s.assert)(e>=0&&e<this._signatureContexts.length),this._signatureContexts[e]}doForEachSignature(e){this._signatureContexts.forEach((t=>{e(t)}))}}t.TypeVarContext=o},9453:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.narrowForKeyAssignment=t.getTypeOfIndexedTypedDict=t.assignToTypedDict=t.assignTypedDictToTypedDict=t.getTypedDictMembersForClass=t.synthesizeTypedDictClassMethods=t.createTypedDictTypeInlined=t.createTypedDictType=void 0;const r=n(9489),o=n(5839),l=n(1290),c=n(9744),p=n(1464),d=n(3550),u=n(9866),y=a(n(563)),m=a(n(8494)),g=n(817),h=n(2917),f=n(1133),T=n(5168),v=n(4447);function _(e,t,n,s){(0,o.assert)(f.ClassType.isTypedDictClass(n));const i=f.FunctionType.createSynthesizedInstance("__new__",1);f.FunctionType.addParameter(i,{category:0,name:"cls",type:n,hasDeclaredType:!0}),f.FunctionType.addDefaultParameters(i),i.details.declaredReturnType=f.ClassType.cloneAsInstance(n);const a=f.FunctionType.createSynthesizedInstance("__init__");f.FunctionType.addParameter(a,{category:0,name:"self",type:f.ClassType.cloneAsInstance(n),hasDeclaredType:!0}),a.details.declaredReturnType=f.NoneType.createInstance(),f.FunctionType.addParameter(a,{category:1,type:f.AnyType.create(),hasDeclaredType:!0});const l=I(e,n);let c=!0;l.forEach(((e,t)=>{f.FunctionType.addParameter(a,{category:0,name:t,hasDefault:!e.isRequired,type:e.valueType,hasDeclaredType:!0}),e.isRequired&&(c=!1)}));const p=n.details.fields;p.set("__init__",g.Symbol.createWithType(4,a)),p.set("__new__",g.Symbol.createWithType(4,i));const d=e.getBuiltInType(t,"str");if((0,f.isInstantiableClass)(d)){const i={category:0,name:"self",type:f.ClassType.cloneAsInstance(n),hasDeclaredType:!0},a=e=>{let t=f.TypeVarType.createInstance("__TDefault");return t=f.TypeVarType.cloneForScopeId(t,e.details.typeVarScopeId,n.details.name,1),t},o=(n,s,r,o=!1,l=!1)=>{const c=f.FunctionType.createSynthesizedInstance("get",256);if(f.FunctionType.addParameter(c,i),c.details.typeVarScopeId=e.getScopeIdForNode(t),f.FunctionType.addParameter(c,{category:0,name:"k",type:n,hasDeclaredType:!0}),r){const e=a(c);let t,n;o?(t=f.AnyType.create(),n=null!=s?s:f.AnyType.create()):(t=l&&s?s:e,n=s?l?s:(0,f.combineTypes)([s,e]):e),f.FunctionType.addParameter(c,{category:0,name:"default",type:t,hasDeclaredType:!0}),c.details.declaredReturnType=n}else c.details.declaredReturnType=o?s:(0,f.combineTypes)([null!=s?s:f.AnyType.create(),f.NoneType.createInstance()]);return c},u=(n,s)=>{const r={category:0,name:"k",type:n,hasDeclaredType:!0},o=f.FunctionType.createSynthesizedInstance("pop",256);f.FunctionType.addParameter(o,i),f.FunctionType.addParameter(o,r),o.details.declaredReturnType=s;const l=f.FunctionType.createSynthesizedInstance("pop",256);f.FunctionType.addParameter(l,i),f.FunctionType.addParameter(l,r),l.details.typeVarScopeId=e.getScopeIdForNode(t);const c=a(l);return f.FunctionType.addParameter(l,{category:0,name:"default",hasDeclaredType:!0,type:c,hasDefault:!0}),l.details.declaredReturnType=(0,f.combineTypes)([s,c]),[o,l]},y=(e,t)=>{const n=f.FunctionType.createSynthesizedInstance("setdefault",256);return f.FunctionType.addParameter(n,i),f.FunctionType.addParameter(n,{category:0,name:"k",hasDeclaredType:!0,type:e}),f.FunctionType.addParameter(n,{category:0,name:"default",hasDeclaredType:!0,type:t}),n.details.declaredReturnType=t,n},m=e=>{const t=f.FunctionType.createSynthesizedInstance("delitem",256);return f.FunctionType.addParameter(t,i),f.FunctionType.addParameter(t,{category:0,name:"k",hasDeclaredType:!0,type:e}),t.details.declaredReturnType=f.NoneType.createInstance(),t},h=[],v=[],_=[];if(l.forEach(((e,t)=>{const n=f.ClassType.cloneAsInstance(f.ClassType.cloneWithLiteral(d,t));h.push(o(n,e.valueType,!1,e.isRequired)),e.isRequired?h.push(o(n,e.valueType,!0,!0,!0)):(h.push(o(n,e.valueType,!0,!1,!0)),h.push(o(n,e.valueType,!0,!1,!1))),e.isRequired||(0,r.appendArray)(v,u(n,e.valueType)),_.push(y(n,e.valueType))})),s){const n=e.getTypingType(t,"LiteralString");if(n&&(0,f.isInstantiableClass)(n)){const e=f.ClassType.cloneAsInstance(n);h.push(o(e,f.NoneType.createInstance(),!1,!0)),h.push(o(e,void 0,!0))}}const I=f.ClassType.cloneAsInstance(d);if(h.push(o(I,f.AnyType.create(),!1)),h.push(o(I,f.AnyType.create(),!0)),p.set("get",g.Symbol.createWithType(4,f.OverloadedFunctionType.create(h))),v.length>0&&p.set("pop",g.Symbol.createWithType(4,f.OverloadedFunctionType.create(v))),_.length>0&&p.set("setdefault",g.Symbol.createWithType(4,f.OverloadedFunctionType.create(_))),p.set("__delitem__",g.Symbol.createWithType(4,m(I))),s&&c){const t=f.FunctionType.createSynthesizedInstance("clear");f.FunctionType.addParameter(t,i),t.details.declaredReturnType=f.NoneType.createInstance(),p.set("clear",g.Symbol.createWithType(4,t));const n=f.FunctionType.createSynthesizedInstance("popitem");f.FunctionType.addParameter(n,i);let s=e.getTupleClassType();s=s&&(0,f.isInstantiableClass)(s)?(0,T.specializeTupleClass)(f.ClassType.cloneAsInstance(s),[{type:I,isUnbounded:!1},{type:f.UnknownType.create(),isUnbounded:!1}],!0):f.UnknownType.create(),n.details.declaredReturnType=s,p.set("popitem",g.Symbol.createWithType(4,n))}}}function I(e,t,n=!1){if(!t.details.typedDictEntries){const n=new Map;C(e,t,n),t.details.typedDictEntries=n}const s=(0,T.buildTypeVarContextFromSpecializedClass)(t),i=new Map;return t.details.typedDictEntries.forEach(((e,t)=>{const n={...e};n.valueType=(0,T.applySolvedTypeVars)(n.valueType,s),i.set(t,n)})),n&&t.typedDictNarrowedEntries&&t.typedDictNarrowedEntries.forEach(((e,t)=>{const n={...e};n.valueType=(0,T.applySolvedTypeVars)(n.valueType,s),i.set(t,n)})),i}function b(e,t,n){const s=new Set,i=y.getFileInfo(t);t.entries.forEach((t=>{if(17!==t.nodeType)return void e.addError(u.Localizer.Diagnostic.typedDictSecondArgDictEntry(),t);if(48!==t.keyExpression.nodeType)return void e.addError(u.Localizer.Diagnostic.typedDictEntryName(),t.keyExpression);const a=t.keyExpression.strings.map((e=>e.value)).join("");if(!a)return void e.addError(u.Localizer.Diagnostic.typedDictEmptyName(),t.keyExpression);if(s.has(a))return void e.addError(u.Localizer.Diagnostic.typedDictEntryUnique(),t.keyExpression);s.add(a);const r=new g.Symbol(8),o={type:1,node:t.keyExpression,path:i.filePath,typeAnnotationNode:t.valueExpression,isRuntimeTypeExpression:!0,range:(0,p.convertOffsetsToRange)(t.keyExpression.start,d.TextRange.getEnd(t.keyExpression),i.lines),moduleName:i.moduleName,isInExceptSuite:!1};r.addDeclaration(o),n.set(a,r)})),e.setTypeForNode(t)}function C(e,t,n,s=0){if((0,o.assert)(f.ClassType.isTypedDictClass(t)),s>f.maxTypeRecursionCount)return;s++,t.details.baseClasses.forEach((i=>{if((0,f.isInstantiableClass)(i)&&f.ClassType.isTypedDictClass(i)){const a=(0,T.partiallySpecializeType)(i,t);(0,o.assert)((0,f.isClass)(a)),C(e,a,n,s)}}));const i=(0,T.buildTypeVarContextFromSpecializedClass)(t);t.details.fields.forEach(((s,a)=>{if(!s.isIgnoredForProtocolMatch()){const r=(0,h.getLastTypedDeclaredForSymbol)(s);if(r&&1===r.type){let o=e.getEffectiveTypeOfSymbol(s);o=(0,T.applySolvedTypeVars)(o,i);let p=!f.ClassType.isCanOmitDictValues(t);!function(e,t){return t.getDeclarations().some((t=>!(1!==t.type||!t.typeAnnotationNode)&&!!e.getTypeOfExpressionExpectingType(t.typeAnnotationNode,{allowFinal:!0,allowRequired:!0}).isRequired))}(e,s)?function(e,t){return t.getDeclarations().some((t=>!(1!==t.type||!t.typeAnnotationNode)&&!!e.getTypeOfExpressionExpectingType(t.typeAnnotationNode,{allowFinal:!0,allowRequired:!0}).isNotRequired))}(e,s)&&(p=!1):p=!0;const d=n.get(a);if(d&&!(0,f.isTypeSame)(d.valueType,o)){const t=new l.DiagnosticAddendum;t.addMessage(u.Localizer.DiagnosticAddendum.typedDictFieldRedefinition().format({parentType:e.printType(d.valueType),childType:e.printType(o)})),e.addDiagnostic(y.getFileInfo(r.node).diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,u.Localizer.Diagnostic.typedDictFieldRedefinition().format({name:a})+t.getString(),r.node)}n.set(a,{valueType:o,isRequired:p,isProvided:!1})}}}))}t.createTypedDictType=function(e,t,n,s){const i=y.getFileInfo(t);let a="TypedDict";if(0===s.length)e.addError(u.Localizer.Diagnostic.typedDictFirstArg(),t);else{const n=s[0];0===n.argumentCategory&&n.valueExpression&&48===n.valueExpression.nodeType?a=n.valueExpression.strings.map((e=>e.value)).join(""):e.addError(u.Localizer.Diagnostic.typedDictFirstArg(),s[0].valueExpression||t)}const r=f.ClassType.createInstantiable(a,m.getClassFullName(t,i.moduleName,a),i.moduleName,i.filePath,128,m.getTypeSourceId(t),void 0,n.details.effectiveMetaclass);r.details.baseClasses.push(n),(0,T.computeMroLinearization)(r);const o=r.details.fields;o.set("__class__",g.Symbol.createWithType(68,r));let l=!1;if(s.length<2)e.addError(u.Localizer.Diagnostic.typedDictSecondArgDict(),t);else{const n=s[1];if(0===n.argumentCategory&&n.valueExpression&&15===n.valueExpression.nodeType)l=!0,b(e,n.valueExpression,o);else if(n.name){const n=new Set;for(let i=1;i<s.length;i++){const a=s[i];if(!a.name||!a.valueExpression)continue;if(n.has(a.name.value)){e.addError(u.Localizer.Diagnostic.typedDictEntryUnique(),a.valueExpression);continue}n.add(a.name.value);const r=new g.Symbol(8),l=y.getFileInfo(t),c={type:1,node:a.name,path:l.filePath,typeAnnotationNode:a.valueExpression,isRuntimeTypeExpression:!0,range:(0,p.convertOffsetsToRange)(a.name.start,d.TextRange.getEnd(a.valueExpression),l.lines),moduleName:l.moduleName,isInExceptSuite:!1};r.addDeclaration(c),o.set(a.name.value,r)}}else e.addError(u.Localizer.Diagnostic.typedDictSecondArgDict(),t)}return l&&(s.length>=3&&(!s[2].name||"total"!==s[2].name.value||!s[2].valueExpression||11!==s[2].valueExpression.nodeType||15!==s[2].valueExpression.constType&&33!==s[2].valueExpression.constType?e.addError(u.Localizer.Diagnostic.typedDictTotalParam(),s[2].valueExpression||t):15===s[2].valueExpression.constType&&(r.details.flags|=256)),s.length>3&&e.addError(u.Localizer.Diagnostic.typedDictExtraArgs(),s[3].valueExpression||t)),_(e,t,r,!1),r},t.createTypedDictTypeInlined=function(e,t,n){const s=y.getFileInfo(t),i="<TypedDict>",a=f.ClassType.createInstantiable(i,m.getClassFullName(t,s.moduleName,i),s.moduleName,s.filePath,128,m.getTypeSourceId(t),void 0,n.details.effectiveMetaclass);return a.details.baseClasses.push(n),(0,T.computeMroLinearization)(a),b(e,t,a.details.fields),_(e,t,a,!0),a},t.synthesizeTypedDictClassMethods=_,t.getTypedDictMembersForClass=I,t.assignTypedDictToTypedDict=function(e,t,n,s,i,a,r=0){let o=!0;const l=I(e,t),c=I(e,n,!0);return l.forEach(((l,p)=>{const d=c.get(p);if(d){l.isRequired&&!d.isRequired?(null==s||s.createAddendum().addMessage(u.Localizer.DiagnosticAddendum.typedDictFieldRequired().format({name:p,type:e.printType(t)})),o=!1):!l.isRequired&&d.isRequired&&(null==s||s.createAddendum().addMessage(u.Localizer.DiagnosticAddendum.typedDictFieldNotRequired().format({name:p,type:e.printType(t)})),o=!1);const n=null==s?void 0:s.createAddendum();e.assignType(l.valueType,d.valueType,null==n?void 0:n.createAddendum(),i,void 0,a,r)||(null==n||n.addMessage(u.Localizer.DiagnosticAddendum.memberTypeMismatch().format({name:p})),o=!1)}else null==s||s.createAddendum().addMessage(u.Localizer.DiagnosticAddendum.typedDictFieldMissing().format({name:p,type:e.printType(n)})),o=!1})),o},t.assignToTypedDict=function(e,t,n,s,i){(0,o.assert)((0,f.isClassInstance)(t)),(0,o.assert)(f.ClassType.isTypedDictClass(t)),(0,o.assert)(n.length===s.length);let a=!0;const r=new Map;let l,c=t;t.details.typeParameters.length>0&&(l=new v.TypeVarContext((0,T.getTypeVarScopeId)(t)),t.typeArguments&&(c=f.ClassType.cloneForSpecialization(t,void 0,!1)));const p=I(e,c);if(n.forEach(((n,o)=>{const c=n.type;if((0,f.isClassInstance)(c)&&f.ClassType.isBuiltIn(c,"str")&&(0,T.isLiteralType)(c)){const d=c.literalValue,y=p.get(d);if(y){const t=null==i?void 0:i.createAddendum();e.assignType(y.valueType,s[o].type,null==t?void 0:t.createAddendum(),l,void 0,128)||(t&&(t.addMessage(u.Localizer.DiagnosticAddendum.typedDictFieldTypeMismatch().format({name:c.literalValue,type:e.printType(s[o].type)})),t.addTextRange(n.node)),a=!1),y.isRequired||r.set(d,{valueType:s[o].type,isRequired:!1,isProvided:!0}),y.isProvided=!0}else if(a=!1,i){const s=null==i?void 0:i.createAddendum();s.addMessage(u.Localizer.DiagnosticAddendum.typedDictFieldUndefined().format({name:c.literalValue,type:e.printType(f.ClassType.cloneAsInstance(t))})),s.addTextRange(n.node)}}else a=!1})),!a)return;if(p.forEach(((n,s)=>{n.isRequired&&!n.isProvided&&(i&&i.addMessage(u.Localizer.DiagnosticAddendum.typedDictFieldRequired().format({name:s,type:e.printType(t)})),a=!1)})),!a)return;const d=l?(0,T.applySolvedTypeVars)(c,l):t;return 0===r.size?d:f.ClassType.cloneForNarrowedTypedDictEntries(d,r)},t.getTypeOfIndexedTypedDict=function(e,t,n,s){if(1!==t.items.length)return e.addError(u.Localizer.Diagnostic.typeArgsMismatchOne().format({received:t.items.length}),t),{type:f.UnknownType.create()};if(t.trailingComma||t.items[0].name||0!==t.items[0].argumentCategory)return;const i=I(e,n,"get"===s.method),a=e.getTypeOfExpression(t.items[0].valueExpression),r=a.type;let o=new l.DiagnosticAddendum,p=!0;const d=(0,T.mapSubtypes)(r,(a=>{var r,l;if((0,f.isAnyOrUnknown)(a))return a;if((0,f.isClassInstance)(a)&&f.ClassType.isBuiltIn(a,"str")){if(void 0===a.literalValue)return f.UnknownType.create();const c=a.literalValue,d=i.get(c);return d?(d.isRequired||d.isProvided||"get"!==s.method||m.isWithinTryBlock(t,!0)||o.addMessage(u.Localizer.DiagnosticAddendum.keyNotRequired().format({name:c,type:e.printType(n)})),"set"===s.method?e.assignType(d.valueType,null!==(l=null===(r=s.setType)||void 0===r?void 0:r.type)&&void 0!==l?l:f.AnyType.create(),o)||(p=!1):"del"===s.method&&d.isRequired&&(o.addMessage(u.Localizer.DiagnosticAddendum.keyRequiredDeleted().format({name:c})),p=!1),d.valueType):(o.addMessage(u.Localizer.DiagnosticAddendum.keyUndefined().format({name:c,type:e.printType(n)})),p=!1,f.UnknownType.create())}return o.addMessage(u.Localizer.DiagnosticAddendum.typeNotStringLiteral().format({type:e.printType(a)})),p=!1,f.UnknownType.create()}));if(!s.setExpectedTypeDiag||o.isEmpty()||s.setExpectedTypeDiag.isEmpty()||(o=s.setExpectedTypeDiag),!o.isEmpty()){let n;n="set"===s.method?u.Localizer.Diagnostic.typedDictSet():"del"===s.method?u.Localizer.Diagnostic.typedDictDelete():u.Localizer.Diagnostic.typedDictAccess();const i=y.getFileInfo(t);e.addDiagnostic(p?i.diagnosticRuleSet.reportTypedDictNotRequiredAccess:i.diagnosticRuleSet.reportGeneralTypeIssues,p?c.DiagnosticRule.reportTypedDictNotRequiredAccess:c.DiagnosticRule.reportGeneralTypeIssues,n+o.getString(),t)}return{type:d,isIncomplete:!!a.isIncomplete}},t.narrowForKeyAssignment=function(e,t){var n;if(!f.ClassType.isTypedDictClass(e)||!e.details.typedDictEntries)return e;const s=e.details.typedDictEntries.get(t);if(!s||s.isRequired)return e;const i=null===(n=e.typedDictNarrowedEntries)||void 0===n?void 0:n.get(t);if(null==i?void 0:i.isProvided)return e;const a=e.typedDictNarrowedEntries?new Map(e.typedDictNarrowedEntries):new Map;return a.set(t,{isProvided:!0,isRequired:!1,valueType:s.valueType}),f.ClassType.cloneForNarrowedTypedDictEntries(e,a)}},1133:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSameWithoutLiteralValue=t.combineTypes=t.findSubtype=t.removeFromUnion=t.removeNoneFromUnion=t.removeUnbound=t.cleanIncompleteUnknown=t.removeIncompleteUnknownFromUnion=t.removeUnknownFromUnion=t.isTypeSame=t.getTypeAliasInfo=t.isOverloadedFunction=t.isFunction=t.isParamSpec=t.isUnpacked=t.isUnpackedClass=t.isUnpackedVariadicTypeVar=t.isVariadicTypeVar=t.isTypeVar=t.isModule=t.isClassInstance=t.isInstantiableClass=t.isClass=t.isPossiblyUnbound=t.isUnion=t.isUnbound=t.isAnyOrUnknown=t.isUnknown=t.isAny=t.isNoneTypeClass=t.isNoneInstance=t.isNever=t.TypeVarType=t.UnionType=t.TypeCondition=t.AnyType=t.NeverType=t.NoneType=t.OverloadedFunctionType=t.FunctionType=t.ClassType=t.ModuleType=t.UnknownType=t.UnboundType=t.TypeBase=t.maxTypeRecursionCount=t.EnumLiteral=t.WildcardTypeVarScopeId=void 0;const s=n(5839);t.WildcardTypeVarScopeId="*";class i{constructor(e,t,n,s){this.classFullName=e,this.className=t,this.itemName=n,this.itemType=s}getName(){return`${this.classFullName}.${this.itemName}`}}var a,r,o,l,c,p,d,u,y,m;function g(e){return 4===e.category}function h(e){return 3===e.category&&a.isInstance(e)}function f(e){return 1===e.category}function T(e){return 2===e.category||1===e.category||!!_(e)&&void 0===e.subtypes.find((e=>!T(e)))}function v(e){return 0===e.category}function _(e){return 9===e.category}function I(e){return 7===e.category}function b(e){return 7===e.category&&a.isInstantiable(e)}function C(e){return 7===e.category&&a.isInstance(e)}function S(e){return 10===e.category}function x(e){return 10===e.category&&e.details.isVariadic&&!!e.isVariadicUnpacked&&!e.isVariadicInUnion}function D(e){return!(!I(e)||!e.isUnpacked)}function F(e,n,s={},i=0){var a,c;if(e===n)return!0;if(e.category!==n.category){if(s.treatAnySameAsUnknown){if(2===e.category&&1===n.category)return!0;if(1===e.category&&2===n.category)return!0}return!1}if(!s.ignoreTypeFlags&&e.flags!==n.flags)return!1;if(i>t.maxTypeRecursionCount)return!0;switch(i++,e.category){case 7:{const t=n;if(!o.isSameGenericClass(e,t,i))return!1;if(!d.isSame(e.condition,n.condition))return!1;if(!s.ignorePseudoGeneric||!o.isPseudoGenericClass(e))if(e.tupleTypeArguments&&t.tupleTypeArguments){const n=e.tupleTypeArguments||[],a=t.tupleTypeArguments||[];if(n.length!==a.length)return!1;for(let e=0;e<n.length;e++){if(!F(n[e].type,a[e].type,{...s,ignoreTypeFlags:!1},i))return!1;if(n[e].isUnbounded!==a[e].isUnbounded)return!1}}else{const n=e.typeArguments||[],a=t.typeArguments||[],o=Math.max(n.length,a.length);for(let e=0;e<o;e++)if(!F(e<n.length?n[e]:r.create(),e<a.length?a[e]:r.create(),{...s,ignoreTypeFlags:!1},i))return!1}return!!o.isLiteralValueSame(e,t)&&!!o.isTypedDictNarrowedEntriesSame(e,t)}case 5:{const t=n,a=e.details.parameters,r=t.details.parameters;if(a.length!==r.length)return!1;const o=a.findIndex((e=>0===e.category&&!e.name)),c=r.findIndex((e=>0===e.category&&!e.name));for(let n=0;n<a.length;n++){const p=a[n],d=r[n];if(p.category!==d.category)return!1;const u=void 0!==o&&n>=o;if(u!==(void 0!==c&&n>=c))return!1;if(u&&p.name!==d.name)return!1;if(!F(l.getEffectiveParameterType(e,n),l.getEffectiveParameterType(t,n),{...s,ignoreTypeFlags:!1},i))return!1}if(!e.specializedTypes&&!t.specializedTypes){const n=e.details.paramSpec,a=t.details.paramSpec;if(n){if(!a)return!1;if(!F(n,a,s,i))return!1}else if(a)return!1}let p=e.details.declaredReturnType;e.specializedTypes&&e.specializedTypes.returnType&&(p=e.specializedTypes.returnType),!p&&e.inferredReturnType&&(p=e.inferredReturnType);let d=t.details.declaredReturnType;return t.specializedTypes&&t.specializedTypes.returnType&&(d=t.specializedTypes.returnType),!d&&t.inferredReturnType&&(d=t.inferredReturnType),!!(!p&&!d||p&&d&&F(p,d,{...s,ignoreTypeFlags:!1},i))}case 6:{const t=n;if(e.overloads.length!==t.overloads.length)return!1;for(let n=0;n<e.overloads.length;n++)if(!F(e.overloads[n],t.overloads[n],s,i))return!1;return!0}case 9:{const t=n,s=e.subtypes,a=t.subtypes;if(s.length!==a.length)return!1;const r=new Set;return void 0===A(e,(e=>!u.containsType(t,e,r,i)))}case 10:{const t=n;if(e.scopeId!==t.scopeId)return!1;if(e.details.recursiveTypeParameters&&t.details.recursiveTypeParameters){const t=(null===(a=null==e?void 0:e.typeAliasInfo)||void 0===a?void 0:a.typeArguments)||[],r=(null===(c=null==n?void 0:n.typeAliasInfo)||void 0===c?void 0:c.typeArguments)||[],o=Math.max(t.length,r.length);for(let e=0;e<o;e++)if(!F(e<t.length?t[e]:p.create(),e<r.length?r[e]:p.create(),{...s,ignoreTypeFlags:!1},i))return!1}if(!e.isVariadicInUnion!=!t.isVariadicInUnion)return!1;if(e.details===t.details)return!0;if(e.details.name!==t.details.name||e.details.isParamSpec!==t.details.isParamSpec||e.details.isVariadic!==t.details.isVariadic||e.details.isSynthesized!==t.details.isSynthesized||e.details.declaredVariance!==t.details.declaredVariance||e.scopeId!==t.scopeId)return!1;const r=e.details.boundType,o=t.details.boundType;if(r){if(!o||!F(r,o,{...s,ignoreTypeFlags:!1},i))return!1}else if(o)return!1;const l=e.details.constraints,d=t.details.constraints;if(l.length!==d.length)return!1;for(let e=0;e<l.length;e++)if(!F(l[e],d[e],{...s,ignoreTypeFlags:!1},i))return!1;return!0}case 8:{const t=n;return e.fields===t.fields||0===e.fields.size&&0===t.fields.size}case 1:{const t=n;return e.isIncomplete===t.isIncomplete}}return!0}function E(e){return P(e,(e=>f(e)&&e.isIncomplete))}function P(e,t){if(_(e)){const n=e.subtypes.filter((e=>!t(e)));if(n.length<e.subtypes.length){const t=N(n);return _(t)&&u.addTypeAliasSource(t,e),t}}return e}function A(e,t){return _(e)?e.subtypes.find((e=>t(e))):t(e)?e:void 0}function N(e,t){let n=!1;if(e.some((e=>4===e.category))&&(e=e.filter((e=>(4===e.category&&e.isNoReturn&&(n=!0),4!==e.category)))),0===e.length)return n?c.createNoReturn():c.createNever();let s=!0;if(e.length>1)for(let t=1;t<e.length;t++)if(e[t]!==e[0]){s=!1;break}if(s)return e[0];let i=[];const a=new Set;for(const t of e)_(t)?(i=i.concat(t.subtypes),t.typeAliasInfo?a.add(t):t.typeAliasSources&&t.typeAliasSources.forEach((e=>{a.add(e)}))):i.push(t);if(i=i.sort(((e,t)=>C(e)&&void 0!==e.literalValue||b(e)&&void 0!==e.literalValue?1:C(t)&&void 0!==t.literalValue||b(t)&&void 0!==t.literalValue?-1:C(e)&&e.isEmptyContainer?1:C(t)&&t.isEmptyContainer?-1:0)),0===i.length)return r.create();const l=u.create();a.size>0&&(l.typeAliasSources=a);let d=!1;return i.forEach(((e,n)=>{0===n?u.addType(l,e):void 0===t||l.subtypes.length<t?function(e,t){if(C(t)&&void 0===t.condition){if(o.isBuiltIn(t,"str")&&void 0!==t.literalValue&&void 0!==e.literalStrMap)return void(e.literalStrMap.has(t.literalValue)||u.addType(e,t));if(o.isBuiltIn(t,"int")&&void 0!==t.literalValue&&void 0!==e.literalIntMap)return void(e.literalIntMap.has(t.literalValue)||u.addType(e,t));if(o.isEnumClass(t)&&void 0!==t.literalValue&&void 0!==e.literalEnumMap){const n=t.literalValue;return void(e.literalEnumMap.has(n.getName())||u.addType(e,t))}}const n=I(t)&&o.isPseudoGenericClass(t);for(let s=0;s<e.subtypes.length;s++){const i=e.subtypes[s];if(F(i,t))return;if(n&&F(i,t,{ignorePseudoGeneric:!0})&&(e.subtypes[s]=o.cloneForSpecialization(t,t.details.typeParameters.map((()=>r.create())),!0)),C(i)&&C(t)){if(k(i,t)&&void 0===i.literalValue)return;if(o.isBuiltIn(i,"bool")&&!i.condition&&o.isBuiltIn(t,"bool")&&!t.condition&&void 0!==t.literalValue&&!t.literalValue===i.literalValue)return void(e.subtypes[s]=o.cloneWithLiteral(i,void 0));if(o.isTypedDictClass(i)&&o.isSameGenericClass(i,t)){if(o.isTypedDictNarrower(t,i))return;if(o.isTypedDictNarrower(i,t))return void(e.subtypes[s]=t)}}if(C(t)&&t.isEmptyContainer&&C(i)&&o.isSameGenericClass(i,t))return}u.addType(e,t)}(l,e):d=!0})),d?p.create():1===l.subtypes.length?l.subtypes[0]:l}function k(e,t){return!!F(e,t)||(b(t)&&void 0!==t.literalValue||!(!C(t)||void 0===t.literalValue))&&F(e,t=o.cloneWithLiteral(t,void 0))}t.EnumLiteral=i,t.maxTypeRecursionCount=32,function(e){function t(e){const t={...e};return delete t.cached,t}e.isInstantiable=function(e){return 0!=(1&e.flags)},e.isInstance=function(e){return 0!=(2&e.flags)},e.isAnnotated=function(e){return 0!=(4&e.flags)},e.isSpecialForm=function(e){return 0!=(8&e.flags)},e.setSpecialForm=function(e){return e.flags|=8},e.isAmbiguous=function(e){return!!e.isAmbiguous},e.cloneType=t,e.cloneTypeAsInstance=function(t){(0,s.assert)(e.isInstantiable(t));const n=e.cloneType(t);return void 0===n.instantiableNestingLevel?(n.flags&=-2,n.flags|=2,delete n.instantiableNestingLevel):1===n.instantiableNestingLevel?delete n.instantiableNestingLevel:n.instantiableNestingLevel--,n},e.cloneTypeAsInstantiable=function(t){const n=e.cloneType(t);return e.isInstance(t)?(n.flags&=-3,n.flags|=1):n.instantiableNestingLevel=void 0===n.instantiableNestingLevel?1:n.instantiableNestingLevel,n},e.cloneForTypeAlias=function(e,n,s,i,a,r){const o=t(e);return o.typeAliasInfo={name:n,fullName:s,typeParameters:a,typeArguments:r,typeVarScopeId:i},o},e.cloneForAnnotated=function(e){const n=t(e);return n.flags|=4,n},e.cloneForCondition=function(e,n){if(void 0===e.condition&&void 0===n)return e;const s=t(e);return s.condition=n,s},e.cloneForAmbiguousType=function(e){if(e.isAmbiguous)return e;const n=t(e);return n.isAmbiguous=!0,n}}(a=t.TypeBase||(t.TypeBase={})),function(e){const t={category:0,flags:3};e.create=function(){return t}}(t.UnboundType||(t.UnboundType={})),function(e){const t={category:1,flags:3,isIncomplete:!1},n={category:1,flags:3,isIncomplete:!0};e.create=function(e=!1){return e?n:t},e.createPossibleType=function(e){return{category:1,flags:3,isIncomplete:!1,possibleType:e}}}(r=t.UnknownType||(t.UnknownType={})),(m=t.ModuleType||(t.ModuleType={})).create=function(e,t,n){return{category:8,fields:n||new Map,loaderFields:new Map,flags:1,moduleName:e,filePath:t}},m.getField=function(e,t){let n=e.fields.get(t);if(e.loaderFields)if(n){const s=e.loaderFields.get(t);s&&!s.isExternallyHidden()&&(n=s)}else n=e.loaderFields.get(t);return n},function(e){function n(e){return a.cloneTypeAsInstantiable(e)}function s(e,t){if(!(1&e.details.flags))return!1;if(void 0!==t){const n=Array.isArray(t)?t:[t];return n.some((t=>t===e.details.name))||n.some((t=>t===e.aliasName))}return!0}function o(n,s,i=0){if(i>t.maxTypeRecursionCount)return!0;if(i++,n.details===s.details)return!0;const a=n.details,r=s.details;if(a===r)return!0;if(a.fullName!==r.fullName||a.flags!==r.flags||a.typeSourceId!==r.typeSourceId||a.baseClasses.length!==r.baseClasses.length||a.typeParameters.length!==r.typeParameters.length)return!1;if(e.isBuiltIn(n,"NamedTuple")&&e.isBuiltIn(s,"NamedTuple"))return!0;if(e.isBuiltIn(n,"tuple")&&e.isBuiltIn(s,"tuple"))return!0;for(let e=0;e<a.baseClasses.length;e++)if(!F(a.baseClasses[e],r.baseClasses[e],{ignorePseudoGeneric:!0},i))return!1;if((a.declaredMetaclass||r.declaredMetaclass)&&(!a.declaredMetaclass||!r.declaredMetaclass||!F(a.declaredMetaclass,r.declaredMetaclass,{ignorePseudoGeneric:!0},i)))return!1;for(let e=0;e<a.typeParameters.length;e++)if(!F(a.typeParameters[e],r.typeParameters[e],{ignorePseudoGeneric:!0},i))return!1;return!0}e.createInstantiable=function(e,t,n,s,i,a,r,o,l){return{category:7,details:{name:e,fullName:t,moduleName:n,filePath:s,flags:i,typeSourceId:a,baseClasses:[],declaredMetaclass:r,effectiveMetaclass:o,mro:[],fields:new Map,typeParameters:[],docString:l},flags:1}},e.cloneAsInstance=function(e,t=!0){if(a.isInstance(e))return e;const n=a.cloneTypeAsInstance(e);return n.flags&=-9,t&&(n.includeSubclasses=!0),n},e.cloneAsInstantiable=n,e.cloneForSpecialization=function(e,t,n,s=!1,i,o){const l=a.cloneType(e);return l.typeArguments=t,l.isTypeArgumentExplicit=n,s&&(l.includeSubclasses=!0),l.tupleTypeArguments=i?i.map((e=>g(e.type)?{type:r.create(),isUnbounded:e.isUnbounded}:e)):void 0,void 0!==o&&(l.isEmptyContainer=o),l},e.cloneWithLiteral=function(e,t){const n=a.cloneType(e);return n.literalValue=t,n},e.cloneForTypingAlias=function(e,t){const n=a.cloneType(e);return n.aliasName=t,n},e.cloneForNarrowedTypedDictEntries=function(e,t){const n=a.cloneType(e);return n.typedDictNarrowedEntries=t,n},e.cloneWithNewTypeParameters=function(e,t){const n=a.cloneType(e);return n.details={...n.details},n.details.typeParameters=t,n.details.requiresVarianceInference=!1,n},e.cloneForTypeGuard=function(e,t,n){const s=a.cloneType(e);return s.typeGuardType=t,s.isStrictTypeGuard=n,s},e.cloneForSymbolTableUpdate=function(e){const t=a.cloneType(e);return t.details={...t.details},t.details.fields=new Map(t.details.fields),t.details.mro=[...t.details.mro],t.details.mro[0]=n(t),t},e.cloneForUnpacked=function(e,t=!0){const n=a.cloneType(e);return n.isUnpacked=t,n},e.isLiteralValueSame=function(e,t){return void 0===e.literalValue?void 0===t.literalValue:void 0!==t.literalValue&&(e.literalValue instanceof i?t.literalValue instanceof i&&e.literalValue.itemName===t.literalValue.itemName:e.literalValue===t.literalValue)},e.isTypedDictNarrowedEntriesSame=function(e,t){if(e.typedDictNarrowedEntries){if(!t.typedDictNarrowedEntries)return!1;const n=e.typedDictNarrowedEntries,s=t.typedDictNarrowedEntries;if(n.size!==s.size)return!1;let i,a;for([i,a]of n.entries()){const e=s.get(i);if(!e)return!1;if(a.isProvided!==e.isProvided)return!1}}else if(t.typedDictNarrowedEntries)return!1;return!0},e.isTypedDictNarrower=function(e,t){var n;const s=t.typedDictNarrowedEntries;if(!s)return!0;const i=null!==(n=e.typedDictNarrowedEntries)&&void 0!==n?n:new Map;let a,r;for([a,r]of s.entries())if(r.isProvided){const e=i.get(a);if(!(null==e?void 0:e.isProvided))return!1}return!0},e.isUnspecialized=function(e){return e.details.typeParameters.length>0&&void 0===e.typeArguments},e.isSpecialBuiltIn=function(e,t){return!!(2&e.details.flags||e.aliasName)&&(void 0===t||e.details.name===t)},e.isBuiltIn=s,e.derivesFromAnyOrUnknown=function(e){return e.details.mro.some((e=>!I(e)))},e.supportsAbstractMethods=function(e){return!!(512&e.details.flags)},e.isDataClass=function(e){return!!(4&e.details.flags)},e.isSkipSynthesizedDataClassInit=function(e){return!!(16&e.details.flags)},e.isSkipSynthesizedDataClassEq=function(e){return!!(32&e.details.flags)},e.isFrozenDataClass=function(e){return!!(8&e.details.flags)},e.isSynthesizedDataclassOrder=function(e){return!!(64&e.details.flags)},e.isDataClassKeywordOnlyParams=function(e){return!!(2097152&e.details.flags)},e.isGeneratedDataClassSlots=function(e){return!!(33554432&e.details.flags)},e.isSynthesizeDataClassUnsafeHash=function(e){return!!(67108864&e.details.flags)},e.isTypedDictClass=function(e){return!!(128&e.details.flags)},e.isCanOmitDictValues=function(e){return!!(256&e.details.flags)},e.isEnumClass=function(e){return!!(1048576&e.details.flags)},e.isPropertyClass=function(e){return!!(2048&e.details.flags)},e.isClassProperty=function(e){return!!(4194304&e.details.flags)},e.isFinal=function(e){return!!(4096&e.details.flags)},e.isProtocolClass=function(e){return!!(8192&e.details.flags)},e.isDefinedInStub=function(e){return!!(8388608&e.details.flags)},e.isPseudoGenericClass=function(e){return!!(16384&e.details.flags)},e.getDataClassEntries=function(e){return e.details.dataClassEntries||[]},e.isRuntimeCheckable=function(e){return!!(32768&e.details.flags)},e.isTypingExtensionClass=function(e){return!!(65536&e.details.flags)},e.isPartiallyEvaluated=function(e){return!!(131072&e.details.flags)},e.hasCustomClassGetItem=function(e){return!!(262144&e.details.flags)},e.isTupleClass=function(e){return!!(524288&e.details.flags)},e.isReadOnlyInstanceVariables=function(e){return!!(16777216&e.details.flags)},e.getTypeParameters=function(e){return e.details.typeParameters},e.hasUnknownBaseClass=function(e){return e.details.mro.some((e=>T(e)))},e.isHierarchyPartiallyEvaluated=function(t){return e.isPartiallyEvaluated(t)||t.details.mro.some((t=>I(t)&&e.isPartiallyEvaluated(t)))},e.isSameGenericClass=o,e.isDerivedFrom=function t(n,i,a){if(o(n,i))return a&&a.push(n),!0;if(s(n)&&s(i,"object"))return a&&a.push(i),!0;if(e.isBuiltIn(n,"property")&&e.isBuiltIn(i,"property"))return a&&a.push(n),!0;for(const e of n.details.baseClasses)if(b(e)){if(t(e,i,a))return a&&a.push(n),!0}else if(T(e))return a&&a.push(r.create()),!0;return!1},e.getReverseMro=function(e){return e.details.mro.slice(0).reverse()}}(o=t.ClassType||(t.ClassType={})),function(e){function t(e,t,n,s,i,a){return{category:5,details:{name:e,fullName:t,moduleName:n,flags:s,parameters:[],typeParameters:[],docString:a},flags:i}}function n(e=!1){return[{category:1,name:"args",type:e?r.create():p.create(),hasDeclaredType:!e},{category:2,name:"kwargs",type:e?r.create():p.create(),hasDeclaredType:!e}]}function i(e,t){return(0,s.assert)(t<e.details.parameters.length,"Parameter types array overflow"),e.specializedTypes&&t<e.specializedTypes.parameterTypes.length?e.specializedTypes.parameterTypes[t]:e.details.parameters[t].type}e.createInstance=function(e,n,s,i,a){return t(e,n,s,i,2,a)},e.createInstantiable=function(e,n){return t("","","",e,1,n)},e.createSynthesizedInstance=function(e,n=0){return t(e,"","",64|n,2)},e.clone=function(e,n=!1,s,a){var r;const o=t(e.details.name,e.details.fullName,e.details.moduleName,e.details.flags,e.flags,e.details.docString);return o.details={...e.details},o.boundToType=s,o.preBoundFlags=o.details.flags,n&&(e.details.parameters.length>0?0===e.details.parameters[0].category&&(e.details.parameters.length>0&&!e.details.parameters[0].isTypeInferred&&(o.strippedFirstParamType=i(e,0)),o.details.parameters=e.details.parameters.slice(1)):n=!1,o.details.flags&=-4,o.details.flags|=4),void 0!==e.typeAliasInfo&&(o.typeAliasInfo=e.typeAliasInfo),e.specializedTypes&&(o.specializedTypes={parameterTypes:n?e.specializedTypes.parameterTypes.slice(1):e.specializedTypes.parameterTypes,parameterDefaultArgs:n?null===(r=e.specializedTypes.parameterDefaultArgs)||void 0===r?void 0:r.slice(1):e.specializedTypes.parameterDefaultArgs,returnType:e.specializedTypes.returnType}),o.inferredReturnType=e.inferredReturnType,o.boundTypeVarScopeId=a,o},e.cloneAsInstance=function(e){const t=a.cloneTypeAsInstance(e);return t.flags&=-9,t},e.cloneAsInstantiable=function(e){const t=a.cloneTypeAsInstantiable(e);return t.flags&=-9,t},e.cloneForSpecialization=function(e,n,i){const a=t(e.details.name,e.details.fullName,e.details.moduleName,e.details.flags,e.flags,e.details.docString);return a.details=e.details,(0,s.assert)(n.parameterTypes.length===e.details.parameters.length),n.parameterDefaultArgs&&(0,s.assert)(n.parameterDefaultArgs.length===e.details.parameters.length),a.specializedTypes=n,i&&(a.inferredReturnType=i),a},e.cloneForParamSpec=function(n,s){const i=t(n.details.name,n.details.fullName,n.details.moduleName,n.details.flags,n.flags,n.details.docString);return i.details={...n.details},delete i.details.paramSpec,s&&(i.details.parameters=[...n.details.parameters,...s.details.parameters.map((e=>({category:e.category,name:e.name,hasDefault:e.hasDefault,defaultValueExpression:e.defaultValueExpression,isNameSynthesized:e.isNameSynthesized,hasDeclaredType:!0,type:e.type})))],i.details.docString||(i.details.docString=s.details.docString),i.details.flags=33031&s.details.flags|64,e.isParamSpecValue(n)&&(i.details.flags|=65536),n.specializedTypes&&(i.specializedTypes={parameterTypes:[...n.specializedTypes.parameterTypes],returnType:n.specializedTypes.returnType},n.specializedTypes.parameterDefaultArgs&&(i.specializedTypes.parameterDefaultArgs=[...n.specializedTypes.parameterDefaultArgs]),s.details.parameters.forEach((e=>{i.specializedTypes.parameterTypes.push(e.type),i.specializedTypes.parameterDefaultArgs&&i.specializedTypes.parameterDefaultArgs.push(void 0)}))),i.details.paramSpec=s.details.paramSpec),i},e.cloneWithNewFlags=function(e,t){const n=a.cloneType(e);return n.details={...e.details},n.details.flags=t,n},e.cloneWithDocString=function(e,t){const n=a.cloneType(e);return n.details={...e.details},n.details.docString=t,n},e.cloneForParamSpecApplication=function(e,t){const n=a.cloneType(e);if(n.details={...e.details},n.details.parameters=n.details.parameters.slice(0,n.details.parameters.length-2),n.details.flags&=-32769,32768&t.details.flags&&(n.details.flags|=32768),t.details.parameters.some((e=>0===e.category&&!e.name))&&n.details.parameters.length>0){const e=n.details.parameters[n.details.parameters.length-1];0!==e.category||e.name||n.details.parameters.pop()}return t.details.parameters.forEach((e=>{n.details.parameters.push({category:e.category,name:e.name,hasDefault:e.hasDefault,defaultValueExpression:e.defaultValueExpression,isNameSynthesized:e.isNameSynthesized,hasDeclaredType:!0,type:e.type})})),n.details.paramSpec=t.details.paramSpec,n.details.docString||(n.details.docString=t.details.docString),n},e.cloneRemoveParamSpecVariadics=function(e,n){const s=t(e.details.name,e.details.fullName,e.details.moduleName,e.details.flags,e.flags,e.details.docString);return s.details={...e.details},s.details.parameters=s.details.parameters.slice(0,s.details.parameters.length-2),e.specializedTypes&&(s.specializedTypes={...e.specializedTypes},s.specializedTypes.parameterTypes=s.specializedTypes.parameterTypes.slice(0,s.specializedTypes.parameterTypes.length-2),s.specializedTypes.parameterDefaultArgs&&(s.specializedTypes.parameterDefaultArgs=s.specializedTypes.parameterDefaultArgs.slice(0,s.specializedTypes.parameterDefaultArgs.length-2))),s.details.paramSpec||(s.details.paramSpec=n),s},e.addDefaultParameters=function(t,s=!1){n(s).forEach((n=>{e.addParameter(t,n)}))},e.getDefaultParameters=n,e.hasDefaultParameters=function(t){let n=!1,s=!1;for(let i=0;i<t.details.parameters.length;i++){const a=t.details.parameters[i];if(a.name){if(0===a.category)return!1;if(1===a.category?n=!0:2===a.category&&(s=!0),!T(e.getEffectiveParameterType(t,i)))return!1}}return n&&s},e.isInstanceMethod=function(e){return 0==(7&e.details.flags)},e.isConstructorMethod=function(e){return 0!=(1&e.details.flags)},e.isStaticMethod=function(e){return 0!=(4&e.details.flags)},e.isClassMethod=function(e){return 0!=(2&e.details.flags)},e.isAbstractMethod=function(e){return 0!=(8&e.details.flags)},e.isGenerator=function(e){return 0!=(16&e.details.flags)},e.isSynthesizedMethod=function(e){return 0!=(64&e.details.flags)},e.isSkipConstructorCheck=function(e){return 0!=(128&e.details.flags)},e.isOverloaded=function(e){return 0!=(256&e.details.flags)},e.isDefaultParameterCheckDisabled=function(e){return 0!=(32&e.details.flags)},e.isAsync=function(e){return 0!=(512&e.details.flags)},e.isWrapReturnTypeInAwait=function(e){return 0!=(1024&e.details.flags)},e.isStubDefinition=function(e){return 0!=(2048&e.details.flags)},e.isPyTypedDefinition=function(e){return 0!=(4096&e.details.flags)},e.isFinal=function(e){return 0!=(8192&e.details.flags)},e.hasUnannotatedParams=function(e){return 0!=(16384&e.details.flags)},e.shouldSkipArgsKwargsCompatibilityCheck=function(e){return 0!=(32768&e.details.flags)},e.isParamSpecValue=function(e){return 0!=(65536&e.details.flags)},e.isPartiallyEvaluated=function(e){return!!(131072&e.details.flags)},e.isOverridden=function(e){return!!(262144&e.details.flags)},e.getEffectiveParameterType=i,e.getEffectiveParameterDefaultArgType=function(e,t){var n;if((0,s.assert)(t<e.details.parameters.length,"Parameter types array overflow"),(null===(n=e.specializedTypes)||void 0===n?void 0:n.parameterDefaultArgs)&&t<e.specializedTypes.parameterDefaultArgs.length){const n=e.specializedTypes.parameterDefaultArgs[t];if(n)return n}return e.details.parameters[t].defaultType},e.addParameter=function(e,t){e.details.parameters.push(t)},e.getSpecializedReturnType=function(e){return e.specializedTypes&&e.specializedTypes.returnType?e.specializedTypes.returnType:e.details.declaredReturnType}}(l=t.FunctionType||(t.FunctionType={})),(y=t.OverloadedFunctionType||(t.OverloadedFunctionType={})).create=function(e){return{category:6,overloads:e,flags:2}},y.addOverload=function(e,t){e.overloads.push(t)},y.getOverloads=function(e){return e.overloads.filter((e=>l.isOverloaded(e)))},y.getImplementation=function(e){return e.overloads.find((e=>!l.isOverloaded(e)))},function(e){const t={category:3,flags:2},n={category:3,flags:1};e.createInstance=function(){return t},e.createType=function(){return n}}(t.NoneType||(t.NoneType={})),function(e){const t={category:4,flags:3,isNoReturn:!1},n={category:4,flags:3,isNoReturn:!0};e.createNever=function(){return t},e.createNoReturn=function(){return n}}(c=t.NeverType||(t.NeverType={})),function(e){const t={category:2,isEllipsis:!1,flags:3},n={category:2,isEllipsis:!0,flags:3};e.create=function(e=!1){return e?n:t}}(p=t.AnyType||(t.AnyType={})),function(e){function t(e,t){return e.typeVarName<t.typeVarName?-1:e.typeVarName>t.typeVarName?1:e.constraintIndex<t.constraintIndex?-1:e.constraintIndex>t.constraintIndex?1:0}e.combine=function(e,n){if(!e)return n;if(!n)return e;const s=[...e];return n.forEach((e=>{s.some((n=>0===t(e,n)))||s.push(e)})),s.sort(t)},e.isSame=function(e,t){return e?!(!t||e.length!==t.length)&&void 0===e.find(((e,n)=>e.typeVarName!==t[n].typeVarName||e.constraintIndex!==t[n].constraintIndex)):!t},e.isCompatible=function(e,t){if(!e||!t)return!0;for(const n of e){let e=!1;const s=t.find((t=>n.typeVarName===t.typeVarName&&(e=!0,n.constraintIndex===t.constraintIndex)));if(e&&!s)return!1}return!0}}(d=t.TypeCondition||(t.TypeCondition={})),function(e){e.create=function(){return{category:9,subtypes:[],flags:3}},e.addType=function(e,t){if(C(t)&&void 0!==t.literalValue&&void 0===t.condition)if(o.isBuiltIn(t,"str"))void 0===e.literalStrMap&&(e.literalStrMap=new Map),e.literalStrMap.set(t.literalValue,t);else if(o.isBuiltIn(t,"int"))void 0===e.literalIntMap&&(e.literalIntMap=new Map),e.literalIntMap.set(t.literalValue,t);else if(o.isEnumClass(t)){void 0===e.literalEnumMap&&(e.literalEnumMap=new Map);const n=t.literalValue;e.literalEnumMap.set(n.getName(),t)}e.flags&=t.flags,e.subtypes.push(t),S(t)&&t.details.recursiveTypeAliasName&&(e.includesRecursiveTypeAlias=!0)},e.containsType=function(e,t,n,s=0){if(C(t)&&void 0===t.condition&&void 0!==t.literalValue){if(o.isBuiltIn(t,"str")&&void 0!==e.literalStrMap)return e.literalStrMap.has(t.literalValue);if(o.isBuiltIn(t,"int")&&void 0!==e.literalIntMap)return e.literalIntMap.has(t.literalValue);if(o.isEnumClass(t)&&void 0!==e.literalEnumMap){const n=t.literalValue;return e.literalEnumMap.has(n.getName())}}const i=e.subtypes.findIndex(((e,i)=>!(null==n?void 0:n.has(i))&&F(e,t,{},s)));return!(i<0||(null==n||n.add(i),0))},e.addTypeAliasSource=function(e,t){if(9===t.category){const n=t.typeAliasInfo?[t]:t.typeAliasSources;n&&(e.typeAliasSources||(e.typeAliasSources=new Set),n.forEach((t=>{e.typeAliasSources.add(t)})))}}}(u=t.UnionType||(t.UnionType={})),function(e){function t(e,t){return`${e}.${t}`}function n(e,t,n){return{category:10,details:{name:e,constraints:[],declaredVariance:2,isParamSpec:t,isVariadic:!1,isSynthesized:!1},flags:n}}e.createInstance=function(e){return n(e,!1,2)},e.createInstantiable=function(e,t=!1){return n(e,t,1)},e.cloneAsInstance=function(e){(0,s.assert)(a.isInstantiable(e));const t=a.cloneTypeAsInstance(e);return t.flags&=-9,t},e.cloneAsInstantiable=function(e){const t=a.cloneTypeAsInstantiable(e);return t.flags&=-9,t},e.cloneForNewName=function(e,n){const s=a.cloneType(e);return s.details={...e.details},s.details.name=n,s.scopeId&&(s.nameWithScope=t(n,s.scopeId)),s},e.cloneForScopeId=function(e,n,s,i){const r=a.cloneType(e);return r.nameWithScope=t(e.details.name,n),r.scopeId=n,r.scopeName=s,r.scopeType=i,r},e.cloneForUnpacked=function(e,t=!1){(0,s.assert)(e.details.isVariadic);const n=a.cloneType(e);return n.isVariadicUnpacked=!0,n.isVariadicInUnion=t,n},e.cloneForPacked=function(e){(0,s.assert)(e.details.isVariadic);const t=a.cloneType(e);return t.isVariadicUnpacked=!1,t.isVariadicInUnion=!1,t},e.cloneAsInvariant=function(e){if(e.details.isParamSpec||e.details.isVariadic)return e;if(0===e.details.declaredVariance)return e;if(2===e.details.declaredVariance&&void 0===e.details.boundType&&0===e.details.constraints.length)return e;const t=a.cloneType(e);return t.details={...t.details},t.details.declaredVariance=2,t.details.boundType=void 0,t.details.constraints=[],t},e.cloneForParamSpecAccess=function(e,t){const n=a.cloneType(e);return n.paramSpecAccess=t,n},e.cloneAsSpecializedSelf=function(e,t){(0,s.assert)(e.details.isSynthesizedSelf);const n=a.cloneType(e);return n.details={...n.details},n.details.boundType=t,n},e.makeNameWithScope=t,e.addConstraint=function(e,t){e.details.constraints.push(t)},e.getNameWithScope=function(e){return e.nameWithScope||e.details.name},e.getReadableName=function(e){return e.scopeName?`${e.details.name}@${e.scopeName}`:e.details.name},e.getVariance=function(e){var t;const n=null!==(t=e.computedVariance)&&void 0!==t?t:e.details.declaredVariance;return(0,s.assert)(0!==n),n},e.isTypeAliasPlaceholder=function(e){return!!e.details.recursiveTypeAliasName&&!e.details.boundType}}(t.TypeVarType||(t.TypeVarType={})),t.isNever=g,t.isNoneInstance=h,t.isNoneTypeClass=function(e){return 3===e.category&&a.isInstantiable(e)},t.isAny=function(e){return 2===e.category},t.isUnknown=f,t.isAnyOrUnknown=T,t.isUnbound=v,t.isUnion=_,t.isPossiblyUnbound=function e(t){return!!v(t)||!!_(t)&&void 0!==t.subtypes.find((t=>e(t)))},t.isClass=I,t.isInstantiableClass=b,t.isClassInstance=C,t.isModule=function(e){return 8===e.category},t.isTypeVar=S,t.isVariadicTypeVar=function(e){return 10===e.category&&e.details.isVariadic},t.isUnpackedVariadicTypeVar=x,t.isUnpackedClass=D,t.isUnpacked=function(e){return x(e)||D(e)},t.isParamSpec=function(e){return 10===e.category&&e.details.isParamSpec},t.isFunction=function(e){return 5===e.category},t.isOverloadedFunction=function(e){return 6===e.category},t.getTypeAliasInfo=function(e){return e.typeAliasInfo?e.typeAliasInfo:S(e)&&e.details.recursiveTypeAliasName&&e.details.boundType&&e.details.boundType.typeAliasInfo?e.details.boundType.typeAliasInfo:void 0},t.isTypeSame=F,t.removeUnknownFromUnion=function(e){return P(e,(e=>f(e)))},t.removeIncompleteUnknownFromUnion=E,t.cleanIncompleteUnknown=function(e){const t=E(e);return g(t)?e:t},t.removeUnbound=function(e){return _(e)?P(e,(e=>v(e))):v(e)?r.create():e},t.removeNoneFromUnion=function(e){return P(e,(e=>h(e)))},t.removeFromUnion=P,t.findSubtype=A,t.combineTypes=N,t.isSameWithoutLiteralValue=k},3213:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FileBasedToken=t.getCancellationTokenId=t.DefaultCancellationProvider=t.CancelAfter=t.throwIfCancellationRequested=t.OperationCanceledException=t.setCancellationFolderName=t.getCancellationFolderName=void 0;const s=n(6744),i=n(4494),a=n(2489);let r;t.getCancellationFolderName=function(){return r},t.setCancellationFolderName=function(e){r=e};class o extends i.ResponseError{constructor(){super(i.LSPErrorCodes.RequestCancelled,"request cancelled")}static is(e){return e.code===i.LSPErrorCodes.RequestCancelled}}t.OperationCanceledException=o,t.throwIfCancellationRequested=function(e){if(!(0,a.isDebugMode)()&&e.isCancellationRequested)throw new o},t.CancelAfter=function(e,...t){const n=e.createCancellationTokenSource(),s=[];for(const e of t)s.push(e.onCancellationRequested((e=>{n.cancel()})));return s.push(n.token.onCancellationRequested((e=>{s.forEach((e=>e.dispose()))}))),n},t.DefaultCancellationProvider=class{createCancellationTokenSource(){return new s.CancellationTokenSource}},t.getCancellationTokenId=function(e){return e instanceof l?e.cancellationFilePath:void 0};class l{constructor(e,t){this.cancellationFilePath=e,this._fs=t,this.isCancelled=!1}cancel(){this.isCancelled||(this.isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this._disposeEmitter()))}get isCancellationRequested(){return!!this.isCancelled||(c.shouldCheck()&&this._pipeExists()&&this.cancel(),this.isCancelled)}get onCancellationRequested(){return this._emitter||(this._emitter=new s.Emitter),this._emitter.event}dispose(){this._disposeEmitter()}_disposeEmitter(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}_pipeExists(){try{return this._fs.statSync(this.cancellationFilePath),!0}catch(e){return!1}}}t.FileBasedToken=l;class c{static shouldCheck(){const e=Date.now().valueOf();return e-this._lastCheckTimestamp>=5&&(this._lastCheckTimestamp=e,!0)}}c._lastCheckTimestamp=0},9489:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.arrayEquals=t.addIfNotNull=t.getMapValues=t.addIfUnique=t.createMapFromItems=t.removeArrayElements=t.getOrAdd=t.getNestedProperty=t.flatten=t.binarySearchKey=t.binarySearch=t.every=t.some=t.map=t.stableSort=t.cloneAndSort=t.insertAt=t.addRange=t.find=t.appendArray=t.append=t.contains=t.emptyArray=void 0;const s=n(2489);function i(e,t,n=s.equateValues){if(e)for(const s of e)if(n(s,t))return!0;return!1}function a(e,t){return t<0?e.length+t:t}function r(e,t,n,s){if(void 0===t||0===t.length)return e;if(void 0===e)return t.slice(n,s);n=void 0===n?0:a(t,n),s=void 0===s?t.length:a(t,s);for(let i=n;i<s&&i<t.length;i++)void 0!==t[i]&&e.push(t[i]);return e}function o(e,t){return t}function l(e,t){return!!e&&(t?e.some(t):e.length>0)}function c(e,t,n,s,i){if(!l(e))return-1;let a=i||0,r=e.length-1;for(;a<=r;){const i=a+(r-a>>1);switch(s(n(e[i]),t)){case-1:a=i+1;break;case 0:return i;case 1:r=i-1}}return~a}t.emptyArray=[],t.contains=i,t.append=function(e,t){return void 0===t?e:void 0===e?[t]:(e.push(t),e)},t.appendArray=function(e,t){if(t.length<256)e.push(...t);else for(const n of t)e.push(n)},t.find=function(e,t){for(let n=0;n<e.length;n++){const s=e[n];if(t(s,n))return s}},t.addRange=r,t.insertAt=function(e,t,n){if(0===t)e.unshift(n);else if(t===e.length)e.push(n);else{for(let n=e.length;n>t;n--)e[n]=e[n-1];e[t]=n}return e},t.cloneAndSort=function(e,t){return 0===e.length?e:e.slice().sort(t)},t.stableSort=function(e,t){const n=function(e){return e.map(o)}(e);return function(e,t,n){t.sort(((t,i)=>n(e[t],e[i])||(0,s.compareValues)(t,i)))}(e,n,t),n.map((t=>e[t]))},t.map=function(e,t){if(e)return e.map(t)},t.some=l,t.every=function(e,t){return!e||e.every(t)},t.binarySearch=function(e,t,n,s,i){return c(e,n(t),n,s,i)},t.binarySearchKey=c,t.flatten=function(e){const t=[];for(const n of e)n&&((0,s.isArray)(n)?r(t,n):t.push(n));return t},t.getNestedProperty=function(e,t){return t.split(".").reduce(((e,t)=>e&&e[t]),e)},t.getOrAdd=function(e,t,n){const s=e.get(t);if(void 0!==s)return s;const i=n();return e.set(t,i),i},t.removeArrayElements=function(e,t){for(let n=0;n<e.length;n++)t(e[n])&&(e.splice(n,1),n--);return e},t.createMapFromItems=function(e,t){return e.map((e=>t(e))).reduce(((t,n,s)=>(t.set(n,(t.get(n)||[]).concat(e[s])),t)),new Map)},t.addIfUnique=function(e,t,n=s.equateValues){return i(e,t,n)||e.push(t),e},t.getMapValues=function(e,t){const n=[];return e.forEach(((e,s)=>{t(s,e)&&n.push(e)})),n},t.addIfNotNull=function(e,t){return void 0===t||e.push(t),e},t.arrayEquals=function(e,t,n){return e.length===t.length&&e.every(((e,s)=>n(e,t[s])))}},1252:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CommandLineOptions=t.getDiagnosticSeverityOverrides=void 0,t.getDiagnosticSeverityOverrides=function(){return["error","warning","information","none"]},t.CommandLineOptions=class{constructor(e,t){this.fileSpecs=[],this.excludeFileSpecs=[],this.ignoreFileSpecs=[],this.logTypeEvaluationTime=!1,this.typeEvaluationTimeThreshold=50,this.enableAmbientAnalysis=!0,this.executionRoot=e,this.fromVsCodeExtension=t}}},2930:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigOptions=t.matchFileSpecs=t.getStrictDiagnosticRuleSet=t.getBasicDiagnosticRuleSet=t.getOffDiagnosticRuleSet=t.getStrictModeNotOverriddenRules=t.getDiagLevelDiagnosticRules=t.getBooleanDiagnosticRules=t.cloneDiagnosticRuleSet=t.SignatureDisplayType=t.ExecutionEnvironment=t.PythonPlatform=void 0;const r=n(1017),o=n(1887),l=a(n(3188)),c=n(9489),p=n(9744),d=n(6657),u=n(6886);var y,m;(m=t.PythonPlatform||(t.PythonPlatform={})).Darwin="Darwin",m.Windows="Windows",m.Linux="Linux";class g{constructor(e,t,n,s){this.extraPaths=[],this.root=e||void 0,this.pythonVersion=t||u.latestStablePythonVersion,this.pythonPlatform=n,this.extraPaths=[...null!=s?s:[]]}}function h(e=!1){const t=[p.DiagnosticRule.strictListInference,p.DiagnosticRule.strictSetInference,p.DiagnosticRule.strictDictionaryInference,p.DiagnosticRule.analyzeUnannotatedFunctions,p.DiagnosticRule.strictParameterNoneValue];return e&&t.push(p.DiagnosticRule.enableTypeIgnoreComments),t}function f(){return[p.DiagnosticRule.reportGeneralTypeIssues,p.DiagnosticRule.reportPropertyTypeMismatch,p.DiagnosticRule.reportFunctionMemberAccess,p.DiagnosticRule.reportMissingImports,p.DiagnosticRule.reportMissingModuleSource,p.DiagnosticRule.reportMissingTypeStubs,p.DiagnosticRule.reportImportCycles,p.DiagnosticRule.reportUnusedImport,p.DiagnosticRule.reportUnusedClass,p.DiagnosticRule.reportUnusedFunction,p.DiagnosticRule.reportUnusedVariable,p.DiagnosticRule.reportDuplicateImport,p.DiagnosticRule.reportWildcardImportFromLibrary,p.DiagnosticRule.reportOptionalSubscript,p.DiagnosticRule.reportOptionalMemberAccess,p.DiagnosticRule.reportOptionalCall,p.DiagnosticRule.reportOptionalIterable,p.DiagnosticRule.reportOptionalContextManager,p.DiagnosticRule.reportOptionalOperand,p.DiagnosticRule.reportTypedDictNotRequiredAccess,p.DiagnosticRule.reportUntypedFunctionDecorator,p.DiagnosticRule.reportUntypedClassDecorator,p.DiagnosticRule.reportUntypedBaseClass,p.DiagnosticRule.reportUntypedNamedTuple,p.DiagnosticRule.reportPrivateUsage,p.DiagnosticRule.reportTypeCommentUsage,p.DiagnosticRule.reportPrivateImportUsage,p.DiagnosticRule.reportConstantRedefinition,p.DiagnosticRule.reportDeprecated,p.DiagnosticRule.reportIncompatibleMethodOverride,p.DiagnosticRule.reportIncompatibleVariableOverride,p.DiagnosticRule.reportInconsistentConstructor,p.DiagnosticRule.reportOverlappingOverload,p.DiagnosticRule.reportMissingSuperCall,p.DiagnosticRule.reportUninitializedInstanceVariable,p.DiagnosticRule.reportInvalidStringEscapeSequence,p.DiagnosticRule.reportUnknownParameterType,p.DiagnosticRule.reportUnknownArgumentType,p.DiagnosticRule.reportUnknownLambdaType,p.DiagnosticRule.reportUnknownVariableType,p.DiagnosticRule.reportUnknownMemberType,p.DiagnosticRule.reportMissingParameterType,p.DiagnosticRule.reportMissingTypeArgument,p.DiagnosticRule.reportInvalidTypeVarUse,p.DiagnosticRule.reportCallInDefaultInitializer,p.DiagnosticRule.reportUnnecessaryIsInstance,p.DiagnosticRule.reportUnnecessaryCast,p.DiagnosticRule.reportUnnecessaryComparison,p.DiagnosticRule.reportUnnecessaryContains,p.DiagnosticRule.reportAssertAlwaysTrue,p.DiagnosticRule.reportSelfClsParameterName,p.DiagnosticRule.reportImplicitStringConcatenation,p.DiagnosticRule.reportUndefinedVariable,p.DiagnosticRule.reportUnboundVariable,p.DiagnosticRule.reportInvalidStubStatement,p.DiagnosticRule.reportIncompleteStub,p.DiagnosticRule.reportUnsupportedDunderAll,p.DiagnosticRule.reportUnusedCallResult,p.DiagnosticRule.reportUnusedCoroutine,p.DiagnosticRule.reportUnusedExpression,p.DiagnosticRule.reportUnnecessaryTypeIgnoreComment,p.DiagnosticRule.reportMatchNotExhaustive,p.DiagnosticRule.reportShadowedImports,p.DiagnosticRule.reportImplicitOverride]}t.ExecutionEnvironment=g,function(e){e.compact="compact",e.formatted="formatted"}(y=t.SignatureDisplayType||(t.SignatureDisplayType={})),t.cloneDiagnosticRuleSet=function(e){return Object.assign({},e)},t.getBooleanDiagnosticRules=h,t.getDiagLevelDiagnosticRules=f,t.getStrictModeNotOverriddenRules=function(){return[p.DiagnosticRule.reportMissingModuleSource]},t.getOffDiagnosticRuleSet=function(){return{printUnknownAsAny:!0,omitTypeArgsIfAny:!0,omitUnannotatedParamType:!0,omitConditionalConstraint:!0,pep604Printing:!0,strictListInference:!1,strictSetInference:!1,strictDictionaryInference:!1,analyzeUnannotatedFunctions:!0,strictParameterNoneValue:!0,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"none",reportPropertyTypeMismatch:"none",reportFunctionMemberAccess:"none",reportMissingImports:"warning",reportMissingModuleSource:"warning",reportMissingTypeStubs:"none",reportImportCycles:"none",reportUnusedImport:"none",reportUnusedClass:"none",reportUnusedFunction:"none",reportUnusedVariable:"none",reportDuplicateImport:"none",reportWildcardImportFromLibrary:"none",reportOptionalSubscript:"none",reportOptionalMemberAccess:"none",reportOptionalCall:"none",reportOptionalIterable:"none",reportOptionalContextManager:"none",reportOptionalOperand:"none",reportTypedDictNotRequiredAccess:"none",reportUntypedFunctionDecorator:"none",reportUntypedClassDecorator:"none",reportUntypedBaseClass:"none",reportUntypedNamedTuple:"none",reportPrivateUsage:"none",reportTypeCommentUsage:"none",reportPrivateImportUsage:"none",reportConstantRedefinition:"none",reportDeprecated:"none",reportIncompatibleMethodOverride:"none",reportIncompatibleVariableOverride:"none",reportInconsistentConstructor:"none",reportOverlappingOverload:"none",reportMissingSuperCall:"none",reportUninitializedInstanceVariable:"none",reportInvalidStringEscapeSequence:"none",reportUnknownParameterType:"none",reportUnknownArgumentType:"none",reportUnknownLambdaType:"none",reportUnknownVariableType:"none",reportUnknownMemberType:"none",reportMissingParameterType:"none",reportMissingTypeArgument:"none",reportInvalidTypeVarUse:"none",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"none",reportUnnecessaryCast:"none",reportUnnecessaryComparison:"none",reportUnnecessaryContains:"none",reportAssertAlwaysTrue:"none",reportSelfClsParameterName:"none",reportImplicitStringConcatenation:"none",reportUnboundVariable:"none",reportUndefinedVariable:"warning",reportInvalidStubStatement:"none",reportIncompleteStub:"none",reportUnsupportedDunderAll:"none",reportUnusedCallResult:"none",reportUnusedCoroutine:"none",reportUnusedExpression:"none",reportUnnecessaryTypeIgnoreComment:"none",reportMatchNotExhaustive:"none",reportShadowedImports:"none",reportImplicitOverride:"none"}},t.getBasicDiagnosticRuleSet=function(){return{printUnknownAsAny:!1,omitTypeArgsIfAny:!1,omitUnannotatedParamType:!0,omitConditionalConstraint:!1,pep604Printing:!0,strictListInference:!1,strictSetInference:!1,strictDictionaryInference:!1,analyzeUnannotatedFunctions:!0,strictParameterNoneValue:!0,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportPropertyTypeMismatch:"none",reportFunctionMemberAccess:"none",reportMissingImports:"error",reportMissingModuleSource:"warning",reportMissingTypeStubs:"none",reportImportCycles:"none",reportUnusedImport:"none",reportUnusedClass:"none",reportUnusedFunction:"none",reportUnusedVariable:"none",reportDuplicateImport:"none",reportWildcardImportFromLibrary:"warning",reportOptionalSubscript:"error",reportOptionalMemberAccess:"error",reportOptionalCall:"error",reportOptionalIterable:"error",reportOptionalContextManager:"error",reportOptionalOperand:"error",reportTypedDictNotRequiredAccess:"error",reportUntypedFunctionDecorator:"none",reportUntypedClassDecorator:"none",reportUntypedBaseClass:"none",reportUntypedNamedTuple:"none",reportPrivateUsage:"none",reportTypeCommentUsage:"none",reportPrivateImportUsage:"error",reportConstantRedefinition:"none",reportDeprecated:"none",reportIncompatibleMethodOverride:"none",reportIncompatibleVariableOverride:"none",reportInconsistentConstructor:"none",reportOverlappingOverload:"none",reportMissingSuperCall:"none",reportUninitializedInstanceVariable:"none",reportInvalidStringEscapeSequence:"warning",reportUnknownParameterType:"none",reportUnknownArgumentType:"none",reportUnknownLambdaType:"none",reportUnknownVariableType:"none",reportUnknownMemberType:"none",reportMissingParameterType:"none",reportMissingTypeArgument:"none",reportInvalidTypeVarUse:"warning",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"none",reportUnnecessaryCast:"none",reportUnnecessaryComparison:"none",reportUnnecessaryContains:"none",reportAssertAlwaysTrue:"warning",reportSelfClsParameterName:"warning",reportImplicitStringConcatenation:"none",reportUnboundVariable:"error",reportUndefinedVariable:"error",reportInvalidStubStatement:"none",reportIncompleteStub:"none",reportUnsupportedDunderAll:"warning",reportUnusedCallResult:"none",reportUnusedCoroutine:"error",reportUnusedExpression:"warning",reportUnnecessaryTypeIgnoreComment:"none",reportMatchNotExhaustive:"none",reportShadowedImports:"none",reportImplicitOverride:"none"}},t.getStrictDiagnosticRuleSet=function(){return{printUnknownAsAny:!1,omitTypeArgsIfAny:!1,omitUnannotatedParamType:!1,omitConditionalConstraint:!1,pep604Printing:!0,strictListInference:!0,strictSetInference:!0,strictDictionaryInference:!0,analyzeUnannotatedFunctions:!0,strictParameterNoneValue:!0,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportPropertyTypeMismatch:"none",reportFunctionMemberAccess:"error",reportMissingImports:"error",reportMissingModuleSource:"warning",reportMissingTypeStubs:"error",reportImportCycles:"error",reportUnusedImport:"error",reportUnusedClass:"error",reportUnusedFunction:"error",reportUnusedVariable:"error",reportDuplicateImport:"error",reportWildcardImportFromLibrary:"error",reportOptionalSubscript:"error",reportOptionalMemberAccess:"error",reportOptionalCall:"error",reportOptionalIterable:"error",reportOptionalContextManager:"error",reportOptionalOperand:"error",reportTypedDictNotRequiredAccess:"error",reportUntypedFunctionDecorator:"error",reportUntypedClassDecorator:"error",reportUntypedBaseClass:"error",reportUntypedNamedTuple:"error",reportPrivateUsage:"error",reportTypeCommentUsage:"error",reportPrivateImportUsage:"error",reportConstantRedefinition:"error",reportDeprecated:"error",reportIncompatibleMethodOverride:"error",reportIncompatibleVariableOverride:"error",reportInconsistentConstructor:"error",reportOverlappingOverload:"error",reportMissingSuperCall:"none",reportUninitializedInstanceVariable:"none",reportInvalidStringEscapeSequence:"error",reportUnknownParameterType:"error",reportUnknownArgumentType:"error",reportUnknownLambdaType:"error",reportUnknownVariableType:"error",reportUnknownMemberType:"error",reportMissingParameterType:"error",reportMissingTypeArgument:"error",reportInvalidTypeVarUse:"error",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"error",reportUnnecessaryCast:"error",reportUnnecessaryComparison:"error",reportUnnecessaryContains:"error",reportAssertAlwaysTrue:"error",reportSelfClsParameterName:"error",reportImplicitStringConcatenation:"none",reportUnboundVariable:"error",reportUndefinedVariable:"error",reportInvalidStubStatement:"error",reportIncompleteStub:"error",reportUnsupportedDunderAll:"error",reportUnusedCallResult:"none",reportUnusedCoroutine:"error",reportUnusedExpression:"error",reportUnnecessaryTypeIgnoreComment:"none",reportMatchNotExhaustive:"error",reportShadowedImports:"none",reportImplicitOverride:"none"}},t.matchFileSpecs=function(e,t,n=!0){for(const s of e.include)if(d.FileSpec.matchIncludeFileSpec(s.regExp,e.exclude,t,n))return!0;return!1};class T{constructor(e,t){this.include=[],this.exclude=[],this.ignore=[],this.strict=[],this.defineConstant=new Map,this.autoImportCompletions=!0,this.indexing=!1,this.logTypeEvaluationTime=!1,this.typeEvaluationTimeThreshold=50,this.initializedFromJson=!1,this.executionEnvironments=[],this.projectRoot=e,this.typeCheckingMode=t,this.diagnosticRuleSet=T.getDiagnosticRuleSet(t),this.functionSignatureDisplay=y.formatted}static getDiagnosticRuleSet(e){return"strict"===e?{printUnknownAsAny:!1,omitTypeArgsIfAny:!1,omitUnannotatedParamType:!1,omitConditionalConstraint:!1,pep604Printing:!0,strictListInference:!0,strictSetInference:!0,strictDictionaryInference:!0,analyzeUnannotatedFunctions:!0,strictParameterNoneValue:!0,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportPropertyTypeMismatch:"none",reportFunctionMemberAccess:"error",reportMissingImports:"error",reportMissingModuleSource:"warning",reportMissingTypeStubs:"error",reportImportCycles:"error",reportUnusedImport:"error",reportUnusedClass:"error",reportUnusedFunction:"error",reportUnusedVariable:"error",reportDuplicateImport:"error",reportWildcardImportFromLibrary:"error",reportOptionalSubscript:"error",reportOptionalMemberAccess:"error",reportOptionalCall:"error",reportOptionalIterable:"error",reportOptionalContextManager:"error",reportOptionalOperand:"error",reportTypedDictNotRequiredAccess:"error",reportUntypedFunctionDecorator:"error",reportUntypedClassDecorator:"error",reportUntypedBaseClass:"error",reportUntypedNamedTuple:"error",reportPrivateUsage:"error",reportTypeCommentUsage:"error",reportPrivateImportUsage:"error",reportConstantRedefinition:"error",reportDeprecated:"error",reportIncompatibleMethodOverride:"error",reportIncompatibleVariableOverride:"error",reportInconsistentConstructor:"error",reportOverlappingOverload:"error",reportMissingSuperCall:"none",reportUninitializedInstanceVariable:"none",reportInvalidStringEscapeSequence:"error",reportUnknownParameterType:"error",reportUnknownArgumentType:"error",reportUnknownLambdaType:"error",reportUnknownVariableType:"error",reportUnknownMemberType:"error",reportMissingParameterType:"error",reportMissingTypeArgument:"error",reportInvalidTypeVarUse:"error",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"error",reportUnnecessaryCast:"error",reportUnnecessaryComparison:"error",reportUnnecessaryContains:"error",reportAssertAlwaysTrue:"error",reportSelfClsParameterName:"error",reportImplicitStringConcatenation:"none",reportUnboundVariable:"error",reportUndefinedVariable:"error",reportInvalidStubStatement:"error",reportIncompleteStub:"error",reportUnsupportedDunderAll:"error",reportUnusedCallResult:"none",reportUnusedCoroutine:"error",reportUnusedExpression:"error",reportUnnecessaryTypeIgnoreComment:"none",reportMatchNotExhaustive:"error",reportShadowedImports:"none",reportImplicitOverride:"none"}:"off"===e?{printUnknownAsAny:!0,omitTypeArgsIfAny:!0,omitUnannotatedParamType:!0,omitConditionalConstraint:!0,pep604Printing:!0,strictListInference:!1,strictSetInference:!1,strictDictionaryInference:!1,analyzeUnannotatedFunctions:!0,strictParameterNoneValue:!0,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"none",reportPropertyTypeMismatch:"none",reportFunctionMemberAccess:"none",reportMissingImports:"warning",reportMissingModuleSource:"warning",reportMissingTypeStubs:"none",reportImportCycles:"none",reportUnusedImport:"none",reportUnusedClass:"none",reportUnusedFunction:"none",reportUnusedVariable:"none",reportDuplicateImport:"none",reportWildcardImportFromLibrary:"none",reportOptionalSubscript:"none",reportOptionalMemberAccess:"none",reportOptionalCall:"none",reportOptionalIterable:"none",reportOptionalContextManager:"none",reportOptionalOperand:"none",reportTypedDictNotRequiredAccess:"none",reportUntypedFunctionDecorator:"none",reportUntypedClassDecorator:"none",reportUntypedBaseClass:"none",reportUntypedNamedTuple:"none",reportPrivateUsage:"none",reportTypeCommentUsage:"none",reportPrivateImportUsage:"none",reportConstantRedefinition:"none",reportDeprecated:"none",reportIncompatibleMethodOverride:"none",reportIncompatibleVariableOverride:"none",reportInconsistentConstructor:"none",reportOverlappingOverload:"none",reportMissingSuperCall:"none",reportUninitializedInstanceVariable:"none",reportInvalidStringEscapeSequence:"none",reportUnknownParameterType:"none",reportUnknownArgumentType:"none",reportUnknownLambdaType:"none",reportUnknownVariableType:"none",reportUnknownMemberType:"none",reportMissingParameterType:"none",reportMissingTypeArgument:"none",reportInvalidTypeVarUse:"none",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"none",reportUnnecessaryCast:"none",reportUnnecessaryComparison:"none",reportUnnecessaryContains:"none",reportAssertAlwaysTrue:"none",reportSelfClsParameterName:"none",reportImplicitStringConcatenation:"none",reportUnboundVariable:"none",reportUndefinedVariable:"warning",reportInvalidStubStatement:"none",reportIncompleteStub:"none",reportUnsupportedDunderAll:"none",reportUnusedCallResult:"none",reportUnusedCoroutine:"none",reportUnusedExpression:"none",reportUnnecessaryTypeIgnoreComment:"none",reportMatchNotExhaustive:"none",reportShadowedImports:"none",reportImplicitOverride:"none"}:{printUnknownAsAny:!1,omitTypeArgsIfAny:!1,omitUnannotatedParamType:!0,omitConditionalConstraint:!1,pep604Printing:!0,strictListInference:!1,strictSetInference:!1,strictDictionaryInference:!1,analyzeUnannotatedFunctions:!0,strictParameterNoneValue:!0,enableTypeIgnoreComments:!0,reportGeneralTypeIssues:"error",reportPropertyTypeMismatch:"none",reportFunctionMemberAccess:"none",reportMissingImports:"error",reportMissingModuleSource:"warning",reportMissingTypeStubs:"none",reportImportCycles:"none",reportUnusedImport:"none",reportUnusedClass:"none",reportUnusedFunction:"none",reportUnusedVariable:"none",reportDuplicateImport:"none",reportWildcardImportFromLibrary:"warning",reportOptionalSubscript:"error",reportOptionalMemberAccess:"error",reportOptionalCall:"error",reportOptionalIterable:"error",reportOptionalContextManager:"error",reportOptionalOperand:"error",reportTypedDictNotRequiredAccess:"error",reportUntypedFunctionDecorator:"none",reportUntypedClassDecorator:"none",reportUntypedBaseClass:"none",reportUntypedNamedTuple:"none",reportPrivateUsage:"none",reportTypeCommentUsage:"none",reportPrivateImportUsage:"error",reportConstantRedefinition:"none",reportDeprecated:"none",reportIncompatibleMethodOverride:"none",reportIncompatibleVariableOverride:"none",reportInconsistentConstructor:"none",reportOverlappingOverload:"none",reportMissingSuperCall:"none",reportUninitializedInstanceVariable:"none",reportInvalidStringEscapeSequence:"warning",reportUnknownParameterType:"none",reportUnknownArgumentType:"none",reportUnknownLambdaType:"none",reportUnknownVariableType:"none",reportUnknownMemberType:"none",reportMissingParameterType:"none",reportMissingTypeArgument:"none",reportInvalidTypeVarUse:"warning",reportCallInDefaultInitializer:"none",reportUnnecessaryIsInstance:"none",reportUnnecessaryCast:"none",reportUnnecessaryComparison:"none",reportUnnecessaryContains:"none",reportAssertAlwaysTrue:"warning",reportSelfClsParameterName:"warning",reportImplicitStringConcatenation:"none",reportUnboundVariable:"error",reportUndefinedVariable:"error",reportInvalidStubStatement:"none",reportIncompleteStub:"none",reportUnsupportedDunderAll:"warning",reportUnusedCallResult:"none",reportUnusedCoroutine:"error",reportUnusedExpression:"warning",reportUnnecessaryTypeIgnoreComment:"none",reportMatchNotExhaustive:"none",reportShadowedImports:"none",reportImplicitOverride:"none"}}getDefaultExecEnvironment(){return new g(this.projectRoot,this.defaultPythonVersion,this.defaultPythonPlatform,this.defaultExtraPaths)}findExecEnvironment(e){var t;return null!==(t=this.executionEnvironments.find((t=>{const n=(0,d.ensureTrailingDirectorySeparator)((0,d.normalizePath)((0,d.combinePaths)(this.projectRoot,t.root)));return e.startsWith(n)})))&&void 0!==t?t:this.getDefaultExecEnvironment()}getExecutionEnvironments(){return this.executionEnvironments.length>0?this.executionEnvironments:[this.getDefaultExecEnvironment()]}initializeFromJson(e,t,n,s,i,a,o=!1){let l;this.initializedFromJson=!0,o||(this.include=[],void 0===e.include)||(Array.isArray(e.include)?e.include.forEach(((e,t)=>{"string"!=typeof e?n.error(`Index ${t} of "include" array should be a string.`):(0,r.isAbsolute)(e)?n.error(`Ignoring path "${e}" in "include" array because it is not relative.`):this.include.push((0,d.getFileSpec)(s,this.projectRoot,e))})):n.error('Config "include" entry must must contain an array.')),this.exclude=[],void 0!==e.exclude&&(Array.isArray(e.exclude)?e.exclude.forEach(((e,t)=>{"string"!=typeof e?n.error(`Index ${t} of "exclude" array should be a string.`):(0,r.isAbsolute)(e)?n.error(`Ignoring path "${e}" in "exclude" array because it is not relative.`):this.exclude.push((0,d.getFileSpec)(s,this.projectRoot,e))})):n.error('Config "exclude" entry must contain an array.')),this.ignore=[],void 0!==e.ignore&&(Array.isArray(e.ignore)?e.ignore.forEach(((e,t)=>{"string"!=typeof e?n.error(`Index ${t} of "ignore" array should be a string.`):(0,r.isAbsolute)(e)?n.error(`Ignoring path "${e}" in "ignore" array because it is not relative.`):this.ignore.push((0,d.getFileSpec)(s,this.projectRoot,e))})):n.error('Config "ignore" entry must contain an array.')),this.strict=[],void 0!==e.strict&&(Array.isArray(e.strict)?e.strict.forEach(((e,t)=>{"string"!=typeof e?n.error(`Index ${t} of "strict" array should be a string.`):(0,r.isAbsolute)(e)?n.error(`Ignoring path "${e}" in "strict" array because it is not relative.`):this.strict.push((0,d.getFileSpec)(s,this.projectRoot,e))})):n.error('Config "strict" entry must contain an array.')),void 0!==e.typeCheckingMode&&("off"===e.typeCheckingMode||"basic"===e.typeCheckingMode||"strict"===e.typeCheckingMode?l=e.typeCheckingMode:n.error('Config "typeCheckingMode" entry must contain "off", "basic", or "strict".')),void 0!==e.useLibraryCodeForTypes&&("boolean"==typeof e.useLibraryCodeForTypes?this.useLibraryCodeForTypes=e.useLibraryCodeForTypes:n.error('Config "useLibraryCodeForTypes" entry must be true or false.')),this.typeCheckingMode=l||t;const c=T.getDiagnosticRuleSet(this.typeCheckingMode);if(this.diagnosticRuleSet={...c},this.applyDiagnosticOverrides(a),h(!0).forEach((t=>{this.diagnosticRuleSet[t]=this._convertBoolean(e[t],t,this.diagnosticRuleSet[t])})),f().forEach((t=>{this.diagnosticRuleSet[t]=this._convertDiagnosticLevel(e[t],t,this.diagnosticRuleSet[t])})),this.venvPath=void 0,void 0!==e.venvPath&&("string"!=typeof e.venvPath?n.error('Config "venvPath" field must contain a string.'):this.venvPath=(0,d.normalizePath)((0,d.combinePaths)(this.projectRoot,e.venvPath))),this.venv=void 0,void 0!==e.venv&&("string"!=typeof e.venv?n.error('Config "venv" field must contain a string.'):this.venv=e.venv),void 0!==e.extraPaths&&(this.defaultExtraPaths=[],Array.isArray(e.extraPaths)?e.extraPaths.forEach(((e,t)=>{"string"!=typeof e?n.error(`Config "extraPaths" field ${t} must be a string.`):this.defaultExtraPaths.push((0,d.normalizePath)((0,d.combinePaths)(this.projectRoot,e)))})):n.error('Config "extraPaths" field must contain an array.')),void 0!==e.pythonVersion)if("string"==typeof e.pythonVersion){const t=(0,u.versionFromString)(e.pythonVersion);t?this.defaultPythonVersion=t:n.error('Config "pythonVersion" field contains unsupported version.')}else n.error('Config "pythonVersion" field must contain a string.');this.ensureDefaultPythonVersion(i,n),void 0!==e.pythonPlatform&&("string"!=typeof e.pythonPlatform?n.error('Config "pythonPlatform" field must contain a string.'):this.defaultPythonPlatform=e.pythonPlatform),this.ensureDefaultPythonPlatform(i,n),this.typeshedPath=void 0,void 0!==e.typeshedPath&&("string"!=typeof e.typeshedPath?n.error('Config "typeshedPath" field must contain a string.'):this.typeshedPath=e.typeshedPath?(0,d.normalizePath)((0,d.combinePaths)(this.projectRoot,e.typeshedPath)):""),this.stubPath=void 0,void 0!==e.typingsPath&&("string"!=typeof e.typingsPath?n.error('Config "typingsPath" field must contain a string.'):(n.error('Config "typingsPath" is now deprecated. Please, use stubPath instead.'),this.stubPath=(0,d.normalizePath)((0,d.combinePaths)(this.projectRoot,e.typingsPath)))),void 0!==e.stubPath&&("string"!=typeof e.stubPath?n.error('Config "stubPath" field must contain a string.'):this.stubPath=(0,d.normalizePath)((0,d.combinePaths)(this.projectRoot,e.stubPath))),void 0!==e.verboseOutput&&("boolean"!=typeof e.verboseOutput?n.error('Config "verboseOutput" field must be true or false.'):this.verboseOutput=e.verboseOutput),void 0!==e.defineConstant&&("object"!=typeof e.defineConstant||Array.isArray(e.defineConstant)?n.error('Config "defineConstant" field must contain a map indexed by constant names.'):Object.getOwnPropertyNames(e.defineConstant).forEach((t=>{const s=e.defineConstant[t],i=typeof s;"boolean"!==i&&"string"!==i?n.error(`Defined constant "${t}" must be associated with a boolean or string value.`):this.defineConstant.set(t,s)}))),void 0!==e.useLibraryCodeForTypes&&("boolean"!=typeof e.useLibraryCodeForTypes?n.error('Config "useLibraryCodeForTypes" field must be true or false.'):this.useLibraryCodeForTypes=e.useLibraryCodeForTypes),this.executionEnvironments=[],void 0!==e.executionEnvironments&&(Array.isArray(e.executionEnvironments)?e.executionEnvironments.forEach(((e,t)=>{const s=this._initExecutionEnvironmentFromJson(e,t,n);s&&this.executionEnvironments.push(s)})):n.error('Config "executionEnvironments" field must contain an array.')),void 0!==e.autoImportCompletions&&("boolean"!=typeof e.autoImportCompletions?n.error('Config "autoImportCompletions" field must be true or false.'):this.autoImportCompletions=e.autoImportCompletions),void 0!==e.indexing&&("boolean"!=typeof e.indexing?n.error('Config "indexing" field must be true or false.'):this.indexing=e.indexing),void 0!==e.logTypeEvaluationTime&&("boolean"!=typeof e.logTypeEvaluationTime?n.error('Config "logTypeEvaluationTime" field must be true or false.'):this.logTypeEvaluationTime=e.logTypeEvaluationTime),void 0!==e.typeEvaluationTimeThreshold&&("number"!=typeof e.typeEvaluationTimeThreshold?n.error('Config "typeEvaluationTimeThreshold" field must be a number.'):this.typeEvaluationTimeThreshold=e.typeEvaluationTimeThreshold),void 0!==e.functionSignatureDisplay&&("string"!=typeof e.functionSignatureDisplay?n.error('Config "functionSignatureDisplay" field must be true or false.'):"compact"!==e.functionSignatureDisplay&&"formatted"!==e.functionSignatureDisplay||(this.functionSignatureDisplay=e.functionSignatureDisplay))}ensureDefaultPythonPlatform(e,t){void 0===this.defaultPythonPlatform&&(this.defaultPythonPlatform=e.getPythonPlatform(),void 0!==this.defaultPythonPlatform&&t.log(`Assuming Python platform ${this.defaultPythonPlatform}`))}ensureDefaultPythonVersion(e,t){if(void 0!==this.defaultPythonVersion)return;const n=[];this.defaultPythonVersion=e.getPythonVersion(this.pythonPath,n),void 0!==this.defaultPythonVersion&&t.info(`Assuming Python version ${(0,u.versionToString)(this.defaultPythonVersion)}`);for(const e of n)t.info(e)}ensureDefaultExtraPaths(e,t,n){const s=[];if(t){const t=(0,d.resolvePaths)(this.projectRoot,l.src);e.existsSync(t)&&!e.existsSync((0,d.resolvePaths)(t,"__init__.py"))&&s.push(t)}if(n&&n.length>0)for(const t of n){const n=(0,d.resolvePaths)(this.projectRoot,t);s.push(n),(0,d.isDirectory)(e,n)&&(0,c.appendArray)(s,(0,o.getPathsFromPthFiles)(e,n))}s.length>0&&(this.defaultExtraPaths=s)}applyDiagnosticOverrides(e){if(e)for(const t of f()){const n=e[t];void 0!==n&&(this.diagnosticRuleSet[t]=n)}}_convertBoolean(e,t,n){return void 0===e?n:"boolean"==typeof e?!!e:(console.log(`Config "${t}" entry must be true or false.`),n)}_convertDiagnosticLevel(e,t,n){return void 0===e?n:"boolean"==typeof e?e?"error":"none":"string"!=typeof e||"error"!==e&&"warning"!==e&&"information"!==e&&"none"!==e?(console.log(`Config "${t}" entry must be true, false, "error", "warning", "information" or "none".`),n):e}_initExecutionEnvironmentFromJson(e,t,n){try{const s=new g(this.projectRoot,this.defaultPythonVersion,this.defaultPythonPlatform,this.defaultExtraPaths);if(e.root&&"string"==typeof e.root?s.root=(0,d.normalizePath)((0,d.combinePaths)(this.projectRoot,e.root)):n.error(`Config executionEnvironments index ${t}: missing root value.`),e.extraPaths&&(Array.isArray(e.extraPaths)?e.extraPaths.forEach(((e,i)=>{"string"!=typeof e?n.error(`Config executionEnvironments index ${t}: extraPaths field ${i} must be a string.`):s.extraPaths.push((0,d.normalizePath)((0,d.combinePaths)(this.projectRoot,e)))})):n.error(`Config executionEnvironments index ${t}: extraPaths field must contain an array.`)),e.pythonVersion)if("string"==typeof e.pythonVersion){const i=(0,u.versionFromString)(e.pythonVersion);i?s.pythonVersion=i:n.warn(`Config executionEnvironments index ${t} contains unsupported pythonVersion.`)}else n.error(`Config executionEnvironments index ${t} pythonVersion must be a string.`);return e.pythonPlatform&&("string"==typeof e.pythonPlatform?s.pythonPlatform=e.pythonPlatform:n.error(`Config executionEnvironments index ${t} pythonPlatform must be a string.`)),s}catch{n.error(`Config executionEnvironments index ${t} is not accessible.`)}}}t.ConfigOptions=T},2211:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.convertLogLevel=t.log=t.ConsoleWithLogLevel=t.StderrConsoleWithLevel=t.StderrConsole=t.StandardConsoleWithLevel=t.StandardConsole=t.NullConsole=t.LogLevel=void 0;const r=a(n(5839));var o;!function(e){e.Error="error",e.Warn="warn",e.Info="info",e.Log="log"}(o=t.LogLevel||(t.LogLevel={})),t.NullConsole=class{constructor(){this.logCount=0,this.infoCount=0,this.warnCount=0,this.errorCount=0}log(e){this.logCount++}info(e){this.infoCount++}warn(e){this.warnCount++}error(e){this.errorCount++}};class l{log(e){console.info(e)}info(e){console.info(e)}warn(e){console.warn(e)}error(e){console.error(e)}}t.StandardConsole=l,t.StandardConsoleWithLevel=class extends l{constructor(e=o.Log){super(),this._maxLevel=e}get level(){return this._maxLevel}};class c{log(e){console.error(e)}info(e){console.error(e)}warn(e){console.error(e)}error(e){console.error(e)}}function p(e,t,n){switch(t){case o.Log:e.log(n);break;case o.Info:e.info(n);break;case o.Warn:e.warn(n);break;case o.Error:e.error(n);break;default:r.fail(`${t} is not expected`)}}t.StderrConsole=c,t.StderrConsoleWithLevel=class extends c{constructor(e=o.Log){super(),this._maxLevel=e}get level(){return this._maxLevel}},t.ConsoleWithLogLevel=class{constructor(e,t=""){this._console=e,this._name=t,this._levelMap=new Map([[o.Error,0],[o.Warn,1],[o.Info,2],[o.Log,3]]),this._maxLevel=2}get level(){switch(this._maxLevel){case 0:return o.Error;case 1:return o.Warn;case 2:return o.Info}return o.Log}set level(e){let t=this._levelMap.get(e);void 0===t&&(t=this._levelMap.get(o.Info)),this._maxLevel=t}error(e){this._log(o.Error,`${this._prefix}${e}`)}warn(e){this._log(o.Warn,`${this._prefix}${e}`)}info(e){this._log(o.Info,`${this._prefix}${e}`)}log(e){this._log(o.Log,`${this._prefix}${e}`)}get _prefix(){return this._name?`(${this._name}) `:""}_log(e,t){this._getNumericalLevel(e)>this._maxLevel||p(this._console,e,t)}_getNumericalLevel(e){const t=this._levelMap.get(e);return r.assert(void 0!==t,"Logger: unknown log level."),void 0!==t?t:2}},t.log=p,t.convertLogLevel=function(e){if(!e)return o.Info;switch(e.toLowerCase()){case"error":return o.Error;case"warning":return o.Warn;case"information":default:return o.Info;case"trace":return o.Log}}},2489:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.containsOnlyWhitespace=t.getEnumNames=t.isDefined=t.isThenable=t.isDebugMode=t.test_setDebugMode=t.toBoolean=t.hasProperty=t.isBoolean=t.isNumber=t.isString=t.isArray=t.compareValues=t.compareComparableValues=t.equateValues=t.toLowerCase=t.identity=t.returnUndefined=t.returnTrue=t.returnFalse=void 0;const s=n(3550);function i(e,t){return e===t?0:void 0===e?-1:void 0===t?1:e<t?-1:1}t.returnFalse=function(){return!1},t.returnTrue=function(){return!0},t.returnUndefined=function(){},t.identity=function(e){return e},t.toLowerCase=function(e){return e.toLowerCase()},t.equateValues=function(e,t){return e===t},t.compareComparableValues=i,t.compareValues=function(e,t){return i(e,t)},t.isArray=function(e){return Array.isArray?Array.isArray(e):e instanceof Array},t.isString=function(e){return"string"==typeof e},t.isNumber=function(e){return"number"==typeof e},t.isBoolean=function(e){return"boolean"==typeof e};const a=Object.prototype.hasOwnProperty;let r;t.hasProperty=function(e,t){return a.call(e,t)},t.toBoolean=function(e){return"TRUE"===(null==e?void 0:e.trim().toUpperCase())},t.test_setDebugMode=function(e){const t=r;return r=e,t},t.isDebugMode=function(){if(void 0===r){const e=process.execArgv.join();r=e.includes("inspect")||e.includes("debug")}return r},t.isThenable=function(e){return"function"==typeof(null==e?void 0:e.then)},t.isDefined=function(e){return void 0!==e},t.getEnumNames=function(e){const t=[];for(const n in e)isNaN(Number(n))&&t.push(n);return t},t.containsOnlyWhitespace=function(e,t){return t&&(e=e.substring(t.start,s.TextRange.getEnd(t))),/^\s*$/.test(e)}},8916:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.randomBytesHex=void 0;const s=n(5839);let i;try{i=n(6113),(null==i?void 0:i.randomBytes)||(i=void 0)}catch{}t.randomBytesHex=function(e){if(i)return i.randomBytes(e).toString("hex");if(crypto){return t=crypto.getRandomValues(new Uint8Array(e)),[...t].map((e=>e.toString(16).padStart(2,"0"))).join("")}var t;(0,s.fail)("crypto library not found")}},5839:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSerializableError=t.getErrorString=t.formatEnum=t.getFunctionName=t.assertNever=t.assertEachDefined=t.assertDefined=t.fail=t.assert=void 0;const s=n(9489),i=n(2489);function a(e,t){const n=new Error(e?`Debug Failure. ${e}`:"Debug Failure.");throw Error.captureStackTrace&&Error.captureStackTrace(n,t||a),n}function r(e,t,n){null==e&&a(t,n||r)}t.assert=function e(t,n,s,i){t||(s&&(n+="\r\nVerbose Debug Information: "+("string"==typeof s?s:s())),a(n?"False expression: "+n:"False expression.",i||e))},t.fail=a,t.assertDefined=r,t.assertEachDefined=function e(t,n,s){for(const i of t)r(i,n,s||e)},t.assertNever=function e(t,n="Illegal value:",s){let i="";try{i=JSON.stringify(t)}catch{}a(`${n} ${i}`,s||e)},t.getFunctionName=function(e){if("function"!=typeof e)return"";if((0,i.hasProperty)(e,"name"))return e.name;{const t=Function.prototype.toString.call(e),n=/^function\s+([\w$]+)\s*\(/.exec(t);return n?n[1]:""}},t.formatEnum=function(e=0,t,n){const a=function(e){const t=[];for(const n of Object.keys(e)){const s=e[n];"number"==typeof s&&t.push([s,n])}return(0,s.stableSort)(t,((e,t)=>(0,i.compareValues)(e[0],t[0])))}(t);if(0===e)return a.length>0&&0===a[0][0]?a[0][1]:"0";if(n){let t="",n=e;for(const[s,i]of a){if(s>e)break;0!==s&&s&e&&(t=`${t}${t?"|":""}${i}`,n&=~s)}if(0===n)return t}else for(const[t,n]of a)if(t===e)return n;return e.toString()},t.getErrorString=function(e){return(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e)},t.getSerializableError=function(e){if(e)return JSON.stringify(e).length>2?e:{name:e.name&&(0,i.isString)(e.name)?e.name:"noname",message:e.message&&(0,i.isString)(e.message)?e.message:"nomessage",stack:e.stack&&(0,i.isString)(e.stack)?e.stack:void 0}}},1290:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticAddendum=t.Diagnostic=t.convertLevelToCategory=t.TaskListPriority=void 0;const s=n(9489);var i;!function(e){e.High="High",e.Normal="Normal",e.Low="Low"}(i=t.TaskListPriority||(t.TaskListPriority={})),t.convertLevelToCategory=function(e){switch(e){case"error":return 0;case"warning":return 1;case"information":return 2;default:throw new Error(`${e} is not expected`)}},t.Diagnostic=class{constructor(e,t,n,s=i.Normal){this.category=e,this.message=t,this.range=n,this.priority=s,this._relatedInfo=[]}addAction(e){void 0===this._actions?this._actions=[e]:this._actions.push(e)}getActions(){return this._actions}setRule(e){this._rule=e}getRule(){return this._rule}addRelatedInfo(e,t,n,s=i.Normal){this._relatedInfo.push({filePath:t,message:e,range:n,priority:s})}getRelatedInfo(){return this._relatedInfo}};class a{constructor(){this._messages=[],this._childAddenda=[]}addMessage(e){this._messages.push(e)}addTextRange(e){this._range=e}createAddendum(){const e=new a;return this.addAddendum(e),e}getString(e=5,t=8){let n=this._getLinesRecursive(e,t);n.length>t&&(n=n.slice(0,t),n.push("  ..."));const s=n.join("\n");return s.length>0?"\n"+s:""}isEmpty(){return 0===this._getMessageCount()}addAddendum(e){this._childAddenda.push(e)}getChildren(){return this._childAddenda}getMessages(){return this._messages}getEffectiveTextRange(){const e=this._getTextRangeRecursive();if(0!==(null==e?void 0:e.length))return e}_getTextRangeRecursive(e=0){if(e>64)return;e++;const t=this._childAddenda.map((t=>t._getTextRangeRecursive(e))).filter((e=>!!e));return t.length>1?{start:0,length:0}:1===t.length?t[0]:this._range?this._range:void 0}_getMessageCount(e=0){if(e>64)return 0;let t=this._messages.length;for(const n of this._childAddenda)t+=n._getMessageCount(e+1);return t}_getLinesRecursive(e,t,n=0){if(e<=0||n>64)return[];let i=[];for(const a of this._childAddenda){const r=this._messages.length>0?e-1:e;if((0,s.appendArray)(i,a._getLinesRecursive(r,t,n+1)),i.length>=t){i=i.slice(0,t);break}}const a=this._messages.length>0?"":"";return this._messages.concat(i).map((e=>a+e))}}t.DiagnosticAddendum=a},9744:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticRule=void 0,(n=t.DiagnosticRule||(t.DiagnosticRule={})).strictListInference="strictListInference",n.strictSetInference="strictSetInference",n.strictDictionaryInference="strictDictionaryInference",n.analyzeUnannotatedFunctions="analyzeUnannotatedFunctions",n.strictParameterNoneValue="strictParameterNoneValue",n.enableTypeIgnoreComments="enableTypeIgnoreComments",n.reportGeneralTypeIssues="reportGeneralTypeIssues",n.reportPropertyTypeMismatch="reportPropertyTypeMismatch",n.reportFunctionMemberAccess="reportFunctionMemberAccess",n.reportMissingImports="reportMissingImports",n.reportMissingModuleSource="reportMissingModuleSource",n.reportMissingTypeStubs="reportMissingTypeStubs",n.reportImportCycles="reportImportCycles",n.reportUnusedImport="reportUnusedImport",n.reportUnusedClass="reportUnusedClass",n.reportUnusedFunction="reportUnusedFunction",n.reportUnusedVariable="reportUnusedVariable",n.reportDuplicateImport="reportDuplicateImport",n.reportWildcardImportFromLibrary="reportWildcardImportFromLibrary",n.reportOptionalSubscript="reportOptionalSubscript",n.reportOptionalMemberAccess="reportOptionalMemberAccess",n.reportOptionalCall="reportOptionalCall",n.reportOptionalIterable="reportOptionalIterable",n.reportOptionalContextManager="reportOptionalContextManager",n.reportOptionalOperand="reportOptionalOperand",n.reportTypedDictNotRequiredAccess="reportTypedDictNotRequiredAccess",n.reportUntypedFunctionDecorator="reportUntypedFunctionDecorator",n.reportUntypedClassDecorator="reportUntypedClassDecorator",n.reportUntypedBaseClass="reportUntypedBaseClass",n.reportUntypedNamedTuple="reportUntypedNamedTuple",n.reportPrivateUsage="reportPrivateUsage",n.reportTypeCommentUsage="reportTypeCommentUsage",n.reportPrivateImportUsage="reportPrivateImportUsage",n.reportConstantRedefinition="reportConstantRedefinition",n.reportDeprecated="reportDeprecated",n.reportIncompatibleMethodOverride="reportIncompatibleMethodOverride",n.reportIncompatibleVariableOverride="reportIncompatibleVariableOverride",n.reportInconsistentConstructor="reportInconsistentConstructor",n.reportOverlappingOverload="reportOverlappingOverload",n.reportMissingSuperCall="reportMissingSuperCall",n.reportUninitializedInstanceVariable="reportUninitializedInstanceVariable",n.reportInvalidStringEscapeSequence="reportInvalidStringEscapeSequence",n.reportUnknownParameterType="reportUnknownParameterType",n.reportUnknownArgumentType="reportUnknownArgumentType",n.reportUnknownLambdaType="reportUnknownLambdaType",n.reportUnknownVariableType="reportUnknownVariableType",n.reportUnknownMemberType="reportUnknownMemberType",n.reportMissingParameterType="reportMissingParameterType",n.reportMissingTypeArgument="reportMissingTypeArgument",n.reportInvalidTypeVarUse="reportInvalidTypeVarUse",n.reportCallInDefaultInitializer="reportCallInDefaultInitializer",n.reportUnnecessaryIsInstance="reportUnnecessaryIsInstance",n.reportUnnecessaryCast="reportUnnecessaryCast",n.reportUnnecessaryComparison="reportUnnecessaryComparison",n.reportUnnecessaryContains="reportUnnecessaryContains",n.reportAssertAlwaysTrue="reportAssertAlwaysTrue",n.reportSelfClsParameterName="reportSelfClsParameterName",n.reportImplicitStringConcatenation="reportImplicitStringConcatenation",n.reportUndefinedVariable="reportUndefinedVariable",n.reportUnboundVariable="reportUnboundVariable",n.reportInvalidStubStatement="reportInvalidStubStatement",n.reportIncompleteStub="reportIncompleteStub",n.reportUnsupportedDunderAll="reportUnsupportedDunderAll",n.reportUnusedCallResult="reportUnusedCallResult",n.reportUnusedCoroutine="reportUnusedCoroutine",n.reportUnusedExpression="reportUnusedExpression",n.reportUnnecessaryTypeIgnoreComment="reportUnnecessaryTypeIgnoreComment",n.reportMatchNotExhaustive="reportMatchNotExhaustive",n.reportShadowedImports="reportShadowedImports",n.reportImplicitOverride="reportImplicitOverride"},3980:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextRangeDiagnosticSink=t.DiagnosticSink=void 0;const s=n(9489),i=n(1290),a=n(1464),r=n(7559);class o{constructor(e){this._diagnosticList=e||[],this._diagnosticMap=new Map}fetchAndClear(){const e=this._diagnosticList;return this._diagnosticList=[],this._diagnosticMap.clear(),e}addError(e,t){return this.addDiagnostic(new i.Diagnostic(0,e,t))}addWarning(e,t){return this.addDiagnostic(new i.Diagnostic(1,e,t))}addInformation(e,t){return this.addDiagnostic(new i.Diagnostic(2,e,t))}addUnusedCode(e,t,n){const s=new i.Diagnostic(3,e,t);return n&&s.addAction(n),this.addDiagnostic(s)}addUnreachableCode(e,t,n){const s=new i.Diagnostic(4,e,t);return n&&s.addAction(n),this.addDiagnostic(s)}addDeprecated(e,t,n){const s=new i.Diagnostic(5,e,t);return n&&s.addAction(n),this.addDiagnostic(s)}addDiagnostic(e){const t=`${e.range.start.line},${e.range.start.character}-${e.range.end.line}-${e.range.end.character}:${(0,r.hashString)(e.message)}}`;return this._diagnosticMap.has(t)||(this._diagnosticList.push(e),this._diagnosticMap.set(t,e)),e}addDiagnostics(e){(0,s.appendArray)(this._diagnosticList,e)}getErrors(){return this._diagnosticList.filter((e=>0===e.category))}getWarnings(){return this._diagnosticList.filter((e=>1===e.category))}getInformation(){return this._diagnosticList.filter((e=>2===e.category))}getUnusedCode(){return this._diagnosticList.filter((e=>3===e.category))}getUnreachableCode(){return this._diagnosticList.filter((e=>4===e.category))}getDeprecated(){return this._diagnosticList.filter((e=>5===e.category))}}t.DiagnosticSink=o,t.TextRangeDiagnosticSink=class extends o{constructor(e,t){super(t),this._lines=e}addDiagnosticWithTextRange(e,t,n){const s=(0,a.convertOffsetsToRange)(n.start,n.start+n.length,this._lines);switch(e){case"error":return this.addError(t,s);case"warning":return this.addWarning(t,s);case"information":return this.addInformation(t,s);default:throw new Error(`${e} is not expected value`)}}addUnusedCodeWithTextRange(e,t,n){return this.addUnusedCode(e,(0,a.convertOffsetsToRange)(t.start,t.start+t.length,this._lines),n)}addUnreachableCodeWithTextRange(e,t,n){return this.addUnreachableCode(e,(0,a.convertOffsetsToRange)(t.start,t.start+t.length,this._lines),n)}addDeprecatedWithTextRange(e,t,n){return this.addDeprecated(e,(0,a.convertOffsetsToRange)(t.start,t.start+t.length,this._lines),n)}}},1250:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FileEditAction=t.TextEditAction=void 0;const s=n(3550);var i,a;!function(e){e.is=function(e){return!!e.range&&void 0!==e.replacementText}}(i=t.TextEditAction||(t.TextEditAction={})),(a=t.FileEditAction||(t.FileEditAction={})).is=function(e){return void 0!==e.filePath&&i.is(e)},a.areEqual=function(e,t){return e===t||e.filePath===t.filePath&&(0,s.rangesAreEqual)(e.range,t.range)&&e.replacementText===t.replacementText}},7991:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Extensions=t.DeclarationUseCase=void 0;const s=n(563);var i;(i=t.DeclarationUseCase||(t.DeclarationUseCase={}))[i.Definition=0]="Definition",i[i.Rename=1]="Rename",i[i.References=2]="References",function(e){const t=[];let n=[],i=[];e.register=function(e){t.push(...e)},e.createProgramExtensions=function(e,s){n.push(...t.map((t=>{let n=t.createProgramExtension?t.createProgramExtension(e,s):void 0;return n&&(n=Object.defineProperty(n,"view",{value:e})),n})).filter((e=>!!e)))},e.destroyProgramExtensions=function(e){n=n.filter((t=>t.view.id!==e))},e.createLanguageServiceExtensions=function(e){i.push(...t.map((t=>{let n=t.createLanguageServiceExtension?t.createLanguageServiceExtension(e):void 0;return n&&(n=Object.defineProperty(n,"owner",{value:e})),n})).filter((e=>!!e)))},e.destroyLanguageServiceExtensions=function(e){i=i.filter((t=>t.owner!==e))},e.getProgramExtensions=function(e){const t=function(e){const t=[...new Set(n.map((e=>e.view)))];let s;return t.forEach((t=>{t.owns(e)&&(s&&!e.startsWith(t.rootPath)||(s=t))})),void 0===s&&(s=1===t.length?t[0]:t.find((t=>t.getBoundSourceFileInfo(e)))||t[0]),s}("string"==typeof e?e.toString():(0,s.getFileInfo)(e).filePath);return n.filter((e=>e.view===t))},e.getLanguageServiceExtensions=function(){return i},e.unregister=function(){n.splice(0,n.length),i.splice(0,i.length),t.splice(0,t.length)}}(t.Extensions||(t.Extensions={}))},7830:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VirtualDirent=t.nullFileWatcherProvider=t.nullFileWatcherHandler=t.ignoredWatchEventFunction=void 0,t.ignoredWatchEventFunction=function(e){const t=e.map((e=>e.toLowerCase()));return e=>{if(!e||e.indexOf("__pycache__")>=0)return!0;const n=e.toLowerCase();return t.every((e=>n.indexOf(e)<0))}};const n={close(){}};t.nullFileWatcherHandler={onFileChange(e,t){}},t.nullFileWatcherProvider={createFileWatcher:(e,t)=>n},t.VirtualDirent=class{constructor(e,t){this.name=e,this._file=t}isFile(){return this._file}isDirectory(){return!this._file}isBlockDevice(){return!1}isCharacterDevice(){return!1}isSymbolicLink(){return!1}isFIFO(){return!1}isSocket(){return!1}}},3584:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.FullAccessHost=t.LimitedAccessHost=void 0;const r=a(n(2081)),o=n(2930),l=n(5839),c=n(8442),p=n(6657),d=n(6886),u=["import os, os.path, sys","normalize = lambda p: os.path.normcase(os.path.normpath(p))","cwd = normalize(os.getcwd())",'orig_sys_path = [p for p in sys.path if p != ""]','sys.path[:] = [p for p in sys.path if p != "" and normalize(p) != cwd]'],y=[...u,"import sys, json","json.dump(dict(path=orig_sys_path, prefix=sys.prefix), sys.stdout)"].join("; "),m=[...u,"import sys, json","json.dump(dict(major=sys.version_info[0], minor=sys.version_info[1]), sys.stdout)"].join("; ");class g extends c.NoAccessHost{get kind(){return 1}getPythonPlatform(e){return"darwin"===process.platform?o.PythonPlatform.Darwin:"linux"===process.platform?o.PythonPlatform.Linux:"win32"===process.platform?o.PythonPlatform.Windows:void 0}}t.LimitedAccessHost=g;class h extends g{constructor(e){super(),this._fs=e}static createHost(e,t){switch(e){case 2:return new c.NoAccessHost;case 1:return new g;case 0:return new h(t);default:(0,l.assertNever)(e)}}get kind(){return 0}getPythonSearchPaths(e,t){const n=null!=t?t:[];let s=this._executePythonInterpreter(e,(e=>this._getSearchPathResultFromInterpreter(this._fs,e,n)));return s||(s={paths:[],prefix:""}),n.push(`Received ${s.paths.length} paths from interpreter`),s.paths.forEach((e=>{n.push(`  ${e}`)})),s}getPythonVersion(e,t){const n=null!=t?t:[];try{const t=["-c",m],s=this._executePythonInterpreter(e,(e=>r.execFileSync(e,t,{encoding:"utf8"}))),i=JSON.parse(s),a=(0,d.versionFromMajorMinor)(i.major,i.minor);return void 0===a?void n.push(`Python version ${i.major}.${i.minor} from interpreter is unsupported`):a}catch{return void n.push("Unable to get Python version from interpreter")}}runScript(e,t,n,s){return new Promise(((i,a)=>{let o="",l="";const c=[t,...n],p=this._executePythonInterpreter(e,(e=>r.spawn(e,c,{cwd:s})));p?(p.stdout.on("data",(e=>o=o.concat(e))),p.stderr.on("data",(e=>l=l.concat(e))),p.on("error",(e=>{a(e)})),p.on("exit",(()=>{i({stdout:o,stderr:l})}))):a(new Error(`Cannot start python interpreter with script ${t}`))}))}_executePythonInterpreter(e,t){if(e)return t(e);{let e;try{"win32"!==process.platform&&(e=t("python3"))}catch{}return void 0!==e?e:t("python")}}_getSearchPathResultFromInterpreter(e,t,n){const s={paths:[],prefix:""};try{const i=["-c",y];n.push(`Executing interpreter: '${t}'`);const a=r.execFileSync(t,i,{encoding:"utf8"});try{const t=JSON.parse(a);for(let i of t.path)if(i=i.trim(),i){const t=(0,p.normalizePath)(i);e.existsSync(t)&&(0,p.isDirectory)(e,t)?s.paths.push(t):n.push(`Skipping '${t}' because it is not a valid directory`)}s.prefix=t.prefix,0===s.paths.length&&n.push("Found no valid directories")}catch(e){throw n.push(`Could not parse output: '${a}'`),e}}catch{return}return s}}t.FullAccessHost=h},8442:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoAccessHost=void 0,t.NoAccessHost=class{get kind(){return 2}getPythonSearchPaths(e,t){return null==t||t.push("No access to python executable."),{paths:[],prefix:""}}getPythonVersion(e,t){}getPythonPlatform(e){}async runScript(e,t,n,s){return{stdout:"",stderr:""}}}},7345:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LogTracker=void 0;const s=n(2211),i=n(8718);t.LogTracker=class{constructor(e,t){this._console=e,this._prefix=t,this._dummyState=new a,this._indentation="",this._previousTitles=[]}get logLevel(){const e=this._console.level;return null!=e?e:s.LogLevel.Error}log(e,t,n=-1,i=!1){if(void 0===this._console)return t(this._dummyState);const r=this._console.level;if(void 0===r||r!==s.LogLevel.Log&&r!==s.LogLevel.Info)return t(this._dummyState);const o=this._indentation;this._previousTitles.push(`${o}${e} ...`),this._indentation+="  ";const l=new a;try{return t(l)}finally{const t=l.duration;if(this._indentation=o,this._previousTitles.length>0&&(l.isSuppressed()||t<=n))this._previousTitles.pop();else{this._printPreviousTitles();let n=`[${this._prefix}] ${this._indentation}${e}${l.get()} (${t}ms)`;i&&l.fileReadTotal+l.tokenizeTotal+l.parsingTotal+l.resolveImportsTotal+l.bindingTotal>0&&(n+=` [f:${l.fileReadTotal}, t:${l.tokenizeTotal}, p:${l.parsingTotal}, i:${l.resolveImportsTotal}, b:${l.bindingTotal}]`),this._console.log(n),t>=2e3&&this._console.info(`[${this._prefix}] Long operation: ${e} (${t}ms)`)}}}_printPreviousTitles(){if(this._previousTitles.pop(),!(this._previousTitles.length<=0)){for(const e of this._previousTitles)this._console.log(`[${this._prefix}] ${e}`);this._previousTitles.length=0}}};class a{constructor(){this._start=new i.Duration,this._startFile=i.timingStats.readFileTime.totalTime,this._startToken=i.timingStats.tokenizeFileTime.totalTime,this._startParse=i.timingStats.parseFileTime.totalTime,this._startImport=i.timingStats.resolveImportsTime.totalTime,this._startBind=i.timingStats.bindTime.totalTime}get duration(){return this._start.getDurationInMilliseconds()}get fileReadTotal(){return i.timingStats.readFileTime.totalTime-this._startFile}get tokenizeTotal(){return i.timingStats.tokenizeFileTime.totalTime-this._startToken}get parsingTotal(){return i.timingStats.parseFileTime.totalTime-this._startParse}get resolveImportsTotal(){return i.timingStats.resolveImportsTime.totalTime-this._startImport}get bindingTotal(){return i.timingStats.bindTime.totalTime-this._startBind}add(e){e&&(this._addendum=e)}get(){return this._addendum?` [${this._addendum}]`:""}suppress(){this._suppress=!0}isSuppressed(){return!!this._suppress}}},1049:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fromLSPAny=t.toLSPAny=void 0,t.toLSPAny=function(e){return e},t.fromLSPAny=function(e){return e}},720:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getHeapStatistics=void 0,t.getHeapStatistics=function(){try{const e=n(4655).getHeapStatistics;if(e)return e}catch{}return()=>({total_heap_size:0,total_heap_size_executable:0,total_physical_size:0,total_available_size:0,used_heap_size:0,heap_size_limit:0,malloced_memory:0,peak_malloced_memory:0,does_zap_garbage:0,number_of_native_contexts:0,number_of_detached_contexts:0})}()},3188:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultStubsDirectory=t.stubsSuffix=t.src=t.distPackages=t.sitePackages=t.lib64=t.libAlternate=t.lib=t.typeshedFallback=void 0,t.typeshedFallback="typeshed-fallback",t.lib="lib",t.libAlternate="Lib",t.lib64="lib64",t.sitePackages="site-packages",t.distPackages="dist-packages",t.src="src",t.stubsSuffix="-stubs",t.defaultStubsDirectory="typings"},6657:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.normalizePathCase=t.convertPathToUri=t.extractPathFromUri=t.convertUriToPath=t.isDiskPathRoot=t.isRootedDiskPath=t.getRegexEscapedSeparator=t.getFileSpec=t.hasPythonExtension=t.getWildcardRoot=t.isDirectoryWildcardPatternPresent=t.getWildcardRegexPattern=t.getFileSystemEntriesFromDirEntries=t.getFileSystemEntries=t.tryRealpath=t.tryStat=t.isFile=t.isDirectory=t.normalizePath=t.stripFileExtension=t.getShortenedFileName=t.getFileName=t.getFileExtension=t.stripTrailingDirectorySeparator=t.hasTrailingDirectorySeparator=t.ensureTrailingDirectorySeparator=t.comparePathsCaseInsensitive=t.comparePathsCaseSensitive=t.getRelativePathComponentsFromDirectory=t.getRelativePathFromDirectory=t.getBaseFileName=t.getAnyExtensionFromPath=t.changeAnyExtension=t.containsPath=t.comparePaths=t.combinePaths=t.resolvePaths=t.normalizeSlashes=t.directoryExists=t.fileExists=t.getFileSize=t.makeDirectories=t.getRelativePath=t.combinePathComponents=t.reducePathComponents=t.getPathComponents=t.getRootLength=t.getDirectoryPath=t.forEachAncestorDirectory=t.FileSpec=void 0,t.deduplicateFolders=t.getDirectoryChangeKind=t.getLibraryPathWithoutExtension=t.isFileSystemCaseSensitiveInternal=t.isFileSystemCaseSensitive=void 0;const r=a(n(1017)),o=n(472),l=n(9489),c=n(2489),p=n(8916),d=a(n(5839)),u=n(7559);let y;const m=/\.pyi?$/;function g(e){return e.substr(0,Math.max(h(e),e.lastIndexOf(r.sep)))}function h(e){if(e.charAt(0)===r.sep){if(e.charAt(1)!==r.sep)return 1;const t=e.indexOf(r.sep,2);if(t<0)return 2;const n=e.indexOf(r.sep,t+1);return n<0?t+1:n+1}return":"===e.charAt(1)&&e.charAt(2)===r.sep?3:0}function f(e){const t=I(e),n=h(t),s=t.substring(0,n),i=t.substring(n).split(r.sep);return i.length>0&&!i[i.length-1]&&i.pop(),T([s,...i])}function T(e){if(!(0,l.some)(e))return[];const t=[e[0]];for(let n=1;n<e.length;n++){const s=e[n];if(s&&"."!==s){if(".."===s)if(t.length>1){if(".."!==t[t.length-1]){t.pop();continue}}else if(t[0])continue;t.push(s)}}return t}function v(e){return 0===e.length?"":I((e[0]&&D(e[0]))+e.slice(1).join(r.sep))}var _;function I(e,t=r.sep){if(e.includes((e=>"/"===e?"\\":"/")(t))){const n=/[\\/]/g;return e.replace(n,t)}return e}function b(e,...t){e&&(e=I(e));for(let n of t)n&&(n=I(n),e=e&&0===h(n)?D(e)+n:n);return e}function C(e,t,n){if(t)return function(e,t,n){if("string"==typeof t)return B(e,t,n)||"";for(const s of t){const t=B(e,s,n);if(t)return t}return""}(E(e),t,n?u.equateStringsCaseInsensitive:u.equateStringsCaseSensitive);const s=S(e),i=s.lastIndexOf(".");return i>=0?s.substring(i):""}function S(e,t,n){if(h(e=I(e))===e.length)return"";const s=(e=E(e)).slice(Math.max(h(e),e.lastIndexOf(r.sep)+1)),i=void 0!==t&&void 0!==n?C(s,t,n):void 0;return i?s.slice(0,s.length-i.length):s}function x(e,t,n){d.assert(h(e)>0==h(t)>0,"Paths must either both be absolute or both be relative");const s="function"==typeof n?n:c.identity,i=function(e,t,n,s){const i=f(e),a=f(t);let r;for(r=0;r<i.length&&r<a.length;r++){const e=s(i[r]),t=s(a[r]);if(!(0===r?u.equateStringsCaseInsensitive:n)(e,t))break}if(0===r)return a;const o=a.slice(r),l=[];for(;r<i.length;r++)l.push("..");return["",...l,...o]}(e,t,"boolean"==typeof n&&n?u.equateStringsCaseInsensitive:u.equateStringsCaseSensitive,s);return i}function D(e){return F(e)?e:e+r.sep}function F(e){if(0===e.length)return!1;const t=e.charCodeAt(e.length-1);return 47===t||92===t}function E(e){return F(e)?e.substr(0,e.length-1):e}function P(e,t=!1){if(!t)return r.extname(e);const n=(e=A(e)).indexOf(".");return e.substr(n)}function A(e){return r.basename(e)}function N(e,t=!1){const n=P(e,t);return e.substr(0,e.length-n.length)}function k(e){return I(r.normalize(e))}function w(e,t){try{if(e.existsSync(t))return e.statSync(t)}catch(e){return}}function M(e,t,n){const s=e.sort(((e,t)=>e.name<t.name?-1:e.name>t.name?1:0)),i=[],a=[];for(const e of s)if("."!==e.name&&".."!==e.name)if(e.isFile())i.push(e.name);else if(e.isDirectory())a.push(e.name);else if(e.isSymbolicLink()){const s=w(t,b(n,e.name));(null==s?void 0:s.isFile())?i.push(e.name):(null==s?void 0:s.isDirectory())&&a.push(e.name)}return{files:i,directories:a}}function R(e,t){let n=k(b(e,t));V(n)||(n=D(n));const s=f(n),i=U(),a=`(${i}[^${i}][^${i}]*)*?`,r=new RegExp(`[^\\w\\s${i}]`,"g");s.length>0&&(s[0]=E(s[0]));let o="",l=!0;for(let e of s)"**"===e?o+=a:(l||(e=i+e),o+=e.replace(r,(e=>"*"===e?`[^${i}]*`:"?"===e?`[^${i}]`:"\\"+e)),l=!1);return o}function O(e){const t=f(k(e));for(const e of t)if("**"===e)return!0;return!1}function L(e,t){let n=k(b(e,t));V(n)||(n=D(n));const s=f(n);if(s.length>0&&(s[0]=E(s[0])),1===s.length&&!s[0])return r.sep;let i="",a=!0;for(let e of s){if("**"===e)break;if(e.match(/[*?]/))break;a||(e=r.sep+e),i+=e,a=!1}return i}function V(e){return e.endsWith(".py")||e.endsWith(".pyi")}function U(){return"/"===r.sep?"/":"\\\\"}function z(e,t,n){if(e===t)return 0;if(void 0===e)return-1;if(void 0===t)return 1;const s=e.substring(0,h(e)),i=t.substring(0,h(t)),a=(0,u.compareStringsCaseInsensitive)(s,i);if(0!==a)return a;const r=U(),o=new RegExp(`(^|${r}).{0,2}($|${r})`),l=e.substring(s.length),p=t.substring(i.length);if(!o.test(l)&&!o.test(p))return n(l,p);const d=f(e),y=f(t),m=Math.min(d.length,y.length);for(let e=1;e<m;e++){const t=n(d[e],y[e]);if(0!==t)return t}return(0,c.compareValues)(d.length,y.length)}function B(e,t,n){if(t.startsWith(".")||(t="."+t),e.length>=t.length&&46===e.charCodeAt(e.length-t.length)){const s=e.slice(e.length-t.length);if(n(s,t))return s}}function G(e,t,n){try{const s=e.statSync(t);switch(n){case 0:return s.isFile();case 1:return s.isDirectory();default:return!1}}catch(e){return!1}}function W(e){const t=o.URI.parse(e);let n=k("file"===t.scheme?t.fsPath:t.path);return n.match(/^\\[a-zA-Z]:\\/)&&(n=n.substr(1)),n}function j(e){return void 0!==y||(y=$(e)),y}function $(e){let t;try{let n,s;do{n=`${(0,p.randomBytesHex)(21)}-a`,t=r.join(e.tmpdir(),n),s=r.join(e.tmpdir(),n.toUpperCase())}while(e.existsSync(t)||e.existsSync(s));return e.writeFileSync(t,"","utf8"),!e.existsSync(s)}catch(e){return!1}finally{t&&e.unlinkSync(t)}}(_=t.FileSpec||(t.FileSpec={})).is=function(e){const t=e;return t&&!!t.wildcardRoot&&!!t.regExp},_.isInPath=function(e,t){return!!t.find((t=>t.regExp.test(e)))},_.matchesIncludeFileRegex=function(e,t=!0){return!t||m.test(e)},_.matchIncludeFileSpec=function(e,t,n,s=!0){return!(!e.test(n)||_.isInPath(n,t)||!_.matchesIncludeFileRegex(n,s))},t.forEachAncestorDirectory=function(e,t){for(;;){const n=t(e);if(void 0!==n)return n;const s=g(e);if(s===e)return;e=s}},t.getDirectoryPath=g,t.getRootLength=h,t.getPathComponents=f,t.reducePathComponents=T,t.combinePathComponents=v,t.getRelativePath=function(e,t){if(!e.startsWith(D(t)))return;const n=f(e);let s=".";for(let e=f(t).length;e<n.length;e++)s+=r.sep+n[e];return s},t.makeDirectories=function(e,t,n){if(!t.startsWith(n))return;const s=f(t);let i=n;for(let t=f(n).length;t<s.length;t++)i=b(i,s[t]),e.existsSync(i)||e.mkdirSync(i)},t.getFileSize=function(e,t){const n=w(e,t);return(null==n?void 0:n.isFile())?n.size:0},t.fileExists=function(e,t){return G(e,t,0)},t.directoryExists=function(e,t){return G(e,t,1)},t.normalizeSlashes=I,t.resolvePaths=function(e,...t){return k((0,l.some)(t)?b(e,...t):I(e))},t.combinePaths=b,t.comparePaths=function(e,t,n,s){return e=k(e),t=k(t),"string"==typeof n?(e=b(n,e),t=b(n,t)):"boolean"==typeof n&&(s=n),z(e,t,(0,u.getStringComparer)(s))},t.containsPath=function(e,t,n,s){if("string"==typeof n?(e=b(n,e),t=b(n,t)):"boolean"==typeof n&&(s=n),void 0===e||void 0===t)return!1;if(e===t)return!0;const i=f(e),a=f(t);if(a.length<i.length)return!1;const r=s?u.equateStringsCaseInsensitive:u.equateStringsCaseSensitive;for(let e=0;e<i.length;e++)if(!(0===e?u.equateStringsCaseInsensitive:r)(i[e],a[e]))return!1;return!0},t.changeAnyExtension=function(e,t,n,s){const i=void 0!==n&&void 0!==s?C(e,n,s):C(e);return i?e.slice(0,e.length-i.length)+(t.startsWith(".")?t:"."+t):e},t.getAnyExtensionFromPath=C,t.getBaseFileName=S,t.getRelativePathFromDirectory=function(e,t,n){return v(x(e,t,n))},t.getRelativePathComponentsFromDirectory=x,t.comparePathsCaseSensitive=function(e,t){return z(e,t,u.compareStringsCaseSensitive)},t.comparePathsCaseInsensitive=function(e,t){return z(e,t,u.compareStringsCaseInsensitive)},t.ensureTrailingDirectorySeparator=D,t.hasTrailingDirectorySeparator=F,t.stripTrailingDirectorySeparator=E,t.getFileExtension=P,t.getFileName=A,t.getShortenedFileName=function(e,t=15){const n=A(e),s=g(e);return s.length>t?`...${s.slice(s.length-t)}${r.sep}${n}`:e},t.stripFileExtension=N,t.normalizePath=k,t.isDirectory=function(e,t){var n,s;return null!==(s=null===(n=w(e,t))||void 0===n?void 0:n.isDirectory())&&void 0!==s&&s},t.isFile=function(e,t,n=!1){var s,i;const a=w(e,t);return!!(null==a?void 0:a.isFile())||!!n&&null!==(i=null===(s=null==a?void 0:a.isZipDirectory)||void 0===s?void 0:s.call(a))&&void 0!==i&&i},t.tryStat=w,t.tryRealpath=function(e,t){try{return e.realpathSync(t)}catch(e){return}},t.getFileSystemEntries=function(e,t){try{return M(e.readdirEntriesSync(t||"."),e,t)}catch(e){return{files:[],directories:[]}}},t.getFileSystemEntriesFromDirEntries=M,t.getWildcardRegexPattern=R,t.isDirectoryWildcardPatternPresent=O,t.getWildcardRoot=L,t.hasPythonExtension=V,t.getFileSpec=function(e,t,n){let s=R(t,n);s=`^(${s})($|${U()})`;const i=new RegExp(s,j(e)?void 0:"i");return{wildcardRoot:L(t,n),regExp:i,hasDirectoryWildcard:O(n)}},t.getRegexEscapedSeparator=U,t.isRootedDiskPath=function(e){return h(e)>0},t.isDiskPathRoot=function(e){const t=h(e);return t>0&&t===e.length},t.convertUriToPath=function(e,t){return e.getMappedFilePath(W(t))},t.extractPathFromUri=W,t.convertPathToUri=function(e,t){return e.getUri(e.getOriginalFilePath(t))},t.normalizePathCase=function(e,t){return j(e)?t:t.toLowerCase()},t.isFileSystemCaseSensitive=j,t.isFileSystemCaseSensitiveInternal=$,t.getLibraryPathWithoutExtension=function(e){let t=N(e);return t.endsWith("__init__")&&(t=t.substr(0,t.length-9)),t},t.getDirectoryChangeKind=function(e,t,n){if(e.realCasePath(t)===e.realCasePath(n))return"Same";const s=x(t,n,(t=>e.realCasePath(t)));return 3===s.length&&".."===s[1]&&".."!==s[2]?"Renamed":"Moved"},t.deduplicateFolders=function(e){const t=new Set;return e.forEach((e=>{e.forEach((e=>{if(!t.has(e)){for(const n of t){if(e.startsWith(n))return;if(n.startsWith(e))return t.delete(n),void t.add(e)}t.add(e)}}))})),[...t]}},1464:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLineEndPosition=t.convertTextRangeToRange=t.convertRangeToTextRange=t.convertPositionToOffset=t.convertOffsetsToRange=t.convertOffsetToPosition=void 0;const s=n(5839),i=n(3550);function a(e,t){if(0===t.end)return{line:0,character:0};const n=e>=t.end?t.count-1:t.getItemContaining(e);(0,s.assert)(n>=0&&n<=t.count);const i=t.getItemAt(n);return(0,s.assert)(void 0!==i),{line:n,character:Math.max(0,Math.min(i.length,e-i.start))}}function r(e,t,n){return{start:a(e,n),end:a(t,n)}}function o(e,t){if(!(e.line>=t.count))return t.getItemAt(e.line).start+e.character}t.convertOffsetToPosition=a,t.convertOffsetsToRange=r,t.convertPositionToOffset=o,t.convertRangeToTextRange=function(e,t){const n=o(e.start,t);if(void 0===n)return;const s=o(e.end,t);return void 0!==s?i.TextRange.fromBounds(n,s):void 0},t.convertTextRangeToRange=function(e,t){return r(e.start,i.TextRange.getEnd(e),t)},t.getLineEndPosition=function(e,t){const n=e.lines,s=n.getItemAt(t);return{line:t,character:t<n.count-1?s.length-e.predominantEndOfLineSequence.length:s.length}}},6886:(e,t)=>{var n;function s(e,t){if(isNaN(e)||isNaN(t))return;if(e>255||t>255)return;const s=256*e+t;return void 0!==n[s]&&i(s)?s:void 0}function i(e){return e>>8==3}Object.defineProperty(t,"__esModule",{value:!0}),t.is3x=t.versionFromMajorMinor=t.versionFromString=t.versionToString=t.latestStablePythonVersion=t.PythonVersion=void 0,function(e){e[e.V3_0=768]="V3_0",e[e.V3_1=769]="V3_1",e[e.V3_2=770]="V3_2",e[e.V3_3=771]="V3_3",e[e.V3_4=772]="V3_4",e[e.V3_5=773]="V3_5",e[e.V3_6=774]="V3_6",e[e.V3_7=775]="V3_7",e[e.V3_8=776]="V3_8",e[e.V3_9=777]="V3_9",e[e.V3_10=778]="V3_10",e[e.V3_11=779]="V3_11",e[e.V3_12=780]="V3_12"}(n=t.PythonVersion||(t.PythonVersion={})),t.latestStablePythonVersion=n.V3_11,t.versionToString=function(e){return`${e>>8&255}.${255&e}`},t.versionFromString=function(e){const t=e.split(".");if(!(t.length<2))return s(parseInt(t[0],10),parseInt(t[1],10))},t.versionFromMajorMinor=s,t.is3x=i},7720:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceFileWatcherProvider=t.createFromRealFileSystem=void 0;const r=n(742),o=n(2771),l=a(n(7147)),c=a(n(1195)),p=n(472),d=n(2211),u=n(7830),y=n(6657);c.setGracefulCleanup(),t.createFromRealFileSystem=function(e,t){return e=null!=e?e:new d.NullConsole,new C(null!=t?t:u.nullFileWatcherProvider,e)};const m=".zip",g=".egg";function h(e){let t=e.indexOf(m);if(t<=0&&(t=e.indexOf(g),t<=0))return null;if(e[t-1]===r.ppath.sep)return null;const n=t+m.length;return e.length>n&&e[n]!==r.ppath.sep?null:e.slice(0,n)}function f(e){return e.endsWith(m)||e.endsWith(g)}const T=[Buffer.from([80,75,3,4]),Buffer.from([80,75,5,6]),Buffer.from([80,75,7,8])];function v(e,t){let n;try{n=e.openSync(t,"r");const s=Buffer.alloc(4);if(e.readSync(n,s,0,4,0)<4)return!1;for(const e of T)if(0===s.compare(e))return!0;return!1}catch{return!1}finally{void 0!==n&&e.closeSync(n)}}class _ extends r.ZipOpenFS{getZipSync(e,t){return super.getZipSync(e,t)}findZip(e){if(this.filter&&!this.filter.test(e))return null;let t="";for(;;){const n=h(e.substr(t.length));if(!n)return null;if(t=this.pathUtils.join(t,n),!1===this.isZip.has(t)){if(this.notZip.has(t))continue;try{if(!this.baseFs.lstatSync(t).isFile()){this.notZip.add(t);continue}if(!v(this.baseFs,t)){this.notZip.add(t);continue}try{this.getZipSync(t,(()=>{}))}catch{this.notZip.add(t);continue}}catch{return null}this.isZip.add(t)}return{archivePath:t,subPath:this.pathUtils.join(r.PortablePath.root,e.substr(t.length))}}}}class I extends r.PosixFS{constructor(){const e=new _({libzip:()=>(0,o.getLibzipSync)(),useCache:!0,maxOpenFiles:80,readOnlyArchives:!0});super(new r.VirtualFS({baseFs:e})),this._eggZipOpenFS=e}isZip(e){return!!this._eggZipOpenFS.findZip(this.mapToBase(e))}}const b=new I;class C{constructor(e,t){this._fileWatcherProvider=e,this._console=t}existsSync(e){try{return b.existsSync(e)}catch{return!1}}mkdirSync(e,t){b.mkdirSync(e,t)}chdir(e){process.chdir(e)}readdirSync(e){return b.readdirSync(e)}readdirEntriesSync(e){return b.readdirSync(e,{withFileTypes:!0}).map((t=>f(t.name)&&t.isFile()&&b.isZip(e)?{name:t.name,isFile:()=>!1,isDirectory:()=>!0,isBlockDevice:()=>!1,isCharacterDevice:()=>!1,isSymbolicLink:()=>!1,isFIFO:()=>!1,isSocket:()=>!1}:t))}readFileSync(e,t=null){return"utf8"===t||"utf-8"===t?b.readFileSync(e,"utf8"):b.readFileSync(e)}writeFileSync(e,t,n){b.writeFileSync(e,t,n||void 0)}statSync(e){const t=b.statSync(e);return f(e)&&t.isFile()&&b.isZip(e)?{...t,isFile:()=>!1,isDirectory:()=>!0,isZipDirectory:()=>!0}:t}unlinkSync(e){b.unlinkSync(e)}realpathSync(e){return b.realpathSync(e)}getModulePath(){return global.__rootDirectory}createFileSystemWatcher(e,t){return this._fileWatcherProvider.createFileWatcher(e.map((e=>this.realCasePath(e))),t)}createReadStream(e){return b.createReadStream(e)}createWriteStream(e){return b.createWriteStream(e)}copyFileSync(e,t){b.copyFileSync(e,t)}readFile(e){return b.readFilePromise(e)}async readFileText(e,t){return"utf8"===t||"utf-8"===t?b.readFilePromise(e,"utf8"):(await b.readFilePromise(e)).toString(t)}tmpdir(){return this._tmpdir||(this._tmpdir=c.dirSync({prefix:"pyright"})),this._tmpdir.name}tmpfile(e){return c.fileSync({dir:this.tmpdir(),discardDescriptor:!0,...e}).name}realCasePath(e){try{if(!l.existsSync(e))return e;const t=l.realpathSync.native(e),n=(0,y.getRootLength)(t);return n<=0?t:t.substr(0,n).toLowerCase()+t.substr(n)}catch(t){return this._console.log(`Failed to get real file system casing for ${e}: ${t}`),e}}isMappedFilePath(e){return!1}getOriginalFilePath(e){return e}getMappedFilePath(e){return e}getUri(e){return p.URI.file(e).toString()}isInZipOrEgg(e){return/[^\\/]\.(?:egg|zip)[\\/]/.test(e)&&b.isZip(e)}dispose(){var e;try{null===(e=this._tmpdir)||void 0===e||e.removeCallback(),this._tmpdir=void 0}catch{}}}t.WorkspaceFileWatcherProvider=class{constructor(){this._fileWatchers=[]}createFileWatcher(e,t){const n=this,s={close(){n._fileWatchers=n._fileWatchers.filter((e=>e!==s))},workspacePaths:e,eventHandler:t};return n._fileWatchers.push(s),s}onFileChange(e,t){this._fileWatchers.forEach((n=>{n.workspacePaths.some((e=>t.startsWith(e)))&&n.eventHandler(e,t)}))}}},7559:function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.truncate=t.getLastDottedString=t.getCharacterCount=t.equateStringsCaseSensitive=t.equateStringsCaseInsensitive=t.getStringComparer=t.compareStringsCaseSensitive=t.compareStringsCaseInsensitive=t.hashString=t.isPatternInSymbol=t.computeCompletionSimilarity=void 0;const i=s(n(7588)),a=n(2489);function r(e,t){return e===t?0:void 0===e?-1:void 0===t?1:(0,a.compareComparableValues)(e.toUpperCase(),t.toUpperCase())}function o(e,t){return(0,a.compareComparableValues)(e,t)}t.computeCompletionSimilarity=function(e,t){if(t.startsWith(e))return 1;const n=t.toLocaleLowerCase(),s=e.toLocaleLowerCase();if(n.startsWith(s))return.75;let a=n.length,r=Number.MAX_VALUE;for(;a>0;){const e=(0,i.default)(n.substr(0,a),s);e<r&&(r=e),a--}return r>=e.length?0:(e.length-r)/e.length*.5},t.isPatternInSymbol=function(e,t){const n=e.toLocaleLowerCase(),s=t.toLocaleLowerCase(),i=n.length,a=s.length;let r=0,o=0;for(;r<i&&o<a;)n[r]===s[o]&&(r+=1),o+=1;return r===i},t.hashString=function(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n)|0;return t},t.compareStringsCaseInsensitive=r,t.compareStringsCaseSensitive=o,t.getStringComparer=function(e){return e?r:o},t.equateStringsCaseInsensitive=function(e,t){return 0===r(e,t)},t.equateStringsCaseSensitive=function(e,t){return 0===o(e,t)},t.getCharacterCount=function(e,t){let n=0;for(let s=0;s<e.length;s++)e[s]===t&&n++;return n},t.getLastDottedString=function(e){const t=e.lastIndexOf(".");return t>0?e.substring(t+1):e},t.truncate=function(e,t){return e.length>t?e.substring(0,t-"...".length)+"...":e}},9232:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.TextEditTracker=void 0;const r=n(563),o=n(7012),l=a(n(8494)),c=n(9489),p=n(2489),d=a(n(5839)),u=n(1250),y=n(1464),m=n(3550);t.TextEditTracker=class{constructor(e=!0){this._mergeOnlyDuplications=e,this._nodesRemoved=new Map,this._results=new Map,this._pendingNodeToRemove=[]}addEdits(...e){e.forEach((e=>this.addEdit(e.filePath,e.range,e.replacementText)))}addEdit(e,t,n){const s=(0,c.getOrAdd)(this._results,e,(()=>[])),i=this._getEditsToMerge(s,t,n);i.length>0&&(this._removeEdits(s,i),(0,m.extendRange)(t,i.map((e=>e.range)))),s.push({filePath:e,range:t,replacementText:n})}addEditWithTextRange(e,t,n){const s=(0,r.getFileInfo)(e.parseTree).filePath;e.text.substr(t.start,t.length)!==n&&this.addEdit(s,(0,y.convertTextRangeToRange)(t,e.tokenizerOutput.lines),n)}deleteImportName(e,t){const n=21===t.nodeType?t.parent.list:t.parent.imports,s=(0,r.getFileInfo)(e.parseTree).filePath;(0,o.getTextRangeForImportNameDeletion)(n,n.findIndex((e=>e===t))).forEach((t=>this.addEditWithTextRange(e,t,""))),this._markNodeRemoved(t,e);let i=0;for(i=n.length-1;i>=0&&this._nodesRemoved.has(n[i]);i--);if(-1===i){const n=t.parent;n&&this.addEdit(s,l.getFullStatementRange(n,e),"")}else if(i>=0&&i<n.length-2){const t=m.TextRange.getEnd(n[i]),s=m.TextRange.getEnd(n[i+1])-t;this.addEditWithTextRange(e,{start:t,length:s},"")}}addOrUpdateImport(e,t,n,s,i,a){i&&this._tryUpdateImport(e,t,n,i,a)||this._addImport(e,t,n,s,i)}removeNodes(...e){this._pendingNodeToRemove.push(...e)}isNodeRemoved(e){return this._nodesRemoved.has(e)}getEdits(e){this._processNodeRemoved(e);const t=[];return this._results.forEach((e=>(0,c.appendArray)(t,e))),t}_addImport(e,t,n,s,i){const a=(0,r.getFileInfo)(e.parseTree).filePath;this.addEdits(...(0,o.getTextEditsForAutoImportInsertion)(null!=i?i:[],n,t,s,e,(0,y.convertOffsetToPosition)(e.parseTree.length,e.tokenizerOutput.lines)).map((e=>({filePath:a,range:e.range,replacementText:e.replacementText}))))}_tryUpdateImport(e,t,n,s,i){if(!i)return!1;const a=t.orderedImports.find((e=>22===e.node.nodeType&&(e.moduleName===n.nameForImportFrom||e.moduleName===n.name)));if(!a||22!==a.node.nodeType||a.node.isWildcardImport)return!1;const l=(0,r.getFileInfo)(e.parseTree).filePath,c=(0,o.getTextEditsForAutoImportSymbolAddition)(s,a,e);if(a.node!==i.currentFromImport)return this.addEdits(...c.map((e=>({filePath:l,range:e.range,replacementText:e.replacementText})))),!0;const p=i.originalModuleName.split("."),d=n.name.split(".");if(!(0,o.haveSameParentModule)(p,d))return!1;if(1!==s.length||1!==c.length)return!1;const u=this._getDeletionsForSpan(l,c[0].range);if(0===u.length)return this.addEdit(l,c[0].range,c[0].replacementText),!0;const m=p[p.length-1],g=d[d.length-1],h=s[0].alias===g?m:s[0].alias,f=i.currentFromImport.imports.find((e=>{var t;return e.name.value===m&&(null===(t=e.alias)||void 0===t?void 0:t.value)===h}));return!!f&&(this._removeEdits(l,u),f.alias&&this._nodesRemoved.delete(f.alias),this.addEdit(l,(0,y.convertTextRangeToRange)(f.name,e.tokenizerOutput.lines),g),!0)}_getDeletionsForSpan(e,t){return this._getOverlappingForSpan(e,t).filter((e=>""===e.replacementText))}_removeEdits(e,t){var n;(0,p.isString)(e)&&(e=null!==(n=this._results.get(e))&&void 0!==n?n:[]),(0,c.removeArrayElements)(e,(e=>t.some((t=>u.FileEditAction.areEqual(e,t)))))}_getEditsToMerge(e,t,n){const s=this._getOverlappingForSpan(e,t);return this._mergeOnlyDuplications&&s.length>0?""===n?s.filter((e=>""===e.replacementText)):s.filter((e=>e.replacementText===n&&((0,m.doesRangeContain)(t,e.range)||(0,m.doesRangeContain)(e.range,t)))):s.filter((e=>""===e.replacementText||e.replacementText===n&&((0,m.doesRangeContain)(t,e.range)||(0,m.doesRangeContain)(e.range,t))))}_getOverlappingForSpan(e,t){var n;return(0,p.isString)(e)&&(e=null!==(n=this._results.get(e))&&void 0!==n?n:[]),e.filter((e=>(0,m.doRangesIntersect)(e.range,t)))}_processNodeRemoved(e){for(;this._pendingNodeToRemove.length>0;){const t=this._pendingNodeToRemove.length,n=this._pendingNodeToRemove[this._pendingNodeToRemove.length-1];if(this._handleImportNameNode(n,e),this._pendingNodeToRemove.length===t){d.assert(`please add handler for ${n.node.nodeType}`),this._pendingNodeToRemove.pop();const e=(0,r.getFileInfo)(n.parseResults.parseTree);this.addEdit(e.filePath,(0,y.convertTextRangeToRange)(n.node,e.lines),"")}}}_handleImportNameNode(e,t){const n=e.node;if(38!==n.nodeType)return!1;const s=e.parseResults.parseTree,i=(0,r.getFileInfo)(s),a=(0,o.getContainingImportStatement)(l.findNodeByOffset(s,n.start),t);if(!a)return!1;const c=(0,o.getAllImportNames)(a),p=this._pendingNodeToRemove.filter((e=>c.some((t=>m.TextRange.overlapsRange(e.node,t)))));if(c.length===p.length)return this.addEdit(i.filePath,l.getFullStatementRange(a,e.parseResults),""),this._removeNodesHandled(p),!0;const d=[];for(let e=0;e<c.length;e++){const t=c[e];p.some((e=>m.TextRange.overlapsRange(e.node,t)))&&d.push(e)}return 0!==d.length&&((0,o.getTextRangeForImportNameDeletion)(c,...d).forEach((e=>this.addEdit(i.filePath,(0,y.convertTextRangeToRange)(e,i.lines),""))),this._removeNodesHandled(p),!0)}_removeNodesHandled(e){e.forEach((e=>this._markNodeRemoved(e.node,e.parseResults))),(0,c.removeArrayElements)(this._pendingNodeToRemove,(e=>this._nodesRemoved.has(e.node)))}_markNodeRemoved(e,t){this._nodesRemoved.set(e,t),21===e.nodeType?(this._nodesRemoved.set(e.module,t),e.module.nameParts.forEach((e=>this._nodesRemoved.set(e,t))),e.alias&&this._nodesRemoved.set(e.alias,t)):23===e.nodeType&&(this._nodesRemoved.set(e.name,t),e.alias&&this._nodesRemoved.set(e.alias,t))}}},3550:(e,t)=>{var n,s;function i(e,t){return e.line<t.line?-1:e.line>t.line?1:e.character<t.character?-1:e.character>t.character?1:0}function a(e,t){return 0===i(e,t)}function r(e){return 0===e.character&&0===e.line}function o(e,t){t&&(Array.isArray(t)?t.forEach((t=>{o(e,t)})):(i(t.start,e.start)<0&&(e.start=t.start),i(t.end,e.end)>0&&(e.end=t.end)))}Object.defineProperty(t,"__esModule",{value:!0}),t.combineRange=t.extendRange=t.isEmptyRange=t.isEmptyPosition=t.getEmptyRange=t.rangesAreEqual=t.positionsAreEqual=t.doesRangeContain=t.doRangesIntersect=t.doRangesOverlap=t.getEmptyPosition=t.comparePositions=t.Range=t.Position=t.TextRange=void 0,function(e){function t(e,t){if(e<0)throw new Error("start must be non-negative");if(t<0)throw new Error("length must be non-negative");return{start:e,length:t}}function n(e){return e.start+e.length}function s(e,t){return t>=e.start&&t<=n(e)}function i(e,t){t&&(Array.isArray(t)?t.forEach((t=>{i(e,t)})):(t.start<e.start&&(e.length+=e.start-t.start,e.start=t.start),n(t)>n(e)&&(e.length+=n(t)-n(e))))}e.create=t,e.fromBounds=function(e,n){if(e<0)throw new Error("start must be non-negative");if(e>n)throw new Error("end must be greater than or equal to start");return t(e,n-e)},e.getEnd=n,e.contains=function(e,t){return t>=e.start&&t<n(e)},e.containsRange=function(e,t){return t.start>=e.start&&n(t)<=n(e)},e.overlaps=s,e.overlapsRange=function(e,t){return s(e,t.start)||s(t,e.start)},e.extend=i,e.combine=function(e){if(0===e.length)return;const t=e[0];for(let n=1;n<e.length;n++)i(t,e[n]);return t}}(t.TextRange||(t.TextRange={})),function(e){e.is=function(e){const t=e;return t&&void 0!==t.line&&void 0!==t.character},e.print=function(e){return`(${e.line}:${e.character})`}}(n=t.Position||(t.Position={})),(s=t.Range||(t.Range={})).is=function(e){const t=e;return t&&void 0!==t.start&&void 0!==t.end},s.print=function(e){return`${n.print(e.start)}-${n.print(e.end)}`},t.comparePositions=i,t.getEmptyPosition=function(){return{line:0,character:0}},t.doRangesOverlap=function(e,t){return!(i(t.start,e.end)>=0||i(e.start,t.end)>=0)},t.doRangesIntersect=function(e,t){return!(i(t.start,e.end)>0||i(e.start,t.end)>0)},t.doesRangeContain=function e(t,s){return n.is(s)?i(t.start,s)<=0&&i(t.end,s)>=0:e(t,s.start)&&e(t,s.end)},t.positionsAreEqual=a,t.rangesAreEqual=function(e,t){return a(e.start,t.start)&&a(e.end,t.end)},t.getEmptyRange=function(){return{start:{line:0,character:0},end:{line:0,character:0}}},t.isEmptyPosition=r,t.isEmptyRange=function(e){return r(e.start)&&r(e.end)},t.extendRange=o,t.combineRange=function(e){if(0===e.length)return;const t=e[0];for(let n=1;n<e.length;n++)o(t,e[n]);return t}},3420:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getIndexContaining=t.TextRangeCollection=void 0;const s=n(3550);function i(e,t){if(0===e.length)return-1;let n=0,i=e.length-1;for(;n<=i;){const r=Math.floor(n+(i-n)/2),o=a(e,r,n,i);if(void 0===o)return-1;if(s.TextRange.contains(o,t))return r;const l=a(e,r+1,r+1,i);if(void 0===l)return-1;if(r<e.length-1&&s.TextRange.getEnd(o)<=t&&t<l.start)return-1;t<o.start?i=r-1:n=r+1}return-1}function a(e,t,n,s){const i=e[t];if(i)return i;for(let n=t+1;n<=s;n++){const n=e[t];if(n)return n}for(let s=t-1;s>=n;s--){const n=e[t];if(n)return n}}t.TextRangeCollection=class{constructor(e){this._items=e}get start(){return this._items.length>0?this._items[0].start:0}get end(){const e=this._items[this._items.length-1];return this._items.length>0?e.start+e.length:0}get length(){return this.end-this.start}get count(){return this._items.length}contains(e){return e>=this.start&&e<this.end}getItemAt(e){if(e<0||e>=this._items.length)throw new Error("index is out of range");return this._items[e]}getItemAtPosition(e){if(0===this.count)return-1;if(e<this.start)return-1;if(e>this.end)return-1;let t=0,n=this.count-1;for(;t<n;){const s=Math.floor(t+(n-t)/2),i=this._items[s];if(e>=i.start&&(s>=this.count-1||e<this._items[s+1].start))return s;e<i.start?n=s-1:t=s+1}return t}getItemContaining(e){return 0===this.count||e<this.start||e>this.end?-1:i(this._items,e)}},t.getIndexContaining=i},8718:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.timingStats=t.TimingStats=t.TimingStat=t.Duration=void 0;class n{constructor(){this._startTime=Date.now()}getDurationInMilliseconds(){return Date.now()-this._startTime}getDurationInSeconds(){return this.getDurationInMilliseconds()/1e3}}t.Duration=n;class s{constructor(){this.totalTime=0,this.callCount=0,this.isTiming=!1}timeOperation(e,...t){if(this.callCount++,this.isTiming)return e(...t);{this.isTiming=!0;const s=new n,i=e(...t);return this.totalTime+=s.getDurationInMilliseconds(),this.isTiming=!1,i}}subtractFromTime(e){if(this.isTiming){this.isTiming=!1;const t=new n;e(),this.totalTime-=t.getDurationInMilliseconds(),this.isTiming=!0}else e()}printTime(){const e=this.totalTime/1e3;return(Math.round(100*e)/100).toString()+"sec"}}t.TimingStat=s;class i{constructor(){this.totalDuration=new n,this.findFilesTime=new s,this.readFileTime=new s,this.tokenizeFileTime=new s,this.parseFileTime=new s,this.resolveImportsTime=new s,this.cycleDetectionTime=new s,this.bindTime=new s,this.typeCheckerTime=new s,this.typeEvaluationTime=new s}printSummary(e){e.info(`Completed in ${this.totalDuration.getDurationInSeconds()}sec`)}printDetails(e){e.info(""),e.info("Timing stats"),e.info("Find Source Files:    "+this.findFilesTime.printTime()),e.info("Read Source Files:    "+this.readFileTime.printTime()),e.info("Tokenize:             "+this.tokenizeFileTime.printTime()),e.info("Parse:                "+this.parseFileTime.printTime()),e.info("Resolve Imports:      "+this.resolveImportsTime.printTime()),e.info("Bind:                 "+this.bindTime.printTime()),e.info("Check:                "+this.typeCheckerTime.printTime()),e.info("Detect Cycles:        "+this.cycleDetectionTime.printTime())}getTotalDuration(){return this.totalDuration.getDurationInSeconds()}}t.TimingStats=i,t.timingStats=new i},8798:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateWorkspaceEdit=t.applyDocumentChanges=t.applyWorkspaceEdit=t.applyTextEditsToString=t.appendToWorkspaceEdit=t.convertToWorkspaceEdit=t.convertToFileTextEdits=t.convertToTextEdits=void 0;const s=n(4494),i=n(6657),a=n(9489),r=n(2489),o=n(5839),l=n(1464),c=n(3550);function p(e,t,n){t.forEach((t=>{const s=(0,i.convertPathToUri)(e,t.filePath);n.changes[s]=n.changes[s]||[],n.changes[s].push({range:t.range,newText:t.replacementText})}))}function d(e,t,n){var s;if(!t.isOpenByClient){const n=t.sourceFile.getFileContent();e.setFileOpened(t.sourceFile.getFilePath(),0,null!=n?n:"",t.sourceFile.getIPythonMode(),t.sourceFile.getRealFilePath())}const i=(null!==(s=t.sourceFile.getClientVersion())&&void 0!==s?s:0)+1;e.updateOpenFileContents(t.sourceFile.getFilePath(),i,n.map((e=>({range:e.range,text:e.newText}))),t.sourceFile.getIPythonMode(),t.sourceFile.getRealFilePath())}t.convertToTextEdits=function(e){return e.map((e=>({range:e.range,newText:e.replacementText})))},t.convertToFileTextEdits=function(e,t){return t.map((t=>({filePath:e,...t})))},t.convertToWorkspaceEdit=function(e,t,n,l="default"){return(0,r.isArray)(t)?function(e,t){const n={changes:{}};return p(e,t,n),n}(e,t):function(e,t,n,r="default"){const l={documentChanges:[],changeAnnotations:n};for(const n of t.fileOperations)switch(n.kind){case"create":l.documentChanges.push(s.CreateFile.create((0,i.convertPathToUri)(e,n.filePath),void 0,r));break;case"rename":case"delete":break;default:(0,o.assertNever)(n)}const c=(0,a.createMapFromItems)(t.edits,(e=>e.filePath));for(const[t,n]of c)l.documentChanges.push(s.TextDocumentEdit.create({uri:(0,i.convertPathToUri)(e,t),version:null},[...n.map((e=>({range:e.range,newText:e.replacementText,annotationId:r})))]));for(const n of t.fileOperations)switch(n.kind){case"create":break;case"rename":l.documentChanges.push(s.RenameFile.create((0,i.convertPathToUri)(e,n.oldFilePath),(0,i.convertPathToUri)(e,n.newFilePath),void 0,r));break;case"delete":l.documentChanges.push(s.DeleteFile.create((0,i.convertPathToUri)(e,n.filePath),void 0,r));break;default:(0,o.assertNever)(n)}return l}(e,t,n,l)},t.appendToWorkspaceEdit=p,t.applyTextEditsToString=function(e,t,n){const s=e.map((e=>{var s;return{range:null!==(s=(0,l.convertRangeToTextRange)(e.range,t))&&void 0!==s?s:{start:n.length,length:0},text:e.replacementText}})).sort(((e,t)=>{const n=t.range.start-e.range.start;return 0!==n?n:c.TextRange.getEnd(t.range)-c.TextRange.getEnd(e.range)}));let i=n;for(const e of s)i=i.substr(0,e.range.start)+e.text+i.substr(c.TextRange.getEnd(e.range));return i},t.applyWorkspaceEdit=function(e,t,n){if(t.changes)for(const s of Object.entries(t.changes)){const t=(0,i.convertUriToPath)(e.fs,s[0]),a=e.backgroundAnalysisProgram.program.getSourceFileInfo(t);a&&a.isTracked&&(d(e,a,s[1]),n.add(t))}if(t.documentChanges)for(const a of t.documentChanges)if(s.TextDocumentEdit.is(a)){const t=(0,i.convertUriToPath)(e.fs,a.textDocument.uri),s=e.backgroundAnalysisProgram.program.getSourceFileInfo(t);if(!s||!s.isTracked)continue;d(e,s,a.edits),n.add(t)}},t.applyDocumentChanges=d,t.generateWorkspaceEdit=function(e,t,n){var s;const a={changes:{}};for(const r of n){const n=e.backgroundAnalysisProgram.program.getBoundSourceFile(r),o=t.backgroundAnalysisProgram.program.getBoundSourceFile(r);if(!n||!o)continue;const c=n.getParseResults();c&&(a.changes[(0,i.convertPathToUri)(e.fs,r)]=[{range:(0,l.convertTextRangeToRange)(c.parseTree,c.tokenizerOutput.lines),newText:null!==(s=o.getFileContent())&&void 0!==s?s:""}])}return a}},8566:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.convertSymbolKindToCompletionItemKind=t.AutoImporter=t.buildModuleSymbolsMap=void 0;const r=n(4494),o=n(563),l=n(7012),c=n(6025),p=a(n(1766)),d=n(2917),u=n(3213),y=n(9489),m=n(6657),g=a(n(7559)),h=n(8718),f=n(9209);function T(e,t){return{forEach(n){e.symbols.forEach((e=>{e.externallyVisible&&n({importAlias:e.alias,kind:e.kind,itemKind:e.itemKind},e.name,t)}))}}}function v(e){switch(e){case r.SymbolKind.File:return r.CompletionItemKind.File;case r.SymbolKind.Module:case r.SymbolKind.Namespace:return r.CompletionItemKind.Module;case r.SymbolKind.Package:return r.CompletionItemKind.Folder;case r.SymbolKind.Class:return r.CompletionItemKind.Class;case r.SymbolKind.Method:return r.CompletionItemKind.Method;case r.SymbolKind.Property:return r.CompletionItemKind.Property;case r.SymbolKind.Field:return r.CompletionItemKind.Field;case r.SymbolKind.Constructor:return r.CompletionItemKind.Constructor;case r.SymbolKind.Enum:return r.CompletionItemKind.Enum;case r.SymbolKind.Interface:return r.CompletionItemKind.Interface;case r.SymbolKind.Function:return r.CompletionItemKind.Function;case r.SymbolKind.Variable:case r.SymbolKind.Array:return r.CompletionItemKind.Variable;case r.SymbolKind.String:return r.CompletionItemKind.Constant;case r.SymbolKind.Number:case r.SymbolKind.Boolean:return r.CompletionItemKind.Value;case r.SymbolKind.Constant:case r.SymbolKind.Null:return r.CompletionItemKind.Constant;case r.SymbolKind.Object:case r.SymbolKind.Key:return r.CompletionItemKind.Value;case r.SymbolKind.EnumMember:return r.CompletionItemKind.EnumMember;case r.SymbolKind.Struct:return r.CompletionItemKind.Struct;case r.SymbolKind.Event:return r.CompletionItemKind.Event;case r.SymbolKind.Operator:return r.CompletionItemKind.Operator;case r.SymbolKind.TypeParameter:return r.CompletionItemKind.TypeParameter;default:return}}t.buildModuleSymbolsMap=function(e,t,n){const s=new Map;return(0,u.throwIfCancellationRequested)(n),e.forEach((e=>{if(e.shadows.length>0)return;const n=e.sourceFile.getFilePath(),i=e.sourceFile.getModuleSymbolTable();if(i){const t=(0,m.stripFileExtension)((0,m.getFileName)(n));if(p.isPrivateOrProtectedName(t))return;return void s.set(n,{forEach(t){i.forEach(((n,s)=>{if(!(0,d.isVisibleExternally)(n))return;const i=n.getDeclarations();if(!i||0===i.length)return;const a=i[0];if(!a)return;if(8===a.type&&(0,c.isUserCode)(e))return;const o=1!==a.type||a.isConstant||a.isFinal?void 0:r.SymbolKind.Variable;t({symbol:n,kind:o},s,!(0,c.isUserCode)(e))}))}})}const a=e.sourceFile.getCachedIndexResults();a&&t&&!a.privateOrProtected&&s.set(n,T(a,!1))})),s},t.AutoImporter=class{constructor(e,t,n,s,i,a,r){this._execEnvironment=e,this._importResolver=t,this._parseResults=n,this._invocationPosition=s,this._excludes=i,this._moduleSymbolMap=a,this._options=r,this._stopWatch=new h.Duration,this._perfInfo={indexUsed:!1,totalInMs:0,moduleTimeInMS:0,indexTimeInMS:0,importAliasTimeInMS:0,symbolCount:0,indexCount:0,importAliasCount:0},this._filePath=(0,o.getFileInfo)(n.parseTree).filePath,this._importStatements=(0,l.getTopLevelImports)(this._parseResults.parseTree,!0),this._perfInfo.indexUsed=!!this._options.libraryMap}getAutoImportCandidatesForAbbr(e,t,n){const s=this._getCandidates(t.importName,1,e,n).get(t.importName);return s?s.filter((e=>e.source===t.importFrom)):[]}getAutoImportCandidates(e,t,n,s){const i=[];return this._getCandidates(e,t,n,s).forEach((e=>(0,y.appendArray)(i,e))),i}getPerfInfo(){return this._perfInfo.totalInMs=this._stopWatch.getDurationInMilliseconds(),this._perfInfo}_getCandidates(e,t,n,s){const i=new Map,a=new Map;return this._addImportsFromModuleMap(e,t,n,a,i,s),this._addImportsFromLibraryMap(e,t,n,a,i,s),this._addImportsFromImportAliasMap(a,n,i,s),i}_addImportsFromLibraryMap(e,t,n,s,i,a){var r;const o=this._stopWatch.getDurationInMilliseconds();null===(r=this._options.libraryMap)||void 0===r||r.forEach(((r,o)=>{if(r.privateOrProtected)return;if(this._moduleSymbolMap.has(o))return;const l=this._isStubFileOrHasInit(this._options.libraryMap,o);this._processModuleSymbolTable(T(r,!0),o,e,t,l,n,s,i,a)})),this._perfInfo.indexTimeInMS=this._stopWatch.getDurationInMilliseconds()-o}_addImportsFromModuleMap(e,t,n,s,i,a){const r=this._stopWatch.getDurationInMilliseconds();this._moduleSymbolMap.forEach(((r,o)=>{const l=this._isStubFileOrHasInit(this._moduleSymbolMap,o);this._processModuleSymbolTable(r,o,e,t,l,n,s,i,a)})),this._perfInfo.moduleTimeInMS=this._stopWatch.getDurationInMilliseconds()-r}_isStubFileOrHasInit(e,t){const n=(0,m.getDirectoryPath)(t),s=(0,m.combinePaths)(n,"__init__.py"),i=s+"i";return{isStub:t.endsWith(".pyi"),hasInit:e.has(s)||e.has(i)}}_processModuleSymbolTable(e,t,n,s,i,a,o,c,p){(0,u.throwIfCancellationRequested)(p);const[d,y,m]=this._getImportPartsForSymbols(t);if(!d)return;const h=g.getCharacterCount(d,".");if(e.forEach(((e,r,p)=>{var u;if(this._perfIndexCount(e,p),!this._shouldIncludeVariable(e,r,i.isStub,p))return;if(!this._isSimilar(n,r,s))return;if(this._containsName(r,d,c))return;if(e.importAlias)return void this._addToImportAliasMap(e.importAlias,{importParts:{symbolName:r,importName:r,importFrom:d,filePath:t,dotCount:h,moduleNameAndType:m},importGroup:y,symbol:e.symbol,kind:e.importAlias.kind,itemKind:e.importAlias.itemKind},o);const g="relative"!==this._options.importFormat||p?void 0:(0,l.getRelativeModuleName)(this._importResolver.fileSystem,this._filePath,t),f=this._getTextEditsForAutoImportByFilePath({name:r,alias:a},{name:d,nameForImportFrom:g},r,y,t);this._addResult(c,{name:r,alias:a,symbol:e.symbol,source:d,kind:null!==(u=e.itemKind)&&void 0!==u?u:v(e.kind),insertionText:f.insertionText,edits:f.edits})})),!i.isStub&&!i.hasInit)return;const f=this._getImportParts(t);f&&this._isSimilar(n,f.importName,s)&&(this._containsName(f.importName,f.importFrom,c)||this._addToImportAliasMap({modulePath:t,originalName:f.importName,kind:r.SymbolKind.Module,itemKind:r.CompletionItemKind.Module},{importParts:f,importGroup:y,kind:r.SymbolKind.Module,itemKind:r.CompletionItemKind.Module},o))}_shouldIncludeVariable(e,t,n,s){var i;return!(!n&&e.kind===r.SymbolKind.Variable)||!(!this._options.allowVariableInAll||s||!(null===(i=e.symbol)||void 0===i?void 0:i.isInDunderAll()))||p.isPublicConstantOrTypeAlias(t)}_addImportsFromImportAliasMap(e,t,n,s){(0,u.throwIfCancellationRequested)(s);const i=this._stopWatch.getDurationInMilliseconds();e.forEach((e=>{this._perfInfo.importAliasCount+=e.size,e.forEach((e=>{var s,i;if(t){if(this._importStatements.mapByFilePath.has(e.importParts.filePath))return;if(e.importParts.importFrom){const t=this._importStatements.orderedImports.find((t=>t.moduleName===e.importParts.importFrom));if(t&&22===t.node.nodeType&&t.node.imports.some((t=>t.name.value===e.importParts.symbolName)))return}}if(this._containsName(e.importParts.importName,e.importParts.importFrom,n))return;const a=this._getTextEditsForAutoImportByFilePath({name:e.importParts.symbolName,alias:t},{name:null!==(s=e.importParts.importFrom)&&void 0!==s?s:e.importParts.importName},e.importParts.importName,e.importGroup,e.importParts.filePath);this._addResult(n,{name:e.importParts.importName,alias:t,symbol:e.symbol,kind:null!==(i=e.itemKind)&&void 0!==i?i:v(e.kind),source:e.importParts.importFrom,insertionText:a.insertionText,edits:a.edits})}))})),this._perfInfo.importAliasTimeInMS=this._stopWatch.getDurationInMilliseconds()-i}_addToImportAliasMap(e,t,n){if(!n.has(e.modulePath)){const s=new Map;return s.set(e.originalName,t),void n.set(e.modulePath,s)}const s=n.get(e.modulePath);if(!s.has(e.originalName))return void s.set(e.originalName,t);const i=s.get(e.originalName);this._compareImportAliasData(i,t)<=0||s.set(e.originalName,t)}_compareImportAliasData(e,t){const n=e.importGroup-t.importGroup;if(0!==n)return n;const s=e.importParts.dotCount-t.importParts.dotCount;return 0!==s?s:e.symbol&&!t.symbol?-1:!e.symbol&&t.symbol?1:g.getStringComparer()(e.importParts.importName,t.importParts.importName)}_getImportPartsForSymbols(e){const t=this._importStatements.mapByFilePath.get(e);if(t)return[t.moduleName,(0,l.getImportGroup)(t),{importType:2,isLocalTypingsFile:!1,moduleName:t.moduleName}];{const t=this._getModuleNameAndTypeFromFilePath(e);return[t.moduleName,(0,l.getImportGroupFromModuleNameAndType)(t),t]}}_getImportParts(e){return function(t){const n=t.moduleName;if(!n)return;const s=n.lastIndexOf("."),i=s>0?n.substring(s+1):void 0,a=s>0?n.substring(0,s):void 0;return{symbolName:i,importName:null!=i?i:n,importFrom:a,filePath:e,dotCount:g.getCharacterCount(n,"."),moduleNameAndType:t}}("__init__"===(0,m.stripFileExtension)((0,m.getFileName)(e))?this._getModuleNameAndTypeFromFilePath((0,m.getDirectoryPath)(e)):this._getModuleNameAndTypeFromFilePath(e))}_isSimilar(e,t,n){if(1===n)return e===t;if(e.length<=0||t.length<=0)return!1;if(!this._options.patternMatcher){const n="_"!==e[0]&&"_"===t[0]&&t.length>1?1:0;return e[0].toLocaleLowerCase()===t[n].toLocaleLowerCase()&&g.isPatternInSymbol(e,t)}return this._options.patternMatcher(e,t)}_shouldExclude(e){return this._excludes.has(e,f.CompletionMap.labelOnlyIgnoringAutoImports)}_containsName(e,t,n){if(this._shouldExclude(e))return!0;const s=n.get(e);return!!(null==s?void 0:s.some((e=>e.source===t)))}_getModuleNameAndTypeFromFilePath(e){return this._importResolver.getModuleNameForImport(e,this._execEnvironment)}_getTextEditsForAutoImportByFilePath(e,t,n,s,i){var a,r,o,c,p,d,u,y,m;const g=this._importStatements.mapByFilePath.get(i);if(g){if(20===g.node.nodeType){const t=null===(r=null===(a=g.subnode)||void 0===a?void 0:a.alias)||void 0===r?void 0:r.value;if(e.name)return{insertionText:`${null!=t?t:g.moduleName}.${e.name}`,edits:[]};if(t)return{insertionText:`${t}`,edits:[]}}if(e.name&&22===g.node.nodeType&&!g.node.isWildcardImport){const s=g.node.imports.find((t=>t.name.value===e.name));if(s){const t=null===(o=s.alias)||void 0===o?void 0:o.value;return{insertionText:`${null!=t?t:e.name}`,edits:[]}}if(t.name===g.moduleName)return{insertionText:null!==(c=e.alias)&&void 0!==c?c:n,edits:this._options.lazyEdit?void 0:(0,l.getTextEditsForAutoImportSymbolAddition)(e,g,this._parseResults)}}}else if(e.name){const s=this._importStatements.orderedImports.find((e=>e.moduleName===t.name));if(s&&22===s.node.nodeType&&!s.node.isWildcardImport){const t=s.node.imports.find((t=>t.name.value===e.name));if(!t)return{insertionText:null!==(d=e.alias)&&void 0!==d?d:n,edits:this._options.lazyEdit?void 0:(0,l.getTextEditsForAutoImportSymbolAddition)(e,s,this._parseResults)};{const e=null===(p=t.alias)||void 0===p?void 0:p.value;if(e)return{insertionText:`${e}`,edits:[]}}}const a=null===(u=this._importStatements.implicitImports)||void 0===u?void 0:u.get(i);if(a){const t=null===(y=a.alias)||void 0===y?void 0:y.value;return{insertionText:`${null!=t?t:a.name.value}.${e.name}`,edits:[]}}}return{insertionText:null!==(m=e.alias)&&void 0!==m?m:n,edits:this._options.lazyEdit?void 0:(0,l.getTextEditsForAutoImportInsertion)(e,t,this._importStatements,s,this._parseResults,this._invocationPosition)}}_perfIndexCount(e,t){e.symbol?this._perfInfo.symbolCount++:t&&this._perfInfo.indexCount++}_addResult(e,t){let n=e.get(t.name);n||(n=[],e.set(t.name,n)),n.push(t)}},t.convertSymbolKindToCompletionItemKind=v},7087:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyProvider=void 0;const r=n(4494),o=a(n(5523)),l=a(n(8494)),c=n(427),p=n(1133),d=n(5168),u=n(3213),y=n(6657),m=n(1464),g=n(3550);t.CallHierarchyProvider=class{static getCallForDeclaration(e,t,n,s,i){if((0,u.throwIfCancellationRequested)(s),5===t.type||6===t.type||8===t.type){if(8===t.type){const e=n.resolveAliasDeclaration(t,!0);if(!e)return;if(5!==e.type&&6!==e.type)return}return{name:e,kind:T(t,n),uri:i,range:t.range,selectionRange:t.range}}}static getIncomingCallsForDeclaration(e,t,n,s,i,a){(0,u.throwIfCancellationRequested)(a);const r=new f(e,t,n,s,i,a).findCalls();return r.length>0?r:void 0}static getOutgoingCallsForDeclaration(e,t,n,s){var i;let a;if((0,u.throwIfCancellationRequested)(s),5===e.type)a=e.node;else if(6===e.type){const t=null===(i=n.getTypeForDeclaration(e))||void 0===i?void 0:i.type;if(t&&(0,p.isInstantiableClass)(t)){const e=(0,d.lookUpClassMember)(t,"__init__",14);if(e){const t=n.getTypeOfMember(e);if(t&&(0,p.isFunction)(t)){const t=e.symbol.getDeclarations();if(t&&t.length>0){const e=t[0];5===e.type&&(a=e.node)}}}}}if(!a)return;const r=new h(a,t,n,s).findCalls();return r.length>0?r:void 0}static getTargetDeclaration(e,t){const n=e.declarations,s=e.nodeAtOffset;let i,a,r=n[0];for(const e of n)if((o.hasTypeForDeclaration(e)||!o.hasTypeForDeclaration(r))&&(5===e.type||6===e.type)&&(r=e,e.node===s))break;return 8===r.type?(i=e.nodeAtOffset.value,a=t):(i=o.getNameFromDeclaration(r)||e.symbolNames[0],a=r.path),{targetDecl:r,callItemUri:a,symbolName:i}}};class h extends c.ParseTreeWalker{constructor(e,t,n,s){super(),this._parseRoot=e,this._parseResults=t,this._evaluator=n,this._cancellationToken=s,this._outgoingCalls=[]}findCalls(){return this.walk(this._parseRoot),this._outgoingCalls}visitCall(e){let t;if((0,u.throwIfCancellationRequested)(this._cancellationToken),38===e.leftExpression.nodeType?t=e.leftExpression:35===e.leftExpression.nodeType&&(t=e.leftExpression.memberName),t){const e=this._evaluator.getDeclarationsForNameNode(t);e&&e.forEach((e=>{this._addOutgoingCallForDeclaration(t,e)}))}return!0}visitMemberAccess(e){(0,u.throwIfCancellationRequested)(this._cancellationToken);const t=this._evaluator.getType(e.leftExpression);return t&&(0,d.doForEachSubtype)(t,(t=>{let n=t;if(n=this._evaluator.makeTopLevelTypeVarsConcrete(n),!(0,p.isClassInstance)(n))return;const s=(0,d.lookUpObjectMember)(n,e.memberName.value);if(!s)return;const i=this._evaluator.getTypeOfMember(s),a=s.symbol.getDeclarations();i&&(0,p.isClassInstance)(i)&&p.ClassType.isPropertyClass(i)&&a.forEach((t=>{this._addOutgoingCallForDeclaration(e.memberName,t)}))})),!0}_addOutgoingCallForDeclaration(e,t){const n=this._evaluator.resolveAliasDeclaration(t,!0);if(!n)return;if(5!==n.type&&6!==n.type)return;const s={name:e.value,kind:T(n,this._evaluator),uri:n.path,range:n.range,selectionRange:n.range};let i=this._outgoingCalls.find((e=>e.to.uri===s.uri&&(0,g.rangesAreEqual)(e.to.range,s.range)));i||(i={to:s,fromRanges:[]},this._outgoingCalls.push(i));const a=(0,m.convertOffsetsToRange)(e.start,e.start+e.length,this._parseResults.tokenizerOutput.lines);i.fromRanges.push(a)}}class f extends c.ParseTreeWalker{constructor(e,t,n,s,i,a){super(),this._filePath=e,this._symbolName=t,this._declaration=n,this._parseResults=s,this._evaluator=i,this._cancellationToken=a,this._incomingCalls=[]}findCalls(){return this.walk(this._parseResults.parseTree),this._incomingCalls}visitCall(e){let t;if((0,u.throwIfCancellationRequested)(this._cancellationToken),38===e.leftExpression.nodeType?t=e.leftExpression:35===e.leftExpression.nodeType&&(t=e.leftExpression.memberName),t&&t.value===this._symbolName){const e=this._evaluator.getDeclarationsForNameNode(t);if(e){const n=e.map((e=>this._evaluator.resolveAliasDeclaration(e,!0))).filter((e=>void 0!==e));if(8===this._declaration.type){const e=this._evaluator.resolveAliasDeclaration(this._declaration,!0);e&&n.some((t=>o.areDeclarationsSame(t,e)))&&this._addIncomingCallForDeclaration(t)}else n.some((e=>o.areDeclarationsSame(e,this._declaration)))&&this._addIncomingCallForDeclaration(t)}}return!0}visitMemberAccess(e){if((0,u.throwIfCancellationRequested)(this._cancellationToken),e.memberName.value===this._symbolName){const t=this._evaluator.getType(e.leftExpression);t&&(0,d.doForEachSubtype)(t,(t=>{let n=t;if(n=this._evaluator.makeTopLevelTypeVarsConcrete(n),!(0,p.isClassInstance)(n))return;const s=(0,d.lookUpObjectMember)(n,e.memberName.value);if(!s)return;const i=this._evaluator.getTypeOfMember(s),a=s.symbol.getDeclarations();i&&a.some((e=>o.areDeclarationsSame(e,this._declaration)))&&this._addIncomingCallForDeclaration(e.memberName)}))}return!0}_addIncomingCallForDeclaration(e){const t=l.getExecutionScopeNode(e);if(!t)return;let n;if(36===t.nodeType){const e=(0,m.convertOffsetsToRange)(0,0,this._parseResults.tokenizerOutput.lines),t=(0,y.getFileName)(this._filePath);n={name:`(module) ${t}`,kind:r.SymbolKind.Module,uri:this._filePath,range:e,selectionRange:e}}else if(30===t.nodeType){const e=(0,m.convertOffsetsToRange)(t.start,t.start+t.length,this._parseResults.tokenizerOutput.lines);n={name:"(lambda)",kind:r.SymbolKind.Function,uri:this._filePath,range:e,selectionRange:e}}else{const e=(0,m.convertOffsetsToRange)(t.name.start,t.name.start+t.name.length,this._parseResults.tokenizerOutput.lines);n={name:t.name.value,kind:r.SymbolKind.Function,uri:this._filePath,range:e,selectionRange:e}}let s=this._incomingCalls.find((e=>e.from.uri===n.uri&&(0,g.rangesAreEqual)(e.from.range,n.range)));s||(s={from:n,fromRanges:[]},this._incomingCalls.push(s));const i=(0,m.convertOffsetsToRange)(e.start,e.start+e.length,this._parseResults.tokenizerOutput.lines);s.fromRanges.push(i)}}function T(e,t){var n;let s;switch(e.type){case 6:case 7:s=r.SymbolKind.Class;break;case 5:if(e.isMethod){const i=null===(n=t.getTypeForDeclaration(e))||void 0===n?void 0:n.type;s=i&&(0,d.isMaybeDescriptorInstance)(i,!1)?r.SymbolKind.Property:r.SymbolKind.Method}else s=r.SymbolKind.Function;break;default:s=r.SymbolKind.Function}return s}},9209:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.CompletionMap=t.CompletionProvider=t.dictionaryKeyDetail=t.autoImportDetail=void 0;const r=n(4494),o=a(n(563)),l=n(8905),c=n(5523),p=n(1272),d=n(7848),u=a(n(8494)),y=n(8494),m=n(5083),g=n(8816),h=a(n(1766)),f=n(2917),T=n(9453),v=n(3371),_=n(3843),I=n(1133),b=n(5168),C=n(3213),S=n(9489),x=a(n(5839)),D=n(5839),F=n(1049),E=n(1464),P=n(6886),A=a(n(7559)),N=n(3550),k=n(3550),w=n(8718),M=n(8798),R=n(5275),O=n(8566),L=n(613),V=n(8127),U=n(3490);var z,B;!function(e){const t=["True","False","None","and","or","not","is","lambda","yield","assert","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","in","nonlocal","pass","raise","return","try","type","while","with"],n=[...t,"async","await"],s=[...n,"case","match"];e.forVersion=function(e){return e>=P.PythonVersion.V3_10?s:e>=P.PythonVersion.V3_5?n:t}}(z||(z={})),function(e){e[e.LikelyKeyword=0]="LikelyKeyword",e[e.RecentImportModuleName=1]="RecentImportModuleName",e[e.ImportModuleName=2]="ImportModuleName",e[e.LiteralValue=3]="LiteralValue",e[e.NamedParameter=4]="NamedParameter",e[e.RecentKeywordOrSymbol=5]="RecentKeywordOrSymbol",e[e.RecentAutoImport=6]="RecentAutoImport",e[e.Keyword=7]="Keyword",e[e.EnumMember=8]="EnumMember",e[e.NormalSymbol=9]="NormalSymbol",e[e.PrivateSymbol=10]="PrivateSymbol",e[e.DunderSymbol=11]="DunderSymbol",e[e.AutoImport=12]="AutoImport"}(B||(B={})),t.autoImportDetail="Auto-import",t.dictionaryKeyDetail="Dictionary key";class G{constructor(e,t,n,s,i,a,r,o,l,c,p,d,u){this._workspacePath=e,this._parseResults=t,this._fileContents=n,this._importResolver=s,this._position=i,this._filePath=a,this._configOptions=r,this._importLookup=o,this._evaluator=l,this._options=c,this._sourceMapper=p,this._autoImportMaps=d,this._cancellationToken=u,this._insideStringLiteral=void 0,this._execEnv=this._configOptions.findExecEnvironment(this._filePath)}getCompletionsForPosition(){var e,t;const n=(0,E.convertPositionToOffset)(this._position,this._parseResults.tokenizerOutput.lines);if(void 0===n)return;const s=u.getTokenOverlapping(this._parseResults.tokenizerOutput.tokens,n);if(5===(null==s?void 0:s.type)){const e=s;this._insideStringLiteral=k.TextRange.contains(e,n)||65536&e.flags?e:void 0}let i=u.findNodeByOffset(this._parseResults.parseTree,n);const a=i,r=i?u.getNodeDepth(i):0;if(!a||38!==a.nodeType){let t=n,s=!1;for(;t>=0;){t--;const n=this._fileContents.substr(t,1);if("("===n||"\n"===n||"}"===n)break;","===n&&(s=!0);const o=u.findNodeByOffset(this._parseResults.parseTree,t);if(o&&o!==a){u.getNodeDepth(o)>r&&(i=o,s&&23===(null===(e=i.parent)||void 0===e?void 0:e.nodeType)&&(i=i.parent));break}}}if(void 0===i)return;const o=this._parseResults.tokenizerOutput.lines.getItemAt(this._position.line),l=this._fileContents.substr(o.start,o.length),c=l.substr(0,this._position.character),p=l.substr(this._position.character),d=c.search(/\w+$/),y=d>=0?c.substr(d):"";if(this._isWithinComment(n))return;let m=i;for(;m&&0!==m.nodeType;)m=m.parent;let g=m||i;for(;;){if((0,C.throwIfCancellationRequested)(this._cancellationToken),49===g.nodeType)return this._getLiteralCompletions(g,n,y,c,p);if(48===g.nodeType||27===g.nodeType)return;if(37===g.nodeType)return this._getImportModuleCompletions(g);if(0===g.nodeType)return this._getExpressionErrorCompletions(g,n,y,c,p);if(35===g.nodeType)return this._getMemberAccessCompletions(g.leftExpression,y);if(15===g.nodeType){const e=new W;if(this._tryAddTypedDictKeysFromDictionary(g,void 0,y,c,p,e))return{completionMap:e}}const e=u.getFirstAncestorOrSelfOfKind(g,17);if(e&&15===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)){const t=e.parent;if(t.trailingCommaToken&&t.trailingCommaToken.start<n){const e=new W;if(this._tryAddTypedDictKeysFromDictionary(t,void 0,y,c,p,e))return{completionMap:e}}}if(38===g.nodeType){const e=this._tryGetNameCompletions(g,n,y,c,p);if(e||void 0===e)return e}if(31===g.nodeType&&"["===this._options.triggerCharacter)return;if(22===g.nodeType)return this._getImportFromCompletions(g,y);if((0,R.isExpressionNode)(g))return this._getExpressionCompletions(g,y,c,p);if(50===g.nodeType){if(g.parent&&25===g.parent.nodeType&&!g.parent.name&&g.parent.typeExpression&&k.TextRange.getEnd(g.parent.typeExpression)<n&&n<=g.parent.exceptSuite.start)return;if(g.parent&&10===g.parent.nodeType&&(!g.parent.name||!g.parent.name.value)&&0===g.parent.arguments.length&&n<=g.parent.suite.start)return;return this._getStatementCompletions(g,y,c,p)}if(36===g.nodeType)return this._getStatementCompletions(g,y,c,p);if(41===g.nodeType&&0===g.length&&g.parent&&30===g.parent.nodeType)return;if(!g.parent)break;g=g.parent}}resolveCompletionItem(e){(0,C.throwIfCancellationRequested)(this._cancellationToken);const t=(0,F.fromLSPAny)(e.data),n=e.label;let s="";t.autoImportText&&(s=t.autoImportText);const i=G._mostRecentCompletions.findIndex((e=>e.label===n&&e.autoImportText===s));if(i>0&&(G._mostRecentCompletions=G._mostRecentCompletions.splice(i,1)),0!==i&&G._mostRecentCompletions.unshift({label:n,autoImportText:s}),G._mostRecentCompletions.length>128&&G._mostRecentCompletions.pop(),t.symbolLabel)if(t.modulePath){const n=(0,v.getModuleDocStringFromPaths)([t.modulePath],this._sourceMapper);if(!n)return;if(this._options.format===r.MarkupKind.Markdown){const t=(0,p.convertDocStringToMarkdown)(n);e.documentation={kind:r.MarkupKind.Markdown,value:t}}else if(this._options.format===r.MarkupKind.PlainText){const t=(0,p.convertDocStringToPlainText)(n);e.documentation={kind:r.MarkupKind.PlainText,value:t}}}else if(this._itemToResolve=e,t.autoImportText){if(!e.additionalTextEdits){const e={completionMap:new W};this._addAutoImportCompletions(t.symbolLabel,1,!1,e)}}else this.getCompletionsForPosition()}_tryGetNameCompletions(e,t,n,s,i){var a,r,o;if(!e.parent)return!1;if(21!==e.parent.nodeType||e.parent.alias!==e){if(37===e.parent.nodeType){if(e.parent.parent&&21===e.parent.parent.nodeType&&!e.parent.parent.alias&&k.TextRange.getEnd(e.parent.parent)<t)return;return this._getImportModuleCompletions(e.parent)}if(23===e.parent.nodeType){if(e.parent.alias===e)return;const s=e.parent.parent;if(s&&22===s.nodeType){if(!e.parent.alias&&k.TextRange.getEnd(e.parent)<t)return;return e.parent.name===e?this._getImportFromCompletions(s,n):this._getImportFromCompletions(s,"")}return!1}if(35===e.parent.nodeType&&e===e.parent.memberName)return this._getMemberAccessCompletions(e.parent.leftExpression,n);if(25!==e.parent.nodeType||e!==e.parent.name){if(28===e.parent.nodeType&&e===e.parent.name)return(null===(a=e.parent.decorators)||void 0===a?void 0:a.some((e=>this._isOverload(e))))?this._getMethodOverloadsCompletions(n,e):void 0;if(!(41===e.parent.nodeType&&e===e.parent.name||10===e.parent.nodeType&&e===e.parent.name||26===e.parent.nodeType&&k.TextRange.contains(e.parent.targetExpression,e.start)||33===e.parent.nodeType&&k.TextRange.contains(e.parent.targetExpression,e.start))){if(3===e.parent.nodeType||4===e.parent.nodeType){if((4===e.parent.nodeType?e.parent.name:e.parent.leftExpression)!==e||0===n.length)return!1;const t=this._evaluator.getDeclarationsForNameNode(e);if(1!==(null==t?void 0:t.length)||!(0,l.isVariableDeclaration)(t[0])||t[0].node!==e)return!1;const a=this._getExpressionCompletions(e,n,s,i);return a&&a.completionMap.delete(e.value),a}if(47===e.parent.nodeType&&50===(null===(r=e.parent.parent)||void 0===r?void 0:r.nodeType)&&10===(null===(o=e.parent.parent.parent)||void 0===o?void 0:o.nodeType)){const t=this._getClassVariableCompletions(e);if(t)return t}return!1}}}}_isWithinComment(e){var t,n;const s=function(e,t){const n=t.getItemAtPosition(e);if(n<0)return;let s=t.getItemAt(n);if(!(e>s.start&&e<s.start+s.length)){for(let e=n-1;e>=0;e--){const n=t.getItemAt(e);if(s.start!==n.start)break;s=n}return e<=s.start?s:(x.assert(n+1<t.length),t.getItemAt(n+1))}}(e,this._parseResults.tokenizerOutput.tokens);return!!s&&null!==(n=null===(t=s.comments)||void 0===t?void 0:t.some((t=>k.TextRange.overlaps(t,e))))&&void 0!==n&&n}_getExpressionErrorCompletions(e,t,n,s,i){var a;switch(e.category){case 0:return this._createSingleKeywordCompletion("in");case 1:return this._createSingleKeywordCompletion("else");case 7:case 2:{const t=this._parseResults.tokenizerOutput,a=(0,E.convertPositionToOffset)(this._position,t.lines),r=u.getTokenIndexAtLeft(t.tokens,a),o=u.getTokenAtIndex(t.tokens,r),l=u.getTokenAtIndex(t.tokens,r-1);if(2===e.category){if(20===(null==o?void 0:o.type)||19===(null==o?void 0:o.type))break;if(8!==(null==o?void 0:o.type)||k.TextRange.getEnd(o)!==a)return this._getExpressionCompletions(e,n,s,i);if(20!==(null==l?void 0:l.type))return this._getExpressionCompletions(e,n,s,i);const t=k.TextRange.getEnd(l),r=u.findNodeByOffset(this._parseResults.parseTree,t);if(0!==(null==r?void 0:r.nodeType)||7!==r.category)return this._getExpressionCompletions(e,n,s,i);e=r}else if(7===e.category&&!(20!==(null==o?void 0:o.type)&&19!==(null==o?void 0:o.type)||20!==(null==l?void 0:l.type)&&19!==(null==l?void 0:l.type)))return;return this._getMissingMemberAccessNameCompletions(e,n)}case 4:return this._getExpressionCompletions(e,n,s,i);case 11:case 3:{let a=this._getLiteralCompletions(e,t,n,s,i);return a||(a=this._getExpressionCompletions(e,n,s,i)),a}case 10:if(e.child&&38===e.child.nodeType)return(null===(a=e.decorators)||void 0===a?void 0:a.some((e=>this._isOverload(e))))?this._getMethodOverloadsCompletions(n,e.child):this._getMethodOverrideCompletions(n,e.child,e.decorators)}}_getMissingMemberAccessNameCompletions(e,t){if(e.child&&(0,R.isExpressionNode)(e.child))return this._getMemberAccessCompletions(e.child,t)}_isOverload(e){return this._checkDecorator(e,"overload")}_checkDecorator(e,t){return 38===e.expression.nodeType&&e.expression.value===t}_createSingleKeywordCompletion(e){const t=r.CompletionItem.create(e);t.kind=r.CompletionItemKind.Keyword,t.sortText=this._makeSortText(B.LikelyKeyword,e);const n=new W;return n.set(t),{completionMap:n}}_addClassVariableTypeAnnotationCompletions(e,t,n){var s,i,a,o;if(54!==(null===(s=t.parent)||void 0===s?void 0:s.nodeType)||38!==t.parent.valueExpression.nodeType||t.parent.typeAnnotation!==t||47!==(null===(i=t.parent.parent)||void 0===i?void 0:i.nodeType)||50!==(null===(a=t.parent.parent.parent)||void 0===a?void 0:a.nodeType)||10!==(null===(o=t.parent.parent.parent.parent)||void 0===o?void 0:o.nodeType))return;const c=u.getEnclosingClass(t,!1);if(!c)return;const p=this._evaluator.getTypeOfClass(c);if(!p)return;const d=t.parent.valueExpression.value,y=(0,b.lookUpClassMember)(p.classType,d,9);if(y){const t=this._evaluator.getTypeOfMember(y),s=this._evaluator.printType(t,{enforcePythonSyntax:!0,expandTypeAlias:!1});return void this._addNameToCompletions(s,r.CompletionItemKind.Reference,e,n,{sortText:this._makeSortText(B.LikelyKeyword,s)})}const m=new Map;for(const e of p.classType.details.mro)e!==p.classType&&(0,I.isInstantiableClass)(e)&&(0,b.getMembersForClass)(e,m,!1);const h=m.get(d);if(!h)return;const f=h.getDeclarations().filter((e=>(0,l.isVariableDeclaration)(e)&&"builtins"!==e.moduleName));if(0===f.length||f.some((e=>e.node&&u.getEnclosingClass(e.node,!1)===c)))return;const T=f.filter((e=>e.typeAnnotationNode));if(0===T.length)return;const v=(0,g.isStubFile)(this._filePath)?3:2,_=`${u.printExpression(T[T.length-1].typeAnnotationNode,v)}`;this._addNameToCompletions(_,r.CompletionItemKind.Reference,e,n,{sortText:this._makeSortText(B.LikelyKeyword,_)})}_getClassVariableCompletions(e){const t=u.getEnclosingClass(e,!1);if(!t)return;const n=this._evaluator.getTypeOfClass(t);if(!n)return;const s=new Map;for(const e of n.classType.details.mro)(0,I.isInstantiableClass)(e)&&(0,b.getMembersForClass)(e,s,!1);const i=new W;return s.forEach(((n,s)=>{if(h.isPrivateName(s)||n.isPrivateMember()||n.isExternallyHidden()||!A.isPatternInSymbol(e.value,s))return;const a=n.getDeclarations().filter((e=>(0,l.isVariableDeclaration)(e)&&"builtins"!==e.moduleName));0===a.length||a.some((e=>e.node&&u.getEnclosingClass(e.node,!1)===t))||this._addSymbol(s,n,e.value,i,{})})),i.size>0?{completionMap:i}:void 0}_getMethodOverloadsCompletions(e,t){var n;const s=function(e,t){const n=u.getEnclosingClass(t,!1);if(n){const t=e.getTypeOfClass(n);if(!t)return;const s=new Map;for(const e of t.classType.details.mro)(0,I.isInstantiableClass)(e)&&(0,b.getMembersForClass)(e,s,!1);return s}const s=u.getEnclosingModule(t);if(s){const e=o.getScope(s);return null==e?void 0:e.symbolTable}}(this._evaluator,t);if(!s)return;const i=28===(null===(n=t.parent)||void 0===n?void 0:n.nodeType)||void 0,a=new W,r=u.getEnclosingFunction(t);return s.forEach(((n,s)=>{const o=(0,f.getLastTypedDeclaredForSymbol)(n);if(!o||5!==o.type)return;if(!o.node.decorators.some((e=>this._isOverload(e))))return;const l=n.getDeclarations();if((1!==l.length||!l.some((e=>e.node===r)))&&A.isPatternInSymbol(t.value,s)){const r=this._createReplaceEdits(e,t,o.node.name.value);this._addSymbol(s,n,t.value,a,{funcParensDisabled:i,edits:{textEdit:r}})}})),{completionMap:a}}_getMethodOverrideCompletions(e,t,n){var s,i;const a=u.getEnclosingClass(t,!0);if(!a)return;const o=this._evaluator.getTypeOfClass(a);if(!o)return;const l=new Map;for(let e=1;e<o.classType.details.mro.length;e++){const t=o.classType.details.mro[e];(0,I.isInstantiableClass)(t)&&(0,b.getMembersForClass)(t,l,!1)}const c=null!==(s=null==n?void 0:n.some((e=>this._checkDecorator(e,"staticmethod"))))&&void 0!==s&&s,p=null!==(i=null==n?void 0:n.some((e=>this._checkDecorator(e,"classmethod"))))&&void 0!==i&&i,d=new W;return l.forEach(((n,s)=>{var i;let a=(0,f.getLastTypedDeclaredForSymbol)(n);if(a&&5===a.type&&A.isPatternInSymbol(t.value,s)){const l=null===(i=this._evaluator.getTypeForDeclaration(a))||void 0===i?void 0:i.type;if(!l)return;let u=(0,I.isClassInstance)(l)&&I.ClassType.isPropertyClass(l);if(h.isDunderName(s)&&(u=!1),!(0,I.isFunction)(l)&&!u)return;if(u){const e=n.getTypedDeclarations();e.length>0&&5===e[0].type&&(a=e[0])}const y=(0,I.isFunction)(l)&&I.FunctionType.isStaticMethod(l),m=(0,I.isFunction)(l)&&I.FunctionType.isClassMethod(l)&&"__init_subclass__"!==s;if(c!==y||p!==m)return;const f=this._printMethodSignature(o.classType,a);let T;T=(0,g.isStubFile)(this._filePath)?`${f}: ...`:`${f}:\n${this._printOverriddenMethodBody(o.classType,y,u,a)}`;const v=this._createReplaceEdits(e,t,T);this._addSymbol(s,n,t.value,d,{funcParensDisabled:!0,edits:{format:this._options.snippet?r.InsertTextFormat.Snippet:void 0,textEdit:v}})}})),{completionMap:d}}_createReplaceEdits(e,t,n){const s=38===(null==t?void 0:t.nodeType)?this._position.character-e.length+t.value.length:this._position.character,i={start:{line:this._position.line,character:this._position.character-e.length},end:{line:this._position.line,character:s}};return r.TextEdit.replace(i,n)}_printMethodSignature(e,t){const n=t.node;let s;(0,g.isStubFile)(this._filePath)?s=!0:e.details.moduleName===t.moduleName&&(s=!1);const i=(0,g.isStubFile)(this._filePath)?3:2,a=n.parameters.map(((e,t)=>{let a="";1===e.category?a+="*":2===e.category&&(a+="**"),e.name&&(a+=e.name.value);const r=u.getTypeAnnotationForParameter(n,t);return r&&(a+=": "+u.printExpression(r,i)),e.defaultValue&&(a+=r?" = ":"=",a+=(null!=s?s:!o(e.defaultValue))?"...":u.printExpression(e.defaultValue,i)),a||e.name||0!==e.category?a:"/"})).join(", ");let r=n.name.value+"("+a+")";return n.returnTypeAnnotation?r+=" -> "+u.printExpression(n.returnTypeAnnotation,i):n.functionAnnotationComment&&(r+=" -> "+u.printExpression(n.functionAnnotationComment.returnTypeAnnotation,i)),r;function o(e){switch(e.nodeType){case 40:case 11:case 35:return!0;case 49:return 0==(64&e.token.flags);case 48:return e.strings.every(o);case 55:return o(e.expression);case 7:return o(e.leftExpression)&&o(e.rightExpression);default:return!1}}}_printOverriddenMethodBody(e,t,n,s){let i=this._parseResults.tokenizerOutput.predominantTabSequence;if(1===e.details.baseClasses.length&&(0,I.isClass)(e.details.baseClasses[0])&&"builtins.object"===e.details.baseClasses[0].details.fullName)return i+=this._options.snippet?"${0:pass}":"pass",i;if(0===s.node.parameters.length)return i+=this._options.snippet?"${0:pass}":"pass",i;const a=function(e){const t=[];let n=!1;for(const s of e)s.name&&t.push([s,0===s.category&&!!s.name&&n]),1===s.category&&(n=!0);return t}(t?s.node.parameters:s.node.parameters.slice(1));return"__init__"!==s.node.name.value&&(i+="return "),s.node.isAsync&&(i+="await "),n?i+`super().${s.node.name.value}`:i+`super().${s.node.name.value}(${a.map((function(e){var t;const n=null===(t=e[0].name)||void 0===t?void 0:t.value;return 1===e[0].category?`*${n}`:2===e[0].category?`**${n}`:e[1]?`${n}=${n}`:n})).join(", ")})`}_getMemberAccessCompletions(e,t){const n=new Map,s=new W;let i={},a=this._evaluator.getType(e);return a&&(a=this._evaluator.makeTopLevelTypeVarsConcrete(a),(0,I.isUnknown)(a)&&a.possibleType&&(a=this._evaluator.makeTopLevelTypeVarsConcrete(a.possibleType)),(0,b.doForEachSubtype)(a,(i=>{if(i=this._evaluator.makeTopLevelTypeVarsConcrete(i),(0,I.isClass)(i))(0,b.getMembersForClass)(i,n,I.TypeBase.isInstance(i));else if((0,I.isModule)(i))(0,b.getMembersForModule)(i,n);else if((0,I.isFunction)(i)||(0,I.isOverloadedFunction)(i)){const t=this._evaluator.getBuiltInType(e,"function");t&&(0,I.isInstantiableClass)(t)&&(0,b.getMembersForClass)(t,n,!0)}else if((0,I.isNoneInstance)(i)){const t=this._evaluator.getBuiltInType(e,"object");t&&(0,I.isInstantiableClass)(t)&&(0,b.getMembersForClass)(t,n,I.TypeBase.isInstance(i))}this._addSymbolsForSymbolTable(n,(()=>!0),t,e,!1,(0,I.isClass)(i)?i:void 0,s)}))),i=this._getLastKnownModule(e,a),{completionMap:s,memberAccessInfo:i}}_getLastKnownModule(e,t){var n;let s=e,i=t,a=35===e.nodeType?null==e?void 0:e.memberName.value:void 0;for(;s&&(9===s.nodeType||35===s.nodeType)&&(s=s.leftExpression,void 0===a&&(a=35===s.nodeType&&null!==(n=null==s?void 0:s.memberName.value)&&void 0!==n?n:""),!s||(i=this._evaluator.getType(s),void 0===i||(0,I.isUnknown)(i)||(0,I.isUnbound)(i))););const r={};if(i&&!(0,I.isUnknown)(i)&&!(0,I.isUnbound)(i)&&s){const e=(0,b.getDeclaringModulesForType)(i);r.lastKnownModule=e.find((e=>"typing"!==e)),35===s.nodeType?r.lastKnownMemberName=s.memberName.value:(38===s.nodeType&&(0,I.isInstantiableClass)(i)||38===s.nodeType&&(0,I.isClassInstance)(i))&&(r.lastKnownMemberName=i.details.name),r.unknownMemberName=a}return r}_getStatementCompletions(e,t,n,s){return this._getExpressionCompletions(e,t,n,s)}_getExpressionCompletions(e,t,n,s){var i,a;if(!this._isIndexArgument(e)&&40===e.nodeType)return;if(59===(null===(i=e.parent)||void 0===i?void 0:i.nodeType)&&e.parent===(null===(a=e.parent.target)||void 0===a?void 0:a.parent))return;const o=new W,l={completionMap:o};return".."===n.slice(-2)||(this._addClassVariableTypeAnnotationCompletions(t,e,o),this._addCallArgumentCompletions(e,t,n,s,!1,o),this._addSymbols(e,t,o),this._findMatchingKeywords(z.forVersion(this._execEnv.pythonVersion),t).map((e=>{if(o.has(e))return;const t=r.CompletionItem.create(e);t.kind=r.CompletionItemKind.Keyword,t.sortText=this._makeSortText(B.Keyword,e),o.set(t)})),t.startsWith("_")||this._itemToResolve||this._addAutoImportCompletions(t,.25,this._options.lazyEdit,l),this._tryAddLiterals(e,t,n,s,o)),l}_isIndexArgument(e){const t=e.parent;return t&&1===t.nodeType&&0===t.argumentCategory&&t.parent&&24===t.parent.nodeType&&t.parent.baseExpression&&38===t.parent.baseExpression.nodeType}_addCallArgumentCompletions(e,t,n,s,i,a){const r=(0,E.convertPositionToOffset)(this._position,this._parseResults.tokenizerOutput.lines),o=(0,y.getCallNodeAndActiveParameterIndex)(e,r,this._parseResults.tokenizerOutput.tokens);if(!o)return;const l=this._evaluator.getCallSignatureInfo(o.callNode,o.activeIndex,o.activeOrFake);if(l){const e=(0,E.convertOffsetToPosition)(l.callNode.leftExpression.start+l.callNode.leftExpression.length,this._parseResults.tokenizerOutput.lines);(0,N.comparePositions)(this._position,e)>0&&(i||this._addNamedParameters(l,t,a),this._addLiteralValuesForArgument(l,t,n,s,a))}}_addLiteralValuesForArgument(e,t,n,s,i){e.signatures.forEach((e=>{if(!e.activeParam)return;const a=e.type,r=a.details.parameters.indexOf(e.activeParam);if(r<0)return;const o=a.details.parameters[r].type;this._addLiteralValuesForTargetType(o,t,n,s,i)}))}_addLiteralValuesForTargetType(e,t,n,s,i){const a=this._getQuoteInfo(t,n);this._getSubTypesWithLiteralValues(e).forEach((e=>{if(I.ClassType.isBuiltIn(e,"str")){const n=(0,_.printLiteralValue)(e,a.quoteCharacter);void 0===a.stringValue?this._addNameToCompletions(n,r.CompletionItemKind.Constant,t,i,{sortText:this._makeSortText(B.LiteralValue,e.literalValue)}):this._addStringLiteralToCompletions(n.substr(1,n.length-2),a,s,i)}}))}_getDictExpressionStringKeys(e,t){const n=function(e){if(15===e.nodeType)return e;let t=e;for(;t&&15!==t.nodeType&&45!==t.nodeType;)if(t=t.parent,!t)return;return t}(e);return n?n.entries.flatMap((e=>17!==e.nodeType||(null==t?void 0:t.has(e.keyExpression.id))?[]:48===e.keyExpression.nodeType?[e.keyExpression.strings.map((e=>e.value)).join("")]:[])):[]}_getSubTypesWithLiteralValues(e){const t=[];return(0,b.doForEachSubtype)(e,(e=>{(0,I.isClassInstance)(e)&&(0,b.isLiteralType)(e)&&t.push(e)})),t}_getIndexerKeyType(e){var t,n;if((I.ClassType.isBuiltIn(e,"dict")||I.ClassType.isBuiltIn(e,"Mapping"))&&2===(null===(t=e.typeArguments)||void 0===t?void 0:t.length))return e.typeArguments[0];const s=(0,b.lookUpObjectMember)(e,"__getitem__");if(null==s?void 0:s.symbol.hasDeclarations()){const e=s.symbol.getDeclarations()[0];if((0,l.isFunctionDeclaration)(e)&&e.isMethod){const t=null===(n=this._evaluator.getTypeForDeclaration(e))||void 0===n?void 0:n.type;if(t&&(0,I.isFunction)(t)&&2===t.details.parameters.length)return t.details.parameters[1].type}}}_getIndexerKeys(e,t){var n,s,i,a,r,o,l,c,p;const d=this._evaluator.getType(e.baseExpression);if(!d||!(0,I.isClassInstance)(d))return[];const y=this._getIndexerKeyType(d);if(y){const e=[];if(this._getSubTypesWithLiteralValues(y).forEach((t=>{(I.ClassType.isBuiltIn(t,"str")||I.ClassType.isBuiltIn(t,"int")||I.ClassType.isBuiltIn(t,"bool")||I.ClassType.isBuiltIn(t,"bytes")||I.ClassType.isEnumClass(t))&&e.push((0,_.printLiteralValue)(t,this._parseResults.tokenizerOutput.predominantSingleQuoteCharacter))})),e.length>0)return e}if(38!==e.baseExpression.nodeType)return[];const m=null!==(n=this._evaluator.getDeclarationsForNameNode(e.baseExpression))&&void 0!==n?n:[],g=m.length>0?m[0]:void 0;if(!g||1!==g.type&&2!==g.type)return[];if(g.path!==this._filePath)return[];let h=e.baseExpression;if(g.node){const e=u.getEvaluationScopeNode(g.node);(null===(s=u.getFileInfoFromNode(h))||void 0===s?void 0:s.filePath)===(null===(i=u.getFileInfoFromNode(e))||void 0===i?void 0:i.filePath)&&(h=e)}const f=V.DocumentSymbolCollector.collectFromNode(e.baseExpression,this._evaluator,this._cancellationToken,h),T=new Set;for(const e of f){const n=54===(null===(a=e.node.parent)||void 0===a?void 0:a.nodeType)?e.node.parent:e.node;if(3===(null===(r=n.parent)||void 0===r?void 0:r.nodeType)||4===(null===(o=n.parent)||void 0===o?void 0:o.nodeType)){if(15===n.parent.rightExpression.nodeType){const e=n.parent.rightExpression;for(const t of e.entries.filter((e=>17===e.nodeType))){const e=this._parseResults.text.substr(t.keyExpression.start,t.keyExpression.length).trim();e.length>0&&T.add(e)}}if(9===n.parent.rightExpression.nodeType){const e=n.parent.rightExpression,t=this._evaluator.getType(e.leftExpression);if(!t||!(0,I.isInstantiableClass)(t)||!I.ClassType.isBuiltIn(t,"dict"))continue;for(const t of e.arguments){const e=null!==(c=null===(l=t.name)||void 0===l?void 0:l.value.trim())&&void 0!==c?c:"",n=this._parseResults.tokenizerOutput.predominantSingleQuoteCharacter;e.length>0&&T.add(`${n}${e}${n}`)}}}if(24===(null===(p=n.parent)||void 0===p?void 0:p.nodeType)&&1===n.parent.items.length&&0!==n.parent.items[0].valueExpression.nodeType&&!k.TextRange.containsRange(n.parent,t)){const e=n.parent.items[0],t=this._parseResults.text.substr(e.valueExpression.start,e.valueExpression.length).trim();t.length>0&&T.add(t)}}return[...T]}_getLiteralCompletions(e,t,n,s,i){if(('"'===this._options.triggerCharacter||"'"===this._options.triggerCharacter)&&e.start!==t-1)return;const a=new W;return this._tryAddLiterals(e,n,s,i,a)?{completionMap:a}:void 0}_tryAddLiterals(e,n,s,i,a){var o,l,c,p,d,u;const y=function(e){var t;if(e.parent){if(49!==e.nodeType)return{parent:e.parent,child:e};if(e.parent.parent&&!(48!==(null===(t=e.parent)||void 0===t?void 0:t.nodeType)||e.parent.strings.length>1))return{parent:e.parent.parent,child:e.parent}}}(e);if(!y)return!1;const m=3===y.parent.nodeType?y.parent.rightExpression===y.child?y.child:void 0:(0,R.isExpressionNode)(y.child)?y.child:void 0;if(m){const e=this._evaluator.getExpectedType(m);if(e&&(0,b.isLiteralTypeOrUnion)(e.type))return this._addLiteralValuesForTargetType(e.type,n,s,i,a),!0}const g=y.parent;if(g){let t;if(17===g.nodeType&&g.keyExpression===y.child&&15===(null===(o=g.parent)||void 0===o?void 0:o.nodeType)?t=g.parent:45===(null==g?void 0:g.nodeType)&&(t=g),t&&this._tryAddTypedDictKeysFromDictionary(t,49===e.nodeType?e:void 0,n,s,i,a))return!0}const h=y.parent;if(1===h.nodeType&&24===(null===(l=h.parent)||void 0===l?void 0:l.nodeType)){const o=49===e.nodeType?s:"";if(this._tryAddTypedDictKeysFromIndexer(h.parent,n,o,i,a))return!0;const l=this._getQuoteInfo(n,o),c=this._getIndexerKeys(h.parent,e);let p=!1;for(const s of c){if(a.has(s))continue;const o=/^["|'].*["|']$/.test(s);if(49!==e.nodeType||o)if(p=!0,o){const e=s.substr(1,s.length-2);this._addStringLiteralToCompletions(e,l,i,a,t.dictionaryKeyDetail)}else this._addNameToCompletions(s,r.CompletionItemKind.Constant,n,a,{sortText:this._makeSortText(B.LiteralValue,s),itemDetail:t.dictionaryKeyDetail})}if(p)return!0}const f=y.parent;if(7===f.nodeType&&[2,12,28].includes(f.operator)){const e=this._evaluator.getType(f.leftExpression);if(e&&(0,b.isLiteralTypeOrUnion)(e))return this._addLiteralValuesForTargetType(e,n,s,i,a),!0}const T=y.parent;if(4===T.nodeType&&T.rightExpression===y.child){const e=this._evaluator.getType(T.name);if(e&&(0,b.isLiteralTypeOrUnion)(e))return this._addLiteralValuesForTargetType(e,n,s,i,a),!0}const v=y.parent;if(64===v.nodeType&&0===v.pattern.nodeType&&11===v.pattern.category&&v.suite===y.child&&63===(null===(c=v.parent)||void 0===c?void 0:c.nodeType)){const e=this._evaluator.getType(v.parent.subjectExpression);if(e&&(0,b.isLiteralTypeOrUnion)(e))return this._addLiteralValuesForTargetType(e,n,s,i,a),!0}const _=y.parent;if((67===_.nodeType||69===_.nodeType)&&66===(null===(p=_.parent)||void 0===p?void 0:p.nodeType)&&64===(null===(d=_.parent.parent)||void 0===d?void 0:d.nodeType)&&63===(null===(u=_.parent.parent.parent)||void 0===u?void 0:u.nodeType)){const e=this._evaluator.getType(_.parent.parent.parent.subjectExpression);if(e&&(0,b.isLiteralTypeOrUnion)(e))return this._addLiteralValuesForTargetType(e,n,s,i,a),!0}if(49===e.nodeType){const t=(0,E.convertPositionToOffset)(this._position,this._parseResults.tokenizerOutput.lines),r=e.parent.start<t&&t<k.TextRange.getEnd(e);return this._addCallArgumentCompletions(e,n,s,i,r,a),!0}return!1}_tryAddTypedDictKeys(e,t,n,s,i,a){let r=[];if((0,b.doForEachSubtype)(e,(e=>{(0,I.isClassInstance)(e)&&I.ClassType.isTypedDictClass(e)&&r.push(e)})),0===r.length)return!1;r=this._tryNarrowTypedDicts(r,t);const o=this._getQuoteInfo(n,s),l=new Set(t);return r.forEach((e=>{(0,T.getTypedDictMembersForClass)(this._evaluator,e,!0).forEach(((e,t)=>{l.has(t)||a.has(t)||(l.add(t),this._addStringLiteralToCompletions(t,o,i,a))}))})),!0}_tryAddTypedDictKeysFromDictionary(e,t,n,s,i,a){var r;const o=this._evaluator.getExpectedType(e);if(!o)return!1;if(u.getNodeDepth(o.node)<u.getNodeDepth(e))return!1;const l=this._getDictExpressionStringKeys(e,t?new Set([null===(r=t.parent)||void 0===r?void 0:r.id]):void 0);return this._tryAddTypedDictKeys(o.type,l,n,s,i,a)}_tryNarrowTypedDicts(e,t){const n=e.flatMap((e=>{const n=(0,T.getTypedDictMembersForClass)(this._evaluator,e,!0);for(let e=0;e<t.length;e++)if(!n.has(t[e]))return[];return[e]}));return 0===n.length?e:n}_getQuoteInfo(e,t){let n,s=e,i=this._parseResults.tokenizerOutput.predominantSingleQuoteCharacter;if(!this._insideStringLiteral)return{priorWord:e,priorText:t,filterText:s,stringValue:n,quoteCharacter:i};if(void 0!==t){const e=t.lastIndexOf("'"),s=t.lastIndexOf('"');e>s?(n=t.substr(e+1),i="'"):s>e&&(n=t.substr(s+1),i='"')}return 64&this._insideStringLiteral.flags&&(i=1&this._insideStringLiteral.flags?'"':"'"),n&&(s=n),{priorWord:e,priorText:t,filterText:s,stringValue:n,quoteCharacter:i}}_tryAddTypedDictKeysFromIndexer(e,t,n,s,i){if(!e)return!1;const a=this._evaluator.getType(e.baseExpression);return!!a&&this._tryAddTypedDictKeys(a,[],t,n,s,i)}_addStringLiteralToCompletions(e,t,n,s,i){if(A.isPatternInSymbol(t.filterText||"",e)){const a=`${t.quoteCharacter}${e}${t.quoteCharacter}`;if(s.has(a))return;const o=r.CompletionItem.create(a);o.kind=r.CompletionItemKind.Constant,o.sortText=this._makeSortText(B.LiteralValue,a);let l=this._position.character;void 0!==t.stringValue?l-=t.stringValue.length+1:t.priorWord&&(l-=t.priorWord.length);let c=this._position.character;void 0!==n&&n.startsWith(t.quoteCharacter)&&c++;const p={start:{line:this._position.line,character:l},end:{line:this._position.line,character:c}};o.textEdit=r.TextEdit.replace(p,a),o.detail=i,s.set(o)}}_addAutoImportCompletions(e,t,n,s){var i,a,o;if(!this._configOptions.autoImportCompletions||!this._options.autoImport)return;const l=this._autoImportMaps.getModuleSymbolsMap(),c=new O.AutoImporter(this._execEnv,this._importResolver,this._parseResults,this._position,s.completionMap,l,{libraryMap:this._autoImportMaps.libraryMap,lazyEdit:n,importFormat:this._options.importFormat}),p=[],d=null===(i=this._autoImportMaps.nameMap)||void 0===i?void 0:i.get(e);d&&e.length>1&&!s.completionMap.has(e)&&(0,S.appendArray)(p,c.getAutoImportCandidatesForAbbr(e,d,this._cancellationToken)),p.push(...c.getAutoImportCandidates(e,t,void 0,this._cancellationToken));const u=c.getPerfInfo(),y=new w.Duration;for(const t of p)t.symbol?this._addSymbol(t.name,t.symbol,e,s.completionMap,{extraCommitChars:!0,autoImportSource:t.source,autoImportAlias:t.alias,edits:{textEdit:this._createReplaceEdits(e,void 0,t.insertionText),additionalTextEdits:t.edits}}):this._addNameToCompletions(null!==(a=t.alias)&&void 0!==a?a:t.name,null!==(o=t.kind)&&void 0!==o?o:r.CompletionItemKind.Module,e,s.completionMap,{extraCommitChars:!0,autoImportText:this._getAutoImportText(t.name,t.source,t.alias),edits:{textEdit:this._createReplaceEdits(e,void 0,t.insertionText),additionalTextEdits:t.edits}});s.autoImportInfo={indexUsed:u.indexUsed,totalTimeInMS:u.totalInMs,moduleTimeInMS:u.moduleTimeInMS,indexTimeInMS:u.indexTimeInMS,importAliasTimeInMS:u.importAliasTimeInMS,itemCount:p.length,symbolCount:u.symbolCount,indexCount:u.indexCount,importAliasCount:u.importAliasCount,additionTimeInMS:y.getDurationInMilliseconds()}}_getImportFromCompletions(e,t){if(e.isWildcardImport)return;const n=o.getImportInfo(e.module);if(!n)return;const s=new W,i=n.resolvedPaths.length>0?n.resolvedPaths[n.resolvedPaths.length-1]:"",a=this._importLookup(i);return a&&this._addSymbolsForSymbolTable(a.symbolTable,((t,n)=>t.getDeclarations().some((e=>!(0,l.isIntrinsicDeclaration)(e)))&&!e.imports.find((e=>e.name.value===n))),t,e,!0,void 0,s),n.implicitImports.forEach((n=>{e.imports.find((e=>e.name.value===n.name))||this._addNameToCompletions(n.name,r.CompletionItemKind.Module,t,s,{modulePath:n.path})})),{completionMap:s}}_findMatchingKeywords(e,t){return e.filter((e=>!t||A.isPatternInSymbol(t,e)))}_addNamedParameters(e,t,n){const s=new Set;e.signatures.forEach((e=>{this._addNamedParametersToMap(e.type,s)})),e.callNode.arguments.forEach((e=>{e.name&&s.delete(e.name.value)})),s.forEach((e=>{if(A.isPatternInSymbol(t,e)){const t=e+"=";if(n.has(t))return;const s=r.CompletionItem.create(t);s.kind=r.CompletionItemKind.Variable;const i={workspacePath:this._workspacePath,filePath:this._filePath,position:this._position};s.data=(0,F.toLSPAny)(i),s.sortText=this._makeSortText(B.NamedParameter,e),s.filterText=e,n.set(s)}}))}_addNamedParametersToMap(e,t){e.details.parameters.forEach((e=>{var n;(0,d.isTypedKwargs)(e)&&7===e.type.category?null===(n=e.type.details.typedDictEntries)||void 0===n||n.forEach(((e,n)=>t.add(n))):e.name&&!e.isNameSynthesized&&(h.isPrivateOrProtectedName(e.name)||t.add(e.name))}))}_addSymbols(e,t,n){let s=e;for(;s;){let i=(0,m.getScopeForNode)(s);if(i){for(;i;)this._addSymbolsForSymbolTable(i.symbolTable,(()=>!0),t,e,!1,void 0,n),i=i.parent;if(10===s.nodeType){const i=this._evaluator.getTypeOfClass(s);i&&(0,I.isInstantiableClass)(i.classType)&&i.classType.details.mro.forEach(((s,i)=>{(0,I.isInstantiableClass)(s)&&this._addSymbolsForSymbolTable(s.details.fields,(e=>!!e.isClassMember()&&e.getDeclarations().some((e=>1===e.type))),t,e,!1,void 0,n)}))}break}s=s.parent}}_addSymbolsForSymbolTable(e,t,n,s,i,a,r){const o=u.isWithinAnnotationComment(s)||u.isWithinTypeAnnotation(s,!1);e.forEach(((e,l)=>{if(((0,f.isVisibleExternally)(e)||e.getDeclarations().some((e=>(0,c.isDefinedInFile)(e,this._filePath))))&&t(e,l)&&!r.has(l)){const t=!this._shouldShowAutoParensForClass(e,s);this._addSymbol(l,e,n,r,{boundObjectOrClass:a,funcParensDisabled:i||o||t,extraCommitChars:!i&&!!n})}}))}_shouldShowAutoParensForClass(e,t){var n;if(e.getDeclarations().every((e=>6!==e.type)))return!0;if(1===(null===(n=t.parent)||void 0===n?void 0:n.nodeType))return!0;const s=u.getTokenIndexAtLeft(this._parseResults.tokenizerOutput.tokens,t.start),i=u.getTokenAtIndex(this._parseResults.tokenizerOutput.tokens,s);return i&&9===i.type&&2===i.operatorType}_addSymbol(e,t,n,s,i){var a,o,l,c;let p=(0,f.getLastTypedDeclaredForSymbol)(t);if(!p){const e=t.getDeclarations();e.length>0&&(p=e[e.length-1])}p=p?null!==(a=this._evaluator.resolveAliasDeclaration(p,!0))&&void 0!==a?a:p:void 0;const d=i.autoImportSource?this._getAutoImportText(e,i.autoImportSource,i.autoImportAlias):void 0;if(this._itemToResolve){const n=(0,F.fromLSPAny)(this._itemToResolve.data);if(n.symbolLabel!==e)return;if(n.autoImportText)return void(n.autoImportText===(null==d?void 0:d.importText)&&(null===(o=i.edits)||void 0===o?void 0:o.additionalTextEdits)&&(this._itemToResolve.additionalTextEdits=(0,M.convertToTextEdits)(i.edits.additionalTextEdits)));const s=this._evaluator.getEffectiveTypeOfSymbol(t);if(!s)return;const a=(0,L.getTypeDetail)(this._evaluator,p,s,e,i,this._configOptions.functionSignatureDisplay),l=(0,U.getDocumentationPartsForTypeAndDecl)(this._sourceMapper,s,p,this._evaluator,{name:e,symbol:t,boundObjectOrClass:i.boundObjectOrClass});this._options.format===r.MarkupKind.Markdown||this._options.format===r.MarkupKind.PlainText?this._itemToResolve.documentation=(0,L.getCompletionItemDocumentation)(a,l,this._options.format):(0,D.fail)(`Unsupported markup type: ${this._options.format}`)}else if(p){let t=this._convertDeclarationTypeToItemKind(p);1===p.type&&i.boundObjectOrClass&&(0,I.isInstantiableClass)(i.boundObjectOrClass)&&I.ClassType.isEnumClass(i.boundObjectOrClass)&&3===(null===(l=p.node.parent)||void 0===l?void 0:l.nodeType)&&(t=r.CompletionItemKind.EnumMember),this._addNameToCompletions(null!==(c=i.autoImportAlias)&&void 0!==c?c:e,t,n,s,{autoImportText:d,extraCommitChars:i.extraCommitChars,funcParensDisabled:i.funcParensDisabled,edits:i.edits})}else{const a=t.getSynthesizedType();if(a){const t=this._convertTypeToItemKind(a);this._addNameToCompletions(e,t,n,s,{extraCommitChars:i.extraCommitChars,funcParensDisabled:i.funcParensDisabled,edits:i.edits})}}}_getAutoImportText(e,t,n){const s=(0,U.getAutoImportText)(e,t,n);let i="";return this._options.format===r.MarkupKind.Markdown?i=`\`\`\`\n${s}\n\`\`\``:this._options.format===r.MarkupKind.PlainText?i=s:(0,D.fail)(`Unsupported markup type: ${this._options.format}`),{source:null!=t?t:"",importText:i}}_addNameToCompletions(e,n,s,i,a){var o,l,c,d;if(!(null==a?void 0:a.autoImportText)&&!A.isPatternInSymbol(s,e))return;if(i.has(e,W.matchKindAndImportText,n,null===(o=null==a?void 0:a.autoImportText)||void 0===o?void 0:o.importText))return;const u=r.CompletionItem.create(e);u.kind=n,(null==a?void 0:a.extraCommitChars)&&this._addExtraCommitChar(u,...this._getExtraCommitCharsForKind(n));const y={workspacePath:this._workspacePath,filePath:this._filePath,position:this._position};if(!(null==a?void 0:a.funcParensDisabled)&&this._options.snippet||(y.funcParensDisabled=!0),(null==a?void 0:a.modulePath)&&(y.modulePath=a.modulePath),u.data=(0,F.toLSPAny)(y),(null==a?void 0:a.sortText)||(null==a?void 0:a.itemDetail)?(u.sortText=a.sortText,u.detail=a.itemDetail):(null==a?void 0:a.autoImportText)?(u.sortText=this._makeSortText(B.AutoImport,`${e}.${this._formatInteger(a.autoImportText.source.length,2)}.${a.autoImportText.source}`,a.autoImportText.importText),y.autoImportText=a.autoImportText.importText,u.detail=t.autoImportDetail,a.autoImportText.source&&(u.labelDetails={description:a.autoImportText.source})):n===r.CompletionItemKind.EnumMember?u.sortText=this._makeSortText(B.EnumMember,e):h.isDunderName(e)?u.sortText=this._makeSortText(B.DunderSymbol,e):""===s&&h.isPrivateOrProtectedName(e)?u.sortText=this._makeSortText(B.PrivateSymbol,e):u.sortText=this._makeSortText(B.NormalSymbol,e),y.symbolLabel=e,this._options.format===r.MarkupKind.Markdown){let e="";(null==a?void 0:a.autoImportText)&&(e+=a.autoImportText.importText,(a.typeDetail||a.documentation)&&(e+="\n\n")),(null==a?void 0:a.typeDetail)&&(e+="```python\n"+a.typeDetail+"\n```\n"),(null==a?void 0:a.documentation)&&(e+="---\n",e+=(0,p.convertDocStringToMarkdown)(a.documentation)),e=e.trimEnd(),e&&(u.documentation={kind:r.MarkupKind.Markdown,value:e})}else if(this._options.format===r.MarkupKind.PlainText){let e="";(null==a?void 0:a.autoImportText)&&(e+=a.autoImportText.importText,(a.typeDetail||a.documentation)&&(e+="\n\n")),(null==a?void 0:a.typeDetail)&&(e+=a.typeDetail+"\n"),(null==a?void 0:a.documentation)&&(e+="\n"+(0,p.convertDocStringToPlainText)(a.documentation)),e=e.trimEnd(),e&&(u.documentation={kind:r.MarkupKind.PlainText,value:e})}else(0,D.fail)(`Unsupported markup type: ${this._options.format}`);(null===(l=null==a?void 0:a.edits)||void 0===l?void 0:l.format)&&(u.insertTextFormat=a.edits.format),(null===(c=null==a?void 0:a.edits)||void 0===c?void 0:c.textEdit)&&(u.textEdit=a.edits.textEdit),(null===(d=null==a?void 0:a.edits)||void 0===d?void 0:d.additionalTextEdits)&&(u.additionalTextEdits=(0,M.convertToTextEdits)(a.edits.additionalTextEdits),this._itemToResolve)&&(0,F.fromLSPAny)(this._itemToResolve.data).autoImportText===y.autoImportText&&(this._itemToResolve.additionalTextEdits=u.additionalTextEdits),i.set(u)}_getRecentListIndex(e,t){return G._mostRecentCompletions.findIndex((n=>n.label===e&&n.autoImportText===t))}_makeSortText(e,t,n=""){const s=this._getRecentListIndex(t,n);return s>=0&&(e===B.AutoImport?e=B.RecentAutoImport:e===B.ImportModuleName?e=B.RecentImportModuleName:e!==B.Keyword&&e!==B.NormalSymbol&&e!==B.PrivateSymbol&&e!==B.DunderSymbol||(e=B.RecentKeywordOrSymbol)),this._formatInteger(e,2)+"."+this._formatInteger(s,4)+"."+t}_formatInteger(e,t){const n="0".charCodeAt(0);let s="";for(let i=0;i<t;i++){let t=Math.floor(e%10);t<0&&(t=9),s=String.fromCharCode(t+n)+s,e=Math.floor(e/10)}return s}_convertDeclarationTypeToItemKind(e){const t=this._evaluator.resolveAliasDeclaration(e,!0);if(!t)return r.CompletionItemKind.Variable;switch(t.type){case 0:return"class"===t.intrinsicType?r.CompletionItemKind.Class:r.CompletionItemKind.Variable;case 2:case 4:return r.CompletionItemKind.Variable;case 3:return r.CompletionItemKind.TypeParameter;case 1:return t.isConstant||t.isFinal?r.CompletionItemKind.Constant:r.CompletionItemKind.Variable;case 5:if(this._isPossiblePropertyDeclaration(t)){const e=this._evaluator.getTypeOfFunction(t.node);if(e&&(0,b.isMaybeDescriptorInstance)(e.decoratedType,!1))return r.CompletionItemKind.Property}return t.isMethod?r.CompletionItemKind.Method:r.CompletionItemKind.Function;case 6:case 7:return r.CompletionItemKind.Class;case 8:return r.CompletionItemKind.Module}}_convertTypeToItemKind(e){switch(e.category){case 8:return r.CompletionItemKind.Module;case 7:return r.CompletionItemKind.Class;case 5:case 6:return(0,b.isMaybeDescriptorInstance)(e,!1)?r.CompletionItemKind.Property:r.CompletionItemKind.Function;case 10:return r.CompletionItemKind.TypeParameter;default:return r.CompletionItemKind.Variable}}_getImportModuleCompletions(e){const t={leadingDots:e.leadingDots,hasTrailingDot:e.hasTrailingDot||!1,nameParts:e.nameParts.map((e=>e.value)),importedSymbols:[]},n=this._importResolver.getCompletionSuggestions(this._filePath,this._execEnv,t),s=new W;if(!e.hasTrailingDot&&e.parent&&22===e.parent.nodeType&&e.parent.missingImportKeyword){const e="import",t=r.CompletionItem.create(e);t.kind=r.CompletionItemKind.Keyword,t.sortText=this._makeSortText(B.Keyword,e),s.set(t)}return n.forEach(((e,t)=>{this._addNameToCompletions(t,r.CompletionItemKind.Module,"",s,{sortText:this._makeSortText(B.ImportModuleName,t),modulePath:e})})),{completionMap:s}}_getExtraCommitCharsForKind(e){switch(e){case r.CompletionItemKind.Class:return[".","("];case r.CompletionItemKind.Function:case r.CompletionItemKind.Method:return["("];case r.CompletionItemKind.Module:case r.CompletionItemKind.Enum:return["."];default:return[]}}_addExtraCommitChar(e,...t){this._options.extraCommitChars&&0!==t.length&&(e.commitCharacters=t)}_isPossiblePropertyDeclaration(e){return e.isMethod&&e.node.decorators.length>0}}t.CompletionProvider=G,G._mostRecentCompletions=[];class W{constructor(){this._completions=new Map}get size(){return this._completions.size}set(e){const t=this._completions.get(e.label);t?Array.isArray(t)?t.push(e):this._completions.set(e.label,[t,e]):this._completions.set(e.label,e)}get(e){return this._completions.get(e)}has(e,t,n,s){const i=this._completions.get(e);return!!i&&(!t||t(i,n,s))}clear(){this._completions.clear()}delete(e){return this._completions.delete(e)}toArray(){var e;const t=[];return null===(e=this._completions)||void 0===e||e.forEach((e=>{Array.isArray(e)?e.forEach((e=>{t.push(e)})):t.push(e)})),t}static matchKindAndImportText(e,t,n){var s;return Array.isArray(e)?!!e.find((e=>{var s;return e.kind===t&&(null===(s=j(e))||void 0===s?void 0:s.autoImportText)===n})):e.kind===t&&(null===(s=j(e))||void 0===s?void 0:s.autoImportText)===n}static labelOnlyIgnoringAutoImports(e){var t;if(Array.isArray(e)){if(e.find((e=>{var t;return!(null===(t=j(e))||void 0===t?void 0:t.autoImportText)})))return!0}else if(!(null===(t=j(e))||void 0===t?void 0:t.autoImportText))return!0;return!1}}function j(e){return(0,F.fromLSPAny)(e.data)}t.CompletionMap=W},613:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCompletionItemDocumentation=t.getTypeDetail=void 0;const s=n(5269),i=n(1272),a=n(1133),r=n(5168),o=n(3490);t.getTypeDetail=function(e,t,n,s,i,l){if(!t)return(0,a.isModule)(n)?s:void 0;switch(t.type){case 0:case 1:case 2:case 3:{let t=!1;if(n&&a.TypeBase.isInstantiable(n)){const e=(0,a.getTypeAliasInfo)(n);e&&e.name===s&&(t=!0)}return s+": "+e.printType(n,{expandTypeAlias:t})}case 5:{const t=(null==i?void 0:i.boundObjectOrClass)&&((0,a.isFunction)(n)||(0,a.isOverloadedFunction)(n))?e.bindFunctionToClassOrObject(i.boundObjectOrClass,n):n;if(!t)return;if((0,r.isProperty)(t)&&(null==i?void 0:i.boundObjectOrClass)&&(0,a.isClassInstance)(i.boundObjectOrClass)){const n=e.getGetterTypeFromProperty(t,!0)||a.UnknownType.create();return s+": "+e.printType(n)+" (property)"}return(0,o.getToolTipForType)(t,"",s,e,!1,l)}case 6:case 7:return"class "+s+"()";default:return s}},t.getCompletionItemDocumentation=function(e,t,n){if(n===s.MarkupKind.Markdown){let n="```python\n"+e+"\n```\n";return t&&(n+="---\n",n+=(0,i.convertDocStringToMarkdown)(t)),n=n.trimEnd(),{kind:s.MarkupKind.Markdown,value:n}}if(n===s.MarkupKind.PlainText){let n=e+"\n";return t&&(n+="\n",n+=(0,i.convertDocStringToPlainText)(t)),n=n.trimEnd(),{kind:s.MarkupKind.PlainText,value:n}}}},3778:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.DefinitionProvider=t.DefinitionFilter=void 0;const r=n(563),o=n(8905),l=a(n(8494)),c=n(8816),p=n(1133),d=n(5168),u=n(3213),y=n(9489),m=n(2489),g=n(7991),h=n(1464),f=n(3550);var T;!function(e){e.All="all",e.PreferSource="preferSource",e.PreferStubs="preferStubs"}(T=t.DefinitionFilter||(t.DefinitionFilter={}));class v{static getDefinitionsForPosition(e,t,n,s,i,a){(0,u.throwIfCancellationRequested)(a);const r=(0,h.convertPositionToOffset)(n,t.tokenizerOutput.lines);if(void 0===r)return;const o=l.findNodeByOffset(t.parseTree,r);return void 0!==o?v.getDefinitionsForNode(e,o,s,i,a):void 0}static getDefinitionsForNode(e,t,n,s,i){const a=[];if(g.Extensions.getProgramExtensions(t).forEach((n=>{if(n.declarationProviderExtension){const r=n.declarationProviderExtension.tryGetDeclarations(s,t,g.DeclarationUseCase.Definition,i);v._resolveDeclarations(r,s,a,e)}})),0===a.length)if(38===t.nodeType){const n=s.getDeclarationsForNameNode(t);v._resolveDeclarations(n,s,a,e)}else if(49===t.nodeType){const n=s.getDeclarationsForStringNode(t);v._resolveDeclarations(n,s,a,e)}if(0===a.length)return;if(n===T.All)return a;const r=n===T.PreferStubs,o=e=>r===(0,c.isStubFile)(e.path);return a.find(o)?a.filter(o):a}static getTypeDefinitionsForPosition(e,t,n,s,i,a){var r;(0,u.throwIfCancellationRequested)(a);const o=(0,h.convertPositionToOffset)(n,t.tokenizerOutput.lines);if(void 0===o)return;const c=l.findNodeByOffset(t.parseTree,o);if(void 0===c)return;const p=[];if(38===c.nodeType){const t=s.getType(c);if(t){let n=[];(0,d.doForEachSubtype)(t,(t=>{7===(null==t?void 0:t.category)&&(0,y.appendArray)(n,e.findClassDeclarationsByType(i,t))})),0===n.length&&(n=null!==(r=s.getDeclarationsForNameNode(c))&&void 0!==r?r:[]),v._resolveDeclarations(n,s,p,e)}}else if(49===c.nodeType){const t=s.getDeclarationsForStringNode(c);v._resolveDeclarations(t,s,p,e)}return 0!==p.length?p:void 0}static _getDeclarationsForNameNode(e,t){var n;return null!==(n=t.getDeclarationsForNameNode(e))&&void 0!==n?n:[]}static _resolveDeclarations(e,t,n,s){e&&e.forEach((e=>{var i;let a=t.resolveAliasDeclaration(e,!0,!0);if(a&&a.path){if(8===a.type&&a.isUnresolved)return;if(8===a.type&&a.symbolName&&a.submoduleFallback&&a.submoduleFallback.path&&(a=a.submoduleFallback),this._addIfUnique(n,{path:a.path,range:a.range}),(0,o.isFunctionDeclaration)(a)){const e=null===(i=t.getTypeForDeclaration(a))||void 0===i?void 0:i.type;if(e&&(0,p.isOverloadedFunction)(e))for(const t of e.overloads.map((e=>e.details.declaration)).filter(m.isDefined))this._addIfUnique(n,{path:t.path,range:t.range})}if((0,c.isStubFile)(a.path))if(8===a.type)s.findModules(a.path).map((e=>{var t;return null===(t=(0,r.getFileInfo)(e))||void 0===t?void 0:t.filePath})).filter(m.isDefined).forEach((e=>this._addIfUnique(n,this._createModuleEntry(e))));else{const e=s.findDeclarations(a);for(const t of e)t&&t.path&&this._addIfUnique(n,{path:t.path,range:t.range})}}}))}static _createModuleEntry(e){return{path:e,range:{start:{line:0,character:0},end:{line:0,character:0}}}}static _addIfUnique(e,t){for(const n of e)if(n.path===t.path&&(0,f.rangesAreEqual)(n.range,t.range))return;e.push(t)}}t.DefinitionProvider=v},8221:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentHighlightProvider=void 0;const r=n(4494),o=a(n(8494)),l=n(3213),c=n(1464),p=n(3550),d=n(8127);t.DocumentHighlightProvider=class{static getDocumentHighlight(e,t,n,s){(0,l.throwIfCancellationRequested)(s);const i=(0,c.convertPositionToOffset)(t,e.tokenizerOutput.lines);if(void 0===i)return;const a=o.findNodeByOffset(e.parseTree,i);return void 0!==a&&38===a.nodeType?d.DocumentSymbolCollector.collectFromNode(a,n,s,e.parseTree,!0).map((t=>({kind:38===t.node.nodeType&&o.isWriteAccess(t.node)?r.DocumentHighlightKind.Write:r.DocumentHighlightKind.Read,range:(0,c.convertOffsetsToRange)(t.range.start,p.TextRange.getEnd(t.range),e.tokenizerOutput.lines)}))):void 0}}},8127:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentSymbolCollector=t.DocumentSymbolCollectorUseCase=void 0;const r=a(n(563)),o=n(8905),l=n(5523),c=n(8494),p=a(n(8494)),d=n(427),u=a(n(5083)),y=n(8816),m=n(1133),g=n(5168),h=n(3213),f=n(9489),T=n(5839),v=n(7991);var _;!function(e){e[e.Rename=0]="Rename",e[e.Reference=1]="Reference"}(_=t.DocumentSymbolCollectorUseCase||(t.DocumentSymbolCollectorUseCase={}));class I extends d.ParseTreeWalker{constructor(e,t,n,s,i,a=!1,r=!0,o=_.Reference){super(),this._declarations=t,this._evaluator=n,this._cancellationToken=s,this._startingNode=i,this._treatModuleInImportAndFromImportSame=a,this._skipUnreachableCode=r,this._useCase=o,this._results=[],this._dunderAllNameNodes=new Set,this._symbolNames=new Set,e.forEach((e=>this._symbolNames.add(e))),this._setDunderAllNodes(this._startingNode);const l=t.find((e=>5===e.type&&"__init__"===e.node.name.value));if(l&&o===_.Reference){const e=t.find((e=>6===e.type));e&&(this._initFunction=l.node,this._symbolNames.add(e.node.name.value))}}static collectFromNode(e,t,n,s,i=!1,a=!0,r=_.Reference){const o=this.getDeclarationsForNode(e,t,!0,r,n);return(s=null!=s?s:(0,c.getModuleNode)(e))?new I([e.value],o,t,n,s,i,a,r).collect():[]}static getDeclarationsForNode(e,t,n,s,i,a,o){(0,h.throwIfCancellationRequested)(i);const l=this._getDeclarationsForNode(e,s,t,i,!1);let c=r.getFileInfo(e).builtinsScope;for(;c&&3===c.type;){const t=null==c?void 0:c.lookUpSymbol(e.value);t&&l.push(...t.getDeclarations()),c=null==c?void 0:c.parent}null==o||o.forEach((t=>{var n;const s=null===(n=t.getParseResults())||void 0===n?void 0:n.parseTree;if(s){const t=r.getScope(s),n=null==t?void 0:t.lookUpSymbol(e.value);n&&l.push(...n.getDeclarations())}}));const p=[];return l.forEach((e=>{const s=t.resolveAliasDeclaration(e,n);if(s&&(p.push(s),a&&(0,y.isStubFile)(s.path))){const e=a.findDeclarations(s);for(const t of e)t&&t.path&&this._addIfUnique(p,t)}})),p}collect(){return this.walk(this._startingNode),this._results}walk(e){this._skipUnreachableCode&&r.isCodeUnreachable(e)||super.walk(e)}visitName(e){if((0,h.throwIfCancellationRequested)(this._cancellationToken),!this._symbolNames.has(e.value))return!1;if(this._declarations.length>0){const t=I._getDeclarationsForNode(e,this._useCase,this._evaluator,this._cancellationToken,this._skipUnreachableCode);t&&t.length>0&&t.some((t=>this._resultsContainsDeclaration(t,e)))&&this._addResult(e)}else this._addResult(e);return!1}visitStringList(e){if(this._declarations.some((t=>{var n;return(null===(n=t.node)||void 0===n?void 0:n.id)===e.id}))){const t=e.strings.find((e=>this._symbolNames.has(e.value)));t&&49===t.nodeType&&this._addResult(t)}return super.visitStringList(e)}visitString(e){return(0,h.throwIfCancellationRequested)(this._cancellationToken),this._dunderAllNameNodes.has(e)&&this._addResult(e),!1}_addResult(e){const t=38===e.nodeType?e:(0,c.getStringNodeValueRange)(e);this._results.push({node:e,range:t})}_isDeclarationAllowed(e,t){var n;const s=this._declarations.find((t=>(0,l.areDeclarationsSame)(t,e,this._treatModuleInImportAndFromImportSame,!0)));return!!s&&(!this._initFunction||5===s.type||6===s.type&&9===(null===(n=t.parent)||void 0===n?void 0:n.nodeType))}_resultsContainsDeclaration(e,t){const n=this._evaluator.resolveAliasDeclaration(e,!1);if(!n)return!1;if(this._isDeclarationAllowed(n,t))return!0;const s=this._getResolveAliasDeclaration(n);return!(!s||s===n)&&this._isDeclarationAllowed(s,t)}_getResolveAliasDeclaration(e){if(n(e))return(0,l.getDeclarationsWithUsesLocalNameRemoved)([e])[0];const t=this._evaluator.resolveAliasDeclaration(e,!0);return n(t)?(0,l.getDeclarationsWithUsesLocalNameRemoved)([t])[0]:t;function n(e){return!!e&&8===e.type&&e.node&&e.usesLocalName&&21===e.node.nodeType}}_setDunderAllNodes(e){if(36!==e.nodeType)return;const t=r.getDunderAllInfo(e);if(!t)return;const n=u.getScopeForNode(e);n&&t.stringNodes.forEach((e=>{if(!this._symbolNames.has(e.value))return;const t=n.lookUpSymbolRecursive(e.value);t&&t.symbol.getDeclarations().some((t=>this._resultsContainsDeclaration(t,e)))&&this._dunderAllNameNodes.add(e)}))}static _addIfUnique(e,t){for(const n of e)if((0,l.areDeclarationsSame)(n,t,!1,!0))return;e.push(t)}static _getDeclarationsForInitNode(e,t){var n;const s=p.getEnclosingClassOrFunction(e.parent);if(10===(null==s?void 0:s.nodeType))return this._getDeclarationsForNonModuleNameNode(s.name,t);if(35===(null===(n=e.parent)||void 0===n?void 0:n.nodeType)&&(9===e.parent.leftExpression.nodeType&&38===e.parent.leftExpression.leftExpression.nodeType&&"super"===e.parent.leftExpression.leftExpression.value||38===e.parent.leftExpression.nodeType&&"super"===e.parent.leftExpression.value)){const n=t.getDeclarationsForNameNode(e,!0);if(n&&n.length>0&&n[0].node.parent){const e=p.getEnclosingClass(n[0].node.parent);if(e)return this._getDeclarationsForNonModuleNameNode(e.name,t)}}return[]}static _getDeclarationsForNode(e,t,n,s,i=!0){var a;let r=[];return 37!==(null===(a=e.parent)||void 0===a?void 0:a.nodeType)?(r=this._getDeclarationsForNonModuleNameNode(e,n,i),"__init__"===e.value&&t===_.Reference&&e.parent&&r.push(...this._getDeclarationsForInitNode(e,n))):r=this._getDeclarationsForModuleNameNode(e,n),v.Extensions.getProgramExtensions(e).forEach((i=>{var a;const o=t===_.Rename?v.DeclarationUseCase.Rename:v.DeclarationUseCase.References,l=null===(a=i.declarationProviderExtension)||void 0===a?void 0:a.tryGetDeclarations(n,e,o,s);l&&l.length>0&&r.push(...l)})),r}static _getDeclarationsForNonModuleNameNode(e,t,n=!0){var s,i;(0,T.assert)(37!==(null===(s=e.parent)||void 0===s?void 0:s.nodeType));let a=t.getDeclarationsForNameNode(e,n)||[];if(23===(null===(i=e.parent)||void 0===i?void 0:i.nodeType)&&(a=a.filter((t=>t.node===e.parent))),0===a.length){const n=t.getType(e);if(8===(null==n?void 0:n.category))return[(0,l.createSynthesizedAliasDeclaration)(n.filePath)]}for(const e of a.filter((e=>(0,o.isAliasDeclaration)(e)&&!e.loadSymbolsFromPath))){const s=e.node;23!==s.nodeType&&a.push(...t.getDeclarationsForNameNode(s.module.nameParts[0],n)||[])}for(const e of a.filter((e=>(0,o.isFunctionDeclaration)(e)&&e.isMethod&&e.node.name.value.length>0))){const n=e,s=p.getEnclosingClass(n.node),i=s?t.getTypeOfClass(s):void 0;if(i&&"__init__"!==n.node.name.value&&"__new__"!==n.node.name.value)for(const e of i.classType.details.mro)if((0,m.isInstantiableClass)(e)){const t=(0,g.lookUpClassMember)(e,n.node.name.value),s=(0,g.lookUpClassMember)(e,n.node.name.value,1);t&&!s&&t.symbol.getDeclarations().filter((e=>(0,o.isFunctionDeclaration)(e)&&e.isMethod)).forEach((e=>this._addIfUnique(a,e)))}}return a}static _getDeclarationsForModuleNameNode(e,t){var n,s,i,a,r;(0,T.assert)(37===(null===(n=e.parent)||void 0===n?void 0:n.nodeType));const c=e.parent;if(21===(null===(s=c.parent)||void 0===s?void 0:s.nodeType)||22===(null===(i=c.parent)||void 0===i?void 0:i.nodeType)){const n=c.nameParts.findIndex((t=>t===e));if(0===n){const n=[];if(n.push(...(null===(a=t.getDeclarationsForNameNode(c.nameParts[0]))||void 0===a?void 0:a.filter((e=>(0,o.isAliasDeclaration)(e))))||[]),0===n.length)return n;const s=1===c.nameParts.length&&21===c.parent.nodeType&&!!c.parent.alias,i=s?c.parent.alias.value:c.nameParts[0].value,p=null===(r=u.getScopeForNode(e))||void 0===r?void 0:r.lookUpSymbolRecursive(i);if(p&&1===c.nameParts.length){let e=[];(0,f.appendArray)(e,p.symbol.getDeclarations().filter((e=>(0,o.isAliasDeclaration)(e)))),e.length>1&&(e=e.filter((e=>void 0!==(e=e).firstNamePart?e.firstNamePart===c.nameParts[0].value:e.node===c.parent))),s&&(e=(0,l.getDeclarationsWithUsesLocalNameRemoved)(e)),n.push(...e)}return n}return n>0&&t.getDeclarationsForNameNode(c.nameParts[n])||[]}return[]}}t.DocumentSymbolCollector=I},2816:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentSymbolProvider=t.convertToFlatSymbols=t.getIndexAliasData=void 0;const r=n(4494),o=n(472),l=a(n(563)),c=n(5523),p=n(2917),d=n(5168),u=n(3213),y=n(1464),m=a(n(7559)),g=n(8566);function h(e,t){var n;if(!t.symbolName)return;const s=(0,c.resolveAliasDeclaration)(e,t,!0,!1);if(!s||!s.declaration)return;if(s.isPrivate)return;const i=(0,c.getNameFromDeclaration)(s.declaration);if(!i||s.declaration.path.length<=0)return;const a=null!==(n=T(i,s.declaration))&&void 0!==n?n:r.SymbolKind.Module;return{originalName:i,modulePath:s.declaration.path,kind:a,itemKind:(0,g.convertSymbolKindToCompletionItemKind)(a)}}t.getIndexAliasData=h,t.convertToFlatSymbols=function(e,t){const n=[];for(const s of t)b(n,e,s);return n};class f{static getSymbolsForDocument(e,t,n,s,i,a){var r;const o=[];return t||n?(v(null!==(r=null==t?void 0:t.symbols)&&void 0!==r?r:f.indexSymbols(e,n,{indexingForAutoImportMode:!1},a),s,i,"",o,a),o):o}static addHierarchicalSymbolsForDocument(e,t,n,s,i){var a;(t||n)&&_(null!==(a=null==t?void 0:t.symbols)&&void 0!==a?a:f.indexSymbols(e,n,{indexingForAutoImportMode:!1},i),s,i)}static indexSymbols(e,t,n,s){const i=[];return I(e,t,t.parseTree,n,i,s),i}}function T(e,t,n){var s;let i;switch(t.type){case 6:case 7:i=r.SymbolKind.Class;break;case 5:if(t.isMethod){const e=null===(s=null==n?void 0:n.getTypeForDeclaration(t))||void 0===s?void 0:s.type;i=e&&(0,d.isMaybeDescriptorInstance)(e,!1)?r.SymbolKind.Property:r.SymbolKind.Method}else i=r.SymbolKind.Function;break;case 8:i=r.SymbolKind.Module;break;case 2:if("self"===e||"cls"===e||"_"===e)return;i=r.SymbolKind.Variable;break;case 3:i=r.SymbolKind.TypeParameter;break;case 1:if("_"===e)return;i=t.isConstant||t.isFinal?r.SymbolKind.Constant:r.SymbolKind.Variable;break;default:i=r.SymbolKind.Variable}return i}function v(e,t,n,s,i,a){if((0,u.throwIfCancellationRequested)(a),e)for(const l of e)if(!l.alias){if(m.isPatternInSymbol(n,l.name)){const e={uri:o.URI.file(t).toString(),range:l.selectionRange},n={name:l.name,kind:l.kind,location:e};s.length&&(n.containerName=s),i.push(n)}v(l.children,t,n,r(s,l.name),i,a)}function r(e,t){return e.length>0?`${e}.${t}`:t}}function _(e,t,n){if((0,u.throwIfCancellationRequested)(n),e)for(const s of e){if(s.alias)continue;if(!s.name)continue;const e=[];_(s.children,e,n);const i={name:s.name,kind:s.kind,range:s.range,selectionRange:s.selectionRange,children:e};t.push(i)}}function I(e,t,n,s,i,a){(0,u.throwIfCancellationRequested)(a);const r=l.getScope(n);r&&r.symbolTable.forEach(((n,r)=>{if(n.isIgnoredForProtocolMatch())return;if(s.indexingForAutoImportMode&&!s.includeAllSymbols&&!e.isStubFile&&!e.isInPyTypedPackage&&!n.isInDunderAll())return;let o=(0,p.getLastTypedDeclaredForSymbol)(n);if(!o&&n.hasDeclarations()&&(o=n.getDeclarations()[0]),o){if(8===o.type){if(!s.indexingForAutoImportMode)return;if(!o.loadSymbolsFromPath||o.path.length<=0)return}!function(e,t,n,s,i,a,r,o){if(s.indexingForAutoImportMode&&!i)return;const c=T(a,n);if(void 0===c)return;const p=n.range;let d=p;const u=[];let m;if(6!==n.type&&5!==n.type||(s.indexingForAutoImportMode||I(e,t,n.node,s,u,o),d=(0,y.convertOffsetsToRange)(n.node.start,n.node.start+n.node.length,t.tokenizerOutput.lines)),8===n.type&&(m=h(l.getFileInfo(t.parseTree).importLookup,n),!m))return;const f={name:a,externallyVisible:i,kind:c,itemKind:(0,g.convertSymbolKindToCompletionItemKind)(c),alias:m,range:s.indexingForAutoImportMode?void 0:d,selectionRange:s.indexingForAutoImportMode?void 0:p,children:s.indexingForAutoImportMode?void 0:u};r.push(f)}(e,t,o,s,(0,p.isVisibleExternally)(n),r,i,a)}}))}function b(e,t,n,s){const i={name:n.name,kind:n.kind,location:r.Location.create(t,n.range)};if(n.tags&&(i.tags=n.tags),s&&(i.containerName=s.name),e.push(i),n.children)for(const s of n.children)b(e,t,s,n)}t.DocumentSymbolProvider=f},3334:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.convertHoverResults=t.HoverProvider=void 0;const r=n(4494),o=n(1272),l=a(n(8494)),c=n(1133),p=n(5168),d=n(3213),u=n(5839),y=n(7991),m=n(1464),g=n(7559),h=n(3550),f=n(5275),T=n(3490);t.HoverProvider=class{static getHoverForPosition(e,t,n,s,i,a,r){var o;(0,d.throwIfCancellationRequested)(r);const u=(0,m.convertPositionToOffset)(n,t.tokenizerOutput.lines);if(void 0===u)return;const g=l.findNodeByOffset(t.parseTree,u);if(void 0===g)return;const f={parts:[],range:{start:(0,m.convertOffsetToPosition)(g.start,t.tokenizerOutput.lines),end:(0,m.convertOffsetToPosition)(h.TextRange.getEnd(g),t.tokenizerOutput.lines)}};if(38===g.nodeType){let t=y.Extensions.getProgramExtensions(g).map((e=>{var t;return(null===(t=e.declarationProviderExtension)||void 0===t?void 0:t.tryGetDeclarations(i,g,y.DeclarationUseCase.Definition,r))||[]})).flat();if(0===t.length&&(t=i.getDeclarationsForNameNode(g)),t&&t.length>0){let n=t[0];(8===n.type&&t.length>1||1===n.type&&t.length>1&&n.isDefinedBySlots)&&(n=t[1]),this._addResultsForDeclaration(s,e,f.parts,n,g,i,a,r),f.lastKnownModule=n.moduleName}else if((!g.parent||37!==g.parent.nodeType)&&0===f.parts.length){let t,n=i.getType(g)||c.UnknownType.create();if((0,c.isModule)(n))t="(module) "+g.value;else{n=this._limitOverloadBasedOnCall(g,i,n);let e="function",s=!1;(0,p.isMaybeDescriptorInstance)(n,!1)&&(s=!0,e="property"),t=(0,T.getToolTipForType)(n,e,g.value,i,s,a)}this._addResultsPart(f.parts,t,!0),this._addDocumentationPart(s,e,f.parts,g,i,void 0)}}else if(49===g.nodeType){const t=null===(o=i.getExpectedType(g))||void 0===o?void 0:o.type;void 0!==t&&this._tryAddPartsForTypedDictKey(s,e,i,g,t,f.parts)}return f.parts.length>0?f:void 0}static _addResultsForDeclaration(e,t,n,s,i,a,r,o){var l,d;const m=a.resolveAliasDeclaration(s,!0);if(m)switch(m.type){case 0:this._addResultsPart(n,i.value+this._getTypeText(i,a),!0),this._addDocumentationPart(e,t,n,i,a,m);break;case 1:{let r=m.isConstant||a.isFinalVariableDeclaration(m)?"constant":"variable",o=i;21===s.node.nodeType||23===s.node.nodeType?s.node.alias&&i!==s.node.alias&&38===m.node.nodeType&&(o=m.node):1===(null===(l=i.parent)||void 0===l?void 0:l.nodeType)&&i.parent.name===i&&38===s.node.nodeType&&(o=s.node);let p=a.getType(o);if((!p||1===p.category)&&m.alternativeTypeNode&&(0,f.isExpressionNode)(m.alternativeTypeNode)){const e=a.getType(m.alternativeTypeNode);e&&1!==e.category&&(p=e,o=m.alternativeTypeNode)}let d,u=!1;if((null==p?void 0:p.typeAliasInfo)&&38===o.nodeType){const e=(0,c.getTypeAliasInfo)(p);(null==e?void 0:e.name)===o.value&&((0,c.isTypeVar)(p)?(r=p.details.isParamSpec?"param spec":"type variable",d=p.details.name):(u=!0,r="type alias"))}const y=d||i.value+this._getTypeText(o,a,u);this._addResultsPart(n,`(${r}) ${y}`,!0),this._addDocumentationPart(e,t,n,i,a,m);break}case 2:m.inferredName&&m.inferredTypeNodes?this._addResultsPart(n,"(parameter) "+m.inferredName+this._getTypesText(m.inferredTypeNodes,a),!0):this._addResultsPart(n,"(parameter) "+i.value+this._getTypeText(i,a),!0),m.docString&&this._addResultsPart(n,m.docString),this._addDocumentationPart(e,t,n,i,a,m);break;case 3:this._addResultsPart(n,"(type parameter) "+i.value+this._getTypeText(i,a),!0),this._addDocumentationPart(e,t,n,i,a,m);break;case 6:case 7:{const s=6===m.type?m.node.name:i;if(this._addInitOrNewMethodInsteadIfCallNode(e,i,a,n,t,m,r))return;this._addResultsPart(n,"(class) "+s.value,!0),this._addDocumentationPart(e,t,n,i,a,m);break}case 5:{let s="function",l=!1;if(m.isMethod){const e=null===(d=a.getTypeForDeclaration(m))||void 0===d?void 0:d.type;l=!!e&&(0,p.isMaybeDescriptorInstance)(e,!1),s=l?"property":"method"}let u=a.getType(i);const g=y.Extensions.getProgramExtensions(m.node).map((e=>{var t;return null===(t=e.typeProviderExtension)||void 0===t?void 0:t.tryGetFunctionNodeType(m.node,a,o)})).find((e=>!!e))||a.getType(m.node.name);if(u=void 0===u||(0,c.isAnyOrUnknown)(u)?g:u,u){u=this._limitOverloadBasedOnCall(i,a,u);const e=(0,T.getToolTipForType)(u,s,i.value,a,l,r);this._addResultsPart(n,e,!0)}this._addDocumentationPart(e,t,n,i,a,m);break}case 8:this._addResultsPart(n,"(module) "+i.value,!0),this._addDocumentationPart(e,t,n,i,a,m);break;case 4:{const s=i.value+this._getTypeText(i,a,!0);this._addResultsPart(n,`(type alias) ${s}`,!0),this._addDocumentationPart(e,t,n,i,a,m);break}default:(0,u.assertNever)(m)}else this._addResultsPart(n,"(import) "+i.value+this._getTypeText(i,a),!0)}static _tryAddPartsForTypedDictKey(e,t,n,s,i,a){(0,p.doForEachSubtype)(i,(i=>{var r,o;if((0,c.isClassInstance)(i)&&c.ClassType.isTypedDictClass(i)){const l=null===(r=i.details.typedDictEntries)||void 0===r?void 0:r.get(s.value);if(l){a.length>0&&a.push({text:"\n\n---\n"});const r="(key) "+s.value+": "+n.printType(l.valueType);this._addResultsPart(a,r,!0);const c=null===(o=i.details.fields.get(s.value))||void 0===o?void 0:o.getDeclarations();if(void 0!==c&&0!==(null==c?void 0:c.length)){const s=c[0];1===s.type&&void 0!==s.docString&&this._addDocumentationPartForType(e,t,a,i,s,n)}}}}))}static _addInitOrNewMethodInsteadIfCallNode(e,t,n,s,i,a,r){var o,l;let d=t;if((35===(null===(o=null==d?void 0:d.parent)||void 0===o?void 0:o.nodeType)&&t===d.parent.memberName||24===(null===(l=null==d?void 0:d.parent)||void 0===l?void 0:l.nodeType))&&(d=t.parent),!d||!d.parent||9!==d.parent.nodeType||d.parent.leftExpression!==d)return!1;const u=n.getType(t);if(!u||!(0,c.isInstantiableClass)(u))return!1;const y=n.getType(d.parent);if(!y||!(0,c.isClassInstance)(y))return!1;let m;const g=(0,p.lookUpClassMember)(u,"__init__",8);if(g){const e=n.getTypeOfMember(g);((0,c.isFunction)(e)||(0,c.isOverloadedFunction)(e))&&(m=n.bindFunctionToClassOrObject(y,e))}if(!m||m&&(0,c.isFunction)(m)&&(c.FunctionType.hasDefaultParameters(m)||0===m.details.parameters.length)){const e=(0,p.lookUpClassMember)(u,"__new__",12);if(e){const t=n.getTypeOfMember(e);((0,c.isFunction)(t)||(0,c.isOverloadedFunction)(t))&&(m=n.bindFunctionToClassOrObject(y,t,void 0,void 0,void 0,!0))}}return!(!m||!(0,c.isFunction)(m)&&!(0,c.isOverloadedFunction)(m))&&(m=this._limitOverloadBasedOnCall(t,n,m),this._addResultsPart(s,(0,T.getConstructorTooltip)(t.value,m,n,r),!0),this._addDocumentationPartForType(e,i,s,m,a,n)||this._addDocumentationPartForType(e,i,s,u,a,n),!0)}static _getTypeText(e,t,n=!1){let s=t.getType(e)||c.UnknownType.create();return s=this._limitOverloadBasedOnCall(e,t,s),": "+t.printType(s,{expandTypeAlias:n})}static _getTypesText(e,t,n=!1){const s=(0,T.combineExpressionTypes)(e,t);return": "+t.printType(s,{expandTypeAlias:n})}static _limitOverloadBasedOnCall(e,t,n){if((0,c.isOverloadedFunction)(n)&&38===e.nodeType){const s=l.getCallForName(e);if(s){const e=t.getTypeResult(s);(null==e?void 0:e.overloadsUsedForCall)&&e.overloadsUsedForCall.length>0&&(n=1===e.overloadsUsedForCall.length?e.overloadsUsedForCall[0]:c.OverloadedFunctionType.create(e.overloadsUsedForCall))}}return n}static _addDocumentationPart(e,t,n,s,i,a){const r=i.getType(s);this._addDocumentationPartForType(e,t,n,r,a,i,s.value)}static _addDocumentationPartForType(e,t,n,s,i,a,r){const o=(0,T.getDocumentationPartsForTypeAndDecl)(t,s,i,a,{name:r});return!!o&&(this._addDocumentationResultsPart(e,n,o),!0)}static _addDocumentationResultsPart(e,t,n){if(n)if(e===r.MarkupKind.Markdown){const e=(0,o.convertDocStringToMarkdown)(n);t.length>0&&e.length>0&&t.push({text:"---\n"}),this._addResultsPart(t,e)}else e===r.MarkupKind.PlainText?this._addResultsPart(t,(0,o.convertDocStringToPlainText)(n)):(0,u.fail)(`Unsupported markup type: ${e}`)}static _addResultsPart(e,t,n=!1){e.push({python:n,text:t})}},t.convertHoverResults=function(e,t,n){if(!t)return;let s=t.parts.map((t=>{if(t.python){if(e===r.MarkupKind.Markdown)return"```python\n"+t.text+"\n```\n";if(e===r.MarkupKind.PlainText)return t.text+"\n\n";(0,u.fail)(`Unsupported markup type: ${e}`)}return t.text})).join("").trimEnd();return t.lastKnownModule&&e===r.MarkupKind.Markdown&&n&&(s+=`\n\x3c!--moduleHash:${(0,g.hashString)(t.lastKnownModule)}--\x3e`),{contents:{kind:e,value:s},range:t.range}}},4342:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImportAdder=void 0;const s=n(563),i=n(8905),a=n(5523),r=n(7012),o=n(8494),l=n(427),c=n(5083),p=n(3213),d=n(9489),u=n(2489),y=n(6657),m=n(1464),g=n(3550);t.ImportAdder=class{constructor(e,t,n){this._configOptions=e,this._importResolver=t,this._evaluator=n}collectImportsForSymbolsUsed(e,t,n){const s=new h(this._evaluator,e,t,n);return s.walk(e.parseTree),{containsUnreferenceableSymbols:s.containsUnreferenceableSymbols,declarations:s.declsForSymbols}}applyImports(e,t,n,s,i,a){(0,p.throwIfCancellationRequested)(a);const o=(0,r.getTopLevelImports)(n.parseTree),l=this._getImportNameWithModuleInfo(t,e,i),c=[],u=[];for(const e of(0,d.createMapFromItems)(l,(e=>e.module.moduleName)))this._tryProcessExistingImports(e,o,n,c)||(0,d.appendArray)(u,e[1]);return c.push(...(0,r.getTextEditsForAutoImportInsertions)(u,o,n,(0,m.convertOffsetToPosition)(s,n.tokenizerOutput.lines))),c}applyImportsTo(e,t,n,i,a){(0,p.throwIfCancellationRequested)(a);const o=(0,s.getFileInfo)(t.parseTree).filePath,l=(0,r.getTopLevelImports)(t.parseTree),c=this._getImportNameWithModuleInfo(o,e,n),u=[];for(const e of(0,d.createMapFromItems)(c,(e=>e.module.moduleName)))this._tryProcessExistingImports(e,l,t,i)||(0,d.appendArray)(u,e[1]);for(const e of(0,d.createMapFromItems)(u,(e=>e.module.moduleName)))this._addOrUpdateImport(e,l,t,e[1],i)}_getImportNameWithModuleInfo(e,t,n){var s;const a=[],o=this._configOptions.findExecEnvironment(e);for(const l of null!==(s=t.declarations.keys())&&void 0!==s?s:[]){const t=this._getImportInfo(l,e);if(!t||(0,i.isUnresolvedAliasDeclaration)(l))continue;const s=(0,r.getRelativeModuleName)(this._importResolver.fileSystem,e,t.filePath),c=this._importResolver.getModuleNameForImport(t.filePath,o);if(!c.moduleName){if(!t.nameInfo.name)continue;n="relative"}(0,d.addIfUnique)(a,{name:t.nameInfo.name,alias:t.nameInfo.alias,module:c,nameForImportFrom:"relative"===n?s:void 0},((e,t)=>this._areSame(e,t)))}return a}_tryProcessExistingImports(e,t,n,s){for(const i of(0,d.createMapFromItems)(t.orderedImports.filter((t=>t.moduleName===e[0])),(e=>20===e.node.nodeType?"import":"importFrom"))){if("importFrom"===i[0]){const a=i[1].filter((e=>22===e.node.nodeType&&!e.node.isWildcardImport));if(0===a.length)continue;const o=e[1].filter((e=>!a.some((t=>22===t.node.nodeType&&t.node.imports.some((t=>{var n;return t.name.value===e.name&&(null===(n=t.alias)||void 0===n?void 0:n.value)===e.alias}))))));return(0,u.isArray)(s)?(0,d.appendArray)(s,(0,r.getTextEditsForAutoImportSymbolAddition)(o,a[0],n)):this._addOrUpdateImport(e,t,n,o,s),!0}"import"!==i[0]||(0,d.removeArrayElements)(e[1],(e=>!e.name&&i[1].some((t=>{var n,s;return e.alias===(null===(s=null===(n=t.subnode)||void 0===n?void 0:n.alias)||void 0===s?void 0:s.value)}))))}return!1}_addOrUpdateImport(e,t,n,s,i){if(0===s.length)return;const a=e[0],o=0===e[1].length?void 0:e[1][0].nameForImportFrom,l=0===e[1].length?2:(0,r.getImportGroupFromModuleNameAndType)(e[1][0].module);i.addOrUpdateImport(n,t,{name:a,nameForImportFrom:o},l,s)}_getImportInfo(e,t){var n,s;if((0,i.isAliasDeclaration)(e)){if(!e.node)return{filePath:e.path,nameInfo:{}};if(21===e.node.nodeType){const t=this._evaluator.getDeclarationsForNameNode(e.node.module.nameParts[e.node.module.nameParts.length-1]);if(!t||0===t.length)return;return{filePath:t[0].path,nameInfo:{alias:e.usesLocalName?null===(n=e.node.alias)||void 0===n?void 0:n.value:void 0}}}if(23===e.node.nodeType){let n=e.path;if(n||e.submoduleFallback&&(n=(0,y.getDirectoryPath)(e.submoduleFallback.path)),!n)return;if(n===t&&!e.usesLocalName&&!e.submoduleFallback)return;return{filePath:n,nameInfo:{name:e.symbolName,alias:e.usesLocalName?null===(s=e.node.alias)||void 0===s?void 0:s.value:void 0}}}if(22===e.node.nodeType)return{filePath:e.path,nameInfo:{name:e.symbolName}}}if((0,i.isVariableDeclaration)(e)||(0,i.isFunctionDeclaration)(e)||(0,i.isClassDeclaration)(e)){const t=(0,a.getNameFromDeclaration)(e);if(!t)return;return{filePath:e.path,nameInfo:{name:t}}}}_areSame(e,t){return e.alias===t.alias&&e.name===t.name&&e.module.importType===t.module.importType&&e.module.isLocalTypingsFile===t.module.isLocalTypingsFile&&e.module.moduleName===t.module.moduleName}};class h extends l.ParseTreeWalker{constructor(e,t,n,i){super(),this._evaluator=e,this._parseResults=t,this._range=n,this._token=i,this.declsForSymbols=new Map,this.containsUnreferenceableSymbols=!1,this._filePath=(0,s.getFileInfo)(this._parseResults.parseTree).filePath}walk(e){g.TextRange.overlapsRange(this._range,e)&&super.walk(e)}visitModuleName(e){return!1}visitName(e){if(!g.TextRange.containsRange(this._range,e))return!1;if((0,p.throwIfCancellationRequested)(this._token),!(0,o.isLastNameOfDottedName)(e))return!1;const t=(0,o.getDottedName)((0,o.getDottedNameWithGivenNodeAsLastName)(e));if(!t)return!1;const n=t[0],s=this._getDeclarationsInModule(n);if(!s||0===s.length)return!1;if(1===t.length)return this._handleName(n,s),!1;for(const e of s)(0,i.isAliasDeclaration)(e)&&21===e.node.nodeType?e.usesLocalName?this._handleName(n,[e]):this._handleImplicitImports(e,t,1):this._handleName(n,[e]);return!1}_getDeclarationsInModule(e){var t;return null===(t=this._evaluator.getDeclarationsForNameNode(e))||void 0===t?void 0:t.filter((e=>(0,a.isDefinedInFile)(e,this._filePath)))}_handleImplicitImports(e,t,n){if(t.length===n)return;if(!e.implicitImports)return void this._handleName(t[n-1],[(0,a.createSynthesizedAliasDeclaration)(e.path)]);const s=e.implicitImports.get(t[n].value);s?this._handleImplicitImports(s,t,n+1):this._handleName(t[n-1],[(0,a.createSynthesizedAliasDeclaration)(e.path)])}_handleName(e,t){for(const n of t)if(!n.node||!g.TextRange.containsRange(this._range,n.node))if((0,i.isParameterDeclaration)(n))this.containsUnreferenceableSymbols=!0;else{if((0,i.isVariableDeclaration)(n)||(0,i.isFunctionDeclaration)(n)||(0,i.isClassDeclaration)(n)){const t=(0,c.getScopeForNode)(e);if(!t){this.containsUnreferenceableSymbols=!0;continue}const n=t.lookUpSymbolRecursive(e.value);if(!n||3!==n.scope.type){this.containsUnreferenceableSymbols=!0;continue}}this._addName(n,e)}}_addName(e,t){(0,d.getOrAdd)(this.declsForSymbols,e,(()=>[])).push(t)}}},4969:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImportSorter=void 0;const s=n(7012),i=n(3213),a=n(1464),r=n(3550);t.ImportSorter=class{constructor(e,t){this._parseResults=e,this._cancellationToken=t}sort(){(0,i.throwIfCancellationRequested)(this._cancellationToken);const e=[],t=(0,s.getTopLevelImports)(this._parseResults.parseTree),n=t.orderedImports.map((e=>e)).sort(((e,t)=>(0,s.compareImportStatements)(e,t)));if(0===n.length)return[];const a=this._getPrimaryReplacementRange(t.orderedImports);return e.push({range:a,replacementText:this._generateSortedImportText(n)}),this._addSecondaryReplacementRanges(t.orderedImports,e),e}_getPrimaryReplacementRange(e){let t=e.findIndex((e=>e.followsNonImportStatement));t<0&&(t=e.length);const n=e[t-1].node;return{start:(0,a.convertOffsetToPosition)(e[0].node.start,this._parseResults.tokenizerOutput.lines),end:(0,a.convertOffsetToPosition)(r.TextRange.getEnd(n),this._parseResults.tokenizerOutput.lines)}}_addSecondaryReplacementRanges(e,t){let n=e.findIndex((e=>e.followsNonImportStatement));if(!(n<0))for(;;){let s=e.findIndex(((e,t)=>t>n&&e.followsNonImportStatement));if(s<0&&(s=e.length),t.push({range:{start:(0,a.convertOffsetToPosition)(e[n].node.start,this._parseResults.tokenizerOutput.lines),end:(0,a.convertOffsetToPosition)(r.TextRange.getEnd(e[s-1].node),this._parseResults.tokenizerOutput.lines)},replacementText:""}),n=s,n>=e.length)break}}_generateSortedImportText(e){let t="",n=(0,s.getImportGroup)(e[0]);for(const i of e){const a=(0,s.getImportGroup)(i);let r;n!==a&&(t+=this._parseResults.tokenizerOutput.predominantEndOfLineSequence,n=a),r=20===i.node.nodeType?this._formatImportNode(i.subnode,i.moduleName):this._formatImportFromNode(i.node,i.moduleName),i!==e[e.length-1]&&(r+=this._parseResults.tokenizerOutput.predominantEndOfLineSequence),t+=r}return t}_formatImportNode(e,t){let n=`import ${t}`;return e.alias&&(n+=` as ${e.alias.value}`),n}_formatImportFromNode(e,t){const n=e.imports.sort(((e,t)=>this._compareSymbols(e,t))).map((e=>{let t=e.name.value;return e.alias&&(t+=` as ${e.alias.value}`),t}));let s=`from ${t} import `;if(e.isWildcardImport)return s+"*";const i=n.join(", ");if(s.length+i.length<=88)return s+i;s+="("+this._parseResults.tokenizerOutput.predominantEndOfLineSequence;for(const e of n)s+=this._parseResults.tokenizerOutput.predominantTabSequence+e+","+this._parseResults.tokenizerOutput.predominantEndOfLineSequence;return s+=")",s}_compareSymbols(e,t){return e.name.value<t.name.value?-1:1}}},598:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createIndentationString=t.getIndentationFromText=t.findNonWhitespaceTokenAtOrBeforeOffset=t.getModuleStatementIndentation=t.reindentSpan=t.getNewlineIndentation=void 0;const s=n(8494),i=n(9489),a=n(1464),r=n(3550),o=n(7093),l=n(1775);function c(e,t,n){const i=function(e,t){const n=e.tokenizerOutput.tokens,i=n.getItemAtPosition(t);if(i<0)return;const o=function(e,t){const n=v(e,t);if(n)return 5===n.type?n:void 0}(n,i);if(!o||5!==o.type)return;const l=o;if(!(4&l.flags))return;if(!(65536&l.flags||r.TextRange.contains((0,s.getStringValueRange)(l),t)))return;const c=e.tokenizerOutput.lines,p=(0,a.convertOffsetToPosition)(o.start,c);return f(e,(0,a.convertOffsetToPosition)(t,c).line,p.line)}(e,t);if(void 0!==i)return i;const o=function(e,t){const n=e.tokenizerOutput.tokens,s=e.tokenizerOutput.lines,i=function(e,t){const n=e.getItemAtPosition(t);if(n<0)return n;for(let t=n+1;t<e.count;t++){const n=_(e,t);if(4!==(null==n?void 0:n.type)&&2!==(null==n?void 0:n.type))return t}return e.count-1}(n,t);if(!(i<0))for(let o=i;o>0;o--){const i=_(n,o);if(r.TextRange.getEnd(i)<t)return;const l=_(n,o-1),c=i?(0,a.convertTextRangeToRange)(i,s):void 0,p=l?(0,a.convertTextRangeToRange)(l,s):void 0;if(c&&p&&p.start.line<c.start.line&&2!==l.type)return h(e,l,0,t)}}(e,t);return void 0!==o?o:(n=null!=n?n:function(e,t){const n=e.tokenizerOutput.tokens,i=n.getItemAtPosition(t);if(i<0)return!1;for(let t=i;t>=0;t--){const i=_(n,t);if(!i)return!1;switch(i.type){case 4:case 2:case 1:continue;case 8:{const e=_(n,t-1);if(10===(null==e?void 0:e.type))return!1;const s=i;if(30===s.keywordType||32===s.keywordType||5===s.keywordType||8===s.keywordType||31===s.keywordType)return!0;if(33!==s.keywordType&&15!==s.keywordType&&26!==s.keywordType&&9!==s.keywordType)return!1}}const a=(0,s.findNodeByOffset)(e.parseTree,i.start);return!!(0,s.getFirstAncestorOrSelf)(a,(e=>44===e.nodeType||43===e.nodeType))}return!1}(e,t),Math.max(p(e,t,n).indentation,0))}function p(e,t,n){const i=T(e.tokenizerOutput.tokens,t);if(!i)return{indentation:0};const o=(0,s.findNodeByOffset)(e.parseTree,r.TextRange.getEnd(i));if(!o)return{indentation:0};if(63===o.nodeType){const n=P(e),s=(0,l.getContainer)(o,!1),i=d(e,t,null!=s?s:e.parseTree,o);return i.indentation+=n,i}const c=(0,s.getFirstAncestorOrSelfOfKind)(o,50);if(!c)return d(e,t,e.parseTree,o);const p=(0,a.convertTextRangeToRange)(c,e.tokenizerOutput.lines);if(n||p.start.line===p.end.line&&c.statements.length>0){const n=(0,l.getContainer)(c,!1);return d(e,t,null!=n?n:e.parseTree,c)}return d(e,t,c,o)}function d(e,t,n,s){if(36===n.nodeType)return{token:u(e,n,s),indentation:0};if(63===n.nodeType||function(e,t,n){const s=n.statements.filter((e=>e.length>0));if(0===s.length)return!0;if(1===s.length&&(47!==s[0].nodeType||1===s[0].statements.length)&&s[0].start>=t&&e.tokenizerOutput.lines.getItemAtPosition(s[0].start)===e.tokenizerOutput.lines.getItemAtPosition(t))return!0;const i=e.tokenizerOutput.tokens,a=i.getItemAtPosition(n.start),r=i.getItemAtPosition(n.statements[0].start);for(let e=a;e<=r;e++){const t=_(i,e);if(3===(null==t?void 0:t.type))return!1}return!0}(e,t,n)){const s=P(e),i=(0,l.getContainer)(n,!1),a=d(e,t,null!=i?i:e.parseTree,n);return{token:a.token,indentation:a.indentation+s}}{const t=e.tokenizerOutput.tokens;return{token:u(e,n,s),indentation:y(t,t.getItemAtPosition(n.start))}}}function u(e,t,n){const i=e.tokenizerOutput.tokens;for(const e of t.statements)if(r.TextRange.containsRange(e,n))return(0,s.getTokenAt)(i,e.start);return(0,s.getTokenAt)(i,t.start)}function y(e,t){for(let n=t;n<e.count;n++){const t=_(e,n);if(3===(null==t?void 0:t.type))return t.indentAmount}return 0}function m(e){return 13===e.type||15===e.type||17===e.type}function g(e){return 14===e.type||16===e.type||18===e.type}function h(e,t,n,i){const r=e.tokenizerOutput.lines,o=(0,a.convertOffsetToPosition)(t.start,r).line,l=r.getItemAt(o),c=P(e);let d=t,u=!0,y=0;for(;d&&d.start>=l.start;){if(g(d))u=!1,y+=1;else{if(m(d)&&0===y){if(13===d.type&&u){const t=p(e,d.start,!1).indentation,n=(0,s.findNodeByOffset)(e.parseTree,d.start-1),i=(0,s.getFirstAncestorOrSelfOfKind)(n,28);return i&&28===i.nodeType&&(0,a.convertOffsetToPosition)(i.start,r).line===o?t+2*c:t+c}return u?p(e,d.start,!1).indentation+c:d.start-l.start+1}m(d)&&y>0?(y--,u=!1):x(d.type)||(u=!1)}d=T(e.tokenizerOutput.tokens,d.start-1)}return f(e,(0,a.convertOffsetToPosition)(i,e.tokenizerOutput.lines).line,o)}function f(e,t,n){n=Math.max(n,0);for(let s=t;s>=n;s--){const t=C(e,s);if(!I(e,s,t.charOffset))return t.indentation}return C(e,n).indentation}function T(e,t){const n=e.getItemAtPosition(t);if(!(n<0))return v(e,n)}function v(e,t){for(let n=t;n>=0;n--){const t=_(e,n);if(!t)break;if(!x(t.type))return t}}function _(e,t){if(!(t<0))return e.getItemAt(t)}function I(e,t,n){const s=b(e,t);return n===e.tokenizerOutput.lines.getItemAt(t).length-s}function b(e,t){let n=0;const s=e.tokenizerOutput.lines.getItemAt(t);for(let t=s.length-1;t>=0;t--)switch(e.text.charCodeAt(s.start+t)){case 12:case 35:case 10:case 13:n++;break;default:return n}return n}function C(e,t,n){let s=0,i=0;const a=P(e),r=e.tokenizerOutput.lines.getItemAt(t);for(let t=0;t<r.length;t++)switch(e.text.charCodeAt(r.start+t)){case 32:i++,s++;break;case 9:i++,s+=a;break;default:if(!n||n===t)return{charOffset:i,indentation:s};i++,s++}return{charOffset:i,indentation:s}}function S(e,t,n,s,i){for(let o=t;o<n;o++)e.text.charCodeAt(o)===s&&i.push({start:o,length:1,range:(0,a.convertTextRangeToRange)(r.TextRange.create(o,1),e.tokenizerOutput.lines),text:String.fromCharCode(s),kind:"token",firstTokenOnLine:!1,multilineDocComment:!1})}function x(e){switch(e){case 4:case 2:case 3:case 1:return!0;default:return!1}}function D(e,t){var n,i;if("string"!==t.kind||!t.firstTokenOnLine||t.range.start.line===t.range.end.line)return!1;const a=(0,s.findNodeByOffset)(e.parseTree,t.start);return 49===(null==a?void 0:a.nodeType)&&48===(null===(n=a.parent)||void 0===n?void 0:n.nodeType)&&47===(null===(i=a.parent.parent)||void 0===i?void 0:i.nodeType)&&(0,s.isDocString)(a.parent.parent)}function F(e,t,n){const s=[];for(let i=t.range.start.line;i<=t.range.end.line;i++)s.push(E(e,i,n,i===t.range.end.line?t:void 0));return s}function E(e,t,n,s){const i=C(e,t);if(I(e,t,i.charOffset))return"";let a=e.tokenizerOutput.lines.getItemAt(t);s&&(a=r.TextRange.fromBounds(a.start,Math.min(r.TextRange.getEnd(s),r.TextRange.getEnd(a))));const o=e.text.substr(a.start+i.charOffset,a.length-i.charOffset);return A(e,Math.max(i.indentation+n,0))+o}function P(e){const t=e.tokenizerOutput.predominantTabSequence,n=t.length;return 1===n&&9===t.charCodeAt(0)?o.defaultTabSize:n}function A(e,t){const n=e.tokenizerOutput.predominantTabSequence;if(1===n.length&&9===n.charCodeAt(0)){const e=t%o.defaultTabSize,n=(t-e)/o.defaultTabSize;return"\t".repeat(n)+" ".repeat(e)}return" ".repeat(t)}t.getNewlineIndentation=c,t.reindentSpan=function(e,t,n,s=!0){let o=0;const l=[],c=function(e,t){const n=e.tokenizerOutput.tokens;let s=Math.max(n.getItemAtPosition(t.start),0);const o=_(n,s);r.TextRange.getEnd(o)<t.start&&s++;let l=Math.min(n.getItemAtPosition(r.TextRange.getEnd(t)),n.length-1);const c=_(n,l);r.TextRange.getEnd(t)<=c.start&&l--;const p=[],d=e.tokenizerOutput.lines;for(let t=s;t<=l;t++){const s=_(n,t);if(s.comments)for(const e of s.comments)p.push({start:e.start,length:e.length,range:(0,a.convertTextRangeToRange)(e,d),text:e.value,kind:"comment",firstTokenOnLine:!1,multilineDocComment:!1});x(s.type)||0===s.length||p.push({start:s.start,length:s.length,range:(0,a.convertTextRangeToRange)(s,d),text:e.text.substr(s.start,s.length),kind:5===s.type?"string":"token",firstTokenOnLine:!1,multilineDocComment:!1})}if(0===p.length)return p;p.sort(((e,t)=>e.start-t.start));let u=p[0];const y=[];"comment"===u.kind&&S(e,0===s?0:r.TextRange.getEnd(_(n,s-1)),u.start,35,y);for(let t=1;t<p.length;t++){const n=p[t];if("comment"!==u.kind)for(let t=u.range.end.line;t<n.range.start.line;t++){const n=d.getItemAt(t),s=n.length-b(e,t)-1;if(s>=0){const t=n.start+s;S(e,t,t+1,92,y)}}"comment"===n.kind&&S(e,u.range.end.line===n.range.start.line?r.TextRange.getEnd(u):d.getItemAt(n.range.start.line).start,n.start,35,y),u=n}if((0,i.appendArray)(p,y),p.sort(((e,t)=>e.start-t.start)),u=p[0],0===s)u.firstTokenOnLine=!0;else{const e=v(n,s-1);if(e){const t=(0,a.convertOffsetToPosition)(r.TextRange.getEnd(e),d);u.firstTokenOnLine=t.line!==u.range.start.line}else u.firstTokenOnLine=!0}u.multilineDocComment=D(e,u);for(let t=1;t<p.length;t++){const n=p[t];n.firstTokenOnLine=u.range.end.line!==n.range.start.line,n.multilineDocComment=D(e,n),u=n}return p}(e,t);let p=c[0];o=n-C(e,p.range.start.line,p.range.start.character).indentation,p.multilineDocComment?(0,i.appendArray)(l,F(e,p,o)):(s&&l.push(A(e,n)),l.push(p.text));for(let t=1;t<c.length;t++){const n=c[t];n.firstTokenOnLine?(l.push(e.tokenizerOutput.predominantEndOfLineSequence.repeat(n.range.start.line-p.range.end.line)),n.multilineDocComment?(0,i.appendArray)(l,F(e,n,o)):(l.push(A(e,Math.max(0,C(e,n.range.start.line,n.range.start.character).indentation+o))),l.push(n.text))):(l.push(" ".repeat(n.range.start.character-p.range.end.character)),l.push(n.text)),p=n}return{originalSpan:r.TextRange.combine(c),text:l.join("")}},t.getModuleStatementIndentation=function(e){return 0===e.parseTree.statements.length?c(e,e.parseTree.length,!0):c(e,e.parseTree.statements[0].start,!0)},t.findNonWhitespaceTokenAtOrBeforeOffset=T,t.getIndentationFromText=C,t.createIndentationString=A},1775:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getContainer=t.getInsertionPointForSymbolUnderModule=void 0;const s=n(563),i=n(5523),a=n(8494),r=n(1766),o=n(2489),l=n(1464),c=n(3550);t.getInsertionPointForSymbolUnderModule=function(e,t,n,p){var d,u;const y=t.parseTree,m=function(e){var t;const n=c.TextRange.getEnd(e.parseTree),s=(0,l.convertOffsetToPosition)(n,e.tokenizerOutput.lines);return 0===s.character?n:(0,a.isBlankLine)(e,s.line)&&null!==(t=(0,l.convertPositionToOffset)({line:s.line,character:0},e.tokenizerOutput.lines))&&void 0!==t?t:n}(t);if(0===y.statements.length)return(0,o.containsOnlyWhitespace)(t.text)?0:m;const g=(0,s.getScope)(y);if(!g)return m;const h=(0,s.getFileInfo)(y),f=g.lookUpSymbol(n);if(f&&function(e,t,n,a){return t.filter((t=>{const r=e.resolveAliasDeclaration(t,!0,!0);if(!r)return!1;if((null==a?void 0:a.symbolDeclToIgnore)&&r.path===a.symbolDeclToIgnore)return!1;if(8===t.type){const e=(0,i.getNameNodeForDeclaration)(t);return!!e&&(0,s.getFileInfo)(e).filePath===n}return r.path===n}))}(e,f.getDeclarations(),h.filePath,p).length>0)return;const T=null!==(d=null==p?void 0:p.insertBefore)&&void 0!==d?d:m;if((0,r.isPrivateName)(n))return Math.max(0,T);if(T<c.TextRange.getEnd(y.statements[0]))return Math.max(0,Math.min(T,y.statements[0].start));const v=function(e,t){let n=e[0];for(let s=1;s<e.length;s++){const i=e[s];if(t<c.TextRange.getEnd(i))return n;switch(i.nodeType){case 10:case 28:if((0,r.isPrivateName)(i.name.value))return n;n=i;continue;case 47:if(i.statements.some((e=>3===e.nodeType&&38===e.leftExpression.nodeType&&(0,r.isPrivateName)(e.leftExpression.value))))return n;n=i;continue;default:n=i;continue}}return n}(y.statements,null!==(u=null==p?void 0:p.insertBefore)&&void 0!==u?u:m);return c.TextRange.getEnd(v)},t.getContainer=function(e,t=!0){return(0,a.getFirstAncestorOrSelf)(e,(n=>!(!t&&e===n||50!==n.nodeType&&63!==n.nodeType)))}},2858:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.performQuickAction=void 0;const r=n(7012),o=a(n(8494)),l=n(3213),c=n(9489),p=n(1464),d=n(3550),u=n(4969);t.performQuickAction=function(e,t,n,s){return"pyright.organizeimports"===e?new u.ImportSorter(n,s).sort():"pyright.addoptionalforparam"===e&&t.length>=1?function(e,t,n){(0,l.throwIfCancellationRequested)(n);let s=o.findNodeByOffset(e.parseTree,t);for(;s&&41!==s.nodeType;)s=s.parent;if(!s)return[];const i=s.typeAnnotation||s.typeAnnotationComment;if(!i)return[];const a=[],u=(0,p.convertOffsetToPosition)(i.start,e.tokenizerOutput.lines),y=(0,p.convertOffsetToPosition)(d.TextRange.getEnd(i),e.tokenizerOutput.lines);a.push({range:{start:u,end:u},replacementText:"Optional["}),a.push({range:{start:y,end:y},replacementText:"]"});const m=(0,r.getTopLevelImports)(e.parseTree),g=m.orderedImports.find((e=>"typing"===e.moduleName));if(g&&22===g.node.nodeType&&!g.node.isWildcardImport){const t=(0,r.getTextEditsForAutoImportSymbolAddition)({name:"Optional"},g,e);(0,c.appendArray)(a,t)}else{const t=(0,r.getTextEditsForAutoImportInsertion)({name:"Optional"},{name:"typing"},m,0,e,u);(0,c.appendArray)(a,t)}return a}(n,parseInt(t[0],10),s):[]}},4952:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ReferencesProvider=t.FindReferencesTreeWalker=t.ReferencesResult=void 0;const r=n(8905),o=n(5523),l=a(n(8494)),c=n(2917),p=n(1133),d=n(3213),u=n(9489),y=n(5839),m=n(1464),g=n(3550),h=n(8127);class f{constructor(e,t,n,s,i,a){this.requiresGlobalSearch=e,this.nodeAtOffset=t,this.symbolNames=n,this.declarations=s,this.useCase=i,this._reporter=a,this._locations=[],this.nonImportDeclarations=s.filter((e=>{var t;if(!(0,r.isAliasDeclaration)(e))return!0;if(!e.usesLocalName||!e.node)return!1;if(22===e.node.nodeType)return!1;const s=null===(t=e.node.alias)||void 0===t?void 0:t.value;return!!n.some((e=>e===s))}))}get containsOnlyImportDecls(){return this.declarations.length>0&&0===this.nonImportDeclarations.length}get locations(){return this._locations}addLocations(...e){0!==e.length&&(this._reporter&&this._reporter(e),(0,u.appendArray)(this._locations,e))}}t.ReferencesResult=f;class T{constructor(e,t,n,s,i,a){this._parseResults=e,this._filePath=t,this._referencesResult=n,this._includeDeclaration=s,this._evaluator=i,this._cancellationToken=a}findReferences(e=this._parseResults.parseTree){const t=new h.DocumentSymbolCollector(this._referencesResult.symbolNames,this._referencesResult.declarations,this._evaluator,this._cancellationToken,e,!0,!1,this._referencesResult.useCase),n=[];for(const e of t.collect())(this._includeDeclaration||e.node!==this._referencesResult.nodeAtOffset)&&n.push({path:this._filePath,range:{start:(0,m.convertOffsetToPosition)(e.range.start,this._parseResults.tokenizerOutput.lines),end:(0,m.convertOffsetToPosition)(g.TextRange.getEnd(e.range),this._parseResults.tokenizerOutput.lines)}});return n}}t.FindReferencesTreeWalker=T,t.ReferencesProvider=class{static getDeclarationForNode(e,t,n,s,i,a,r,u){(0,d.throwIfCancellationRequested)(r);const m=h.DocumentSymbolCollector.getDeclarationsForNode(n,s,!1,a,r,e,u);if(0===m.length)return;const g=function(e,t,n,s){const i=e.lookUpSymbolRecursive(n,n.value,!1);return!(i&&!a(i.symbol))&&s.some((e=>{var n,s;if(e.path!==t)return!0;const i=l.getEvaluationScopeNode(e.node);return 36===i.nodeType||10===i.nodeType||35===(null===(s=null===(n=e.node)||void 0===n?void 0:n.parent)||void 0===s?void 0:s.nodeType)&&e.node===e.node.parent.memberName}));function a(e,t=0){return!(t>p.maxTypeRecursionCount)&&(t++,!!(0,c.isVisibleExternally)(e)&&e.getDeclarations().reduce(((e,n)=>{if(!e)return!1;switch(n.type){case 8:case 0:case 7:return e;case 6:case 5:case 2:return e&&r(n.node.name,t);case 3:return!1;case 1:case 4:return 38===n.node.nodeType&&e&&r(n.node,t);default:(0,y.assertNever)(n)}}),!0))}function r(t,n){const s=l.getEvaluationScopeNode(t);switch(s.nodeType){case 10:case 28:{const t=s.name,i=e.lookUpSymbolRecursive(t,t.value,!1);return!i||a(i.symbol,n)}case 30:case 32:return!1;case 36:return!0;default:(0,y.assertNever)(s)}}}(s,t,n,m),T=new Set(m.map((e=>(0,o.getNameFromDeclaration)(e))).filter((e=>!!e)));return T.add(n.value),new f(g,n,[...T.values()],m,a,i)}static getDeclarationForPosition(e,t,n,s,i,a,r,o,c){(0,d.throwIfCancellationRequested)(o);const p=(0,m.convertPositionToOffset)(s,t.tokenizerOutput.lines);if(void 0===p)return;const u=l.findNodeByOffset(t.parseTree,p);return void 0!==u&&38===u.nodeType?this.getDeclarationForNode(e,n,u,i,a,r,o,c):void 0}static addReferences(e,t,n,s,i,a){const r=new T(e,t,n,s,i,a);n.addLocations(...r.findReferences())}}},1670:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RenameModuleProvider=void 0;const s=n(4494),i=n(563),a=n(8905),r=n(5523),o=n(2374),l=n(7012),c=n(8494),p=n(427),d=n(8816),u=n(1766),y=n(9489),m=n(2930),g=n(5839),h=n(6657),f=n(1464),T=n(9232),v=n(3550),_=n(5275),I=n(8127);var b;!function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Symbol=2]="Symbol"}(b||(b={}));class C{constructor(e,t,n,s,i,a,r,o,c){this._fs=e,this._evaluator=t,this._moduleFilePath=n,this._moduleNameAndType=i,this._newModuleNameAndType=a,this._type=r,this.declarations=o,this._token=c,this._aliasIntroduced=new Set,this._textEditTracker=new T.TextEditTracker,this._newModuleFilePath=(0,h.resolvePaths)(s),this._moduleNames=this._moduleName.split("."),this._newModuleNames=this._newModuleName.split("."),this._onlyNameChanged=(0,l.haveSameParentModule)(this._moduleNames,this._newModuleNames),(0,g.assert)(this._type!==b.Folder||this._onlyNameChanged,"We only support simple rename for folder")}static createForModule(e,t,n,s,i,a){if(e.fileSystem.existsSync(s)){if((0,h.isFile)(e.fileSystem,s))return this._create(e,t,n,s,i,b.File,a);if((0,h.isDirectory)(e.fileSystem,s)){if("Renamed"!==(0,h.getDirectoryChangeKind)(e.fileSystem,s,i))return;let r=(0,h.combinePaths)(s,"__init__.pyi");if(!e.fileSystem.existsSync(r)&&(r=(0,h.combinePaths)(s,"__init__.py"),!e.fileSystem.existsSync(r)))return;return this._create(e,t,n,r,(0,h.combinePaths)(i,(0,h.getFileName)(r)),b.Folder,a)}}}static createForSymbol(e,t,n,s,i,r,o){if(!e.fileSystem.existsSync(s))return;const l=r.filter((e=>(0,a.isClassDeclaration)(e)||(0,a.isFunctionDeclaration)(e)||(0,a.isVariableDeclaration)(e)));return 0!==l.length?this._create(e,t,n,s,i,b.Symbol,l,o):void 0}static canMoveSymbol(e,t,n){var s;const r=null===(s=(0,i.getFileInfo)(n))||void 0===s?void 0:s.filePath;if(!r||!(0,m.matchFileSpecs)(e,r,!0))return!1;if((0,u.isPrivateName)(n.value))return!1;const o=t.lookUpSymbolRecursive(n,n.value,!1);if(void 0===o||3!==o.scope.type)return!1;const l=o.symbol.getDeclarations();return 0!==l.length&&l.every((e=>{var s,i,r;if(!v.TextRange.containsRange(e.node,n))return!1;if((0,a.isFunctionDeclaration)(e)||(0,a.isClassDeclaration)(e))return!0;if((0,a.isVariableDeclaration)(e)){if(t.isExplicitTypeAliasDeclaration(e))return!1;if(e.inferredTypeSource&&(0,_.isExpressionNode)(e.inferredTypeSource)){const n=t.getType(e.inferredTypeSource);if(10===(null==n?void 0:n.category))return!1}return 3===(null===(s=e.node.parent)||void 0===s?void 0:s.nodeType)&&47===(null===(r=null===(i=e.node.parent)||void 0===i?void 0:i.parent)||void 0===r?void 0:r.nodeType)&&e.node.start===e.node.parent.start}return!1}))}static getSymbolTextRange(e,t){var n,s;if((0,a.isVariableDeclaration)(t)){const i=null!==(n=(0,c.getFirstAncestorOrSelfOfKind)(t.node,3))&&void 0!==n?n:t.node,a=(0,c.getFullStatementRange)(i,e),r=null!==(s=(0,f.convertRangeToTextRange)(a,e.tokenizerOutput.lines))&&void 0!==s?s:i;if(void 0!==t.docString){const e=(0,c.getVariableDocStringNode)(t.node);e&&v.TextRange.extend(r,e)}return r}return t.node}static getSymbolFullStatementTextRange(e,t){var n,s;const i=(0,a.isVariableDeclaration)(t)&&null!==(n=(0,c.getFirstAncestorOrSelfOfKind)(t.node,3))&&void 0!==n?n:t.node,r=(0,c.getFullStatementRange)(i,e,{includeTrailingBlankLines:!0});return null!==(s=(0,f.convertRangeToTextRange)(r,e.tokenizerOutput.lines))&&void 0!==s?s:i}static getRenameModulePath(e){const t=e.find((e=>!e.node));if(t)return t.path;const n=[...e.reduce(((e,t)=>e.add(t.path)),new Set)],s=n.findIndex((e=>(0,d.isStubFile)(e)));return s>=0?n[s]:n[0]}static getRenameModulePathInfo(e,t){const n=function(e){return"__init__"===(0,h.stripFileExtension)((0,h.getFileName)(e))?(0,h.getDirectoryPath)(e):e}(e),s=function(e,t){const n=(0,h.getFileExtension)(e),s=(0,h.getDirectoryPath)(e);return(0,h.combinePaths)(s,`${t}${n}`)}(n,t);return{filePath:n,newFilePath:s}}static _create(e,t,n,i,a,l,c,p){const u=t.findExecEnvironment(i),y=e.getModuleNameForImport(i,u);if(!y.moduleName)return;const m=e.getModuleNameForImport(a,u);if(!m.moduleName)return;p=s.CancellationToken.is(c)?c:p;const g=s.CancellationToken.is(c)?[]:c;return 0===g.length&&(g.push((0,r.createSynthesizedAliasDeclaration)(i)),(0,d.isStubFile)(i)&&(e.resolveImport(i,u,(0,o.createImportedModuleDescriptor)(y.moduleName)),e.getSourceFilesFromStub(i,u,!1).forEach((e=>g.push((0,r.createSynthesizedAliasDeclaration)(e)))))),new C(e.fileSystem,n,i,a,y,m,l,g,p)}get lastModuleName(){return this._moduleNames[this._moduleNames.length-1]}get textEditTracker(){return this._textEditTracker}getEdits(){return this._textEditTracker.getEdits(this._token)}renameReferences(e){switch(this._type){case b.Folder:return this._renameFolderReferences(e);case b.File:return this._renameModuleReferences(e);case b.Symbol:return this._updateSymbolReferences(e);default:return(0,g.assertNever)(this._type,`${this._type} is unknown`)}}tryGetFirstSymbolUsage(e,t){var n,s,i;const a=null!==(s=null!==(n=null==t?void 0:t.name)&&void 0!==n?n:(0,r.getNameFromDeclaration)(this.declarations[0]))&&void 0!==s?s:"",o=new I.DocumentSymbolCollector([a],null!==(i=null==t?void 0:t.decls)&&void 0!==i?i:this.declarations,this._evaluator,this._token,e.parseTree,!0,!1);for(const e of o.collect().sort(((e,t)=>e.range.start-t.range.start)))if(!((0,c.isImportModuleName)(e.node)||(0,c.isImportAlias)(e.node)||(0,c.isFromImportModuleName)(e.node)||(0,c.isFromImportName)(e.node)||(0,c.isFromImportAlias)(e.node)))return e.range.start}_updateSymbolReferences(e){const t=(0,i.getFileInfo)(e.parseTree).filePath,n=t===this._moduleFilePath,s=new I.DocumentSymbolCollector([(0,r.getNameFromDeclaration)(this.declarations[0])||""],this.declarations,this._evaluator,this._token,e.parseTree,!0,!1),a=(0,l.getTopLevelImports)(e.parseTree,!0),o=a.orderedImports.find((e=>e.moduleName===this._newModuleName));let p=!1;const d=new Map,u=new Map;for(const t of s.collect()){const s=t.node;if(49===s.nodeType){n&&this._textEditTracker.addEditWithTextRange(e,s,"");continue}if((0,c.isFromImportName)(s)){this._updateNameInFromImportForSymbolReferences(e,a,s);continue}p=!n||!this.declarations.some((e=>v.TextRange.containsRange(e.node,s)));const i=(0,c.getDottedNameWithGivenNodeAsLastName)(s);i!==s&&35===i.nodeType?this._collectSymbolReferencesPerImports(i,u):this._collectWildcardImports(s,d)}if(n&&p){const n=22===(null==o?void 0:o.node.nodeType)?this._getNewModuleName(t,o.node.module.leadingDots>0,!1):void 0,s=22===(null==o?void 0:o.node.nodeType)?{currentFromImport:o.node,originalModuleName:this._moduleName}:void 0;this._textEditTracker.addOrUpdateImport(e,a,{name:this._newModuleName,nameForImportFrom:n},(0,l.getImportGroupFromModuleNameAndType)(this._newModuleNameAndType),[{name:(0,r.getNameFromDeclaration)(this.declarations[0])}],s)}this._processSymbolReferenceOffWildcardImports(e,a,d),this._processSymbolReferenceOffImports(e,a,o,u)}_processSymbolReferenceOffImports(e,t,n,s){const a=(0,i.getFileInfo)(e.parseTree).filePath;if(a===this._newModuleFilePath)for(const[t,n]of s){this._canReplaceImportName(e,t,n)&&this._textEditTracker.deleteImportName(e,t);for(const t of n)this._textEditTracker.addEditWithTextRange(e,v.TextRange.fromBounds(t.start,t.memberName.start),"")}else for(const[i,r]of s){let s;if(this._canReplaceImportName(e,i,r)){const r=this._getReferenceModuleName(t,n);if(21===i.nodeType)r?(s=r,this._textEditTracker.deleteImportName(e,i)):(s=i.alias?i.alias.value:this._newModuleName,this._textEditTracker.addEditWithTextRange(e,i.module,this._newModuleName));else if(r)s=r,this._textEditTracker.deleteImportName(e,i);else{const t=i.parent,n=this._getNewModuleName(a,t.module.leadingDots>0,!0);s=i.alias?i.alias.value:this._newLastModuleName,this._textEditTracker.addEditWithTextRange(e,t.module,n),this._textEditTracker.addEditWithTextRange(e,i.name,this._newLastModuleName)}}else{const i=this._getReferenceModuleName(t,n);i?s=i:(s=this._newModuleName,this._textEditTracker.addOrUpdateImport(e,t,{name:this._newModuleName},(0,l.getImportGroupFromModuleNameAndType)(this._newModuleNameAndType)))}for(const t of r)this._textEditTracker.addEditWithTextRange(e,t.leftExpression,s)}}_processSymbolReferenceOffWildcardImports(e,t,n){const s=(0,i.getFileInfo)(e.parseTree).filePath;if(s!==this._newModuleFilePath)for(const[i,a]of n){const n=i,r=this._getNewModuleName(s,n.module.leadingDots>0,!1);this._textEditTracker.addOrUpdateImport(e,t,{name:this._newModuleName,nameForImportFrom:r},(0,l.getImportGroupFromModuleNameAndType)(this._newModuleNameAndType),[...a].map((e=>({name:e}))),{currentFromImport:n,originalModuleName:this._moduleName})}}_collectSymbolReferencesPerImports(e,t){var n;const s=35===e.leftExpression.nodeType?e.leftExpression.memberName:38===e.leftExpression.nodeType?e.leftExpression:void 0;if(!s)return;const i=null===(n=this._evaluator.getDeclarationsForNameNode(s))||void 0===n?void 0:n.filter((e=>(0,a.isAliasDeclaration)(e)&&(21===e.node.nodeType||23===e.node.nodeType)));if(!i||0===i.length)return;const r=i[0].node;(0,y.getOrAdd)(t,r,(()=>[])).push(e)}_collectWildcardImports(e,t){const n=this._evaluator.getDeclarationsForNameNode(e),s=null==n?void 0:n.find((e=>22===e.node.nodeType&&e.node.isWildcardImport));s&&(0,a.isAliasDeclaration)(s)&&(0,y.getOrAdd)(t,s.node,(()=>new Set)).add(e.value)}_updateNameInFromImportForSymbolReferences(e,t,n){var s;const a=(0,i.getFileInfo)(e.parseTree).filePath,r=a===this._newModuleFilePath,o=n.parent,c=null==o?void 0:o.parent,p=this._getNewModuleName(a,c.module.leadingDots>0,!1);if(r)return void this._textEditTracker.deleteImportName(e,o);if(1===c.imports.length)return void this._textEditTracker.addEditWithTextRange(e,c.module,p);this._textEditTracker.deleteImportName(e,o);const d={name:o.name.value,alias:null===(s=o.alias)||void 0===s?void 0:s.value};this._textEditTracker.addOrUpdateImport(e,t,{name:this._newModuleName,nameForImportFrom:p},(0,l.getImportGroupFromModuleNameAndType)(this._newModuleNameAndType),[d],{currentFromImport:c,originalModuleName:this._moduleName})}_getReferenceModuleName(e,t){var n,s;if(t&&20===t.node.nodeType)return(null===(n=t.subnode)||void 0===n?void 0:n.alias)?t.subnode.alias.value:this._newModuleName;if(null===(s=e.implicitImports)||void 0===s?void 0:s.has(this._newModuleFilePath)){const t=e.implicitImports.get(this._newModuleFilePath);return t.alias?t.alias.value:t.name.value}}_canReplaceImportName(e,t,n){var s;const i=null!==(s=t.alias)&&void 0!==s?s:21===t.nodeType?t.module.nameParts[t.module.nameParts.length-1]:t.name,a=I.DocumentSymbolCollector.getDeclarationsForNode(i,this._evaluator,!1,I.DocumentSymbolCollectorUseCase.Rename,this._token);if(0===a.length)return!1;const r=new I.DocumentSymbolCollector([i.value],a,this._evaluator,this._token,e.parseTree,!0,!1);for(const e of r.collect())if(!((0,c.isImportModuleName)(e.node)||(0,c.isImportAlias)(e.node)||(0,c.isFromImportModuleName)(e.node)||(0,c.isFromImportName)(e.node)||(0,c.isFromImportAlias)(e.node)||n.some((t=>v.TextRange.containsRange(t,e.node)))))return!1;return!0}_renameFolderReferences(e){const t=new I.DocumentSymbolCollector([this.lastModuleName],this.declarations,this._evaluator,this._token,e.parseTree,!0,!1);for(const n of t.collect())this._textEditTracker.addEditWithTextRange(e,n.range,this._newLastModuleName)}_renameModuleReferences(e){const t=new I.DocumentSymbolCollector([this.lastModuleName],this.declarations,this._evaluator,this._token,e.parseTree,!0,!1).collect();this._updateModuleReferences(e,t),this._updateRelativeModuleNamePath(e,t)}_updateRelativeModuleNamePath(e,t){const n=(0,i.getFileInfo)(e.parseTree).filePath;if(n!==this._moduleFilePath)return;let s;for(const i of this._getNewRelativeModuleNamesForFileMoved(n,S.collect(e.parseTree).filter((e=>!t.some((t=>v.TextRange.containsRange(e.parent,t.node))))))){if(this._textEditTracker.addEditWithTextRange(e,i.moduleName,i.newModuleName),!i.itemsToMove)continue;const t=i.moduleName.parent;for(const t of i.itemsToMove)this._textEditTracker.deleteImportName(e,t);s=null!=s?s:(0,l.getTopLevelImports)(e.parseTree,!1),this._textEditTracker.addOrUpdateImport(e,s,{name:this._newModuleName,nameForImportFrom:(0,l.getRelativeModuleName)(this._fs,this._newModuleFilePath,this._newModuleFilePath,!1,!0)},(0,l.getImportGroupFromModuleNameAndType)(this._newModuleNameAndType),i.itemsToMove.map((e=>{var t;return{name:e.name.value,alias:null===(t=e.alias)||void 0===t?void 0:t.value}})),{currentFromImport:t,originalModuleName:this._moduleName})}}_updateModuleReferences(e,t){var n,s,r,o,p;const d=(0,i.getFileInfo)(e.parseTree).filePath;let u;for(const i of t){const y=i.node;if(49===y.nodeType){this._textEditTracker.addEditWithTextRange(e,i.range,this._newLastModuleName);continue}if((0,c.isImportModuleName)(y)){if(!(0,c.isLastNameOfModuleName)(y))continue;const t=(0,c.getFirstAncestorOrSelfOfKind)(y,37);if(1===t.nameParts.length&&21===(null===(n=t.parent)||void 0===n?void 0:n.nodeType)&&!t.parent.alias&&this._newModuleNames.length>1){this._aliasIntroduced.add(t.parent),this._textEditTracker.addEditWithTextRange(e,t,`${this._newModuleName} as ${this._newLastModuleName}`);continue}this._textEditTracker.addEditWithTextRange(e,t,this._newModuleName);continue}if((0,c.isImportAlias)(y)){this._textEditTracker.addEditWithTextRange(e,i.range,this._newLastModuleName);continue}if((0,c.isFromImportModuleName)(y)){if(!(0,c.isLastNameOfModuleName)(y))continue;const n=(0,c.getFirstAncestorOrSelfOfKind)(y,37),s=n.parent,i=[],a=[];for(const e of s.imports)this._isExportedSymbol(e.name)?i.push(e):a.push(e);if(0===a.length){this._textEditTracker.addEditWithTextRange(e,n,this._getNewModuleName(d,n.leadingDots>0,!1));continue}if(0===i.length)continue;if(s.module.leadingDots>0)for(const t of this._getNewRelativeModuleNamesForFileMoved(d,[s.module]))this._textEditTracker.addEditWithTextRange(e,t.moduleName,t.newModuleName);for(const t of i)this._textEditTracker.deleteImportName(e,t);u=null!=u?u:(0,l.getTopLevelImports)(e.parseTree,!1),this._textEditTracker.addOrUpdateImport(e,u,{name:this._newModuleName},(0,l.getImportGroupFromModuleNameAndType)(this._newModuleNameAndType),i.map((e=>{var n;return{name:t.findIndex((t=>t.node===e.name))>=0?this._newLastModuleName:e.name.value,alias:t.findIndex((t=>t.node===e.alias))>=0?this._newLastModuleName:null===(n=e.alias)||void 0===n?void 0:n.value}})),{currentFromImport:s,originalModuleName:this._moduleName});continue}if((0,c.isFromImportName)(y)){if(this._textEditTracker.isNodeRemoved(y))continue;const t=null===(s=y.parent)||void 0===s?void 0:s.parent,n=this._getNewModuleName(d,t.module.leadingDots>0,!0);if(this._isExportedSymbol(y)){this._textEditTracker.addEditWithTextRange(e,i.range,this._newLastModuleName);continue}if(1===t.imports.length)this._textEditTracker.addEditWithTextRange(e,t.module,n),this._textEditTracker.addEditWithTextRange(e,i.range,this._newLastModuleName);else{const s=y.parent;if(t.module.leadingDots>0)for(const n of this._getNewRelativeModuleNamesForFileMoved(d,[t.module]))this._textEditTracker.addEditWithTextRange(e,n.moduleName,n.newModuleName);this._textEditTracker.deleteImportName(e,s),u=null!=u?u:(0,l.getTopLevelImports)(e.parseTree,!1);const i={name:this._newLastModuleName,alias:(null===(r=s.alias)||void 0===r?void 0:r.value)===this.lastModuleName?this._newLastModuleName:null===(o=s.alias)||void 0===o?void 0:o.value};this._textEditTracker.addOrUpdateImport(e,u,{name:this._newModuleName,nameForImportFrom:n},(0,l.getImportGroupFromModuleNameAndType)(this._newModuleNameAndType),[i],{currentFromImport:t,originalModuleName:this._moduleName})}continue}if((0,c.isFromImportAlias)(y)){if(this._textEditTracker.isNodeRemoved(y))continue;this._textEditTracker.addEditWithTextRange(e,i.range,this._newLastModuleName);continue}const m=I.DocumentSymbolCollector.getDeclarationsForNode(y,this._evaluator,!1,I.DocumentSymbolCollectorUseCase.Rename,this._token).filter((e=>(0,a.isAliasDeclaration)(e)));if(this._onlyNameChanged)this._textEditTracker.addEditWithTextRange(e,i.range,this._newLastModuleName);else if(null==m?void 0:m.some((e=>!(e.usesLocalName||e.node&&21!==e.node.nodeType||this._aliasIntroduced.has(e.node))))){const t=(0,c.getDottedNameWithGivenNodeAsLastName)(y);if(35!==(null===(p=t.parent)||void 0===p?void 0:p.nodeType)){this._textEditTracker.addEditWithTextRange(e,t,this._newModuleName);continue}const n=this._evaluator.getDeclarationsForNameNode(t.parent.memberName);if(!n||0===n.length)continue;this._textEditTracker.addEditWithTextRange(e,t,this._newModuleName)}else i.node.value===this._newLastModuleName||this._textEditTracker.addEditWithTextRange(e,i.range,this._newLastModuleName)}}_getNewRelativeModuleNamesForFileMoved(e,t){if(e!==this._moduleFilePath)return[];const n="__init__"===(0,h.stripFileExtension)((0,h.getFileName)(e)),s=(0,h.getDirectoryPath)(e),i=[];for(const e of t){if(0===e.leadingDots)continue;const t=this._getNewModuleNameInfoForFileMoved(e,n,s);if(!t)continue;const a=(0,l.getRelativeModuleName)(this._fs,t.src,t.dest,!1,!0);i.push({moduleName:e,newModuleName:a,itemsToMove:t.itemsToMove})}return i}_getNewModuleNameInfoForFileMoved(e,t,n){const s=(0,i.getImportInfo)(e);if(!s)return;let a=s.resolvedPaths[s.resolvedPaths.length-1];if(!a){if(0!==e.nameParts.length)return;{const t=(0,l.getDirectoryLeadingDotsPointsTo)(n,e.leadingDots);if(!t)return;a=(0,h.combinePaths)(t,"__init__.py")}}if(this._moduleFilePath!==a||!t)return{src:this._newModuleFilePath,dest:a};const r=[],o=[];for(const t of e.parent.imports)this._isExportedSymbol(t.name)?r.push(t):o.push(t);return 0===o.length?{src:this._newModuleFilePath,dest:this._newModuleFilePath}:0===r.length?{src:this._newModuleFilePath,dest:this._moduleFilePath}:{src:this._newModuleFilePath,dest:this._moduleFilePath,itemsToMove:[...r]}}_isExportedSymbol(e){const t=this._evaluator.getDeclarationsForNameNode(e);return!!t&&!t.some((e=>(0,a.isAliasDeclaration)(e)&&e.submoduleFallback))}_getNewModuleName(e,t,n){const s=e===this._moduleFilePath?this._newModuleFilePath:e,i=t?(0,l.getRelativeModuleName)(this._fs,s,this._newModuleFilePath,n,!0):this._newModuleName;if(n&&i.endsWith(this._newLastModuleName)){const e=i===this._newLastModuleName?0:i.length>this._newLastModuleName.length+1&&"."!==i[i.length-this._newLastModuleName.length-2]?1:0,t=i.length-this._newLastModuleName.length-e,n=i.substr(0,t);return n.length>0?n:"."}return i}get _moduleName(){return this._moduleNameAndType.moduleName}get _newLastModuleName(){return this._newModuleNames[this._newModuleNames.length-1]}get _newModuleName(){return this._newModuleNameAndType.moduleName}}t.RenameModuleProvider=C;class S extends p.ParseTreeWalker{constructor(){super(...arguments),this._result=[]}walk(e){(0,_.isExpressionNode)(e)||super.walk(e)}visitModuleName(e){return this._result.push(e),!1}static collect(e){const t=new S;return t.walk(e),t._result}}},9437:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.SignatureHelpProvider=void 0;const r=n(4494),o=n(1272),l=n(5678),c=n(7848),p=a(n(8494)),d=n(8494),u=n(1133),y=n(3213),m=n(1464),g=n(3490);t.SignatureHelpProvider=class{static getSignatureHelpForPosition(e,t,n,s,i,a){var r;(0,y.throwIfCancellationRequested)(a);const o=(0,m.convertPositionToOffset)(t,e.tokenizerOutput.lines);if(void 0===o)return;let l=p.findNodeByOffset(e.parseTree,o);const c=l,u=l?p.getNodeDepth(l):0;let g=o-1;for(;g>=0;){const t=e.text.substr(g,1);if(","===t||"("===t)break;const n=p.findNodeByOffset(e.parseTree,g);if(n&&n!==c){p.getNodeDepth(n)>u&&(l=n);break}g--}if(void 0===l)return;const h=(0,d.getCallNodeAndActiveParameterIndex)(l,o,e.tokenizerOutput.tokens);if(!h)return;const f=s.getCallSignatureInfo(h.callNode,h.activeIndex,h.activeOrFake);return f?{signatures:f.signatures.map((e=>this._makeSignature(f.callNode,e,n,s,i))),callHasParameters:!!(null===(r=f.callNode.arguments)||void 0===r?void 0:r.length)}:void 0}static _makeSignature(e,t,n,s,i){var a;const p=t.type,d=s.printFunctionParts(p,1024),y=[],m=null!==(a=(0,g.getFunctionDocStringFromType)(p,n,s))&&void 0!==a?a:this._getDocStringFromCallNode(e,n,s);let h,f="(";const T=p.details.parameters;d[0].forEach(((e,n)=>{let s="";n<T.length?s=T[n].name||"":T.length>0&&(s=T[T.length-1].name||"");const i=n>=T.length?T.length-1:n;if(i>=0){const e=T[i];if((0,c.isTypedKwargs)(e)&&(0,u.isClassInstance)(e.type)&&e.type.details.typedDictEntries){const t=n-i;s=[...e.type.details.typedDictEntries.keys()][t]}}y.push({startOffset:f.length,endOffset:f.length+e.length,text:e,documentation:(0,l.extractParameterDocumentation)(m||"",s)}),s&&t.activeParam&&t.activeParam.name===s&&(h=n),f+=e,n<d[0].length-1&&(f+=", ")})),f+=") -> "+d[1],t.activeParam&&void 0===h&&(h=T.indexOf(t.activeParam),-1===h&&(h=void 0));const v={label:f,parameters:y,activeParameter:h};return m&&(i===r.MarkupKind.Markdown?v.documentation={kind:r.MarkupKind.Markdown,value:(0,o.convertDocStringToMarkdown)(m)}:v.documentation={kind:r.MarkupKind.PlainText,value:(0,o.convertDocStringToPlainText)(m)}),v}static _getDocStringFromCallNode(e,t,n){var s;let i;const a=e.leftExpression;if(38===a.nodeType?i=a:35===a.nodeType&&(i=a.memberName),i)for(const e of null!==(s=n.getDeclarationsForNameNode(i))&&void 0!==s?s:[]){const s=n.resolveAliasDeclaration(e,!0);if(!s)continue;const a=n.getType(i);if(!a)continue;const r=(0,g.getDocumentationPartsForTypeAndDecl)(t,a,s,n);if(r)return r}}}},3490:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.combineExpressionTypes=t.getAutoImportText=t.getDocumentationPartsForTypeAndDecl=t.getOverloadedFunctionDocStringsFromType=t.getFunctionDocStringFromType=t.getConstructorTooltip=t.getFunctionTooltip=t.getOverloadedFunctionTooltip=t.getToolTipForType=void 0;const r=a(n(8494)),o=n(3371),l=n(1133),c=n(2930),p=n(2489);function d(e,t,n,s=70){let i="";const a=l.OverloadedFunctionType.getOverloads(e).map((e=>u("",e.details.name,e,t,!1,n)));for(let e=0;e<a.length;e++)0!==e&&a[e].length>s&&a[e-1].length<=s&&(i+="\n"),i+=a[e]+": ...",e<a.length-1&&(i+="\n",a[e].length>s&&(i+="\n"));return i}function u(e,t,n,s,i=!1,a){const r=0===e.length?"":`(${e}) `,o=a===c.SignatureDisplayType.formatted?"\n"+" ".repeat(4):"",l=s.printFunctionParts(n);return`${r}${i?"":"def "}${t}${i?": ":""}${y(l,o,a)} -> ${l[1]}`}function y(e,t,n){return n===c.SignatureDisplayType.formatted&&e.length>0&&e[0].length>1?`(${t}${e[0].join(","+t)}\n)`:`(${e[0].join(", ")})`}function m(e,t,n){const s=e.details.declaration,i=s?r.getEnclosingClass(s.node):void 0,a=i?n.getTypeOfClass(i):void 0;return(0,o.getFunctionDocStringInherited)(e,s,t,null==a?void 0:a.classType)}function g(e,t,n){if(0===e.overloads.length)return[];const s=e.overloads[0].details.declaration,i=s?r.getEnclosingClass(s.node):void 0,a=i?n.getTypeOfClass(i):void 0;return(0,o.getOverloadedFunctionDocStringsInherited)(e,e.overloads.map((e=>e.details.declaration)).filter(p.isDefined),t,n,null==a?void 0:a.classType)}t.getToolTipForType=function(e,t,n,s,i,a){let r="";return(0,l.isOverloadedFunction)(e)?(r=t.length>0?`(${t})\n`:"",r+=`${d(e,s,a)}`):(0,l.isFunction)(e)?r=`${u(t,n,e,s,i,a)}`:(r=t.length>0?`(${t}) `:"",r+=`${n}: ${s.printType(e)}`),r},t.getOverloadedFunctionTooltip=d,t.getFunctionTooltip=u,t.getConstructorTooltip=function e(t,n,s,i){let a="";if((0,l.isOverloadedFunction)(n))n.overloads.map((n=>e(t,n,s,i))).forEach(((e,t)=>{a+=e+": ...\n\n"}));else if((0,l.isFunction)(n)){const e=i===c.SignatureDisplayType.formatted?"\n"+" ".repeat(4):" ",r=y(s.printFunctionParts(n),e,i);a+=`class ${t}${r}`}return a},t.getFunctionDocStringFromType=m,t.getOverloadedFunctionDocStringsFromType=g,t.getDocumentationPartsForTypeAndDecl=function(e,t,n,s,i){var a;const r=function(e,t,n,s){var i;if(1===(null==t?void 0:t.type)&&t.typeAliasName&&t.docString)return t.docString;if(1===(null==t?void 0:t.type)){const n=null!==(i=null==s?void 0:s.getDeclarations().find((e=>1===e.type&&!!e.docString)))&&void 0!==i?i:t,a=(0,o.getVariableDocString)(n,e);if(a)return a}else if(5===(null==t?void 0:t.type)){const s=(0,o.getPropertyDocStringInherited)(t,e,n);if(s)return s}}(e,n,s,null==i?void 0:i.symbol);let c;if(8===(null==n?void 0:n.type)){if(8===n.type&&n.node&&21===n.node.nodeType&&(null==i?void 0:i.name)&&!n.node.alias){const e=n.node.module.nameParts.find((e=>e.value===i.name));if(e){const t=null!==(a=s.getDeclarationsForNameNode(e))&&void 0!==a?a:[n];n=t.length>0?t[0]:n}}c=(0,o.getModuleDocStringFromPaths)([n.path],e)}return c=null!=c?c:t?function(e,t,n,s,i){if((0,l.isModule)(t)){const s=(0,o.getModuleDocString)(t,n,e);if(s)return s}else if((0,l.isInstantiableClass)(t)){const s=(0,o.getClassDocString)(t,n,e);if(s)return s}else if((0,l.isFunction)(t)){const n=i?s.bindFunctionToClassOrObject(i,t):t;if(n&&(0,l.isFunction)(n)){const t=m(n,e,s);if(t)return t}}else if((0,l.isOverloadedFunction)(t)){const n=i?s.bindFunctionToClassOrObject(i,t):t;if(n&&(0,l.isOverloadedFunction)(n)){const t=g(n,e,s).find((e=>e));if(t)return t}}}(e,t,n,s,null==i?void 0:i.boundObjectOrClass):void 0,r&&c&&r!==c?`${r}\n\n${c}`:r||c},t.getAutoImportText=function(e,t,n){let s;return s=t?`from ${t} import ${e}`:`import ${e}`,n&&(s=`${s} as ${n}`),s},t.combineExpressionTypes=function(e,t){const n=e.map((e=>t.getType(e)||l.UnknownType.create()));let s=(0,l.combineTypes)(n);return 1===n.length&&7===s.category&&l.ClassType.isBuiltIn(s,"list")&&s.typeArguments?s=s.typeArguments[0]:1===n.length&&7===s.category&&l.ClassType.isBuiltIn(s,"range")&&(s=t.getBuiltInObject(e[0],"int")),s}},9866:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Localizer=t.loadStringsForLocale=t.getLocaleFromEnv=t.setLocaleOverride=t.getRawStringFromMap=t.ParameterizedString=void 0;const s=n(5839),i=n(603),a=n(1783),r=n(1859),o=n(3409),l=n(6687),c=n(5491),p=n(3559),d=n(1308);class u{constructor(e){this._formatString=e}format(e){let t=this._formatString;return Object.keys(e).forEach((n=>{t=t.replace(new RegExp(`{${n}}`,"g"),e[n].toString())})),t}getFormatString(){return this._formatString}}t.ParameterizedString=u;const y="en-us",m=new Map([["de",a],["en-us",i],["es",r],["fr",o],["ja",l],["ru",c],["zh-cn",p],["zh-tw",d]]);let g,h,f={};function T(e){void 0===g&&(f=function(){const e=m.get(y);return e||(console.error("Could not load default strings"),{})}(),g=I(_(),m));const t=e.split("."),n=v(g,t)||v(f,t);if(n)return n;(0,s.fail)(`Missing localized string for key "${e}"`)}function v(e,t){let n=e;for(const e of t){if(!n[e])return;n=n[e]}return n}function _(){if(h)return h;try{if(null===navigator||void 0===navigator?void 0:navigator.language)return navigator.language.toLowerCase()}catch{}const e=process.env,t=e.VSCODE_NLS_CONFIG;if(t)try{return JSON.parse(t).locale}catch{}const n=e.LC_ALL||e.LC_MESSAGES||e.LANG||e.LANGUAGE;if(n){const e=n.split(".");if(e.length>0&&e[0])return e[0]}return y}function I(e,t){if(e===y)return{};let n=t.get(e);if(void 0!==n)return n;const s=e.split("-");return s.length>0&&s[0]&&(n=t.get(s[0]),void 0!==n)?n:{}}t.getRawStringFromMap=v,t.setLocaleOverride=function(e){h=e.toLowerCase()},t.getLocaleFromEnv=_,t.loadStringsForLocale=I,function(e){let t,n,s,i;!function(e){e.annotatedParamCountMismatch=()=>new u(T("Diagnostic.annotatedParamCountMismatch")),e.annotatedTypeArgMissing=()=>T("Diagnostic.annotatedTypeArgMissing"),e.annotationFormatString=()=>T("Diagnostic.annotationFormatString"),e.annotationNotSupported=()=>T("Diagnostic.annotationNotSupported"),e.annotationSpansStrings=()=>T("Diagnostic.annotationSpansStrings"),e.annotationStringEscape=()=>T("Diagnostic.annotationStringEscape"),e.argAssignment=()=>new u(T("Diagnostic.argAssignment")),e.argAssignmentFunction=()=>new u(T("Diagnostic.argAssignmentFunction")),e.argAssignmentParam=()=>new u(T("Diagnostic.argAssignmentParam")),e.argAssignmentParamFunction=()=>new u(T("Diagnostic.argAssignmentParamFunction")),e.argMissingForParam=()=>new u(T("Diagnostic.argMissingForParam")),e.argMissingForParams=()=>new u(T("Diagnostic.argMissingForParams")),e.argMorePositionalExpectedCount=()=>new u(T("Diagnostic.argMorePositionalExpectedCount")),e.argMorePositionalExpectedOne=()=>T("Diagnostic.argMorePositionalExpectedOne"),e.argPositional=()=>T("Diagnostic.argPositional"),e.argPositionalExpectedCount=()=>new u(T("Diagnostic.argPositionalExpectedCount")),e.argPositionalExpectedOne=()=>T("Diagnostic.argPositionalExpectedOne"),e.argTypePartiallyUnknown=()=>T("Diagnostic.argTypePartiallyUnknown"),e.argTypeUnknown=()=>T("Diagnostic.argTypeUnknown"),e.assertAlwaysTrue=()=>T("Diagnostic.assertAlwaysTrue"),e.assertTypeArgs=()=>T("Diagnostic.assertTypeArgs"),e.assertTypeTypeMismatch=()=>new u(T("Diagnostic.assertTypeTypeMismatch")),e.assignmentExprContext=()=>T("Diagnostic.assignmentExprContext"),e.assignmentExprComprehension=()=>new u(T("Diagnostic.assignmentExprComprehension")),e.assignmentExprInSubscript=()=>T("Diagnostic.assignmentExprInSubscript"),e.assignmentInProtocol=()=>T("Diagnostic.assignmentInProtocol"),e.assignmentTargetExpr=()=>T("Diagnostic.assignmentTargetExpr"),e.asyncNotInAsyncFunction=()=>T("Diagnostic.asyncNotInAsyncFunction"),e.awaitIllegal=()=>T("Diagnostic.awaitIllegal"),e.awaitNotInAsync=()=>T("Diagnostic.awaitNotInAsync"),e.backticksIllegal=()=>T("Diagnostic.backticksIllegal"),e.baseClassCircular=()=>T("Diagnostic.baseClassCircular"),e.baseClassInvalid=()=>T("Diagnostic.baseClassInvalid"),e.baseClassFinal=()=>new u(T("Diagnostic.baseClassFinal")),e.baseClassMethodTypeIncompatible=()=>new u(T("Diagnostic.baseClassMethodTypeIncompatible")),e.baseClassVariableTypeIncompatible=()=>new u(T("Diagnostic.baseClassVariableTypeIncompatible")),e.baseClassUnknown=()=>T("Diagnostic.baseClassUnknown"),e.bindTypeMismatch=()=>new u(T("Diagnostic.bindTypeMismatch")),e.breakOutsideLoop=()=>T("Diagnostic.breakOutsideLoop"),e.callableExtraArgs=()=>T("Diagnostic.callableExtraArgs"),e.callableFirstArg=()=>T("Diagnostic.callableFirstArg"),e.callableNotInstantiable=()=>new u(T("Diagnostic.callableNotInstantiable")),e.callableSecondArg=()=>T("Diagnostic.callableSecondArg"),e.casePatternIsIrrefutable=()=>T("Diagnostic.casePatternIsIrrefutable"),e.classAlreadySpecialized=()=>new u(T("Diagnostic.classAlreadySpecialized")),e.classDecoratorTypeUnknown=()=>T("Diagnostic.classDecoratorTypeUnknown"),e.classDefinitionCycle=()=>new u(T("Diagnostic.classDefinitionCycle")),e.classGetItemClsParam=()=>T("Diagnostic.classGetItemClsParam"),e.classMethodClsParam=()=>T("Diagnostic.classMethodClsParam"),e.classNotRuntimeSubscriptable=()=>new u(T("Diagnostic.classNotRuntimeSubscriptable")),e.classPatternBuiltInArgCount=()=>T("Diagnostic.classPatternBuiltInArgCount"),e.classPatternBuiltInArgPositional=()=>T("Diagnostic.classPatternBuiltInArgPositional"),e.classPatternTypeAlias=()=>new u(T("Diagnostic.classPatternTypeAlias")),e.classTypeParametersIllegal=()=>T("Diagnostic.classTypeParametersIllegal"),e.classVarNotAllowed=()=>T("Diagnostic.classVarNotAllowed"),e.classVarFirstArgMissing=()=>T("Diagnostic.classVarFirstArgMissing"),e.classVarOverridesInstanceVar=()=>new u(T("Diagnostic.classVarOverridesInstanceVar")),e.classVarTooManyArgs=()=>T("Diagnostic.classVarTooManyArgs"),e.classVarWithTypeVar=()=>T("Diagnostic.classVarWithTypeVar"),e.clsSelfParamTypeMismatch=()=>new u(T("Diagnostic.clsSelfParamTypeMismatch")),e.codeTooComplexToAnalyze=()=>T("Diagnostic.codeTooComplexToAnalyze"),e.collectionAliasInstantiation=()=>new u(T("Diagnostic.collectionAliasInstantiation")),e.comparisonAlwaysFalse=()=>new u(T("Diagnostic.comparisonAlwaysFalse")),e.comparisonAlwaysTrue=()=>new u(T("Diagnostic.comparisonAlwaysTrue")),e.comprehensionInDict=()=>T("Diagnostic.comprehensionInDict"),e.comprehensionInSet=()=>T("Diagnostic.comprehensionInSet"),e.concatenateParamSpecMissing=()=>T("Diagnostic.concatenateParamSpecMissing"),e.concatenateTypeArgsMissing=()=>T("Diagnostic.concatenateTypeArgsMissing"),e.constantRedefinition=()=>new u(T("Diagnostic.constantRedefinition")),e.constructorNoArgs=()=>new u(T("Diagnostic.constructorNoArgs")),e.constructorParametersMismatch=()=>new u(T("Diagnostic.constructorParametersMismatch")),e.containmentAlwaysFalse=()=>new u(T("Diagnostic.containmentAlwaysFalse")),e.containmentAlwaysTrue=()=>new u(T("Diagnostic.containmentAlwaysTrue")),e.continueInFinally=()=>T("Diagnostic.continueInFinally"),e.continueOutsideLoop=()=>T("Diagnostic.continueOutsideLoop"),e.dataClassBaseClassFrozen=()=>T("Diagnostic.dataClassBaseClassFrozen"),e.dataClassBaseClassNotFrozen=()=>T("Diagnostic.dataClassBaseClassNotFrozen"),e.dataClassFieldWithDefault=()=>T("Diagnostic.dataClassFieldWithDefault"),e.dataClassFieldWithoutAnnotation=()=>T("Diagnostic.dataClassFieldWithoutAnnotation"),e.dataClassFieldWithPrivateName=()=>T("Diagnostic.dataClassFieldWithPrivateName"),e.dataClassPostInitParamCount=()=>new u(T("Diagnostic.dataClassPostInitParamCount")),e.dataClassPostInitType=()=>new u(T("Diagnostic.dataClassPostInitType")),e.dataClassSlotsOverwrite=()=>T("Diagnostic.dataClassSlotsOverwrite"),e.dataClassTransformExpectedBoolLiteral=()=>T("Diagnostic.dataClassTransformExpectedBoolLiteral"),e.dataClassTransformFieldSpecifier=()=>new u(T("Diagnostic.dataClassTransformFieldSpecifier")),e.dataClassTransformPositionalParam=()=>T("Diagnostic.dataClassTransformPositionalParam"),e.dataClassTransformUnknownArgument=()=>new u(T("Diagnostic.dataClassTransformUnknownArgument")),e.declaredReturnTypePartiallyUnknown=()=>new u(T("Diagnostic.declaredReturnTypePartiallyUnknown")),e.declaredReturnTypeUnknown=()=>T("Diagnostic.declaredReturnTypeUnknown"),e.defaultValueContainsCall=()=>T("Diagnostic.defaultValueContainsCall"),e.defaultValueNotAllowed=()=>T("Diagnostic.defaultValueNotAllowed"),e.deprecatedClass=()=>new u(T("Diagnostic.deprecatedClass")),e.deprecatedConstructor=()=>new u(T("Diagnostic.deprecatedConstructor")),e.deprecatedFunction=()=>new u(T("Diagnostic.deprecatedFunction")),e.deprecatedType=()=>new u(T("Diagnostic.deprecatedType")),e.dictExpandIllegalInComprehension=()=>T("Diagnostic.dictExpandIllegalInComprehension"),e.dictInAnnotation=()=>T("Diagnostic.dictInAnnotation"),e.dictKeyValuePairs=()=>T("Diagnostic.dictKeyValuePairs"),e.dictUnpackIsNotMapping=()=>T("Diagnostic.dictUnpackIsNotMapping"),e.delTargetExpr=()=>T("Diagnostic.delTargetExpr"),e.dunderAllSymbolNotPresent=()=>new u(T("Diagnostic.dunderAllSymbolNotPresent")),e.duplicateArgsParam=()=>T("Diagnostic.duplicateArgsParam"),e.duplicateBaseClass=()=>T("Diagnostic.duplicateBaseClass"),e.duplicateCatchAll=()=>T("Diagnostic.duplicateCatchAll"),e.duplicateEnumMember=()=>new u(T("Diagnostic.duplicateEnumMember")),e.duplicateGenericAndProtocolBase=()=>T("Diagnostic.duplicateGenericAndProtocolBase"),e.duplicateImport=()=>new u(T("Diagnostic.duplicateImport")),e.duplicateKwargsParam=()=>T("Diagnostic.duplicateKwargsParam"),e.duplicateKeywordOnly=()=>T("Diagnostic.duplicateKeywordOnly"),e.duplicateParam=()=>new u(T("Diagnostic.duplicateParam")),e.duplicateCapturePatternTarget=()=>new u(T("Diagnostic.duplicateCapturePatternTarget")),e.duplicateStarPattern=()=>T("Diagnostic.duplicateStarPattern"),e.duplicateStarStarPattern=()=>T("Diagnostic.duplicateStarStarPattern"),e.duplicatePositionOnly=()=>T("Diagnostic.duplicatePositionOnly"),e.duplicateUnpack=()=>T("Diagnostic.duplicateUnpack"),e.ellipsisContext=()=>T("Diagnostic.ellipsisContext"),e.ellipsisSecondArg=()=>T("Diagnostic.ellipsisSecondArg"),e.enumClassOverride=()=>new u(T("Diagnostic.enumClassOverride")),e.exceptionGroupIncompatible=()=>T("Diagnostic.exceptionGroupIncompatible"),e.exceptionTypeIncorrect=()=>new u(T("Diagnostic.exceptionTypeIncorrect")),e.exceptionTypeNotClass=()=>new u(T("Diagnostic.exceptionTypeNotClass")),e.exceptionTypeNotInstantiable=()=>new u(T("Diagnostic.exceptionTypeNotInstantiable")),e.expectedAfterDecorator=()=>T("Diagnostic.expectedAfterDecorator"),e.expectedArrow=()=>T("Diagnostic.expectedArrow"),e.expectedAsAfterException=()=>T("Diagnostic.expectedAsAfterException"),e.expectedAssignRightHandExpr=()=>T("Diagnostic.expectedAssignRightHandExpr"),e.expectedBinaryRightHandExpr=()=>T("Diagnostic.expectedBinaryRightHandExpr"),e.expectedBoolLiteral=()=>T("Diagnostic.expectedBoolLiteral"),e.expectedCase=()=>T("Diagnostic.expectedCase"),e.expectedClassName=()=>T("Diagnostic.expectedClassName"),e.expectedCloseBrace=()=>T("Diagnostic.expectedCloseBrace"),e.expectedCloseBracket=()=>T("Diagnostic.expectedCloseBracket"),e.expectedCloseParen=()=>T("Diagnostic.expectedCloseParen"),e.expectedColon=()=>T("Diagnostic.expectedColon"),e.expectedComplexNumberLiteral=()=>T("Diagnostic.expectedComplexNumberLiteral"),e.expectedDecoratorExpr=()=>T("Diagnostic.expectedDecoratorExpr"),e.expectedDecoratorName=()=>T("Diagnostic.expectedDecoratorName"),e.expectedDecoratorNewline=()=>T("Diagnostic.expectedDecoratorNewline"),e.expectedDelExpr=()=>T("Diagnostic.expectedDelExpr"),e.expectedElse=()=>T("Diagnostic.expectedElse"),e.expectedEquals=()=>T("Diagnostic.expectedEquals"),e.expectedExceptionClass=()=>T("Diagnostic.expectedExceptionClass"),e.expectedExceptionObj=()=>T("Diagnostic.expectedExceptionObj"),e.expectedExpr=()=>T("Diagnostic.expectedExpr"),e.expectedImport=()=>T("Diagnostic.expectedImport"),e.expectedImportAlias=()=>T("Diagnostic.expectedImportAlias"),e.expectedImportSymbols=()=>T("Diagnostic.expectedImportSymbols"),e.expectedIdentifier=()=>T("Diagnostic.expectedIdentifier"),e.expectedIndentedBlock=()=>T("Diagnostic.expectedIndentedBlock"),e.expectedIn=()=>T("Diagnostic.expectedIn"),e.expectedInExpr=()=>T("Diagnostic.expectedInExpr"),e.expectedFunctionAfterAsync=()=>T("Diagnostic.expectedFunctionAfterAsync"),e.expectedFunctionName=()=>T("Diagnostic.expectedFunctionName"),e.expectedMemberName=()=>T("Diagnostic.expectedMemberName"),e.expectedModuleName=()=>T("Diagnostic.expectedModuleName"),e.expectedNameAfterAs=()=>T("Diagnostic.expectedNameAfterAs"),e.expectedNamedParameter=()=>T("Diagnostic.expectedNamedParameter"),e.expectedNewline=()=>T("Diagnostic.expectedNewline"),e.expectedNewlineOrSemicolon=()=>T("Diagnostic.expectedNewlineOrSemicolon"),e.expectedOpenParen=()=>T("Diagnostic.expectedOpenParen"),e.expectedParamName=()=>T("Diagnostic.expectedParamName"),e.expectedPatternExpr=()=>T("Diagnostic.expectedPatternExpr"),e.expectedPatternSubjectExpr=()=>T("Diagnostic.expectedPatternSubjectExpr"),e.expectedPatternValue=()=>T("Diagnostic.expectedPatternValue"),e.expectedReturnExpr=()=>T("Diagnostic.expectedReturnExpr"),e.expectedSliceIndex=()=>T("Diagnostic.expectedSliceIndex"),e.expectedTypeNotString=()=>T("Diagnostic.expectedTypeNotString"),e.expectedTypeParameterName=()=>T("Diagnostic.expectedTypeParameterName"),e.expectedYieldExpr=()=>T("Diagnostic.expectedYieldExpr"),e.finalClassIsAbstract=()=>new u(T("Diagnostic.finalClassIsAbstract")),e.finalContext=()=>T("Diagnostic.finalContext"),e.finalMethodOverride=()=>new u(T("Diagnostic.finalMethodOverride")),e.finalReassigned=()=>new u(T("Diagnostic.finalReassigned")),e.finalRedeclaration=()=>new u(T("Diagnostic.finalRedeclaration")),e.finalRedeclarationBySubclass=()=>new u(T("Diagnostic.finalRedeclarationBySubclass")),e.finalTooManyArgs=()=>T("Diagnostic.finalTooManyArgs"),e.finalUnassigned=()=>new u(T("Diagnostic.finalUnassigned")),e.formatStringBrace=()=>T("Diagnostic.formatStringBrace"),e.formatStringBytes=()=>T("Diagnostic.formatStringBytes"),e.formatStringEscape=()=>T("Diagnostic.formatStringEscape"),e.formatStringInPattern=()=>T("Diagnostic.formatStringInPattern"),e.formatStringIllegal=()=>T("Diagnostic.formatStringIllegal"),e.formatStringUnicode=()=>T("Diagnostic.formatStringUnicode"),e.formatStringUnterminated=()=>T("Diagnostic.formatStringUnterminated"),e.functionDecoratorTypeUnknown=()=>T("Diagnostic.functionDecoratorTypeUnknown"),e.functionInConditionalExpression=()=>T("Diagnostic.functionInConditionalExpression"),e.functionTypeParametersIllegal=()=>T("Diagnostic.functionTypeParametersIllegal"),e.futureImportLocationNotAllowed=()=>T("Diagnostic.futureImportLocationNotAllowed"),e.generatorAsyncReturnType=()=>T("Diagnostic.generatorAsyncReturnType"),e.generatorNotParenthesized=()=>T("Diagnostic.generatorNotParenthesized"),e.generatorSyncReturnType=()=>T("Diagnostic.generatorSyncReturnType"),e.genericBaseClassNotAllowed=()=>T("Diagnostic.genericBaseClassNotAllowed"),e.genericClassAssigned=()=>T("Diagnostic.genericClassAssigned"),e.genericClassDeleted=()=>T("Diagnostic.genericClassDeleted"),e.genericNotAllowed=()=>T("Diagnostic.genericNotAllowed"),e.genericTypeAliasBoundTypeVar=()=>new u(T("Diagnostic.genericTypeAliasBoundTypeVar")),e.genericTypeArgMissing=()=>T("Diagnostic.genericTypeArgMissing"),e.genericTypeArgTypeVar=()=>T("Diagnostic.genericTypeArgTypeVar"),e.genericTypeArgUnique=()=>T("Diagnostic.genericTypeArgUnique"),e.globalReassignment=()=>new u(T("Diagnostic.globalReassignment")),e.globalRedefinition=()=>new u(T("Diagnostic.globalRedefinition")),e.implicitStringConcat=()=>T("Diagnostic.implicitStringConcat"),e.importCycleDetected=()=>T("Diagnostic.importCycleDetected"),e.importDepthExceeded=()=>new u(T("Diagnostic.importDepthExceeded")),e.importResolveFailure=()=>new u(T("Diagnostic.importResolveFailure")),e.importSourceResolveFailure=()=>new u(T("Diagnostic.importSourceResolveFailure")),e.importSymbolUnknown=()=>new u(T("Diagnostic.importSymbolUnknown")),e.incompatibleMethodOverride=()=>new u(T("Diagnostic.incompatibleMethodOverride")),e.inconsistentIndent=()=>T("Diagnostic.inconsistentIndent"),e.inconsistentTabs=()=>T("Diagnostic.inconsistentTabs"),e.initMustReturnNone=()=>T("Diagnostic.initMustReturnNone"),e.initSubclassClsParam=()=>T("Diagnostic.initSubclassClsParam"),e.instanceMethodSelfParam=()=>T("Diagnostic.instanceMethodSelfParam"),e.instanceVarOverridesClassVar=()=>new u(T("Diagnostic.instanceVarOverridesClassVar")),e.instantiateAbstract=()=>new u(T("Diagnostic.instantiateAbstract")),e.instantiateProtocol=()=>new u(T("Diagnostic.instantiateProtocol")),e.internalBindError=()=>new u(T("Diagnostic.internalBindError")),e.internalParseError=()=>new u(T("Diagnostic.internalParseError")),e.internalTypeCheckingError=()=>new u(T("Diagnostic.internalTypeCheckingError")),e.invalidIdentifierChar=()=>T("Diagnostic.invalidIdentifierChar"),e.invalidStubStatement=()=>T("Diagnostic.invalidStubStatement"),e.invalidTokenChars=()=>new u(T("Diagnostic.invalidTokenChars")),e.isInstanceInvalidType=()=>new u(T("Diagnostic.isInstanceInvalidType")),e.isSubclassInvalidType=()=>new u(T("Diagnostic.isSubclassInvalidType")),e.keyValueInSet=()=>T("Diagnostic.keyValueInSet"),e.keywordArgInTypeArgument=()=>T("Diagnostic.keywordArgInTypeArgument"),e.keywordOnlyAfterArgs=()=>T("Diagnostic.keywordOnlyAfterArgs"),e.keywordParameterMissing=()=>T("Diagnostic.keywordParameterMissing"),e.keywordSubscriptIllegal=()=>T("Diagnostic.keywordSubscriptIllegal"),e.lambdaReturnTypeUnknown=()=>T("Diagnostic.lambdaReturnTypeUnknown"),e.lambdaReturnTypePartiallyUnknown=()=>new u(T("Diagnostic.lambdaReturnTypePartiallyUnknown")),e.listAssignmentMismatch=()=>new u(T("Diagnostic.listAssignmentMismatch")),e.listInAnnotation=()=>T("Diagnostic.listInAnnotation"),e.literalUnsupportedType=()=>T("Diagnostic.literalUnsupportedType"),e.literalEmptyArgs=()=>T("Diagnostic.literalEmptyArgs"),e.literalNotCallable=()=>T("Diagnostic.literalNotCallable"),e.matchIncompatible=()=>T("Diagnostic.matchIncompatible"),e.matchIsNotExhaustive=()=>T("Diagnostic.matchIsNotExhaustive"),e.maxParseDepthExceeded=()=>T("Diagnostic.maxParseDepthExceeded"),e.memberAccess=()=>new u(T("Diagnostic.memberAccess")),e.memberDelete=()=>new u(T("Diagnostic.memberDelete")),e.memberSet=()=>new u(T("Diagnostic.memberSet")),e.metaclassConflict=()=>T("Diagnostic.metaclassConflict"),e.metaclassDuplicate=()=>T("Diagnostic.metaclassDuplicate"),e.metaclassIsGeneric=()=>T("Diagnostic.metaclassIsGeneric"),e.methodNotDefined=()=>new u(T("Diagnostic.methodNotDefined")),e.methodNotDefinedOnType=()=>new u(T("Diagnostic.methodNotDefinedOnType")),e.methodOrdering=()=>T("Diagnostic.methodOrdering"),e.methodOverridden=()=>new u(T("Diagnostic.methodOverridden")),e.methodReturnsNonObject=()=>new u(T("Diagnostic.methodReturnsNonObject")),e.missingProtocolMembers=()=>T("Diagnostic.missingProtocolMembers"),e.missingSuperCall=()=>new u(T("Diagnostic.missingSuperCall")),e.moduleAsType=()=>T("Diagnostic.moduleAsType"),e.moduleNotCallable=()=>T("Diagnostic.moduleNotCallable"),e.moduleUnknownMember=()=>new u(T("Diagnostic.moduleUnknownMember")),e.namedExceptAfterCatchAll=()=>T("Diagnostic.namedExceptAfterCatchAll"),e.namedParamAfterParamSpecArgs=()=>new u(T("Diagnostic.namedParamAfterParamSpecArgs")),e.namedTupleEmptyName=()=>T("Diagnostic.namedTupleEmptyName"),e.namedTupleFirstArg=()=>T("Diagnostic.namedTupleFirstArg"),e.namedTupleMultipleInheritance=()=>T("Diagnostic.namedTupleMultipleInheritance"),e.namedTupleNameType=()=>T("Diagnostic.namedTupleNameType"),e.namedTupleNameUnique=()=>T("Diagnostic.namedTupleNameUnique"),e.namedTupleNoTypes=()=>T("Diagnostic.namedTupleNoTypes"),e.namedTupleSecondArg=()=>T("Diagnostic.namedTupleSecondArg"),e.newClsParam=()=>T("Diagnostic.newClsParam"),e.newTypeBadName=()=>T("Diagnostic.newTypeBadName"),e.newTypeLiteral=()=>T("Diagnostic.newTypeLiteral"),e.newTypeNotAClass=()=>T("Diagnostic.newTypeNotAClass"),e.newTypeParamCount=()=>T("Diagnostic.newTypeParamCount"),e.newTypeProtocolClass=()=>T("Diagnostic.newTypeProtocolClass"),e.nonDefaultAfterDefault=()=>T("Diagnostic.nonDefaultAfterDefault"),e.noneNotCallable=()=>T("Diagnostic.noneNotCallable"),e.noneNotIterable=()=>T("Diagnostic.noneNotIterable"),e.noneNotSubscriptable=()=>T("Diagnostic.noneNotSubscriptable"),e.noneNotUsableWith=()=>T("Diagnostic.noneNotUsableWith"),e.noneOperator=()=>new u(T("Diagnostic.noneOperator")),e.noneUnknownMember=()=>new u(T("Diagnostic.noneUnknownMember")),e.nonLocalNoBinding=()=>new u(T("Diagnostic.nonLocalNoBinding")),e.nonLocalReassignment=()=>new u(T("Diagnostic.nonLocalReassignment")),e.nonLocalRedefinition=()=>new u(T("Diagnostic.nonLocalRedefinition")),e.nonLocalInModule=()=>T("Diagnostic.nonLocalInModule"),e.noOverload=()=>new u(T("Diagnostic.noOverload")),e.noReturnContainsReturn=()=>T("Diagnostic.noReturnContainsReturn"),e.noReturnContainsYield=()=>T("Diagnostic.noReturnContainsYield"),e.noReturnReturnsNone=()=>T("Diagnostic.noReturnReturnsNone"),e.notRequiredArgCount=()=>T("Diagnostic.notRequiredArgCount"),e.notRequiredNotInTypedDict=()=>T("Diagnostic.notRequiredNotInTypedDict"),e.objectNotCallable=()=>new u(T("Diagnostic.objectNotCallable")),e.obscuredClassDeclaration=()=>new u(T("Diagnostic.obscuredClassDeclaration")),e.obscuredFunctionDeclaration=()=>new u(T("Diagnostic.obscuredFunctionDeclaration")),e.obscuredMethodDeclaration=()=>new u(T("Diagnostic.obscuredMethodDeclaration")),e.obscuredParameterDeclaration=()=>new u(T("Diagnostic.obscuredParameterDeclaration")),e.obscuredTypeAliasDeclaration=()=>new u(T("Diagnostic.obscuredTypeAliasDeclaration")),e.obscuredVariableDeclaration=()=>new u(T("Diagnostic.obscuredVariableDeclaration")),e.operatorLessOrGreaterDeprecated=()=>T("Diagnostic.operatorLessOrGreaterDeprecated"),e.optionalExtraArgs=()=>T("Diagnostic.optionalExtraArgs"),e.orPatternIrrefutable=()=>T("Diagnostic.orPatternIrrefutable"),e.orPatternMissingName=()=>T("Diagnostic.orPatternMissingName"),e.overlappingOverload=()=>new u(T("Diagnostic.overlappingOverload")),e.overloadAbstractMismatch=()=>new u(T("Diagnostic.overloadAbstractMismatch")),e.overloadImplementationMismatch=()=>new u(T("Diagnostic.overloadImplementationMismatch")),e.overloadReturnTypeMismatch=()=>new u(T("Diagnostic.overloadReturnTypeMismatch")),e.overloadWithImplementation=()=>new u(T("Diagnostic.overloadWithImplementation")),e.overloadWithoutImplementation=()=>new u(T("Diagnostic.overloadWithoutImplementation")),e.overriddenMethodNotFound=()=>new u(T("Diagnostic.overriddenMethodNotFound")),e.overrideDecoratorMissing=()=>new u(T("Diagnostic.overrideDecoratorMissing")),e.paramAfterKwargsParam=()=>T("Diagnostic.paramAfterKwargsParam"),e.paramAlreadyAssigned=()=>new u(T("Diagnostic.paramAlreadyAssigned")),e.paramAnnotationMissing=()=>new u(T("Diagnostic.paramAnnotationMissing")),e.paramNameMissing=()=>new u(T("Diagnostic.paramNameMissing")),e.paramSpecArgsKwargsUsage=()=>T("Diagnostic.paramSpecArgsKwargsUsage"),e.paramSpecArgsMissing=()=>new u(T("Diagnostic.paramSpecArgsMissing")),e.paramSpecArgsUsage=()=>T("Diagnostic.paramSpecArgsUsage"),e.paramSpecAssignedName=()=>new u(T("Diagnostic.paramSpecAssignedName")),e.paramSpecContext=()=>T("Diagnostic.paramSpecContext"),e.paramSpecDefaultNotTuple=()=>T("Diagnostic.paramSpecDefaultNotTuple"),e.paramSpecFirstArg=()=>T("Diagnostic.paramSpecFirstArg"),e.paramSpecKwargsUsage=()=>T("Diagnostic.paramSpecKwargsUsage"),e.paramSpecNotBound=()=>new u(T("Diagnostic.paramSpecNotBound")),e.paramSpecNotUsedByOuterScope=()=>new u(T("Diagnostic.paramSpecNotUsedByOuterScope")),e.paramSpecScopedToReturnType=()=>new u(T("Diagnostic.paramSpecScopedToReturnType")),e.paramSpecUnknownArg=()=>T("Diagnostic.paramSpecUnknownArg"),e.paramSpecUnknownMember=()=>new u(T("Diagnostic.paramSpecUnknownMember")),e.paramSpecUnknownParam=()=>new u(T("Diagnostic.paramSpecUnknownParam")),e.paramTypeCovariant=()=>T("Diagnostic.paramTypeCovariant"),e.paramTypeUnknown=()=>new u(T("Diagnostic.paramTypeUnknown")),e.paramAssignmentMismatch=()=>new u(T("Diagnostic.paramAssignmentMismatch")),e.paramTypePartiallyUnknown=()=>new u(T("Diagnostic.paramTypePartiallyUnknown")),e.parenthesizedContextManagerIllegal=()=>T("Diagnostic.parenthesizedContextManagerIllegal"),e.patternNeverMatches=()=>new u(T("Diagnostic.patternNeverMatches")),e.positionArgAfterNamedArg=()=>T("Diagnostic.positionArgAfterNamedArg"),e.privateImportFromPyTypedModule=()=>new u(T("Diagnostic.privateImportFromPyTypedModule")),e.positionOnlyAfterArgs=()=>T("Diagnostic.positionOnlyAfterArgs"),e.positionOnlyAfterKeywordOnly=()=>T("Diagnostic.positionOnlyAfterKeywordOnly"),e.positionOnlyIncompatible=()=>T("Diagnostic.positionOnlyIncompatible"),e.positionOnlyFirstParam=()=>T("Diagnostic.positionOnlyFirstParam"),e.privateUsedOutsideOfClass=()=>new u(T("Diagnostic.privateUsedOutsideOfClass")),e.privateUsedOutsideOfModule=()=>new u(T("Diagnostic.privateUsedOutsideOfModule")),e.propertyOverridden=()=>new u(T("Diagnostic.propertyOverridden")),e.propertyStaticMethod=()=>T("Diagnostic.propertyStaticMethod"),e.protectedUsedOutsideOfClass=()=>new u(T("Diagnostic.protectedUsedOutsideOfClass")),e.protocolBaseClass=()=>new u(T("Diagnostic.protocolBaseClass")),e.protocolBaseClassWithTypeArgs=()=>T("Diagnostic.protocolBaseClassWithTypeArgs"),e.protocolIllegal=()=>T("Diagnostic.protocolIllegal"),e.protocolMemberNotClassVar=()=>new u(T("Diagnostic.protocolMemberNotClassVar")),e.protocolNotAllowedInTypeArgument=()=>T("Diagnostic.protocolNotAllowedInTypeArgument"),e.protocolUsedInCall=()=>new u(T("Diagnostic.protocolUsedInCall")),e.protocolVarianceContravariant=()=>new u(T("Diagnostic.protocolVarianceContravariant")),e.protocolVarianceCovariant=()=>new u(T("Diagnostic.protocolVarianceCovariant")),e.protocolVarianceInvariant=()=>new u(T("Diagnostic.protocolVarianceInvariant")),e.pyrightCommentInvalidDiagnosticBoolValue=()=>T("Diagnostic.pyrightCommentInvalidDiagnosticBoolValue"),e.pyrightCommentInvalidDiagnosticSeverityValue=()=>T("Diagnostic.pyrightCommentInvalidDiagnosticSeverityValue"),e.pyrightCommentMissingDirective=()=>T("Diagnostic.pyrightCommentMissingDirective"),e.pyrightCommentUnknownDirective=()=>new u(T("Diagnostic.pyrightCommentUnknownDirective")),e.pyrightCommentUnknownDiagnosticRule=()=>new u(T("Diagnostic.pyrightCommentUnknownDiagnosticRule")),e.recursiveDefinition=()=>new u(T("Diagnostic.recursiveDefinition")),e.relativeImportNotAllowed=()=>T("Diagnostic.relativeImportNotAllowed"),e.requiredArgCount=()=>T("Diagnostic.requiredArgCount"),e.requiredNotInTypedDict=()=>T("Diagnostic.requiredNotInTypedDict"),e.returnInAsyncGenerator=()=>T("Diagnostic.returnInAsyncGenerator"),e.returnMissing=()=>new u(T("Diagnostic.returnMissing")),e.returnOutsideFunction=()=>T("Diagnostic.returnOutsideFunction"),e.returnTypeContravariant=()=>T("Diagnostic.returnTypeContravariant"),e.returnTypeMismatch=()=>new u(T("Diagnostic.returnTypeMismatch")),e.returnTypeUnknown=()=>T("Diagnostic.returnTypeUnknown"),e.returnTypePartiallyUnknown=()=>new u(T("Diagnostic.returnTypePartiallyUnknown")),e.revealLocalsArgs=()=>T("Diagnostic.revealLocalsArgs"),e.revealLocalsNone=()=>T("Diagnostic.revealLocalsNone"),e.revealTypeArgs=()=>T("Diagnostic.revealTypeArgs"),e.revealTypeExpectedTextArg=()=>T("Diagnostic.revealTypeExpectedTextArg"),e.revealTypeExpectedTextMismatch=()=>new u(T("Diagnostic.revealTypeExpectedTextMismatch")),e.revealTypeExpectedTypeMismatch=()=>new u(T("Diagnostic.revealTypeExpectedTypeMismatch")),e.selfTypeContext=()=>T("Diagnostic.selfTypeContext"),e.selfTypeWithTypedSelfOrCls=()=>T("Diagnostic.selfTypeWithTypedSelfOrCls"),e.setterGetterTypeMismatch=()=>T("Diagnostic.setterGetterTypeMismatch"),e.starPatternInAsPattern=()=>T("Diagnostic.starPatternInAsPattern"),e.starPatternInOrPattern=()=>T("Diagnostic.starPatternInOrPattern"),e.singleOverload=()=>new u(T("Diagnostic.singleOverload")),e.slotsAttributeError=()=>new u(T("Diagnostic.slotsAttributeError")),e.slotsClassVarConflict=()=>new u(T("Diagnostic.slotsClassVarConflict")),e.starStarWildcardNotAllowed=()=>T("Diagnostic.starStarWildcardNotAllowed"),e.staticClsSelfParam=()=>T("Diagnostic.staticClsSelfParam"),e.stdlibModuleOverridden=()=>new u(T("Diagnostic.stdlibModuleOverridden")),e.strictTypeGuardReturnType=()=>new u(T("Diagnostic.strictTypeGuardReturnType")),e.stringNonAsciiBytes=()=>T("Diagnostic.stringNonAsciiBytes"),e.stringNotSubscriptable=()=>T("Diagnostic.stringNotSubscriptable"),e.stringUnsupportedEscape=()=>T("Diagnostic.stringUnsupportedEscape"),e.stringUnterminated=()=>T("Diagnostic.stringUnterminated"),e.stubFileMissing=()=>new u(T("Diagnostic.stubFileMissing")),e.stubUsesGetAttr=()=>T("Diagnostic.stubUsesGetAttr"),e.sublistParamsIncompatible=()=>T("Diagnostic.sublistParamsIncompatible"),e.superCallArgCount=()=>T("Diagnostic.superCallArgCount"),e.superCallFirstArg=()=>new u(T("Diagnostic.superCallFirstArg")),e.superCallSecondArg=()=>new u(T("Diagnostic.superCallSecondArg")),e.superCallZeroArgForm=()=>T("Diagnostic.superCallZeroArgForm"),e.symbolIsUnbound=()=>new u(T("Diagnostic.symbolIsUnbound")),e.symbolIsUndefined=()=>new u(T("Diagnostic.symbolIsUndefined")),e.symbolIsPossiblyUnbound=()=>new u(T("Diagnostic.symbolIsPossiblyUnbound")),e.symbolOverridden=()=>new u(T("Diagnostic.symbolOverridden")),e.totalOrderingMissingMethod=()=>T("Diagnostic.totalOrderingMissingMethod"),e.trailingCommaInFromImport=()=>T("Diagnostic.trailingCommaInFromImport"),e.tryWithoutExcept=()=>T("Diagnostic.tryWithoutExcept"),e.tupleAssignmentMismatch=()=>new u(T("Diagnostic.tupleAssignmentMismatch")),e.tupleInAnnotation=()=>T("Diagnostic.tupleInAnnotation"),e.tupleIndexOutOfRange=()=>new u(T("Diagnostic.tupleIndexOutOfRange")),e.typeAliasIllegalExpressionForm=()=>T("Diagnostic.typeAliasIllegalExpressionForm"),e.typeAliasIsRecursiveDirect=()=>new u(T("Diagnostic.typeAliasIsRecursiveDirect")),e.typeAliasNotInModuleOrClass=()=>T("Diagnostic.typeAliasNotInModuleOrClass"),e.typeAliasRedeclared=()=>new u(T("Diagnostic.typeAliasRedeclared")),e.typeAliasStatementIllegal=()=>T("Diagnostic.typeAliasStatementIllegal"),e.typeAnnotationCall=()=>T("Diagnostic.typeAnnotationCall"),e.typeAnnotationVariable=()=>T("Diagnostic.typeAnnotationVariable"),e.typeArgListExpected=()=>T("Diagnostic.typeArgListExpected"),e.typeArgListNotAllowed=()=>T("Diagnostic.typeArgListNotAllowed"),e.typeArgsExpectingNone=()=>new u(T("Diagnostic.typeArgsExpectingNone")),e.typeArgsMismatchOne=()=>new u(T("Diagnostic.typeArgsMismatchOne")),e.typeArgsMissingForAlias=()=>new u(T("Diagnostic.typeArgsMissingForAlias")),e.typeArgsMissingForClass=()=>new u(T("Diagnostic.typeArgsMissingForClass")),e.typeArgsTooFew=()=>new u(T("Diagnostic.typeArgsTooFew")),e.typeArgsTooMany=()=>new u(T("Diagnostic.typeArgsTooMany")),e.typeAssignmentMismatch=()=>new u(T("Diagnostic.typeAssignmentMismatch")),e.typeCallNotAllowed=()=>T("Diagnostic.typeCallNotAllowed"),e.typeCommentDeprecated=()=>T("Diagnostic.typeCommentDeprecated"),e.typedDictAccess=()=>T("Diagnostic.typedDictAccess"),e.typedDictBadVar=()=>T("Diagnostic.typedDictBadVar"),e.typedDictBaseClass=()=>T("Diagnostic.typedDictBaseClass"),e.typedDictDelete=()=>T("Diagnostic.typedDictDelete"),e.typedDictEmptyName=()=>T("Diagnostic.typedDictEmptyName"),e.typedDictEntryName=()=>T("Diagnostic.typedDictEntryName"),e.typedDictEntryUnique=()=>T("Diagnostic.typedDictEntryUnique"),e.typedDictExtraArgs=()=>T("Diagnostic.typedDictExtraArgs"),e.typedDictFieldRedefinition=()=>new u(T("Diagnostic.typedDictFieldRedefinition")),e.typedDictFirstArg=()=>T("Diagnostic.typedDictFirstArg"),e.typedDictSecondArgDict=()=>T("Diagnostic.typedDictSecondArgDict"),e.typedDictSecondArgDictEntry=()=>T("Diagnostic.typedDictSecondArgDictEntry"),e.typedDictSet=()=>T("Diagnostic.typedDictSet"),e.typedDictTotalParam=()=>T("Diagnostic.typedDictTotalParam"),e.typeExpectedClass=()=>new u(T("Diagnostic.typeExpectedClass")),e.typeGuardArgCount=()=>T("Diagnostic.typeGuardArgCount"),e.typeGuardParamCount=()=>T("Diagnostic.typeGuardParamCount"),e.typeNotAwaitable=()=>new u(T("Diagnostic.typeNotAwaitable")),e.typeNotCallable=()=>new u(T("Diagnostic.typeNotCallable")),e.typeNotIntantiable=()=>new u(T("Diagnostic.typeNotIntantiable")),e.typeNotIterable=()=>new u(T("Diagnostic.typeNotIterable")),e.typeNotSpecializable=()=>new u(T("Diagnostic.typeNotSpecializable")),e.typeNotSubscriptable=()=>new u(T("Diagnostic.typeNotSubscriptable")),e.typeNotUsableWith=()=>new u(T("Diagnostic.typeNotUsableWith")),e.typeNotSupportBinaryOperator=()=>new u(T("Diagnostic.typeNotSupportBinaryOperator")),e.typeNotSupportBinaryOperatorBidirectional=()=>new u(T("Diagnostic.typeNotSupportBinaryOperatorBidirectional")),e.typeNotSupportUnaryOperator=()=>new u(T("Diagnostic.typeNotSupportUnaryOperator")),e.typeNotSupportUnaryOperatorBidirectional=()=>new u(T("Diagnostic.typeNotSupportUnaryOperatorBidirectional")),e.typeParameterBoundNotAllowed=()=>T("Diagnostic.typeParameterBoundNotAllowed"),e.typeParameterConstraintTuple=()=>T("Diagnostic.typeParameterConstraintTuple"),e.typeParameterExistingTypeParameter=()=>new u(T("Diagnostic.typeParameterExistingTypeParameter")),e.typeParametersMissing=()=>T("Diagnostic.typeParametersMissing"),e.typeParameterNotDeclared=()=>new u(T("Diagnostic.typeParameterNotDeclared")),e.typePartiallyUnknown=()=>new u(T("Diagnostic.typePartiallyUnknown")),e.typeUnknown=()=>new u(T("Diagnostic.typeUnknown")),e.typeVarAssignedName=()=>new u(T("Diagnostic.typeVarAssignedName")),e.typeVarAssignmentMismatch=()=>new u(T("Diagnostic.typeVarAssignmentMismatch")),e.typeVarBoundAndConstrained=()=>T("Diagnostic.typeVarBoundAndConstrained"),e.typeVarBoundGeneric=()=>T("Diagnostic.typeVarBoundGeneric"),e.typeVarConstraintGeneric=()=>T("Diagnostic.typeVarConstraintGeneric"),e.typeVarDefaultBoundMismatch=()=>T("Diagnostic.typeVarDefaultBoundMismatch"),e.typeVarDefaultConstraintMismatch=()=>T("Diagnostic.typeVarDefaultConstraintMismatch"),e.typeVarFirstArg=()=>T("Diagnostic.typeVarFirstArg"),e.typeVarDefaultInvalidTypeVar=()=>new u(T("Diagnostic.typeVarDefaultInvalidTypeVar")),e.typeVarNoMember=()=>new u(T("Diagnostic.typeVarNoMember")),e.typeVarNotSubscriptable=()=>new u(T("Diagnostic.typeVarNotSubscriptable")),e.typeVarNotUsedByOuterScope=()=>new u(T("Diagnostic.typeVarNotUsedByOuterScope")),e.typeVarPossiblyUnsolvable=()=>new u(T("Diagnostic.typeVarPossiblyUnsolvable")),e.typeVarScopedToReturnType=()=>new u(T("Diagnostic.typeVarScopedToReturnType")),e.typeVarSingleConstraint=()=>T("Diagnostic.typeVarSingleConstraint"),e.typeVarsNotInGenericOrProtocol=()=>T("Diagnostic.typeVarsNotInGenericOrProtocol"),e.typeVarTupleContext=()=>T("Diagnostic.typeVarTupleContext"),e.typeVarTupleDefaultNotUnpacked=()=>T("Diagnostic.typeVarTupleDefaultNotUnpacked"),e.typeVarTupleMustBeUnpacked=()=>T("Diagnostic.typeVarTupleMustBeUnpacked"),e.typeVarTupleUnknownParam=()=>new u(T("Diagnostic.typeVarTupleUnknownParam")),e.typeVarUnknownParam=()=>new u(T("Diagnostic.typeVarUnknownParam")),e.typeVarUsedByOuterScope=()=>new u(T("Diagnostic.typeVarUsedByOuterScope")),e.typeVarUsedOnlyOnce=()=>new u(T("Diagnostic.typeVarUsedOnlyOnce")),e.typeVarVariance=()=>T("Diagnostic.typeVarVariance"),e.typeVarWithoutDefault=()=>new u(T("Diagnostic.typeVarWithoutDefault")),e.unaccessedClass=()=>new u(T("Diagnostic.unaccessedClass")),e.unaccessedFunction=()=>new u(T("Diagnostic.unaccessedFunction")),e.unaccessedImport=()=>new u(T("Diagnostic.unaccessedImport")),e.unaccessedSymbol=()=>new u(T("Diagnostic.unaccessedSymbol")),e.unaccessedVariable=()=>new u(T("Diagnostic.unaccessedVariable")),e.unannotatedFunctionSkipped=()=>new u(T("Diagnostic.unannotatedFunctionSkipped")),e.unexpectedAsyncToken=()=>T("Diagnostic.unexpectedAsyncToken"),e.unexpectedExprToken=()=>T("Diagnostic.unexpectedExprToken"),e.unexpectedIndent=()=>T("Diagnostic.unexpectedIndent"),e.unexpectedUnindent=()=>T("Diagnostic.unexpectedUnindent"),e.unhashableDictKey=()=>T("Diagnostic.unhashableDictKey"),e.unhashableSetEntry=()=>T("Diagnostic.unhashableSetEntry"),e.unionForwardReferenceNotAllowed=()=>T("Diagnostic.unionForwardReferenceNotAllowed"),e.unionSyntaxIllegal=()=>T("Diagnostic.unionSyntaxIllegal"),e.unionTypeArgCount=()=>T("Diagnostic.unionTypeArgCount"),e.uninitializedInstanceVariable=()=>new u(T("Diagnostic.uninitializedInstanceVariable")),e.unmatchedEndregionComment=()=>T("Diagnostic.unmatchedEndregionComment"),e.unmatchedRegionComment=()=>T("Diagnostic.unmatchedRegionComment"),e.unnecessaryCast=()=>new u(T("Diagnostic.unnecessaryCast")),e.unnecessaryIsInstanceAlways=()=>new u(T("Diagnostic.unnecessaryIsInstanceAlways")),e.unnecessaryIsSubclassAlways=()=>new u(T("Diagnostic.unnecessaryIsSubclassAlways")),e.unnecessaryPyrightIgnore=()=>T("Diagnostic.unnecessaryPyrightIgnore"),e.unnecessaryPyrightIgnoreRule=()=>new u(T("Diagnostic.unnecessaryPyrightIgnoreRule")),e.unnecessaryTypeIgnore=()=>T("Diagnostic.unnecessaryTypeIgnore"),e.unpackArgCount=()=>T("Diagnostic.unpackArgCount"),e.unpackedArgInTypeArgument=()=>T("Diagnostic.unpackedArgInTypeArgument"),e.unpackedArgWithVariadicParam=()=>T("Diagnostic.unpackedArgWithVariadicParam"),e.unpackedDictArgumentNotMapping=()=>T("Diagnostic.unpackedDictArgumentNotMapping"),e.unpackedSubscriptIllegal=()=>T("Diagnostic.unpackedSubscriptIllegal"),e.unpackedTypedDictArgument=()=>T("Diagnostic.unpackedTypedDictArgument"),e.unpackedTypeVarTupleExpected=()=>new u(T("Diagnostic.unpackedTypeVarTupleExpected")),e.unpackExpectedTypedDict=()=>T("Diagnostic.unpackExpectedTypedDict"),e.unpackExpectedTypeVarTuple=()=>T("Diagnostic.unpackExpectedTypeVarTuple"),e.unpackIllegalInComprehension=()=>T("Diagnostic.unpackIllegalInComprehension"),e.unpackInAnnotation=()=>T("Diagnostic.unpackInAnnotation"),e.unpackInDict=()=>T("Diagnostic.unpackInDict"),e.unpackInSet=()=>T("Diagnostic.unpackInSet"),e.unpackNotAllowed=()=>T("Diagnostic.unpackNotAllowed"),e.unpackOperatorNotAllowed=()=>T("Diagnostic.unpackOperatorNotAllowed"),e.unpackTuplesIllegal=()=>T("Diagnostic.unpackTuplesIllegal"),e.unreachableCode=()=>T("Diagnostic.unreachableCode"),e.unreachableExcept=()=>T("Diagnostic.unreachableExcept"),e.unsupportedDunderAllOperation=()=>T("Diagnostic.unsupportedDunderAllOperation"),e.unusedCallResult=()=>new u(T("Diagnostic.unusedCallResult")),e.unusedCoroutine=()=>T("Diagnostic.unusedCoroutine"),e.unusedExpression=()=>T("Diagnostic.unusedExpression"),e.varAnnotationIllegal=()=>T("Diagnostic.varAnnotationIllegal"),e.variableFinalOverride=()=>new u(T("Diagnostic.variableFinalOverride")),e.variadicTypeArgsTooMany=()=>T("Diagnostic.variadicTypeArgsTooMany"),e.variadicTypeParamTooManyAlias=()=>new u(T("Diagnostic.variadicTypeParamTooManyAlias")),e.variadicTypeParamTooManyClass=()=>new u(T("Diagnostic.variadicTypeParamTooManyClass")),e.walrusIllegal=()=>T("Diagnostic.walrusIllegal"),e.walrusNotAllowed=()=>T("Diagnostic.walrusNotAllowed"),e.wildcardInFunction=()=>T("Diagnostic.wildcardInFunction"),e.wildcardPatternTypeUnknown=()=>T("Diagnostic.wildcardPatternTypeUnknown"),e.wildcardPatternTypePartiallyUnknown=()=>T("Diagnostic.wildcardPatternTypePartiallyUnknown"),e.wildcardLibraryImport=()=>T("Diagnostic.wildcardLibraryImport"),e.yieldFromIllegal=()=>T("Diagnostic.yieldFromIllegal"),e.yieldFromOutsideAsync=()=>T("Diagnostic.yieldFromOutsideAsync"),e.yieldOutsideFunction=()=>T("Diagnostic.yieldOutsideFunction"),e.yieldTypeMismatch=()=>new u(T("Diagnostic.yieldTypeMismatch")),e.yieldWithinListCompr=()=>T("Diagnostic.yieldWithinListCompr"),e.zeroCaseStatementsFound=()=>T("Diagnostic.zeroCaseStatementsFound"),e.zeroLengthTupleNotAllowed=()=>T("Diagnostic.zeroLengthTupleNotAllowed")}(t=e.Diagnostic||(e.Diagnostic={})),function(e){e.argParam=()=>new u(T("DiagnosticAddendum.argParam")),e.argParamFunction=()=>new u(T("DiagnosticAddendum.argParamFunction")),e.argsParamMissing=()=>new u(T("DiagnosticAddendum.argsParamMissing")),e.argsPositionOnly=()=>new u(T("DiagnosticAddendum.argsPositionOnly")),e.argumentType=()=>new u(T("DiagnosticAddendum.argumentType")),e.argumentTypes=()=>new u(T("DiagnosticAddendum.argumentTypes")),e.assignToNone=()=>T("DiagnosticAddendum.assignToNone"),e.asyncHelp=()=>T("DiagnosticAddendum.asyncHelp"),e.baseClassOverriddenType=()=>new u(T("DiagnosticAddendum.baseClassOverriddenType")),e.baseClassOverridesType=()=>new u(T("DiagnosticAddendum.baseClassOverridesType")),e.dataClassFrozen=()=>new u(T("DiagnosticAddendum.dataClassFrozen")),e.dataClassFieldLocation=()=>T("DiagnosticAddendum.dataClassFieldLocation"),e.finalMethod=()=>T("DiagnosticAddendum.finalMethod"),e.functionParamDefaultMissing=()=>new u(T("DiagnosticAddendum.functionParamDefaultMissing")),e.functionParamName=()=>new u(T("DiagnosticAddendum.functionParamName")),e.functionReturnTypeMismatch=()=>new u(T("DiagnosticAddendum.functionReturnTypeMismatch")),e.functionTooFewParams=()=>new u(T("DiagnosticAddendum.functionTooFewParams")),e.incompatibleGetter=()=>T("DiagnosticAddendum.incompatibleGetter"),e.incompatibleSetter=()=>T("DiagnosticAddendum.incompatibleSetter"),e.incompatibleDeleter=()=>T("DiagnosticAddendum.incompatibleDeleter"),e.initMethodLocation=()=>new u(T("DiagnosticAddendum.initMethodLocation")),e.initMethodSignature=()=>new u(T("DiagnosticAddendum.initMethodSignature")),e.functionTooManyParams=()=>new u(T("DiagnosticAddendum.functionTooManyParams")),e.keyNotRequired=()=>new u(T("DiagnosticAddendum.keyNotRequired")),e.keyRequiredDeleted=()=>new u(T("DiagnosticAddendum.keyRequiredDeleted")),e.keyUndefined=()=>new u(T("DiagnosticAddendum.keyUndefined")),e.kwargsParamMissing=()=>new u(T("DiagnosticAddendum.kwargsParamMissing")),e.listAssignmentMismatch=()=>new u(T("DiagnosticAddendum.listAssignmentMismatch")),e.literalAssignmentMismatch=()=>new u(T("DiagnosticAddendum.literalAssignmentMismatch")),e.matchIsNotExhaustiveType=()=>new u(T("DiagnosticAddendum.matchIsNotExhaustiveType")),e.matchIsNotExhaustiveHint=()=>T("DiagnosticAddendum.matchIsNotExhaustiveHint"),e.memberAssignment=()=>new u(T("DiagnosticAddendum.memberAssignment")),e.memberIsAbstract=()=>new u(T("DiagnosticAddendum.memberIsAbstract")),e.memberIsAbstractMore=()=>new u(T("DiagnosticAddendum.memberIsAbstractMore")),e.memberIsFinalInProtocol=()=>new u(T("DiagnosticAddendum.memberIsFinalInProtocol")),e.memberIsInitVar=()=>new u(T("DiagnosticAddendum.memberIsInitVar")),e.memberIsInvariant=()=>new u(T("DiagnosticAddendum.memberIsInvariant")),e.memberIsNotFinalInProtocol=()=>new u(T("DiagnosticAddendum.memberIsNotFinalInProtocol")),e.memberSetClassVar=()=>new u(T("DiagnosticAddendum.memberSetClassVar")),e.memberTypeMismatch=()=>new u(T("DiagnosticAddendum.memberTypeMismatch")),e.memberUnknown=()=>new u(T("DiagnosticAddendum.memberUnknown")),e.missingProtocolMember=()=>new u(T("DiagnosticAddendum.missingProtocolMember")),e.missingGetter=()=>T("DiagnosticAddendum.missingGetter"),e.missingSetter=()=>T("DiagnosticAddendum.missingSetter"),e.missingDeleter=()=>T("DiagnosticAddendum.missingDeleter"),e.namedParamMissingInDest=()=>new u(T("DiagnosticAddendum.namedParamMissingInDest")),e.namedParamMissingInSource=()=>new u(T("DiagnosticAddendum.namedParamMissingInSource")),e.namedParamTypeMismatch=()=>new u(T("DiagnosticAddendum.namedParamTypeMismatch")),e.newMethodLocation=()=>new u(T("DiagnosticAddendum.newMethodLocation")),e.newMethodSignature=()=>new u(T("DiagnosticAddendum.newMethodSignature")),e.noOverloadAssignable=()=>new u(T("DiagnosticAddendum.noOverloadAssignable")),e.orPatternMissingName=()=>new u(T("DiagnosticAddendum.orPatternMissingName")),e.overloadSignature=()=>T("DiagnosticAddendum.overloadSignature"),e.overloadNotAssignable=()=>new u(T("DiagnosticAddendum.overloadNotAssignable")),e.overloadWithImplementation=()=>T("DiagnosticAddendum.overloadWithImplementation"),e.overriddenMethod=()=>T("DiagnosticAddendum.overriddenMethod"),e.overriddenSymbol=()=>T("DiagnosticAddendum.overriddenSymbol"),e.overrideNoOverloadMatches=()=>T("DiagnosticAddendum.overrideNoOverloadMatches"),e.overrideNotClassMethod=()=>T("DiagnosticAddendum.overrideNotClassMethod"),e.overrideNotInstanceMethod=()=>T("DiagnosticAddendum.overrideNotInstanceMethod"),e.overrideNotStaticMethod=()=>T("DiagnosticAddendum.overrideNotStaticMethod"),e.overrideParamKeywordNoDefault=()=>new u(T("DiagnosticAddendum.overrideParamKeywordNoDefault")),e.overrideParamKeywordType=()=>new u(T("DiagnosticAddendum.overrideParamKeywordType")),e.overrideParamName=()=>new u(T("DiagnosticAddendum.overrideParamName")),e.overrideParamNameExtra=()=>new u(T("DiagnosticAddendum.overrideParamNameExtra")),e.overrideParamNameMissing=()=>new u(T("DiagnosticAddendum.overrideParamNameMissing")),e.overrideParamNamePositionOnly=()=>new u(T("DiagnosticAddendum.overrideParamNamePositionOnly")),e.overrideParamNoDefault=()=>new u(T("DiagnosticAddendum.overrideParamNoDefault")),e.overrideParamType=()=>new u(T("DiagnosticAddendum.overrideParamType")),e.overridePositionalParamCount=()=>new u(T("DiagnosticAddendum.overridePositionalParamCount")),e.overrideReturnType=()=>new u(T("DiagnosticAddendum.overrideReturnType")),e.overrideType=()=>new u(T("DiagnosticAddendum.overrideType")),e.paramAssignment=()=>new u(T("DiagnosticAddendum.paramAssignment")),e.paramType=()=>new u(T("DiagnosticAddendum.paramType")),e.privateImportFromPyTypedSource=()=>new u(T("DiagnosticAddendum.privateImportFromPyTypedSource")),e.propertyAccessFromProtocolClass=()=>T("DiagnosticAddendum.propertyAccessFromProtocolClass"),e.propertyMethodIncompatible=()=>new u(T("DiagnosticAddendum.propertyMethodIncompatible")),e.propertyMethodMissing=()=>new u(T("DiagnosticAddendum.propertyMethodMissing")),e.propertyMissingDeleter=()=>new u(T("DiagnosticAddendum.propertyMissingDeleter")),e.propertyMissingSetter=()=>new u(T("DiagnosticAddendum.propertyMissingSetter")),e.protocolMemberClassVar=()=>new u(T("DiagnosticAddendum.protocolMemberClassVar")),e.protocolIncompatible=()=>new u(T("DiagnosticAddendum.protocolIncompatible")),e.protocolMemberMissing=()=>new u(T("DiagnosticAddendum.protocolMemberMissing")),e.protocolSourceIsNotConcrete=()=>new u(T("DiagnosticAddendum.protocolSourceIsNotConcrete")),e.readOnlyAttribute=()=>new u(T("DiagnosticAddendum.readOnlyAttribute")),e.seeDeclaration=()=>T("DiagnosticAddendum.seeDeclaration"),e.seeClassDeclaration=()=>T("DiagnosticAddendum.seeClassDeclaration"),e.seeFunctionDeclaration=()=>T("DiagnosticAddendum.seeFunctionDeclaration"),e.seeMethodDeclaration=()=>T("DiagnosticAddendum.seeMethodDeclaration"),e.seeParameterDeclaration=()=>T("DiagnosticAddendum.seeParameterDeclaration"),e.seeTypeAliasDeclaration=()=>T("DiagnosticAddendum.seeTypeAliasDeclaration"),e.seeVariableDeclaration=()=>T("DiagnosticAddendum.seeVariableDeclaration"),e.tupleEntryTypeMismatch=()=>new u(T("DiagnosticAddendum.tupleEntryTypeMismatch")),e.tupleAssignmentMismatch=()=>new u(T("DiagnosticAddendum.tupleAssignmentMismatch")),e.tupleSizeMismatch=()=>new u(T("DiagnosticAddendum.tupleSizeMismatch")),e.typeAssignmentMismatch=()=>new u(T("DiagnosticAddendum.typeAssignmentMismatch")),e.typeBound=()=>new u(T("DiagnosticAddendum.typeBound")),e.typeConstrainedTypeVar=()=>new u(T("DiagnosticAddendum.typeConstrainedTypeVar")),e.typedDictFieldMissing=()=>new u(T("DiagnosticAddendum.typedDictFieldMissing")),e.typedDictFieldNotRequired=()=>new u(T("DiagnosticAddendum.typedDictFieldNotRequired")),e.typedDictFieldRedefinition=()=>new u(T("DiagnosticAddendum.typedDictFieldRedefinition")),e.typedDictFieldRequired=()=>new u(T("DiagnosticAddendum.typedDictFieldRequired")),e.typedDictFieldTypeMismatch=()=>new u(T("DiagnosticAddendum.typedDictFieldTypeMismatch")),e.typedDictFieldUndefined=()=>new u(T("DiagnosticAddendum.typedDictFieldUndefined")),e.typedDictFinalMismatch=()=>new u(T("DiagnosticAddendum.typedDictFinalMismatch")),e.typeIncompatible=()=>new u(T("DiagnosticAddendum.typeIncompatible")),e.typeNotCallable=()=>new u(T("DiagnosticAddendum.typeNotCallable")),e.typeNotClass=()=>new u(T("DiagnosticAddendum.typeNotClass")),e.typeParamSpec=()=>new u(T("DiagnosticAddendum.typeParamSpec")),e.typeNotStringLiteral=()=>new u(T("DiagnosticAddendum.typeNotStringLiteral")),e.typeOfSymbol=()=>new u(T("DiagnosticAddendum.typeOfSymbol")),e.typeUnsupported=()=>new u(T("DiagnosticAddendum.typeUnsupported")),e.typeVarDefaultOutOfScope=()=>new u(T("DiagnosticAddendum.typeVarDefaultOutOfScope")),e.typeVarIsContravariant=()=>new u(T("DiagnosticAddendum.typeVarIsContravariant")),e.typeVarIsCovariant=()=>new u(T("DiagnosticAddendum.typeVarIsCovariant")),e.typeVarIsInvariant=()=>new u(T("DiagnosticAddendum.typeVarIsInvariant")),e.typeVarsMissing=()=>new u(T("DiagnosticAddendum.typeVarsMissing")),e.typeVarNotAllowed=()=>T("DiagnosticAddendum.typeVarNotAllowed"),e.typeVarTupleRequiresKnownLength=()=>T("DiagnosticAddendum.typeVarTupleRequiresKnownLength"),e.typeVarUnsolvableRemedy=()=>T("DiagnosticAddendum.typeVarUnsolvableRemedy"),e.unhashableType=()=>new u(T("DiagnosticAddendum.unhashableType")),e.unreachableExcept=()=>new u(T("DiagnosticAddendum.unreachableExcept")),e.useDictInstead=()=>T("DiagnosticAddendum.useDictInstead"),e.useListInstead=()=>T("DiagnosticAddendum.useListInstead"),e.useTupleInstead=()=>T("DiagnosticAddendum.useTupleInstead"),e.useTypeInstead=()=>T("DiagnosticAddendum.useTypeInstead"),e.varianceMismatchForClass=()=>new u(T("DiagnosticAddendum.varianceMismatchForClass")),e.varianceMismatchForTypeAlias=()=>new u(T("DiagnosticAddendum.varianceMismatchForTypeAlias"))}(n=e.DiagnosticAddendum||(e.DiagnosticAddendum={})),function(e){e.addOptionalToAnnotation=()=>T("CodeAction.addOptionalToAnnotation"),e.createTypeStub=()=>T("CodeAction.createTypeStub"),e.createTypeStubFor=()=>new u(T("CodeAction.createTypeStubFor")),e.executingCommand=()=>T("CodeAction.executingCommand"),e.filesToAnalyzeOne=()=>T("CodeAction.filesToAnalyzeOne"),e.filesToAnalyzeCount=()=>new u(T("CodeAction.filesToAnalyzeCount")),e.findingReferences=()=>T("CodeAction.findingReferences"),e.organizeImports=()=>T("CodeAction.organizeImports"),e.renameShadowedFile=()=>new u(T("CodeAction.renameShadowedFile"))}(s=e.CodeAction||(e.CodeAction={})),function(e){e.moveFile=()=>new u(T("Refactoring.moveFile")),e.moveFileLabel=()=>new u(T("Refactoring.moveFileLabel")),e.moveFileDescription=()=>new u(T("Refactoring.moveFileDescription"))}(i=e.Refactoring||(e.Refactoring={}))}(t.Localizer||(t.Localizer={}))},9671:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterStream=void 0;const s=n(6956);t.CharacterStream=class{constructor(e){this._text=e,this._position=0,this._currentChar=e.length>0?e.charCodeAt(0):0,this._isEndOfStream=0===e.length}getText(){return this._text}get position(){return this._position}set position(e){this._position=e,this._checkBounds()}get currentChar(){return this._currentChar}getCurrentChar(){return this._currentChar}get nextChar(){return this.position+1<this._text.length?this._text.charCodeAt(this.position+1):0}get prevChar(){return this.position-1>=0?this._text.charCodeAt(this.position-1):0}isEndOfStream(){return this._isEndOfStream}lookAhead(e){const t=this._position+e;return t<0||t>=this._text.length?0:this._text.charCodeAt(t)}advance(e){this.position+=e}moveNext(){return this._position<this._text.length-1?(this._position+=1,this._currentChar=this._text.charCodeAt(this._position),!0):(this.advance(1),!this.isEndOfStream())}isAtWhiteSpace(){return(0,s.isWhiteSpace)(this.currentChar)}isAtLineBreak(){return(0,s.isLineBreak)(this.currentChar)}skipLineBreak(){13===this._currentChar?(this.moveNext(),10===this.currentChar&&this.moveNext()):10===this._currentChar&&this.moveNext()}skipWhitespace(){for(;!this.isEndOfStream()&&this.isAtWhiteSpace();)this.moveNext()}skipToEol(){for(;!this.isEndOfStream()&&!this.isAtLineBreak();)this.moveNext()}skipToWhitespace(){for(;!this.isEndOfStream()&&!this.isAtWhiteSpace();)this.moveNext()}charCodeAt(e){return this._text.charCodeAt(e)}get length(){return this._text.length}_checkBounds(){this._position<0&&(this._position=0),this._isEndOfStream=this._position>=this._text.length,this._isEndOfStream&&(this._position=this._text.length),this._currentChar=this._isEndOfStream?0:this._text.charCodeAt(this._position)}}},6956:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.isBinary=t.isOctal=t.isHex=t.isDecimal=t.isNumber=t.isLineBreak=t.isWhiteSpace=t.isSurrogateChar=t.isIdentifierChar=t.isIdentifierStartChar=void 0;const r=a(n(7770));var o;!function(e){e[e.NotIdentifierChar=0]="NotIdentifierChar",e[e.StartIdentifierChar=1]="StartIdentifierChar",e[e.IdentifierChar=2]="IdentifierChar",e[e.SurrogateChar=3]="SurrogateChar"}(o||(o={}));const l=256,c=new Array(l),p={},d={};let u=!1;function y(e){return e>=48&&e<=57||95===e}function m(e,t){if(p[e]!==o.SurrogateChar)return o.NotIdentifierChar;const n=d[e];return n?n[t]:o.NotIdentifierChar}t.isIdentifierStartChar=function(e,t){if(e<l)return c[e]===o.StartIdentifierChar;let n;return u||(I(!1),u=!0),n=void 0!==t?m(e,t):p[e],n===o.StartIdentifierChar},t.isIdentifierChar=function(e,t){return e<l?c[e]===o.StartIdentifierChar||c[e]===o.IdentifierChar:(u||(I(!1),u=!0),void 0!==t?m(e,t):p[e]===o.StartIdentifierChar||p[e]===o.IdentifierChar)},t.isSurrogateChar=function(e){return!(e<l)&&(u||(I(!1),u=!0),p[e]===o.SurrogateChar)},t.isWhiteSpace=function(e){return 32===e||9===e||12===e},t.isLineBreak=function(e){return 13===e||10===e},t.isNumber=function(e){return e>=48&&e<=57||95===e},t.isDecimal=y,t.isHex=function(e){return y(e)||e>=97&&e<=102||e>=65&&e<=70||95===e},t.isOctal=function(e){return e>=48&&e<=55||95===e},t.isBinary=function(e){return 48===e||49===e||95===e};const g=[[95,6277,6278,8472,8494,12443,12444],r.unicodeLu,r.unicodeLl,r.unicodeLt,r.unicodeLo,r.unicodeLm,r.unicodeNl],h=[r.unicodeLuSurrogate,r.unicodeLlSurrogate,r.unicodeLoSurrogate,r.unicodeLmSurrogate,r.unicodeNlSurrogate],f=[[183,903,4969,4970,4971,4972,4973,4974,4975,4976,4977,6618],r.unicodeMn,r.unicodeMc,r.unicodeNd,r.unicodePc],T=[r.unicodeMnSurrogate,r.unicodeMcSurrogate,r.unicodeNdSurrogate];function v(e,t,n,s,i){for(let a=0;a<e.length;a++){const r=e[a];let o,c;Array.isArray(r)?(o=r[0],c=r[1]):o=c=r;for(let e=o;e<=c;e++)e<l?s[e]=t:i[e]=t;if(n&&o>=l)break}}function _(e,t){for(const n in e)d[n]||(d[n]={},p[n]=o.SurrogateChar),v(e[n],t,!1,d[n],d[n])}function I(e){if(c.fill(o.NotIdentifierChar),f.forEach((t=>{v(t,o.IdentifierChar,e,c,p)})),g.forEach((t=>{v(t,o.StartIdentifierChar,e,c,p)})),!e){for(const e of T)_(e,o.IdentifierChar);for(const e of h)_(e,o.StartIdentifierChar)}}I(!0)},5275:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StringListNode=t.FormatStringNode=t.StringNode=t.NumberNode=t.EllipsisNode=t.ConstantNode=t.NameNode=t.LambdaNode=t.MemberAccessNode=t.YieldFromNode=t.YieldNode=t.SliceNode=t.IndexNode=t.ListComprehensionNode=t.CallNode=t.TupleNode=t.UnpackNode=t.TernaryNode=t.AwaitNode=t.AugmentedAssignmentNode=t.FunctionAnnotationNode=t.TypeAnnotationNode=t.TypeAliasNode=t.TypeParameterListNode=t.TypeParameterNode=t.TypeParameterCategory=t.AssignmentNode=t.AssignmentExpressionNode=t.BinaryOperationNode=t.UnaryOperationNode=t.ErrorNode=t.isExpressionNode=t.StatementListNode=t.DecoratorNode=t.WithItemNode=t.WithNode=t.ClassNode=t.ParameterNode=t.FunctionNode=t.ExceptNode=t.TryNode=t.ListComprehensionIfNode=t.ListComprehensionForNode=t.ForNode=t.WhileNode=t.IfNode=t.SuiteNode=t.ModuleNode=t.extendRange=t.getNextNodeId=void 0,t.PatternValueNode=t.PatternMappingExpandEntryNode=t.PatternMappingKeyEntryNode=t.PatternMappingNode=t.PatternCaptureNode=t.PatternClassArgumentNode=t.PatternClassNode=t.PatternLiteralNode=t.PatternAsNode=t.PatternSequenceNode=t.CaseNode=t.MatchNode=t.RaiseNode=t.ReturnNode=t.ContinueNode=t.BreakNode=t.AssertNode=t.NonlocalNode=t.GlobalNode=t.ImportFromAsNode=t.ImportFromNode=t.ImportAsNode=t.ModuleNameNode=t.ImportNode=t.PassNode=t.DelNode=t.ArgumentNode=t.ListNode=t.SetNode=t.DictionaryExpandEntryNode=t.DictionaryKeyEntryNode=t.DictionaryNode=void 0;const s=n(3550);let i=1;function a(e,t){t.start<e.start&&(e.length+=e.start-t.start,e.start=t.start),s.TextRange.getEnd(t)>s.TextRange.getEnd(e)&&(e.length=s.TextRange.getEnd(t)-e.start)}var r,o;t.getNextNodeId=function(){return i++},t.extendRange=a,(t.ModuleNode||(t.ModuleNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:36,id:i++,statements:[]}},(t.SuiteNode||(t.SuiteNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:50,id:i++,statements:[]}},(t.IfNode||(t.IfNode={})).create=function(e,t,n,s){const r={start:e.start,length:e.length,nodeType:19,id:i++,testExpression:t,ifSuite:n,elseSuite:s};return t.parent=r,n.parent=r,a(r,t),a(r,n),s&&(a(r,s),s.parent=r),r},(t.WhileNode||(t.WhileNode={})).create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:57,id:i++,testExpression:t,whileSuite:n};return t.parent=s,n.parent=s,a(s,n),s},(t.ForNode||(t.ForNode={})).create=function(e,t,n,s){const r={start:e.start,length:e.length,nodeType:26,id:i++,targetExpression:t,iterableExpression:n,forSuite:s};return t.parent=r,n.parent=r,s.parent=r,a(r,s),r},(t.ListComprehensionForNode||(t.ListComprehensionForNode={})).create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:33,id:i++,targetExpression:t,iterableExpression:n};return t.parent=s,n.parent=s,a(s,t),a(s,n),s},(t.ListComprehensionIfNode||(t.ListComprehensionIfNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:34,id:i++,testExpression:t};return t.parent=n,a(n,t),n},(t.TryNode||(t.TryNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:53,id:i++,trySuite:t,exceptClauses:[]};return t.parent=n,a(n,t),n},(t.ExceptNode||(t.ExceptNode={})).create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:25,id:i++,exceptSuite:t,isExceptGroup:n};return t.parent=s,a(s,t),s},(t.FunctionNode||(t.FunctionNode={})).create=function(e,t,n,s){const r={start:e.start,length:e.length,nodeType:28,id:i++,decorators:[],name:t,typeParameters:s,parameters:[],suite:n};return t.parent=r,n.parent=r,s&&(s.parent=r),a(r,n),r},(t.ParameterNode||(t.ParameterNode={})).create=function(e,t){return{start:e.start,length:e.length,nodeType:41,id:i++,category:t}},(o=t.ClassNode||(t.ClassNode={})).create=function(e,t,n,s){const r={start:e.start,length:e.length,nodeType:10,id:i++,decorators:[],name:t,typeParameters:s,arguments:[],suite:n};return t.parent=r,n.parent=r,s&&(s.parent=r),a(r,n),r},o.createDummyForDecorators=function(e){const t={start:e[0].start,length:0,nodeType:10,id:i++,decorators:e,name:{start:e[0].start,length:0,id:0,nodeType:38,token:{type:7,start:0,length:0,comments:[],value:""},value:""},arguments:[],suite:{start:e[0].start,length:0,id:0,nodeType:50,statements:[]}};return e.forEach((e=>{e.parent=t,a(t,e)})),t.name.parent=t,t.suite.parent=t,t},(t.WithNode||(t.WithNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:58,id:i++,withItems:[],suite:t};return t.parent=n,a(n,t),n},(t.WithItemNode||(t.WithItemNode={})).create=function(e){const t={start:e.start,length:e.length,nodeType:59,id:i++,expression:e};return e.parent=t,t},(t.DecoratorNode||(t.DecoratorNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:13,id:i++,expression:t};return t.parent=n,a(n,t),n},(t.StatementListNode||(t.StatementListNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:47,id:i++,statements:[]}},t.isExpressionNode=function(e){switch(e.nodeType){case 0:case 55:case 7:case 4:case 54:case 6:case 51:case 56:case 52:case 9:case 32:case 24:case 46:case 60:case 61:case 35:case 30:case 38:case 11:case 18:case 40:case 49:case 27:case 48:case 15:case 31:case 45:return!0;default:return!1}},(t.ErrorNode||(t.ErrorNode={})).create=function(e,t,n,s){const r={start:e.start,length:e.length,nodeType:0,id:i++,category:t,child:n,decorators:s};return n&&(n.parent=r,a(r,n)),s&&(s.forEach((e=>{e.parent=r})),s.length>0&&a(r,s[0])),r},(t.UnaryOperationNode||(t.UnaryOperationNode={})).create=function(e,t,n){var s;const r={start:e.start,length:e.length,nodeType:55,id:i++,operator:n,operatorToken:e,expression:t};return t.parent=r,r.maxChildDepth=1+(null!==(s=t.maxChildDepth)&&void 0!==s?s:0),a(r,t),r},(t.BinaryOperationNode||(t.BinaryOperationNode={})).create=function(e,t,n,s){var r,o;const l={start:e.start,length:e.length,nodeType:7,id:i++,leftExpression:e,operatorToken:n,operator:s,rightExpression:t};return e.parent=l,t.parent=l,l.maxChildDepth=1+Math.max(null!==(r=e.maxChildDepth)&&void 0!==r?r:0,null!==(o=t.maxChildDepth)&&void 0!==o?o:0),a(l,t),l},(t.AssignmentExpressionNode||(t.AssignmentExpressionNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:4,id:i++,name:e,rightExpression:t};return e.parent=n,t.parent=n,a(n,t),n},(t.AssignmentNode||(t.AssignmentNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:3,id:i++,leftExpression:e,rightExpression:t};return e.parent=n,t.parent=n,a(n,t),n},(r=t.TypeParameterCategory||(t.TypeParameterCategory={}))[r.TypeVar=0]="TypeVar",r[r.TypeVarTuple=1]="TypeVarTuple",r[r.ParamSpec=2]="ParamSpec",(t.TypeParameterNode||(t.TypeParameterNode={})).create=function(e,t,n,s){const r={start:e.start,length:e.length,nodeType:75,id:i++,name:e,typeParamCategory:t,boundExpression:n,defaultExpression:s};return e.parent=r,n&&(n.parent=r,a(r,n)),s&&(s.parent=r,a(r,s)),r},(t.TypeParameterListNode||(t.TypeParameterListNode={})).create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:76,id:i++,parameters:n};return a(s,t),n.forEach((e=>{a(s,e),e.parent=s})),s},(t.TypeAliasNode||(t.TypeAliasNode={})).create=function(e,t,n,s){const r={start:e.start,length:e.length,nodeType:77,id:i++,name:t,typeParameters:s,expression:n};return t.parent=r,n.parent=r,s&&(s.parent=r),a(r,n),r},(t.TypeAnnotationNode||(t.TypeAnnotationNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:54,id:i++,valueExpression:e,typeAnnotation:t};return e.parent=n,t.parent=n,a(n,t),n},(t.FunctionAnnotationNode||(t.FunctionAnnotationNode={})).create=function(e,t,n,s){const r={start:e.start,length:e.length,nodeType:62,id:i++,isParamListEllipsis:t,paramTypeAnnotations:n,returnTypeAnnotation:s};return n.forEach((e=>{e.parent=r})),s.parent=r,a(r,s),r},(t.AugmentedAssignmentNode||(t.AugmentedAssignmentNode={})).create=function(e,t,n,s){const r={start:e.start,length:e.length,nodeType:5,id:i++,leftExpression:e,operator:n,rightExpression:t,destExpression:s};return e.parent=r,t.parent=r,s.parent=r,a(r,t),r},(t.AwaitNode||(t.AwaitNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:6,id:i++,expression:t};return t.parent=n,a(n,t),n},(t.TernaryNode||(t.TernaryNode={})).create=function(e,t,n){const s={start:e.start,length:e.length,nodeType:51,id:i++,ifExpression:e,testExpression:t,elseExpression:n};return e.parent=s,t.parent=s,n.parent=s,a(s,n),s},(t.UnpackNode||(t.UnpackNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:56,id:i++,expression:t};return t.parent=n,a(n,t),n},(t.TupleNode||(t.TupleNode={})).create=function(e,t){return{start:e.start,length:e.length,nodeType:52,id:i++,expressions:[],enclosedInParens:t}},(t.CallNode||(t.CallNode={})).create=function(e,t,n){var s;const r={start:e.start,length:e.length,nodeType:9,id:i++,leftExpression:e,arguments:t,trailingComma:n};return e.parent=r,r.maxChildDepth=1+(null!==(s=e.maxChildDepth)&&void 0!==s?s:0),t.length>0&&(t.forEach((e=>{e.parent=r})),a(r,t[t.length-1])),r},(t.ListComprehensionNode||(t.ListComprehensionNode={})).create=function(e){const t={start:e.start,length:e.length,nodeType:32,id:i++,expression:e,forIfNodes:[]};return e.parent=t,t},(t.IndexNode||(t.IndexNode={})).create=function(e,t,n,s){var r;const o={start:e.start,length:e.length,nodeType:24,id:i++,baseExpression:e,items:t,trailingComma:n};return e.parent=o,t.forEach((e=>{e.parent=o})),a(o,s),o.maxChildDepth=1+(null!==(r=e.maxChildDepth)&&void 0!==r?r:0),o},(t.SliceNode||(t.SliceNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:46,id:i++}},(t.YieldNode||(t.YieldNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:60,id:i++,expression:t};return t&&(t.parent=n,a(n,t)),n},(t.YieldFromNode||(t.YieldFromNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:61,id:i++,expression:t};return t.parent=n,a(n,t),n},(t.MemberAccessNode||(t.MemberAccessNode={})).create=function(e,t){var n;const s={start:e.start,length:e.length,nodeType:35,id:i++,leftExpression:e,memberName:t};return e.parent=s,t.parent=s,a(s,t),s.maxChildDepth=1+(null!==(n=e.maxChildDepth)&&void 0!==n?n:0),s},(t.LambdaNode||(t.LambdaNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:30,id:i++,parameters:[],expression:t};return t.parent=n,a(n,t),n},(t.NameNode||(t.NameNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:38,id:i++,token:e,value:e.value}},(t.ConstantNode||(t.ConstantNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:11,id:i++,constType:e.keywordType}},(t.EllipsisNode||(t.EllipsisNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:18,id:i++}},(t.NumberNode||(t.NumberNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:40,id:i++,value:e.value,isInteger:e.isInteger,isImaginary:e.isImaginary}},(t.StringNode||(t.StringNode={})).create=function(e,t,n){return{start:e.start,length:e.length,nodeType:49,id:i++,token:e,value:t,hasUnescapeErrors:n}},(t.FormatStringNode||(t.FormatStringNode={})).create=function(e,t,n,s){const a={start:e.start,length:e.length,nodeType:27,id:i++,token:e,value:t,hasUnescapeErrors:n,expressions:s};return s.forEach((e=>{e.parent=a})),a},(t.StringListNode||(t.StringListNode={})).create=function(e){const t={start:e[0].start,length:e[0].length,nodeType:48,id:i++,strings:e};return e.length>0&&(e.forEach((e=>{e.parent=t})),a(t,e[e.length-1])),t},(t.DictionaryNode||(t.DictionaryNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:15,id:i++,entries:[]}},(t.DictionaryKeyEntryNode||(t.DictionaryKeyEntryNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:17,id:i++,keyExpression:e,valueExpression:t};return e.parent=n,t.parent=n,a(n,t),n},(t.DictionaryExpandEntryNode||(t.DictionaryExpandEntryNode={})).create=function(e){const t={start:e.start,length:e.length,nodeType:16,id:i++,expandExpression:e};return e.parent=t,t},(t.SetNode||(t.SetNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:45,id:i++,entries:[]}},(t.ListNode||(t.ListNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:31,id:i++,entries:[]}},(t.ArgumentNode||(t.ArgumentNode={})).create=function(e,t,n){const s={start:e?e.start:t.start,length:e?e.length:t.length,nodeType:1,id:i++,valueExpression:t,argumentCategory:n};return t.parent=s,a(s,t),s},(t.DelNode||(t.DelNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:14,id:i++,expressions:[]}},(t.PassNode||(t.PassNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:42,id:i++}},(t.ImportNode||(t.ImportNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:20,id:i++,list:[]}},(t.ModuleNameNode||(t.ModuleNameNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:37,id:i++,leadingDots:0,nameParts:[]}},(t.ImportAsNode||(t.ImportAsNode={})).create=function(e){const t={start:e.start,length:e.length,nodeType:21,id:i++,module:e};return e.parent=t,t},(t.ImportFromNode||(t.ImportFromNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:22,id:i++,module:t,imports:[],isWildcardImport:!1,usesParens:!1};return t.parent=n,a(n,t),n},(t.ImportFromAsNode||(t.ImportFromAsNode={})).create=function(e){const t={start:e.start,length:e.length,nodeType:23,id:i++,name:e};return e.parent=t,t},(t.GlobalNode||(t.GlobalNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:29,id:i++,nameList:[]}},(t.NonlocalNode||(t.NonlocalNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:39,id:i++,nameList:[]}},(t.AssertNode||(t.AssertNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:2,id:i++,testExpression:t};return t.parent=n,a(n,t),n},(t.BreakNode||(t.BreakNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:8,id:i++}},(t.ContinueNode||(t.ContinueNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:12,id:i++}},(t.ReturnNode||(t.ReturnNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:44,id:i++}},(t.RaiseNode||(t.RaiseNode={})).create=function(e){return{start:e.start,length:e.length,nodeType:43,id:i++}},(t.MatchNode||(t.MatchNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:63,id:i++,subjectExpression:t,cases:[]};return t.parent=n,a(n,t),n},(t.CaseNode||(t.CaseNode={})).create=function(e,t,n,s,r){const o={start:e.start,length:e.length,nodeType:64,id:i++,pattern:t,isIrrefutable:n,guardExpression:s,suite:r};return a(o,r),t.parent=o,r.parent=o,s&&(s.parent=o),o},(t.PatternSequenceNode||(t.PatternSequenceNode={})).create=function(e,t){const n=t.findIndex((e=>1===e.orPatterns.length&&69===e.orPatterns[0].nodeType&&e.orPatterns[0].isStar)),s={start:e.start,length:e.length,nodeType:65,id:i++,entries:t,starEntryIndex:n>=0?n:void 0};return t.length>0&&a(s,t[t.length-1]),t.forEach((e=>{e.parent=s})),s},(t.PatternAsNode||(t.PatternAsNode={})).create=function(e,t){const n={start:e[0].start,length:e[0].length,nodeType:66,id:i++,orPatterns:e,target:t};return e.length>1&&a(n,e[e.length-1]),e.forEach((e=>{e.parent=n})),t&&(a(n,t),t.parent=n),n},(t.PatternLiteralNode||(t.PatternLiteralNode={})).create=function(e){const t={start:e.start,length:e.length,nodeType:67,id:i++,expression:e};return e.parent=t,t},(t.PatternClassNode||(t.PatternClassNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:68,id:i++,className:e,arguments:t};return e.parent=n,t.forEach((e=>{e.parent=n})),t.length>0&&a(n,t[t.length-1]),n},(t.PatternClassArgumentNode||(t.PatternClassArgumentNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:74,id:i++,pattern:e,name:t};return e.parent=n,t&&(a(n,t),t.parent=n),n},(t.PatternCaptureNode||(t.PatternCaptureNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:69,id:i++,target:e,isStar:void 0!==t,isWildcard:"_"===e.value};return e.parent=n,t&&a(n,t),n},(t.PatternMappingNode||(t.PatternMappingNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:70,id:i++,entries:t};return t.length>0&&a(n,t[t.length-1]),t.forEach((e=>{e.parent=n})),n},(t.PatternMappingKeyEntryNode||(t.PatternMappingKeyEntryNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:71,id:i++,keyPattern:e,valuePattern:t};return e.parent=n,t.parent=n,a(n,t),n},(t.PatternMappingExpandEntryNode||(t.PatternMappingExpandEntryNode={})).create=function(e,t){const n={start:e.start,length:e.length,nodeType:72,id:i++,target:t};return t.parent=n,a(n,t),n},(t.PatternValueNode||(t.PatternValueNode={})).create=function(e){const t={start:e.start,length:e.length,nodeType:73,id:i++,expression:e};return e.parent=t,t}},2540:function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,i)}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=t.ParseOptions=void 0;const r=n(4221),o=n(9489),l=n(5839),c=n(1290),p=n(3980),d=n(1464),u=n(6886),y=n(3550),m=n(8718),g=n(9866),h=n(5275),f=a(n(5136)),T=n(7093),v=n(6180);class _{constructor(){this.isStubFile=!1,this.pythonVersion=u.latestStablePythonVersion,this.reportInvalidStringEscapeSequence=!1,this.skipFunctionAndClassBody=!1,this.ipythonMode=r.IPythonMode.None,this.reportErrorsForParsedStringContents=!1}}t.ParseOptions=_;const I=256;class b{constructor(){this._tokenIndex=0,this._areErrorsSuppressed=!1,this._parseOptions=new _,this._diagSink=new p.DiagnosticSink,this._isInLoop=!1,this._isInFunction=!1,this._isInFinally=!1,this._isParsingTypeAnnotation=!1,this._isParsingIndexTrailer=!1,this._isParsingQuotedText=!1,this._futureImports=new Set,this._importedModules=[],this._containsWildcardImport=!1,this._assignmentExpressionsAllowed=!0,this._typingImportAliases=[],this._typingSymbolAliases=new Map}parseSourceFile(e,t,n){m.timingStats.tokenizeFileTime.timeOperation((()=>{this._startNewParse(e,0,e.length,t,n)}));const s=h.ModuleNode.create({start:0,length:e.length});return m.timingStats.parseFileTime.timeOperation((()=>{for(;!this._atEof();)if(!this._consumeTokenIfType(2)){const e=this._peekToken();if(3===e.type){this._getNextToken();const t=e;t.isIndentAmbiguous?this._addError(g.Localizer.Diagnostic.inconsistentTabs(),t):this._addError(g.Localizer.Diagnostic.unexpectedIndent(),e)}const t=this._parseStatement();t?(t.parent=s,s.statements.push(t)):this._consumeTokensUntilType([2])}})),(0,l.assert)(void 0!==this._tokenizerOutput),{text:e,parseTree:s,importedModules:this._importedModules,futureImports:this._futureImports,tokenizerOutput:this._tokenizerOutput,containsWildcardImport:this._containsWildcardImport,typingSymbolAliases:this._typingSymbolAliases}}parseTextExpression(e,t,n,s,i=0,a=0,r){const o=new p.DiagnosticSink;let l;if(this._startNewParse(e,t,n,s,o,a),r&&(this._typingSymbolAliases=new Map(r)),1===i)this._isParsingQuotedText=!0,l=this._parseTypeAnnotation();else if(2===i)this._isParsingQuotedText=!0,l=this._parseFunctionTypeAnnotation();else{const e=this._parseTestOrStarExpressionList(!1,!0);e.parseError?l=e.parseError:(0===e.list.length&&this._addError(g.Localizer.Diagnostic.expectedExpr(),this._peekToken()),l=this._makeExpressionOrTuple(e,!1))}return 2===this._peekTokenType()&&this._getNextToken(),this._atEof()||this._addError(g.Localizer.Diagnostic.unexpectedExprToken(),this._peekToken()),{parseTree:l,lines:this._tokenizerOutput.lines,diagnostics:o.fetchAndClear()}}_startNewParse(e,t,n,s,i,a=0){this._fileContents=e,this._parseOptions=s,this._diagSink=i;const r=new T.Tokenizer;this._tokenizerOutput=r.tokenize(e,t,n,a,this._parseOptions.ipythonMode),this._tokenIndex=0}_parseStatement(){switch(this._consumeTokenIfType(4)&&this._addError(g.Localizer.Diagnostic.unexpectedUnindent(),this._peekToken()),this._peekKeywordType()){case 20:return this._parseIfStatement();case 36:return this._parseWhileStatement();case 17:return this._parseForStatement();case 34:return this._parseTryStatement();case 37:return this._parseWithStatement();case 10:return this._parseFunctionDef();case 7:return this._parseClassDef();case 3:return this._parseAsyncStatement();case 25:{const e=this._peekToken(1);let t=!1;if(10===e.type||11===e.type||12===e.type||20===e.type||2===e.type||1===e.type)t=!0;else if(9===e.type){const n=e;26!==n.operatorType&&33!==n.operatorType&&(t=!0)}if(!t){const e=this._parseMatchStatement();if(e)return e}break}}return 22===this._peekOperatorType()?this._parseDecorated():this._parseSimpleStatement()}_parseAsyncStatement(){const e=this._getKeywordToken(3);switch(this._peekKeywordType()){case 10:return this._parseFunctionDef(e);case 37:return this._parseWithStatement(e);case 17:return this._parseForStatement(e)}this._addError(g.Localizer.Diagnostic.unexpectedAsyncToken(),e)}_parseTypeAliasStatement(){const e=this._getKeywordToken(35);!this._parseOptions.isStubFile&&this._getLanguageVersion()<u.PythonVersion.V3_12&&this._addError(g.Localizer.Diagnostic.typeAliasStatementIllegal(),e);const t=this._getTokenIfIdentifier();(0,l.assert)(void 0!==t);const n=h.NameNode.create(t);let s;15===this._peekToken().type&&(s=this._parseTypeParameterList());const i=this._peekToken();9!==i.type||2!==i.operatorType?this._addError(g.Localizer.Diagnostic.expectedEquals(),i):this._getNextToken();const a=this._parseOrTest();return h.TypeAliasNode.create(e,n,a,s)}_parseTypeParameterList(){const e=[],t=this._getNextToken();for((0,l.assert)(15===t.type);;){if(16===this._peekToken().type){0===e.length&&this._addError(g.Localizer.Diagnostic.typeParametersMissing(),this._peekToken());break}const t=this._parseTypeParameter();if(!t)break;if(e.push(t),!this._consumeTokenIfType(12))break}const n=this._peekToken();return 16!==n.type?(this._addError(g.Localizer.Diagnostic.expectedCloseBracket(),this._peekToken()),this._consumeTokensUntilType([2,16,10])):this._getNextToken(),h.TypeParameterListNode.create(t,n,e)}_parseTypeParameter(){let e=h.TypeParameterCategory.TypeVar;this._consumeTokenIfOperator(26)?e=h.TypeParameterCategory.TypeVarTuple:this._consumeTokenIfOperator(29)&&(e=h.TypeParameterCategory.ParamSpec);const t=this._getTokenIfIdentifier();if(!t)return void this._addError(g.Localizer.Diagnostic.expectedTypeParameterName(),this._peekToken());const n=h.NameNode.create(t);let s,i;return this._consumeTokenIfType(10)&&(s=this._parseExpression(!1),e!==h.TypeParameterCategory.TypeVar&&this._addError(g.Localizer.Diagnostic.typeParameterBoundNotAllowed(),s)),this._consumeTokenIfOperator(2)&&(i=this._parseExpression(e===h.TypeParameterCategory.TypeVarTuple)),h.TypeParameterNode.create(n,e,s,i)}_parseMatchStatement(){let e=!1;if(this._suppressErrors((()=>{const t=this._tokenIndex;this._getKeywordToken(25);const n=this._parseTestOrStarListAsExpression(!0,!0,12,(()=>g.Localizer.Diagnostic.expectedReturnExpr()));e=0!==n.nodeType&&10===this._peekToken().type,this._tokenIndex=t})),!e)return;const t=this._getKeywordToken(25),n=this._parseTestOrStarListAsExpression(!0,!0,12,(()=>g.Localizer.Diagnostic.expectedReturnExpr())),s=h.MatchNode.create(t,n),i=this._peekToken();if(this._consumeTokenIfType(10)){if((0,h.extendRange)(s,i),this._consumeTokenIfType(2)){const e=this._peekToken();if(this._consumeTokenIfType(3)){const t=e;t.isIndentAmbiguous&&this._addError(g.Localizer.Diagnostic.inconsistentTabs(),t)}else this._addError(g.Localizer.Diagnostic.expectedIndentedBlock(),this._peekToken());for(;;){const e=this._peekToken();if(3===e.type){this._getNextToken();const t=e;t.isIndentAmbiguous?this._addError(g.Localizer.Diagnostic.inconsistentTabs(),t):this._addError(g.Localizer.Diagnostic.unexpectedIndent(),e)}const t=this._parseCaseStatement();t?(t.parent=s,s.cases.push(t)):this._consumeTokensUntilType([2,10])&&this._getNextToken();const n=this._peekToken();if(this._consumeTokenIfType(4)){n.matchesIndent||this._addError(g.Localizer.Diagnostic.inconsistentIndent(),n),n.isDedentAmbiguous&&this._addError(g.Localizer.Diagnostic.inconsistentTabs(),n);break}if(1===this._peekTokenType())break}}else this._addError(g.Localizer.Diagnostic.expectedNewline(),i);s.cases.length>0?(0,h.extendRange)(s,s.cases[s.cases.length-1]):this._addError(g.Localizer.Diagnostic.zeroCaseStatementsFound(),t)}else this._addError(g.Localizer.Diagnostic.expectedColon(),i),this._consumeTokensUntilType([2,10])&&this._getNextToken();this._getLanguageVersion()<u.PythonVersion.V3_10&&this._addError(g.Localizer.Diagnostic.matchIncompatible(),t);for(let e=0;e<s.cases.length-1;e++){const t=s.cases[e];!t.guardExpression&&t.isIrrefutable&&this._addError(g.Localizer.Diagnostic.casePatternIsIrrefutable(),t.pattern)}return s}_parseCaseStatement(){const e=this._peekToken();if(!this._consumeTokenIfKeyword(6))return void this._addError(g.Localizer.Diagnostic.expectedCase(),e);const t=this._parsePatternSequence();let n,s;if(t.parseError)n=t.parseError;else if(0===t.list.length)this._addError(g.Localizer.Diagnostic.expectedPatternExpr(),this._peekToken()),n=h.ErrorNode.create(e,11);else if(1!==t.list.length||t.trailingComma)n=h.PatternSequenceNode.create(t.list[0],t.list);else{const e=t.list[0].orPatterns[0];n=69===e.nodeType&&e.isStar?h.PatternSequenceNode.create(t.list[0],t.list):t.list[0]}this._consumeTokenIfKeyword(20)&&(s=this._parseTestExpression(!0));const i=this._parseSuite(this._isInFunction);return h.CaseNode.create(e,n,this._isPatternIrrefutable(n),s,i)}_isPatternIrrefutable(e){return 69===e.nodeType||66===e.nodeType&&e.orPatterns.some((e=>this._isPatternIrrefutable(e)))}_getPatternTargetNames(e,t){switch(e.nodeType){case 65:e.entries.forEach((e=>{this._getPatternTargetNames(e,t)}));break;case 68:e.arguments.forEach((e=>{this._getPatternTargetNames(e.pattern,t)}));break;case 66:e.target&&t.add(e.target.value),e.orPatterns.forEach((e=>{this._getPatternTargetNames(e,t)}));break;case 69:e.isWildcard||t.add(e.target.value);break;case 70:e.entries.forEach((e=>{72===e.nodeType?t.add(e.target.value):(this._getPatternTargetNames(e.keyPattern,t),this._getPatternTargetNames(e.valuePattern,t))}))}}_parsePatternSequence(){const e=this._parseExpressionListGeneric((()=>this._parsePatternAs())),t=e.list.filter((e=>1===e.orPatterns.length&&69===e.orPatterns[0].nodeType&&e.orPatterns[0].isStar));t.length>1&&this._addError(g.Localizer.Diagnostic.duplicateStarPattern(),t[1].orPatterns[0]);const n=new Map;return e.list.forEach((e=>{e.orPatterns.forEach((e=>{69!==e.nodeType||e.isStar||e.isWildcard||(n.has(e.target.value)?this._addError(g.Localizer.Diagnostic.duplicateCapturePatternTarget().format({name:e.target.value}),e):n.set(e.target.value,e))}))})),e}_parsePatternAs(){const e=[];for(;;){const t=this._parsePatternAtom();if(e.push(t),!this._consumeTokenIfOperator(6))break}let t;if(e.length>1&&e.forEach((e=>{69===e.nodeType&&e.isStar&&this._addError(g.Localizer.Diagnostic.starPatternInOrPattern(),e)})),this._consumeTokenIfKeyword(1)){const e=this._getTokenIfIdentifier();e?t=h.NameNode.create(e):this._addError(g.Localizer.Diagnostic.expectedNameAfterAs(),this._peekToken())}t&&1===e.length&&69===e[0].nodeType&&e[0].isStar&&this._addError(g.Localizer.Diagnostic.starPatternInAsPattern(),e[0]),e.forEach(((t,n)=>{n<e.length-1&&this._isPatternIrrefutable(t)&&this._addError(g.Localizer.Diagnostic.orPatternIrrefutable(),t)}));const n=new Set;return e.forEach((e=>{this._getPatternTargetNames(e,n)})),e.forEach((e=>{const t=new Set;if(this._getPatternTargetNames(e,t),t.size<n.size){const s=Array.from(n.keys()).filter((e=>!t.has(e))),i=new c.DiagnosticAddendum;i.addMessage(g.Localizer.DiagnosticAddendum.orPatternMissingName().format({name:s.map((e=>`"${e}"`)).join(", ")})),this._addError(g.Localizer.Diagnostic.orPatternMissingName()+i.getString(),e)}})),h.PatternAsNode.create(e,t)}_parsePatternAtom(){const e=this._parsePatternLiteral();if(e)return e;const t=this._parsePatternCaptureOrValue();if(t){const e=this._peekToken();if(0===t.nodeType||!this._consumeTokenIfType(13))return t;const n=this._parseClassPatternArgList(),s=69===t.nodeType?t.target:t.expression,i=h.PatternClassNode.create(s,n);return this._consumeTokenIfType(14)||(this._addError(g.Localizer.Diagnostic.expectedCloseParen(),e),this._consumeTokensUntilType([2]),(0,h.extendRange)(i,this._peekToken())),i}const n=this._peekToken();if(26===this._peekOperatorType()){const e=this._getNextToken(),t=this._getTokenIfIdentifier();return t?h.PatternCaptureNode.create(h.NameNode.create(t),e):(this._addError(g.Localizer.Diagnostic.expectedIdentifier(),this._peekToken()),h.ErrorNode.create(e,2))}if(13===n.type||15===n.type){const e=this._getNextToken(),t=this._parsePatternSequence();let s;if(t.parseError)s=t.parseError;else if(1!==t.list.length||t.trailingComma||13!==e.type)s=h.PatternSequenceNode.create(e,t.list);else{const i=t.list[0].orPatterns[0];s=69===i.nodeType&&i.isStar?h.PatternSequenceNode.create(e,t.list):t.list[0],(0,h.extendRange)(s,n)}const i=this._peekToken();return this._consumeTokenIfType(13===n.type?14:16)?(0,h.extendRange)(s,i):(this._addError(13===n.type?g.Localizer.Diagnostic.expectedCloseParen():g.Localizer.Diagnostic.expectedCloseBracket(),n),this._consumeTokensUntilType([10,13===n.type?14:16])),s}if(17===n.type){const e=this._getNextToken(),t=this._parsePatternMapping(e),s=this._peekToken();return this._consumeTokenIfType(18)?(0,h.extendRange)(t,s):(this._addError(g.Localizer.Diagnostic.expectedCloseBrace(),n),this._consumeTokensUntilType([10,18])),t}return this._handleExpressionParseError(11,g.Localizer.Diagnostic.expectedPatternExpr())}_parseClassPatternArgList(){const e=[];let t=!1;for(;;){const n=this._peekTokenType();if(14===n||2===n||1===n)break;const s=this._parseClassPatternArgument();if(s.name?t=!0:t&&!s.name&&this._addError(g.Localizer.Diagnostic.positionArgAfterNamedArg(),s),e.push(s),!this._consumeTokenIfType(12))break}return e}_parseClassPatternArgument(){const e=this._peekToken(),t=this._peekToken(1);let n;if((7===e.type||8===e.type)&&9===t.type&&2===t.operatorType){const e=this._getTokenIfIdentifier();void 0!==e&&(n=h.NameNode.create(e),this._getNextToken())}const s=this._parsePatternAs();return h.PatternClassArgumentNode.create(s,n)}_parsePatternLiteral(){const e=this._peekToken(),t=this._peekOperatorType();if(6===e.type||33===t)return this._parsePatternLiteralNumber();if(5===e.type){const e=this._parseAtom();return(0,l.assert)(48===e.nodeType),e.strings.forEach((e=>{64&e.token.flags&&this._addError(g.Localizer.Diagnostic.formatStringInPattern(),e)})),h.PatternLiteralNode.create(e)}if(8===e.type){const t=e;if(15===t.keywordType||33===t.keywordType||26===t.keywordType)return h.PatternLiteralNode.create(this._parseAtom())}}_parsePatternLiteralNumber(){const e=this._parseArithmeticExpression();let t,n;return 7===e.nodeType?33!==e.operator&&0!==e.operator||(t=e.leftExpression,n=e.rightExpression):t=e,t&&(55===t.nodeType&&33===t.operator&&(t=t.expression),(40!==t.nodeType||void 0!==n&&t.isImaginary)&&(this._addError(g.Localizer.Diagnostic.expectedComplexNumberLiteral(),e),n=void 0)),n&&(55===n.nodeType&&33===n.operator&&(n=n.expression),40===n.nodeType&&n.isImaginary||this._addError(g.Localizer.Diagnostic.expectedComplexNumberLiteral(),e)),h.PatternLiteralNode.create(e)}_parsePatternMapping(e){const t=this._parseExpressionListGeneric((()=>this._parsePatternMappingItem()));if(t.list.length>0){const n=t.list.filter((e=>72===e.nodeType));return n.length>1&&this._addError(g.Localizer.Diagnostic.duplicateStarStarPattern(),n[1]),h.PatternMappingNode.create(e,t.list)}return t.parseError||h.ErrorNode.create(this._peekToken(),11)}_parsePatternMappingItem(){let e;const t=this._peekToken();if(this._consumeTokenIfOperator(29)){const e=this._getTokenIfIdentifier();if(!e)return this._addError(g.Localizer.Diagnostic.expectedIdentifier(),this._peekToken()),h.ErrorNode.create(this._peekToken(),11);const n=h.NameNode.create(e);return"_"===e.value&&this._addError(g.Localizer.Diagnostic.starStarWildcardNotAllowed(),n),h.PatternMappingExpandEntryNode.create(t,n)}const n=this._parsePatternLiteral();if(n)e=n;else{const t=this._parsePatternCaptureOrValue();t&&(73===t.nodeType?e=t:(this._addError(g.Localizer.Diagnostic.expectedPatternValue(),t),e=h.ErrorNode.create(this._peekToken(),11)))}let s;return e||(this._addError(g.Localizer.Diagnostic.expectedPatternExpr(),this._peekToken()),e=h.ErrorNode.create(this._peekToken(),11)),this._consumeTokenIfType(10)?s=this._parsePatternAs():(this._addError(g.Localizer.Diagnostic.expectedColon(),this._peekToken()),s=h.ErrorNode.create(this._peekToken(),11)),h.PatternMappingKeyEntryNode.create(e,s)}_parsePatternCaptureOrValue(){const e=this._peekToken();if(7===e.type||8===e.type){let e;for(;;){const t=this._getTokenIfIdentifier();if(!t){this._addError(g.Localizer.Diagnostic.expectedIdentifier(),this._peekToken());break}{const n=h.NameNode.create(t);e=e?h.MemberAccessNode.create(e,n):n}if(!this._consumeTokenIfType(20))break}return e?35===e.nodeType?h.PatternValueNode.create(e):h.PatternCaptureNode.create(e):(this._addError(g.Localizer.Diagnostic.expectedIdentifier(),this._peekToken()),h.ErrorNode.create(this._peekToken(),11))}}_parseIfStatement(e=20){const t=this._getKeywordToken(e),n=this._parseTestExpression(!0),s=this._parseSuite(this._isInFunction),i=h.IfNode.create(t,n,s);return this._consumeTokenIfKeyword(13)?(i.elseSuite=this._parseSuite(this._isInFunction),i.elseSuite.parent=i,(0,h.extendRange)(i,i.elseSuite)):12===this._peekKeywordType()&&(i.elseSuite=this._parseIfStatement(12),i.elseSuite.parent=i,(0,h.extendRange)(i,i.elseSuite)),i}_parseLoopSuite(){const e=this._isInLoop,t=this._isInFinally;let n;this._isInLoop=!0,this._isInFinally=!1;const s=this._parseSuite(this._isInFunction,!1,(()=>{const e=this._getTypeAnnotationCommentText();e&&(n=e)}));return this._isInLoop=e,this._isInFinally=t,n&&(s.typeComment=n),s}_parseSuite(e=!1,t=!1,n){const s=this._peekToken(),i=h.SuiteNode.create(s);if(!this._consumeTokenIfType(10)&&(this._addError(g.Localizer.Diagnostic.expectedColon(),s),this._consumeTokensUntilType([2,10])))if(10===this._peekTokenType())this._getNextToken();else if(3!==this._peekToken(1).type)return this._getNextToken(),i;if(t){if(this._consumeTokenIfType(2)){let e=0;for(;;){const t=this._getNextToken();if(3===t.type&&e++,4===t.type&&(t.isDedentAmbiguous&&this._addError(g.Localizer.Diagnostic.inconsistentTabs(),t),e--,0===e))break;if(1===t.type)break}}else this._parseSimpleStatement();return this._tokenIndex>0&&(0,h.extendRange)(i,this._tokenizerOutput.tokens.getItemAt(this._tokenIndex-1)),i}n&&n();const a=this._isInFunction;if(this._isInFunction=e,this._consumeTokenIfType(2)){n&&n();const e=this._peekToken();if(!this._consumeTokenIfType(3))return this._addError(g.Localizer.Diagnostic.expectedIndentedBlock(),this._peekToken()),i;const t=e;for(t.isIndentAmbiguous&&this._addError(g.Localizer.Diagnostic.inconsistentTabs(),t);;){const e=this._peekToken();if(3===e.type){this._getNextToken();const t=e;t.isIndentAmbiguous?this._addError(g.Localizer.Diagnostic.inconsistentTabs(),t):this._addError(g.Localizer.Diagnostic.unexpectedIndent(),e)}else if(4===e.type){const n=e;if(n.matchesIndent||this._addError(g.Localizer.Diagnostic.inconsistentIndent(),n),n.isDedentAmbiguous&&this._addError(g.Localizer.Diagnostic.inconsistentTabs(),n),i.statements.length>0?this._consumeTokenIfType(4):(0,h.extendRange)(i,n),!t||n.indentAmount<t.indentAmount)break;if(n.indentAmount===t.indentAmount){const e=this._peekToken();if(this._consumeTokenIfType(4)){(0,h.extendRange)(i,e);break}}}const n=this._parseStatement();if(n?(n.parent=i,i.statements.push(n)):this._consumeTokensUntilType([2]),1===this._peekTokenType())break}}else{const e=this._parseSimpleStatement();i.statements.push(e),e.parent=i}return i.statements.length>0&&(0,h.extendRange)(i,i.statements[i.statements.length-1]),this._isInFunction=a,i}_parseForStatement(e){const t=this._getKeywordToken(17),n=this._parseExpressionListAsPossibleTuple(2,(()=>g.Localizer.Diagnostic.expectedExpr()),t);let s,i,a;if(this._consumeTokenIfKeyword(22)){if(s=this._parseTestOrStarListAsExpression(!1,!0,2,(()=>g.Localizer.Diagnostic.expectedInExpr())),i=this._parseLoopSuite(),this._getLanguageVersion()<u.PythonVersion.V3_9&&!this._parseOptions.isStubFile&&52===s.nodeType&&!s.enclosedInParens){let e=!1;s.expressions.forEach((t=>{56!==t.nodeType||e||(this._addError(g.Localizer.Diagnostic.unpackOperatorNotAllowed(),t),e=!0)}))}this._consumeTokenIfKeyword(13)&&(a=this._parseSuite(this._isInFunction))}else s=this._handleExpressionParseError(0,g.Localizer.Diagnostic.expectedIn()),i=h.SuiteNode.create(this._peekToken());const r=h.ForNode.create(t,n,s,i);return r.elseSuite=a,a&&((0,h.extendRange)(r,a),a.parent=r),e&&(r.isAsync=!0,r.asyncToken=e,(0,h.extendRange)(r,e)),i.typeComment&&(r.typeComment=i.typeComment),r}_tryParseListComprehension(e){const t=this._tryParseCompForStatement();if(!t)return;56===e.nodeType?this._addError(g.Localizer.Diagnostic.unpackIllegalInComprehension(),e):16===e.nodeType&&this._addError(g.Localizer.Diagnostic.dictExpandIllegalInComprehension(),e);const n=h.ListComprehensionNode.create(e),s=[t];for(;;){const e=this._tryParseCompForStatement()||this._tryParseCompIfStatement();if(!e)break;e.parent=n,s.push(e)}return n.forIfNodes=s,s.length>0&&(s.forEach((e=>{e.parent=n})),(0,h.extendRange)(n,s[s.length-1])),n}_tryParseCompForStatement(){const e=this._peekKeywordType();if(3===e){const e=this._peekToken(1);if(8!==e.type||17!==e.keywordType)return}else if(17!==e)return;let t;3===this._peekKeywordType()&&(t=this._getKeywordToken(3));const n=this._getKeywordToken(17),s=this._parseExpressionListAsPossibleTuple(2,(()=>g.Localizer.Diagnostic.expectedExpr()),n);let i;this._consumeTokenIfKeyword(22)?this._disallowAssignmentExpression((()=>{i=this._parseOrTest()})):i=this._handleExpressionParseError(0,g.Localizer.Diagnostic.expectedIn());const a=h.ListComprehensionForNode.create(t||n,s,i);return t&&(a.isAsync=!0,a.asyncToken=t),a}_tryParseCompIfStatement(){if(20!==this._peekKeywordType())return;const e=this._getKeywordToken(20),t=this._tryParseLambdaExpression()||this._parseAssignmentExpression(!0);return h.ListComprehensionIfNode.create(e,t)}_parseWhileStatement(){const e=this._getKeywordToken(36),t=h.WhileNode.create(e,this._parseTestExpression(!0),this._parseLoopSuite());return this._consumeTokenIfKeyword(13)&&(t.elseSuite=this._parseSuite(this._isInFunction),t.elseSuite.parent=t,(0,h.extendRange)(t,t.elseSuite)),t}_parseTryStatement(){const e=this._getKeywordToken(34),t=this._parseSuite(this._isInFunction),n=h.TryNode.create(e,t);let s=!1;for(;;){const e=this._peekToken();if(!this._consumeTokenIfKeyword(14))break;const t=this._peekToken();let i,a,r=!1;if(this._consumeTokenIfOperator(26)&&(this._getLanguageVersion()<u.PythonVersion.V3_11&&!this._parseOptions.isStubFile&&this._addError(g.Localizer.Diagnostic.exceptionGroupIncompatible(),t),r=!0),10!==this._peekTokenType())if(i=this._parseTestExpression(!0),this._consumeTokenIfKeyword(1))a=this._getTokenIfIdentifier(),a||this._addError(g.Localizer.Diagnostic.expectedNameAfterAs(),this._peekToken());else{const e=this._peekToken();this._consumeTokenIfType(12)&&(this._addError(g.Localizer.Diagnostic.expectedAsAfterException(),e),this._parseTestExpression(!1))}i?s&&this._addError(g.Localizer.Diagnostic.namedExceptAfterCatchAll(),i):(s&&this._addError(g.Localizer.Diagnostic.duplicateCatchAll(),e),s=!0);const o=this._parseSuite(this._isInFunction),l=h.ExceptNode.create(e,o,r);i&&(l.typeExpression=i,l.typeExpression.parent=l),a&&(l.name=h.NameNode.create(a),l.name.parent=l),n.exceptClauses.push(l),l.parent=n}return n.exceptClauses.length>0&&((0,h.extendRange)(n,n.exceptClauses[n.exceptClauses.length-1]),this._consumeTokenIfKeyword(13)&&(n.elseSuite=this._parseSuite(this._isInFunction),n.elseSuite.parent=n,(0,h.extendRange)(n,n.elseSuite))),this._consumeTokenIfKeyword(16)&&(n.finallySuite=this._parseSuite(this._isInFunction),n.finallySuite.parent=n,(0,h.extendRange)(n,n.finallySuite)),n.finallySuite||0!==n.exceptClauses.length||this._addError(g.Localizer.Diagnostic.tryWithoutExcept(),e),n}_parseFunctionDef(e,t){const n=this._getKeywordToken(10),s=this._getTokenIfIdentifier();if(!s)return this._addError(g.Localizer.Diagnostic.expectedFunctionName(),n),h.ErrorNode.create(n,10,void 0,t);let i;15===this._peekToken().type&&(i=this._parseTypeParameterList(),!this._parseOptions.isStubFile&&this._getLanguageVersion()<u.PythonVersion.V3_12&&this._addError(g.Localizer.Diagnostic.functionTypeParametersIllegal(),i));const a=this._peekToken();if(!this._consumeTokenIfType(13))return this._addError(g.Localizer.Diagnostic.expectedOpenParen(),this._peekToken()),h.ErrorNode.create(s,10,h.NameNode.create(s),t);const r=this._parseVarArgsList(14,!0);let o,l;this._consumeTokenIfType(14)||(this._addError(g.Localizer.Diagnostic.expectedCloseParen(),a),this._consumeTokensUntilType([10])),this._consumeTokenIfType(21)&&(o=this._parseTypeAnnotation());const c=this._parseSuite(!0,this._parseOptions.skipFunctionAndClassBody,(()=>{l||(l=this._getTypeAnnotationCommentText())})),p=h.FunctionNode.create(n,h.NameNode.create(s),c,i);return e&&(p.isAsync=!0,(0,h.extendRange)(p,e)),p.parameters=r,r.forEach((e=>{e.parent=p})),t&&(p.decorators=t,t.forEach((e=>{e.parent=p})),t.length>0&&(0,h.extendRange)(p,t[0])),o&&(p.returnTypeAnnotation=o,p.returnTypeAnnotation.parent=p,(0,h.extendRange)(p,o)),l&&this._parseFunctionTypeAnnotationComment(l,p),p}_parseVarArgsList(e,t){const n=new Map,s=[];let i=!1,a=!1,r=!1,o=!1,l=!1,c=!1,p=!1;for(;this._peekTokenType()!==e;){const d=this._parseParameter(t);if(!d){this._consumeTokensUntilType([e]);break}if(d.name){const e=d.name.value;n.has(e)?this._addError(g.Localizer.Diagnostic.duplicateParam().format({name:e}),d.name):n.set(e,e)}else 0===d.category&&0===s.length&&this._addError(g.Localizer.Diagnostic.positionOnlyFirstParam(),d);0===d.category&&(d.name?(r&&(l=!0),d.defaultValue?i=!0:!i||r||c||a||(this._addError(g.Localizer.Diagnostic.nonDefaultAfterDefault(),d),a=!0)):(o?this._addError(g.Localizer.Diagnostic.duplicatePositionOnly(),d):r?this._addError(g.Localizer.Diagnostic.positionOnlyAfterKeywordOnly(),d):c&&this._addError(g.Localizer.Diagnostic.positionOnlyAfterArgs(),d),o=!0)),s.push(d),1===d.category&&(d.name?((r||c)&&this._addError(g.Localizer.Diagnostic.duplicateArgsParam(),d),c=!0):(r?this._addError(g.Localizer.Diagnostic.duplicateKeywordOnly(),d):c&&this._addError(g.Localizer.Diagnostic.keywordOnlyAfterArgs(),d),r=!0)),2===d.category?(p&&this._addError(g.Localizer.Diagnostic.duplicateKwargsParam(),d),p=!0,r&&!l&&this._addError(g.Localizer.Diagnostic.keywordParameterMissing(),d)):p&&this._addError(g.Localizer.Diagnostic.paramAfterKwargsParam(),d);const u=this._consumeTokenIfType(12);if(t&&!d.typeAnnotation){const e=this._parseVariableTypeAnnotationComment();e&&(d.typeAnnotationComment=e,d.typeAnnotationComment.parent=d,(0,h.extendRange)(d,d.typeAnnotationComment))}if(!u)break}if(s.length>0){const e=s[s.length-1];1!==e.category||e.name||this._addError(g.Localizer.Diagnostic.expectedNamedParameter(),e)}return s}_parseParameter(e){let t=0,n=0;const s=this._peekToken();this._consumeTokenIfOperator(26)?t=1:this._consumeTokenIfOperator(29)?t=2:this._consumeTokenIfOperator(10)&&(this._getLanguageVersion()<u.PythonVersion.V3_8&&!this._parseOptions.isStubFile&&this._addError(g.Localizer.Diagnostic.positionOnlyIncompatible(),s),n=1);const i=this._getTokenIfIdentifier();if(!i){if(1===t)return h.ParameterNode.create(s,1);if(1===n)return h.ParameterNode.create(s,0);if(13===this._peekTokenType()){const e=this._getNextToken();this._consumeTokensUntilType([14])&&this._getNextToken(),this._addError(g.Localizer.Diagnostic.sublistParamsIncompatible(),e)}else this._addError(g.Localizer.Diagnostic.expectedParamName(),this._peekToken())}let a=0;1===t?a=1:2===t&&(a=2);const r=h.ParameterNode.create(s,a);return i&&(r.name=h.NameNode.create(i),r.name.parent=r,(0,h.extendRange)(r,i)),e&&this._consumeTokenIfType(10)&&(r.typeAnnotation=this._parseTypeAnnotation(1===a),r.typeAnnotation.parent=r,(0,h.extendRange)(r,r.typeAnnotation)),this._consumeTokenIfOperator(2)&&(r.defaultValue=this._parseTestExpression(!1),r.defaultValue.parent=r,(0,h.extendRange)(r,r.defaultValue),t>0&&this._addError(g.Localizer.Diagnostic.defaultValueNotAllowed(),r.defaultValue)),r}_parseWithStatement(e){const t=this._getKeywordToken(37);let n=[];const s=this._peekToken();let i,a=!1;if(13===s.type){const e=this._tokenIndex;this._suppressErrors((()=>{for(this._getNextToken();n.push(this._parseWithItem()),this._consumeTokenIfType(12)&&14!==this._peekToken().type;);14===this._peekToken().type&&10===this._peekToken(1).type&&(a=1!==n.length||void 0!==n[0].target),this._tokenIndex=e,n=[]}))}for(a&&(this._consumeTokenIfType(13),this._getLanguageVersion()<u.PythonVersion.V3_9&&this._addError(g.Localizer.Diagnostic.parenthesizedContextManagerIllegal(),s));n.push(this._parseWithItem()),this._consumeTokenIfType(12)&&14!==this._peekToken().type;);a&&(this._consumeTokenIfType(14)||this._addError(g.Localizer.Diagnostic.expectedCloseParen(),s));const r=this._parseSuite(this._isInFunction,!1,(()=>{const e=this._getTypeAnnotationCommentText();e&&(i=e)})),o=h.WithNode.create(t,r);return e&&(o.isAsync=!0,o.asyncToken=e,(0,h.extendRange)(o,e)),i&&(o.typeComment=i),o.withItems=n,n.forEach((e=>{e.parent=o})),o}_parseWithItem(){const e=this._parseTestExpression(!0),t=h.WithItemNode.create(e);return this._consumeTokenIfKeyword(1)&&(t.target=this._parseExpression(!1),t.target.parent=t,(0,h.extendRange)(t,t.target)),t}_parseDecorated(){const e=[];for(;22===this._peekOperatorType();)e.push(this._parseDecorator());const t=this._peekToken();if(8===t.type)if(3===t.keywordType){if(this._getNextToken(),10===this._peekKeywordType())return this._parseFunctionDef(t,e);this._addError(g.Localizer.Diagnostic.expectedFunctionAfterAsync(),this._peekToken())}else{if(10===t.keywordType)return this._parseFunctionDef(void 0,e);if(7===t.keywordType)return this._parseClassDef(e)}return this._addError(g.Localizer.Diagnostic.expectedAfterDecorator(),this._peekToken()),h.ClassNode.createDummyForDecorators(e)}_parseDecorator(){const e=this._getNextToken();(0,l.assert)(22===e.operatorType);const t=this._parseTestExpression(!0);if(this._getLanguageVersion()<u.PythonVersion.V3_9){let e=!1;(this._isNameOrMemberAccessExpression(t)||9===t.nodeType&&this._isNameOrMemberAccessExpression(t.leftExpression))&&(e=!0),e||this._addError(g.Localizer.Diagnostic.expectedDecoratorExpr(),t)}const n=h.DecoratorNode.create(e,t);return this._consumeTokenIfType(2)||(this._addError(g.Localizer.Diagnostic.expectedDecoratorNewline(),this._peekToken()),this._consumeTokensUntilType([2])),n}_isNameOrMemberAccessExpression(e){return 38===e.nodeType||35===e.nodeType&&this._isNameOrMemberAccessExpression(e.leftExpression)}_parseClassDef(e){const t=this._getKeywordToken(7);let n,s=this._getTokenIfIdentifier();s||(this._addError(g.Localizer.Diagnostic.expectedClassName(),this._peekToken()),s=v.IdentifierToken.create(0,0,"",void 0)),15===this._peekToken().type&&(n=this._parseTypeParameterList(),!this._parseOptions.isStubFile&&this._getLanguageVersion()<u.PythonVersion.V3_12&&this._addError(g.Localizer.Diagnostic.classTypeParametersIllegal(),n));let i=[];const a=this._peekToken();this._consumeTokenIfType(13)&&(i=this._parseArgList().args,this._consumeTokenIfType(14)||this._addError(g.Localizer.Diagnostic.expectedCloseParen(),a));const r=this._parseSuite(!1,this._parseOptions.skipFunctionAndClassBody),o=h.ClassNode.create(t,h.NameNode.create(s),r,n);return o.arguments=i,i.forEach((e=>{e.parent=o})),e&&(o.decorators=e,e.length>0&&(e.forEach((e=>{e.parent=o})),(0,h.extendRange)(o,e[0]))),o}_parsePassStatement(){return h.PassNode.create(this._getKeywordToken(30))}_parseBreakStatement(){const e=this._getKeywordToken(5);return this._isInLoop||this._addError(g.Localizer.Diagnostic.breakOutsideLoop(),e),h.BreakNode.create(e)}_parseContinueStatement(){const e=this._getKeywordToken(8);return this._isInLoop?this._isInFinally&&this._addError(g.Localizer.Diagnostic.continueInFinally(),e):this._addError(g.Localizer.Diagnostic.continueOutsideLoop(),e),h.ContinueNode.create(e)}_parseReturnStatement(){const e=this._getKeywordToken(32),t=h.ReturnNode.create(e);if(this._isInFunction||this._addError(g.Localizer.Diagnostic.returnOutsideFunction(),e),!this._isNextTokenNeverExpression()){const e=this._parseTestOrStarListAsExpression(!0,!0,2,(()=>g.Localizer.Diagnostic.expectedReturnExpr()));this._reportConditionalErrorForStarTupleElement(e),t.returnExpression=e,t.returnExpression.parent=t,(0,h.extendRange)(t,e)}return t}_parseFromStatement(){const e=this._getKeywordToken(18),t=this._parseDottedModuleName(!0),n=h.ImportFromNode.create(e,t),s=0===t.leadingDots&&1===t.nameParts.length&&"__future__"===t.nameParts[0].value,i=this._peekToken();if(this._consumeTokenIfKeyword(21)){(0,h.extendRange)(n,i);const e=this._peekToken();if(this._consumeTokenIfOperator(26))(0,h.extendRange)(n,e),n.isWildcardImport=!0,n.wildcardToken=e,this._containsWildcardImport=!0;else{const e=this._peekToken(),t=this._consumeTokenIfType(13);let i;for(;;){const e=this._getTokenIfIdentifier();if(!e)break;i=void 0;const t=h.ImportFromAsNode.create(h.NameNode.create(e));if(this._consumeTokenIfKeyword(1)){const e=this._getTokenIfIdentifier();e?(t.alias=h.NameNode.create(e),t.alias.parent=t,(0,h.extendRange)(t,e)):this._addError(g.Localizer.Diagnostic.expectedImportAlias(),this._peekToken())}n.imports.push(t),t.parent=n,(0,h.extendRange)(n,t),s&&this._futureImports.add(e.value);const a=this._peekToken();if(!this._consumeTokenIfType(12))break;i=a}if(0===n.imports.length&&this._addError(g.Localizer.Diagnostic.expectedImportSymbols(),this._peekToken()),t){n.usesParens=!0;const t=this._peekToken();this._consumeTokenIfType(14)?(0,h.extendRange)(n,t):this._addError(g.Localizer.Diagnostic.expectedCloseParen(),e)}else i&&this._addError(g.Localizer.Diagnostic.trailingCommaInFromImport(),i)}}else this._addError(g.Localizer.Diagnostic.expectedImport(),this._peekToken()),t.hasTrailingDot||(n.missingImportKeyword=!0);this._importedModules.push({nameNode:n.module,leadingDots:n.module.leadingDots,nameParts:n.module.nameParts.map((e=>e.value)),importedSymbols:n.imports.map((e=>e.name.value))});let a=!1;if(1===n.module.nameParts.length){const e=n.module.nameParts[0].value;"typing"!==e&&"typing_extensions"!==e||(a=!0)}if(a){const e=["Literal","TypeAlias","Annotated"];n.isWildcardImport?e.forEach((e=>{this._typingSymbolAliases.set(e,e)})):n.imports.forEach((t=>{var n;e.some((e=>e===t.name.value))&&this._typingSymbolAliases.set((null===(n=t.alias)||void 0===n?void 0:n.value)||t.name.value,t.name.value)}))}return n}_parseImportStatement(){var e;const t=this._getKeywordToken(21),n=h.ImportNode.create(t);for(;;){const t=this._parseDottedModuleName(),s=h.ImportAsNode.create(t);if(this._consumeTokenIfKeyword(1)){const e=this._getTokenIfIdentifier();e?(s.alias=h.NameNode.create(e),s.alias.parent=s,(0,h.extendRange)(s,s.alias)):this._addError(g.Localizer.Diagnostic.expectedImportAlias(),this._peekToken())}s.module.leadingDots>0&&this._addError(g.Localizer.Diagnostic.relativeImportNotAllowed(),s.module),n.list.push(s),s.parent=n;const i=s.module.nameParts.map((e=>e.value));if(s.alias||s.module.leadingDots>0||0===s.module.nameParts.length?this._importedModules.push({nameNode:s.module,leadingDots:s.module.leadingDots,nameParts:i,importedSymbols:void 0}):s.module.nameParts.forEach(((e,t)=>{this._importedModules.push({nameNode:s.module,leadingDots:s.module.leadingDots,nameParts:i.slice(0,t+1),importedSymbols:void 0})})),1===t.nameParts.length){const n=t.nameParts[0].value;"typing"!==n&&"typing_extensions"!==n||this._typingImportAliases.push((null===(e=s.alias)||void 0===e?void 0:e.value)||n)}if(!this._consumeTokenIfType(12))break}return n.list.length>0&&(0,h.extendRange)(n,n.list[n.list.length-1]),n}_parseDottedModuleName(e=!1){var t;const n=h.ModuleNameNode.create(this._peekToken());for(;;){const e=null!==(t=this._getTokenIfType(19))&&void 0!==t?t:this._getTokenIfType(20);if(!e)break;19===e.type?n.leadingDots+=3:n.leadingDots++,(0,h.extendRange)(n,e)}for(;;){const t=this._getTokenIfIdentifier();if(!t){(!e||0===n.leadingDots||n.nameParts.length>0)&&(this._addError(g.Localizer.Diagnostic.expectedModuleName(),this._peekToken()),n.hasTrailingDot=!0);break}const s=h.NameNode.create(t);n.nameParts.push(s),s.parent=n,(0,h.extendRange)(n,s);const i=this._peekToken();if(!this._consumeTokenIfType(20))break;(0,h.extendRange)(n,i)}return n}_parseGlobalStatement(){const e=this._getKeywordToken(19),t=h.GlobalNode.create(e);return t.nameList=this._parseNameList(),t.nameList.length>0&&(t.nameList.forEach((e=>{e.parent=t})),(0,h.extendRange)(t,t.nameList[t.nameList.length-1])),t}_parseNonlocalStatement(){const e=this._getKeywordToken(27),t=h.NonlocalNode.create(e);return t.nameList=this._parseNameList(),t.nameList.length>0&&(t.nameList.forEach((e=>{e.parent=t})),(0,h.extendRange)(t,t.nameList[t.nameList.length-1])),t}_parseNameList(){const e=[];for(;;){const t=this._getTokenIfIdentifier();if(!t){this._addError(g.Localizer.Diagnostic.expectedIdentifier(),this._peekToken());break}if(e.push(h.NameNode.create(t)),!this._consumeTokenIfType(12))break}return e}_parseRaiseStatement(){const e=this._getKeywordToken(31),t=h.RaiseNode.create(e);return this._isNextTokenNeverExpression()||(t.typeExpression=this._parseTestExpression(!0),t.typeExpression.parent=t,(0,h.extendRange)(t,t.typeExpression),this._consumeTokenIfKeyword(18)?(t.valueExpression=this._parseTestExpression(!0),t.valueExpression.parent=t,(0,h.extendRange)(t,t.valueExpression)):this._consumeTokenIfType(12)&&(t.valueExpression=this._parseTestExpression(!0),t.valueExpression.parent=t,(0,h.extendRange)(t,t.valueExpression),this._consumeTokenIfType(12)&&(t.tracebackExpression=this._parseTestExpression(!0),t.tracebackExpression.parent=t,(0,h.extendRange)(t,t.tracebackExpression)))),t}_parseAssertStatement(){const e=this._getKeywordToken(2),t=this._parseTestExpression(!1),n=h.AssertNode.create(e,t);if(this._consumeTokenIfType(12)){const e=this._parseTestExpression(!1);n.exceptionExpression=e,n.exceptionExpression.parent=n,(0,h.extendRange)(n,e)}return n}_parseDelStatement(){const e=this._getKeywordToken(11),t=this._parseExpressionList(!0);t.parseError||0!==t.list.length||this._addError(g.Localizer.Diagnostic.expectedDelExpr(),this._peekToken());const n=h.DelNode.create(e);return n.expressions=t.list,n.expressions.length>0&&(n.expressions.forEach((e=>{e.parent=n})),(0,h.extendRange)(n,n.expressions[n.expressions.length-1])),n}_parseYieldExpression(){const e=this._getKeywordToken(38),t=this._peekToken();if(this._consumeTokenIfKeyword(18))return this._getLanguageVersion()<u.PythonVersion.V3_3&&this._addError(g.Localizer.Diagnostic.yieldFromIllegal(),t),h.YieldFromNode.create(e,this._parseTestExpression(!0));let n;return this._isNextTokenNeverExpression()||(n=this._parseTestOrStarListAsExpression(!0,!0,2,(()=>g.Localizer.Diagnostic.expectedYieldExpr())),this._reportConditionalErrorForStarTupleElement(n)),h.YieldNode.create(e,n)}_tryParseYieldExpression(){if(38===this._peekKeywordType())return this._parseYieldExpression()}_parseSimpleStatement(){const e=h.StatementListNode.create(this._peekToken());for(;;){if(0===this._peekTokenType()){const e=this._getNextToken(),t=this._fileContents.substr(e.start,e.length).charCodeAt(0);this._addError(g.Localizer.Diagnostic.invalidTokenChars().format({text:`\\u${t.toString(16)}`}),e),this._consumeTokensUntilType([2]);break}const t=this._parseSmallStatement();if(e.statements.push(t),t.parent=e,(0,h.extendRange)(e,t),0===t.nodeType)break;if(!this._consumeTokenIfType(11))break;const n=this._peekTokenType();if(2===n||1===n)break}return this._consumeTokenIfType(2)||this._addError(g.Localizer.Diagnostic.expectedNewlineOrSemicolon(),this._peekToken()),e}_parseSmallStatement(){switch(this._peekKeywordType()){case 30:return this._parsePassStatement();case 5:return this._parseBreakStatement();case 8:return this._parseContinueStatement();case 32:return this._parseReturnStatement();case 18:return this._parseFromStatement();case 21:return this._parseImportStatement();case 19:return this._parseGlobalStatement();case 27:return this._parseNonlocalStatement();case 31:return this._parseRaiseStatement();case 2:return this._parseAssertStatement();case 11:return this._parseDelStatement();case 38:return this._parseYieldExpression();case 35:{const e=this._peekToken(1),t=this._peekToken(2);let n=!0;if(7!==e.type&&8!==e.type||(15===t.type||9===t.type&&2===t.operatorType)&&(n=!1),!n)return this._parseTypeAliasStatement();break}}return this._parseExpressionStatement()}_makeExpressionOrTuple(e,t){if(1===e.list.length&&!e.trailingComma)return 56===e.list[0].nodeType&&this._addError(g.Localizer.Diagnostic.unpackOperatorNotAllowed(),e.list[0]),e.list[0];const n=e.list.length>0?e.list[0]:this._peekToken(-1),s=h.TupleNode.create(n,t);return s.expressions=e.list,e.list.length>0&&(e.list.forEach((e=>{e.parent=s})),(0,h.extendRange)(s,e.list[e.list.length-1])),s}_parseExpressionListAsPossibleTuple(e,t,n){if(this._isNextTokenNeverExpression())return this._addError(t(),n),h.ErrorNode.create(n,e);const s=this._parseExpressionList(!0);return s.parseError?s.parseError:this._makeExpressionOrTuple(s,!1)}_parseTestListAsExpression(e,t){if(this._isNextTokenNeverExpression())return this._handleExpressionParseError(e,t());const n=this._parseTestExpressionList();return n.parseError?n.parseError:this._makeExpressionOrTuple(n,!1)}_parseTestOrStarListAsExpression(e,t,n,s){if(this._isNextTokenNeverExpression())return this._handleExpressionParseError(n,s());const i=this._parseTestOrStarExpressionList(e,t);return i.parseError?i.parseError:this._makeExpressionOrTuple(i,!1)}_parseExpressionList(e){return this._parseExpressionListGeneric((()=>this._parseExpression(e)))}_parseTestExpressionList(){return this._parseExpressionListGeneric((()=>this._parseTestExpression(!1)))}_parseTestOrStarExpressionList(e,t){const n=this._parseExpressionListGeneric((()=>this._parseTestOrStarExpression(e)));if(!t&&!n.parseError){let e=!1;for(const t of n.list)if(56===t.nodeType){if(e){this._addError(g.Localizer.Diagnostic.duplicateUnpack(),t);break}e=!0}}return n}_parseExpression(e){const t=this._peekToken();return e&&this._consumeTokenIfOperator(26)?h.UnpackNode.create(t,this._parseExpression(!1)):this._parseBitwiseOrExpression()}_parseTestOrStarExpression(e){return 26===this._peekOperatorType()?this._parseExpression(!0):this._parseTestExpression(e)}_parseTestExpression(e){if(24===this._peekKeywordType())return this._parseLambdaExpression();const t=this._parseAssignmentExpression(!e);if(0===t.nodeType)return t;if(!this._consumeTokenIfKeyword(20))return t;const n=this._parseOrTest();if(0===n.nodeType)return n;if(!this._consumeTokenIfKeyword(13))return h.TernaryNode.create(t,n,this._handleExpressionParseError(1,g.Localizer.Diagnostic.expectedElse()));const s=this._parseTestExpression(!0);return h.TernaryNode.create(t,n,s)}_parseAssignmentExpression(e=!1){const t=this._parseOrTest();if(0===t.nodeType)return t;if(38!==t.nodeType)return t;const n=this._peekToken();if(!this._consumeTokenIfOperator(35))return t;(!this._assignmentExpressionsAllowed||this._isParsingTypeAnnotation||e)&&this._addError(g.Localizer.Diagnostic.walrusNotAllowed(),n),this._getLanguageVersion()<u.PythonVersion.V3_8&&this._addError(g.Localizer.Diagnostic.walrusIllegal(),n);const s=this._parseTestExpression(!1);return h.AssignmentExpressionNode.create(t,s)}_parseOrTest(){let e=this._parseAndTest();if(0===e.nodeType)return e;for(;;){const t=this._peekToken();if(!this._consumeTokenIfKeyword(29))break;const n=this._parseAndTest();e=this._createBinaryOperationNode(e,n,t,37)}return e}_parseAndTest(){let e=this._parseNotTest();if(0===e.nodeType)return e;for(;;){const t=this._peekToken();if(!this._consumeTokenIfKeyword(0))break;const n=this._parseNotTest();e=this._createBinaryOperationNode(e,n,t,36)}return e}_parseNotTest(){const e=this._peekToken();if(this._consumeTokenIfKeyword(28)){const t=this._parseNotTest();return this._createUnaryOperationNode(e,t,38)}return this._parseComparison()}_parseComparison(){let e=this._parseBitwiseOrExpression();if(0===e.nodeType)return e;for(;;){let t;const n=this._peekToken();if(T.Tokenizer.isOperatorComparison(this._peekOperatorType()))t=this._peekOperatorType(),19===t&&(this._addError(g.Localizer.Diagnostic.operatorLessOrGreaterDeprecated(),n),t=28),this._getNextToken();else if(this._consumeTokenIfKeyword(22))t=41;else if(this._consumeTokenIfKeyword(23))t=this._consumeTokenIfKeyword(28)?40:39;else if(28===this._peekKeywordType()){const e=this._peekToken(1);8===e.type&&22===e.keywordType&&(this._getNextToken(),this._getNextToken(),t=42)}if(void 0===t)break;const s=this._parseComparison();e=this._createBinaryOperationNode(e,s,n,t)}return e}_parseBitwiseOrExpression(){let e=this._parseBitwiseXorExpression();if(0===e.nodeType)return e;for(;;){const t=this._peekToken();if(!this._consumeTokenIfOperator(6))break;const n=this._parseBitwiseXorExpression();e=this._createBinaryOperationNode(e,n,t,6)}return e}_parseBitwiseXorExpression(){let e=this._parseBitwiseAndExpression();if(0===e.nodeType)return e;for(;;){const t=this._peekToken();if(!this._consumeTokenIfOperator(8))break;const n=this._parseBitwiseAndExpression();e=this._createBinaryOperationNode(e,n,t,8)}return e}_parseBitwiseAndExpression(){let e=this._parseShiftExpression();if(0===e.nodeType)return e;for(;;){const t=this._peekToken();if(!this._consumeTokenIfOperator(3))break;const n=this._parseShiftExpression();e=this._createBinaryOperationNode(e,n,t,3)}return e}_parseShiftExpression(){let e=this._parseArithmeticExpression();if(0===e.nodeType)return e;let t=this._peekToken(),n=this._peekOperatorType();for(;17===n||31===n;){this._getNextToken();const s=this._parseArithmeticExpression();e=this._createBinaryOperationNode(e,s,t,n),t=this._peekToken(),n=this._peekOperatorType()}return e}_parseArithmeticExpression(){let e=this._parseArithmeticTerm();if(0===e.nodeType)return e;let t=this._peekToken(),n=this._peekOperatorType();for(;0===n||33===n;){this._getNextToken();const s=this._parseArithmeticTerm();if(0===s.nodeType)return s;e=this._createBinaryOperationNode(e,s,t,n),t=this._peekToken(),n=this._peekOperatorType()}return e}_parseArithmeticTerm(){let e=this._parseArithmeticFactor();if(0===e.nodeType)return e;let t=this._peekToken(),n=this._peekOperatorType();for(;26===n||22===n||10===n||24===n||13===n;){this._getNextToken();const s=this._parseArithmeticFactor();e=this._createBinaryOperationNode(e,s,t,n),t=this._peekToken(),n=this._peekOperatorType()}return e}_parseArithmeticFactor(){const e=this._peekToken(),t=this._peekOperatorType();if(0===t||33===t||5===t){this._getNextToken();const n=this._parseArithmeticFactor();return this._createUnaryOperationNode(e,n,t)}const n=this._parseAtomExpression();if(0===n.nodeType)return n;const s=this._peekToken();if(this._consumeTokenIfOperator(29)){const e=this._parseArithmeticFactor();return this._createBinaryOperationNode(n,e,s,29)}return n}_isTypingAnnotation(e,t){if(38===e.nodeType){if(this._typingSymbolAliases.get(e.value)===t)return!0}else if(35===e.nodeType&&38===e.leftExpression.nodeType&&e.memberName.value===t){const t=e.leftExpression.value;return this._typingImportAliases.some((e=>e===t))}return!1}_parseAtomExpression(){let e;4!==this._peekKeywordType()||this._isParsingTypeAnnotation||(e=this._getKeywordToken(4),this._getLanguageVersion()<u.PythonVersion.V3_5&&this._addError(g.Localizer.Diagnostic.awaitIllegal(),e));let t=this._parseAtom();if(0===t.nodeType)return t;for(;;){const e=this._peekToken();if(this._consumeTokenIfType(13)){const n=this._isParsingTypeAnnotation;this._isParsingTypeAnnotation=!1;const s=this._parseArgList(),i=h.CallNode.create(t,s.args,s.trailingComma);(s.args.length>1||s.trailingComma)&&s.args.forEach((e=>{32===e.valueExpression.nodeType&&(e.valueExpression.isParenthesized||this._addError(g.Localizer.Diagnostic.generatorNotParenthesized(),e.valueExpression))}));const a=this._peekToken();let r=!1;if(this._consumeTokenIfType(14)?((0,h.extendRange)(i,a),r=!0):(this._addError(g.Localizer.Diagnostic.expectedCloseParen(),e),this._consumeTokensUntilType([2]),(0,h.extendRange)(i,this._peekToken())),this._isParsingTypeAnnotation=n,this._isParsingTypeAnnotation){const e=new c.DiagnosticAddendum;38===t.nodeType&&"type"===t.value&&(e.addMessage(g.Localizer.DiagnosticAddendum.useTypeInstead()),this._addError(g.Localizer.Diagnostic.typeCallNotAllowed()+e.getString(),i))}if(t=i,void 0!==t.maxChildDepth&&t.maxChildDepth>=I&&(t=h.ErrorNode.create(t,14),this._addError(g.Localizer.Diagnostic.maxParseDepthExceeded(),t)),!r)break}else if(this._consumeTokenIfType(15)){const n=this._isParsingIndexTrailer,s=this._isParsingTypeAnnotation;(this._isTypingAnnotation(t,"Literal")||this._isTypingAnnotation(t,"Annotated"))&&(this._isParsingTypeAnnotation=!1),this._isParsingIndexTrailer=!0;const i=this._parseSubscriptList();this._isParsingTypeAnnotation=s,this._isParsingIndexTrailer=n;const a=this._peekToken(),r=h.IndexNode.create(t,i.list,i.trailingComma,a);(0,h.extendRange)(r,r),this._consumeTokenIfType(16)||this._handleExpressionParseError(6,g.Localizer.Diagnostic.expectedCloseBracket(),e,r),t=r,void 0!==t.maxChildDepth&&t.maxChildDepth>=I&&(t=h.ErrorNode.create(t,14),this._addError(g.Localizer.Diagnostic.maxParseDepthExceeded(),t))}else{if(!this._consumeTokenIfType(20))break;{const n=this._getTokenIfIdentifier();if(!n)return this._handleExpressionParseError(7,g.Localizer.Diagnostic.expectedMemberName(),e,t,[8]);t=h.MemberAccessNode.create(t,h.NameNode.create(n)),void 0!==t.maxChildDepth&&t.maxChildDepth>=I&&(t=h.ErrorNode.create(t,14),this._addError(g.Localizer.Diagnostic.maxParseDepthExceeded(),t))}}}return e?h.AwaitNode.create(e,t):t}_parseSubscriptList(){const e=[];let t=!1,n=!1;for(;;){const s=this._peekToken();if(10!==s.type&&this._isNextTokenNeverExpression())break;let i=0;this._consumeTokenIfOperator(26)?i=1:this._consumeTokenIfOperator(29)&&(i=2);const a=this._tokenIndex;let r,o=this._parsePossibleSlice();if(0===i)if(this._consumeTokenIfOperator(2)){const e=o;o=this._parsePossibleSlice(),38===e.nodeType?r=e.token:this._addError(g.Localizer.Diagnostic.expectedParamName(),e)}else 38===o.nodeType&&35===this._peekOperatorType()&&(this._tokenIndex=a,o=this._parseTestExpression(!0),!this._parseOptions.isStubFile&&this._getLanguageVersion()<u.PythonVersion.V3_10&&this._addError(g.Localizer.Diagnostic.assignmentExprInSubscript(),o));const l=h.ArgumentNode.create(s,o,i);if(r&&(l.name=h.NameNode.create(r),l.name.parent=l),l.name?t=!0:t&&0===l.argumentCategory&&this._addError(g.Localizer.Diagnostic.positionArgAfterNamedArg(),l),e.push(l),l.name&&this._addError(g.Localizer.Diagnostic.keywordSubscriptIllegal(),l.name),0!==i){const e=this._parseOptions.isStubFile||this._isParsingQuotedText||this._getLanguageVersion()>=u.PythonVersion.V3_11;2!==i&&e||this._addError(g.Localizer.Diagnostic.unpackedSubscriptIllegal(),l)}if(!this._consumeTokenIfType(12)){n=!1;break}n=!0}if(0===e.length){const t=this._handleExpressionParseError(3,g.Localizer.Diagnostic.expectedSliceIndex(),void 0,void 0,[16]);e.push(h.ArgumentNode.create(this._peekToken(),t,0))}return{list:e,trailingComma:n}}_parsePossibleSlice(){const e=this._peekToken(),t=[void 0,void 0,void 0];let n=0,s=!1;for(;;){const e=this._peekTokenType();if(16===e||12===e)break;if(10!==e){const e=this._parseOptions.isStubFile||this._getLanguageVersion()>=u.PythonVersion.V3_10;t[n]=this._parseTestExpression(e)}if(n++,n>=3||!this._consumeTokenIfType(10))break;s=!0}if(!s)return t[0]?t[0]:h.ErrorNode.create(this._peekToken(),3);const i=h.SliceNode.create(e);i.startValue=t[0],i.startValue&&(i.startValue.parent=i),i.endValue=t[1],i.endValue&&(i.endValue.parent=i),i.stepValue=t[2],i.stepValue&&(i.stepValue.parent=i);const a=t[2]||t[1]||t[0];return a&&(0,h.extendRange)(i,a),i}_parseArgList(){const e=[];let t=!1,n=!1;for(;;){const s=this._peekTokenType();if(14===s||2===s||1===s)break;n=!1;const i=this._parseArgument();if(i.name?t=!0:t&&0===i.argumentCategory&&this._addError(g.Localizer.Diagnostic.positionArgAfterNamedArg(),i),e.push(i),!this._consumeTokenIfType(12))break;n=!0}return{args:e,trailingComma:n}}_parseArgument(){const e=this._peekToken();let t=0;this._consumeTokenIfOperator(26)?t=1:this._consumeTokenIfOperator(29)&&(t=2);let n,s=this._parseTestExpression(!0);if(0===t)if(this._consumeTokenIfOperator(2)){const e=s;s=this._parseTestExpression(!1),38===e.nodeType?n=e.token:this._addError(g.Localizer.Diagnostic.expectedParamName(),e)}else{const e=this._tryParseListComprehension(s);e&&(s=e)}const i=h.ArgumentNode.create(e,s,t);return n&&(i.name=h.NameNode.create(n),i.name.parent=i),i}_parseAtom(){const e=this._peekToken();if(19===e.type)return h.EllipsisNode.create(this._getNextToken());if(6===e.type)return h.NumberNode.create(this._getNextToken());if(7===e.type)return h.NameNode.create(this._getNextToken());if(5===e.type)return this._parseStringList();if(22===e.type){this._getNextToken(),this._addError(g.Localizer.Diagnostic.backticksIllegal(),e);const t=this._parseTestListAsExpression(2,(()=>g.Localizer.Diagnostic.expectedExpr()));return this._consumeTokenIfType(22),t}if(13===e.type){const e=this._parseTupleAtom();if(52===e.nodeType&&this._isParsingTypeAnnotation&&!this._isParsingIndexTrailer){const t=new c.DiagnosticAddendum;t.addMessage(g.Localizer.DiagnosticAddendum.useTupleInstead()),this._addError(g.Localizer.Diagnostic.tupleInAnnotation()+t.getString(),e)}return 7===e.nodeType&&(e.parenthesized=!0),48===e.nodeType&&(e.isParenthesized=!0),32===e.nodeType&&(e.isParenthesized=!0),e}if(15===e.type){const e=this._parseListAtom();if(this._isParsingTypeAnnotation&&!this._isParsingIndexTrailer){const t=new c.DiagnosticAddendum;t.addMessage(g.Localizer.DiagnosticAddendum.useListInstead()),this._addError(g.Localizer.Diagnostic.listInAnnotation()+t.getString(),e)}return e}if(17===e.type){const e=this._parseDictionaryOrSetAtom();if(this._isParsingTypeAnnotation&&!this._isParsingIndexTrailer){const t=new c.DiagnosticAddendum;t.addMessage(g.Localizer.DiagnosticAddendum.useDictInstead()),this._addError(g.Localizer.Diagnostic.dictInAnnotation()+t.getString(),e)}return e}if(8===e.type){const t=e;if(15===t.keywordType||33===t.keywordType||9===t.keywordType||26===t.keywordType)return h.ConstantNode.create(this._getNextToken());const n=this._getTokenIfIdentifier();if(n)return h.NameNode.create(n)}return this._handleExpressionParseError(2,g.Localizer.Diagnostic.expectedExpr())}_handleExpressionParseError(e,t,n,s,i){var a;this._addError(t,null!=n?n:this._peekToken());const r=[2];i&&(0,o.appendArray)(r,i);const l=this._peekToken(),c=r.some((e=>l.type===e))?null!==(a=null!=n?n:s)&&void 0!==a?a:y.TextRange.create(l.start,0):l,p=h.ErrorNode.create(c,e,s);return this._consumeTokensUntilType(r),p}_parseLambdaExpression(e=!0){const t=this._getKeywordToken(24),n=this._parseVarArgsList(10,!1);let s;this._consumeTokenIfType(10)||this._addError(g.Localizer.Diagnostic.expectedColon(),this._peekToken()),s=e?this._parseTestExpression(!1):this._tryParseLambdaExpression(!1)||this._parseOrTest();const i=h.LambdaNode.create(t,s);return i.parameters=n,n.forEach((e=>{e.parent=i})),i}_tryParseLambdaExpression(e=!0){if(24===this._peekKeywordType())return this._parseLambdaExpression(e)}_parseTupleAtom(){var e;const t=this._getNextToken();(0,l.assert)(13===t.type);const n=this._tryParseYieldExpression();if(n)return 14!==this._peekTokenType()?this._handleExpressionParseError(8,g.Localizer.Diagnostic.expectedCloseParen(),t,n):((0,h.extendRange)(n,this._getNextToken()),n);const s=this._parseTestListWithComprehension(),i=this._makeExpressionOrTuple(s,!0);return(0,h.extendRange)(i,t),14!==this._peekTokenType()?this._handleExpressionParseError(8,g.Localizer.Diagnostic.expectedCloseParen(),t,null!==(e=s.parseError)&&void 0!==e?e:i):((0,h.extendRange)(i,this._getNextToken()),i)}_parseListAtom(){var e;const t=this._getNextToken();(0,l.assert)(15===t.type);const n=this._parseTestListWithComprehension(),s=this._peekToken();return this._consumeTokenIfType(16)?i():this._handleExpressionParseError(9,g.Localizer.Diagnostic.expectedCloseBracket(),t,null!==(e=n.parseError)&&void 0!==e?e:i());function i(){const e=h.ListNode.create(t);return s&&(0,h.extendRange)(e,s),n.list.length>0&&(n.list.forEach((t=>{t.parent=e})),(0,h.extendRange)(e,n.list[n.list.length-1])),e.entries=n.list,e}}_parseTestListWithComprehension(){let e=!1;return this._parseExpressionListGeneric((()=>{let t=this._parseTestOrStarExpression(!0);const n=this._tryParseListComprehension(t);return n&&(t=n,e=!0),t}),(()=>this._isNextTokenNeverExpression()),(()=>e))}_parseDictionaryOrSetAtom(){const e=this._getNextToken();(0,l.assert)(17===e.type);const t=[],n=[];let s,i=!1,a=!1,r=!1,o=!0;for(;18!==this._peekTokenType();){let e,c,p;s=void 0;const d=this._peekToken();if(this._consumeTokenIfOperator(29)?e=this._parseExpression(!1):(c=this._parseTestOrStarExpression(!0),this._consumeTokenIfType(10)&&(p=this._parseTestExpression(!1))),c&&p)if(56===c.nodeType&&this._addError(g.Localizer.Diagnostic.unpackInDict(),c),a)this._addError(g.Localizer.Diagnostic.keyValueInSet(),p);else{const e=h.DictionaryKeyEntryNode.create(c,p);let n=e;const s=this._tryParseListComprehension(e);s&&(n=s,r=!0,o||this._addError(g.Localizer.Diagnostic.comprehensionInDict(),n)),t.push(n),i=!0}else if(e)if(a)this._addError(g.Localizer.Diagnostic.unpackInSet(),e);else{const n=h.DictionaryExpandEntryNode.create(e);(0,h.extendRange)(n,d);let s=n;const a=this._tryParseListComprehension(n);a&&(s=a,r=!0,o||this._addError(g.Localizer.Diagnostic.comprehensionInDict(),e)),t.push(s),i=!0}else if((0,l.assert)(void 0!==c),c)if(i){const e=h.ErrorNode.create(this._peekToken(),13),n=h.DictionaryKeyEntryNode.create(c,e);t.push(n),this._addError(g.Localizer.Diagnostic.dictKeyValuePairs(),c)}else{const e=this._tryParseListComprehension(c);e&&(c=e,r=!0,o||this._addError(g.Localizer.Diagnostic.comprehensionInSet(),c)),n.push(c),a=!0}if(r)break;if(12!==this._peekTokenType())break;s=this._getNextToken(),o=!1}let c=this._peekToken();if(this._consumeTokenIfType(18)||(this._addError(g.Localizer.Diagnostic.expectedCloseBrace(),e),c=void 0),a){const t=h.SetNode.create(e);return c&&(0,h.extendRange)(t,c),n.length>0&&(0,h.extendRange)(t,n[n.length-1]),n.forEach((e=>{e.parent=t})),t.entries=n,t}const p=h.DictionaryNode.create(e);return s&&(p.trailingCommaToken=s,(0,h.extendRange)(p,s)),c&&(0,h.extendRange)(p,c),t.length>0&&(t.forEach((e=>{e.parent=p})),(0,h.extendRange)(p,t[t.length-1])),p.entries=t,p}_parseExpressionListGeneric(e,t=(()=>this._isNextTokenNeverExpression()),n=(()=>!1)){let s=!1;const i=[];let a;for(;!t();){const t=e();if(0===t.nodeType){a=t;break}if(i.push(t),n())break;if(!this._consumeTokenIfType(12)){s=!1;break}s=!0}return{trailingComma:s,list:i,parseError:a}}_parseExpressionStatement(){let e,t=this._parseTestOrStarListAsExpression(!1,!1,2,(()=>g.Localizer.Diagnostic.expectedExpr()));if(0===t.nodeType)return t;if(this._consumeTokenIfType(10)){if(e=this._parseTypeAnnotation(),t=h.TypeAnnotationNode.create(t,e),!this._parseOptions.isStubFile&&this._getLanguageVersion()<u.PythonVersion.V3_6&&this._addError(g.Localizer.Diagnostic.varAnnotationIllegal(),e),!this._consumeTokenIfOperator(2))return t;const n=this._isTypingAnnotation(e,"TypeAlias"),s=this._isParsingTypeAnnotation;n&&(this._isParsingTypeAnnotation=!0);const i=this._tryParseYieldExpression()||this._parseTestOrStarListAsExpression(!1,!0,2,(()=>g.Localizer.Diagnostic.expectedAssignRightHandExpr()));return this._isParsingTypeAnnotation=s,h.AssignmentNode.create(t,i)}if(this._consumeTokenIfOperator(2))return this._parseChainAssignments(t);if(T.Tokenizer.isOperatorAssignment(this._peekOperatorType())){const e=this._getNextToken(),n=this._tryParseYieldExpression()||this._parseTestListAsExpression(2,(()=>g.Localizer.Diagnostic.expectedBinaryRightHandExpr())),s=Object.assign({},t);return s.id=(0,h.getNextNodeId)(),h.AugmentedAssignmentNode.create(t,n,e.operatorType,s)}return t}_parseChainAssignments(e){const t=[e];let n;for(;n=this._tryParseYieldExpression()||this._parseTestOrStarListAsExpression(!1,!0,2,(()=>g.Localizer.Diagnostic.expectedAssignRightHandExpr())),0!==n.nodeType&&this._consumeTokenIfOperator(2);)t.push(n);let s=h.AssignmentNode.create(t[0],n);const i=this._parseVariableTypeAnnotationComment();return i&&(t.length>1?s.chainedTypeAnnotationComment=i:(s.typeAnnotationComment=i,s.typeAnnotationComment.parent=s,(0,h.extendRange)(s,s.typeAnnotationComment))),t.forEach(((e,t)=>{t>0&&(s=h.AssignmentNode.create(e,s))})),s}_parseFunctionTypeAnnotation(){const e=this._peekToken();if(!this._consumeTokenIfType(13))return void this._addError(g.Localizer.Diagnostic.expectedOpenParen(),this._peekToken());let t=[];for(;;){const e=this._peekTokenType();if(14===e||2===e||1===e)break;this._consumeTokenIfOperator(26)||this._consumeTokenIfOperator(29);const n=this._parseTypeAnnotation();if(t.push(n),!this._consumeTokenIfType(12))break}if(this._consumeTokenIfType(14)||(this._addError(g.Localizer.Diagnostic.expectedCloseParen(),e),this._consumeTokensUntilType([10])),!this._consumeTokenIfType(21))return void this._addError(g.Localizer.Diagnostic.expectedArrow(),this._peekToken());const n=this._parseTypeAnnotation();let s=!1;return 1===t.length&&18===t[0].nodeType&&(t=[],s=!0),h.FunctionAnnotationNode.create(e,s,t,n)}_parseTypeAnnotation(e=!1){const t=this._isParsingTypeAnnotation;this._isParsingTypeAnnotation=!0;const n=this._peekToken(),s=this._consumeTokenIfOperator(26);s&&(e?!this._parseOptions.isStubFile&&!this._isParsingQuotedText&&this._getLanguageVersion()<u.PythonVersion.V3_11&&this._addError(g.Localizer.Diagnostic.unpackedSubscriptIllegal(),n):this._addError(g.Localizer.Diagnostic.unpackInAnnotation(),n));let i=this._parseTestExpression(!1);return s&&e&&(i=h.UnpackNode.create(n,i)),this._isParsingTypeAnnotation=t,i}_reportStringTokenErrors(e,t){65536&e.flags&&this._addError(g.Localizer.Diagnostic.stringUnterminated(),e),t.nonAsciiInBytes&&this._addError(g.Localizer.Diagnostic.stringNonAsciiBytes(),e),64&e.flags&&(this._getLanguageVersion()<u.PythonVersion.V3_6&&this._addError(g.Localizer.Diagnostic.formatStringIllegal(),e),32&e.flags&&this._addError(g.Localizer.Diagnostic.formatStringBytes(),e),16&e.flags&&this._addError(g.Localizer.Diagnostic.formatStringUnicode(),e))}_makeStringNode(e){const t=f.getUnescapedString(e);return this._reportStringTokenErrors(e,t),h.StringNode.create(e,t.value,t.unescapeErrors.length>0)}_getTypeAnnotationCommentText(){if(0===this._tokenIndex)return;const e=this._tokenizerOutput.tokens.getItemAt(this._tokenIndex-1),t=this._tokenizerOutput.tokens.getItemAt(this._tokenIndex);if(e.start+e.length===t.start)return;const n=this._fileContents.substring(e.start+e.length,t.start).match(/^(\s*#\s*type:\s*)([^\r\n]*)/);if(!n)return;const s=n[2];if(s.trim().match(/^ignore(\s|\[|$)/))return;const i=e.start+e.length+n[1].length;return v.StringToken.create(i,s.length,0,s,0,void 0)}_parseVariableTypeAnnotationComment(){const e=this._getTypeAnnotationCommentText();if(!e)return;const t=this._makeStringNode(e),n=h.StringListNode.create([t]),s=(new b).parseTextExpression(this._fileContents,e.start,e.length,this._parseOptions,1,void 0,this._typingSymbolAliases);return s.diagnostics.forEach((e=>{this._addError(e.message,n)})),s.parseTree?((0,l.assert)(62!==s.parseTree.nodeType),s.parseTree):void 0}_parseFunctionTypeAnnotationComment(e,t){const n=this._makeStringNode(e),s=h.StringListNode.create([n]),i=(new b).parseTextExpression(this._fileContents,e.start,e.length,this._parseOptions,2,void 0,this._typingSymbolAliases);if(i.diagnostics.forEach((e=>{this._addError(e.message,s)})),!i.parseTree||62!==i.parseTree.nodeType)return;const a=i.parseTree;t.functionAnnotationComment=a,a.parent=t,(0,h.extendRange)(t,a)}_parseFormatStringSegment(e,t,n,s){(0,l.assert)(t.isExpression);const i=(new b).parseTextExpression(this._fileContents,e.start+e.prefixLength+e.quoteMarkLength+t.offset+n,s,this._parseOptions,0,1,this._typingSymbolAliases);return i.diagnostics.forEach((t=>{const n=(t.range?(0,d.convertPositionToOffset)(t.range.start,i.lines):e.start)||e.start,s={start:n,length:((t.range?((0,d.convertPositionToOffset)(t.range.end,i.lines)||0)+1:e.start+e.length)||e.start+e.length)-n};this._addError(t.message,s)})),i.parseTree}_parseFormatString(e){const t=f.getUnescapedString(e);this._reportStringTokenErrors(e,t);const n=[];for(const s of t.formatStringSegments)if(s.isExpression){const t=this._getFormatStringExpressionLength(s.value.trimEnd()),i=this._parseFormatStringSegment(e,s,0,t);i&&((0,l.assert)(62!==i.nodeType),n.push(i));const a=s.value.substr(t);let r=0,o=0;for(let i=0;i<a.length;i++)if(123===a.charCodeAt(i))0===r&&(o=i+1),r++;else if(125===a.charCodeAt(i)&&r>0&&(r--,0===r)){const a=this._getFormatStringExpressionLength(s.value.substr(t+o,i-o)),r=this._parseFormatStringSegment(e,s,t+o,a);r&&((0,l.assert)(62!==r.nodeType),n.push(r))}}return h.FormatStringNode.create(e,t.value,t.unescapeErrors.length>0,n)}_getFormatStringExpressionLength(e){let t=0;const n=[];let s,i=0,a=0,r=0;for(;t<e.length;){const o=e[t],l=n.length>0||i>0||a>0||r>0,c=n.length>0;if("="===o)s=t;else{if(":"===o){if(!l)break}else if("!"===o){if(!l&&(t===e.length-1||"="!==e[t+1]))break}else if("'"===o||'"'===o){let s=o;t+2<e.length&&e[t+1]===o&&e[t+2]===o&&(s=o+o+o,t+=2),n.length>0&&n[n.length-1]===s?n.pop():0===n.length&&n.push(s)}else"("===o?c||a++:")"===o?!c&&a>0&&a--:"{"===o?c||i++:"}"===o?!c&&i>0&&i--:"["===o?c||r++:"]"===o&&!c&&r>0&&r--;" "!==o&&(s=void 0)}t++}return this._parseOptions.pythonVersion>=u.PythonVersion.V3_8&&void 0!==s&&(t=s),t}_createBinaryOperationNode(e,t,n,s){return void 0!==e.maxChildDepth&&e.maxChildDepth>=I&&(e=h.ErrorNode.create(e,14),this._addError(g.Localizer.Diagnostic.maxParseDepthExceeded(),e)),void 0!==t.maxChildDepth&&t.maxChildDepth>=I&&(t=h.ErrorNode.create(t,14),this._addError(g.Localizer.Diagnostic.maxParseDepthExceeded(),t)),h.BinaryOperationNode.create(e,t,n,s)}_createUnaryOperationNode(e,t,n){return void 0!==t.maxChildDepth&&t.maxChildDepth>=I&&(t=h.ErrorNode.create(t,14),this._addError(g.Localizer.Diagnostic.maxParseDepthExceeded(),t)),h.UnaryOperationNode.create(e,t,n)}_parseStringList(){const e=[];for(;5===this._peekTokenType();){const t=this._getNextToken();64&t.flags?e.push(this._parseFormatString(t)):e.push(this._makeStringNode(t))}const t=h.StringListNode.create(e);if(this._isParsingTypeAnnotation)if(t.strings.length>1)this._addError(g.Localizer.Diagnostic.annotationSpansStrings(),t);else if(64&t.strings[0].token.flags)this._addError(g.Localizer.Diagnostic.annotationFormatString(),t);else{const e=t.strings[0].token,n=f.getUnescapedString(t.strings[0].token).value,s=e.start,i=e.prefixLength+e.quoteMarkLength;if(n.length!==e.length-i-e.quoteMarkLength)this._addError(g.Localizer.Diagnostic.annotationStringEscape(),t);else{const e=(new b).parseTextExpression(this._fileContents,s+i,n.length,this._parseOptions,1,0!=(4&t.strings[0].token.flags)?1:0,this._typingSymbolAliases);(0===e.diagnostics.length||this._parseOptions.reportErrorsForParsedStringContents)&&(e.diagnostics.forEach((e=>{this._addError(e.message,t)})),e.parseTree&&((0,l.assert)(62!==e.parseTree.nodeType),t.typeAnnotation=e.parseTree,t.typeAnnotation.parent=t))}}return t}_reportConditionalErrorForStarTupleElement(e){if(52===e.nodeType&&!(e.enclosedInParens||this._parseOptions.pythonVersion>=u.PythonVersion.V3_8))for(const t of e.expressions)if(56===t.nodeType)return void this._addError(g.Localizer.Diagnostic.unpackTuplesIllegal(),t)}_isNextTokenNeverExpression(){switch(this._peekToken().type){case 8:switch(this._peekKeywordType()){case 17:case 22:case 20:return!0}break;case 9:switch(this._peekOperatorType()){case 1:case 34:case 27:case 11:case 25:case 4:case 7:case 9:case 18:case 32:case 30:case 14:case 2:return!0}break;case 3:case 4:case 2:case 1:case 11:case 14:case 16:case 18:case 12:case 10:return!0}return!1}_disallowAssignmentExpression(e){const t=this._assignmentExpressionsAllowed;this._assignmentExpressionsAllowed=!1,e(),this._assignmentExpressionsAllowed=t}_getNextToken(){const e=this._tokenizerOutput.tokens.getItemAt(this._tokenIndex);return this._atEof()||this._tokenIndex++,e}_atEof(){return this._tokenIndex>=this._tokenizerOutput.tokens.count-1}_peekToken(e=0){return this._tokenIndex+e<0?this._tokenizerOutput.tokens.getItemAt(0):this._tokenIndex+e>=this._tokenizerOutput.tokens.count?this._tokenizerOutput.tokens.getItemAt(this._tokenizerOutput.tokens.count-1):this._tokenizerOutput.tokens.getItemAt(this._tokenIndex+e)}_peekTokenType(){return this._peekToken().type}_peekKeywordType(){const e=this._peekToken();if(8===e.type)return e.keywordType}_peekOperatorType(){const e=this._peekToken();if(9===e.type)return e.operatorType}_getTokenIfIdentifier(){const e=this._peekToken();if(7===e.type)return this._getNextToken();if(0===e.type)return this._getNextToken(),this._addError(g.Localizer.Diagnostic.invalidIdentifierChar(),e),v.IdentifierToken.create(e.start,e.length,"",e.comments);if(8===e.type){const t=this._peekKeywordType();if(v.softKeywords.find((e=>e===t))){const t=this._fileContents.substr(e.start,e.length);return this._getNextToken(),v.IdentifierToken.create(e.start,e.length,t,e.comments)}}}_consumeTokensUntilType(e){for(;;){const t=this._peekToken();if(e.some((e=>e===t.type)))return!0;if(1===t.type)return!1;this._getNextToken()}}_getTokenIfType(e){if(this._peekTokenType()===e)return this._getNextToken()}_consumeTokenIfType(e){return!!this._getTokenIfType(e)}_consumeTokenIfKeyword(e){return this._peekKeywordType()===e&&(this._getNextToken(),!0)}_consumeTokenIfOperator(e){return this._peekOperatorType()===e&&(this._getNextToken(),!0)}_getKeywordToken(e){const t=this._getNextToken();return(0,l.assert)(8===t.type),(0,l.assert)(t.keywordType===e),t}_getLanguageVersion(){return this._parseOptions.pythonVersion}_suppressErrors(e){const t=this._areErrorsSuppressed;try{this._areErrorsSuppressed=!0,e()}finally{this._areErrorsSuppressed=t}}_addError(e,t){(0,l.assert)(void 0!==t),this._areErrorsSuppressed||this._diagSink.addError(e,(0,d.convertOffsetsToRange)(t.start,t.start+t.length,this._tokenizerOutput.lines))}}t.Parser=b},5136:(e,t)=>{function n(e){return e>=48&&e<=57||e>=97&&e<=122||e>=65&&e<=90}function s(e){return e>=48&&e<=55}function i(e){return e>=48&&e<=57||e>=97&&e<=102||e>=65&&e<=70}function a(e){return e>=48&&e<=57?e-48:e>=97&&e<=102?e-97+10:e>=65&&e<=70?e-65+10:0}Object.defineProperty(t,"__esModule",{value:!0}),t.getUnescapedString=void 0,t.getUnescapedString=function(e){const t=e.escapedValue,r=0!=(8&e.flags),o=0!=(64&e.flags);if(r&&!o)return{value:t,unescapeErrors:[],nonAsciiInBytes:!1,formatStringSegments:[]};const l=[];for(let e=0;e<t.length;e++)l.push(t.charCodeAt(e));const c=0!=(32&e.flags);if(!o&&!l.some((e=>13===e||10===e||92===e)))return{value:t,unescapeErrors:[],nonAsciiInBytes:c&&l.some((e=>e>=128)),formatStringSegments:[]};let p=0,d={offset:0,length:0,valueParts:[],isExpression:!1,hasFormatSpecifier:!1},u=0;const y={valueParts:[],unescapeErrors:[],nonAsciiInBytes:!1,formatStringSegments:[]},m=()=>{r||y.unescapeErrors.push({offset:u-1,length:2,errorType:0})},g=(e=0)=>u+e>=l.length?3:l[u+e],h=e=>{let t=!1,n=0,s="";for(let s=0;s<e;s++){const e=g(1+s);if(!i(e)){t=!0;break}n=16*n+a(e)}return t?(m(),s="\\"+String.fromCharCode(g()),u++):(s=String.fromCharCode(n),u+=1+e),s},f=e=>{const t=String.fromCharCode(e);y.valueParts.push(t),d.valueParts.push(t)};for(;;){let e=g();if(3===e)return o&&(d.isExpression&&y.unescapeErrors.push({offset:d.offset,length:u-d.offset,errorType:3}),u!==d.offset&&(d.length=u-d.offset,y.formatStringSegments.push(d))),v=y,{...v,value:v.valueParts.join(""),formatStringSegments:v.formatStringSegments.map((e=>({...e,value:e.valueParts.join("")})))};if(92===e){if(o&&d.isExpression&&!d.hasFormatSpecifier&&y.unescapeErrors.push({offset:u,length:1,errorType:1}),u++,r){f(e);continue}e=g();let t="";if(13===e||10===e)13===e&&10===g(1)&&(r&&(t+=String.fromCharCode(e)),u++,e=g()),r&&(t="\\"+t+String.fromCharCode(e)),u++;else if(r||o&&d.isExpression)t="\\"+String.fromCharCode(e),u++;else switch(e){case 92:case 39:case 34:t=String.fromCharCode(e),u++;break;case 97:t="",u++;break;case 98:t="\b",u++;break;case 102:t="\f",u++;break;case 110:t="\n",u++;break;case 114:t="\r",u++;break;case 116:t="\t",u++;break;case 118:t="\v",u++;break;case 120:t=h(2);break;case 78:{let s=!1,i=1;if(123!==g(i))s=!0;else for(i++;;){const e=g(i);if(125===e)break;if(!n(e)&&45!==e&&32!==(T=e)&&9!==T){s=!0;break}i++}s?(m(),t="\\"+String.fromCharCode(e),u++):(t="-",u+=1+i);break}case 117:t=h(4);break;case 85:t=h(8);break;default:if(s(e)){let n=e-48;u++,e=g(),s(e)&&(n=8*n+e-48,u++,e=g(),s(e)&&(n=8*n+e-48,u++)),t=String.fromCharCode(n)}else t="\\",m()}y.valueParts.push(t),d.valueParts.push(t)}else if(10===e||13===e)13===e&&10===g(1)&&(f(e),u++,e=g()),f(e),u++;else if(o&&123===e)d.isExpression||123!==g(1)?(0===p?(d.length=u-d.offset,d.length>0&&y.formatStringSegments.push(d),u++,d={offset:u,length:0,valueParts:[],isExpression:!0,hasFormatSpecifier:!1}):(f(e),u++),p++):(f(e),u+=2);else if(o&&125===e)d.isExpression||125!==g(1)?0===p?(y.unescapeErrors.push({offset:u,length:1,errorType:2}),u++):(p--,0===p?(d.length=u-d.offset,y.formatStringSegments.push(d),u++,d={offset:u,length:0,valueParts:[],isExpression:!1,hasFormatSpecifier:!1}):(f(e),u++)):(f(e),u+=2);else if(!d.isExpression||39!==e&&34!==e)d.isExpression&&58===e&&(d.hasFormatSpecifier=!0),c&&e>=128&&(y.nonAsciiInBytes=!0),f(e),u++;else{const t=e;f(e);const n=g(1)===t&&g(2)===t;for(n&&(u+=2,f(e),f(e),y.valueParts.push(String.fromCharCode(e)),y.valueParts.push(String.fromCharCode(e)));;){u++;let e=g();if(3===e)break;if(92!==e){if((10===e||13===e)&&!n)break;if(e===t){if(!n){u++,f(e);break}if(g(1)===t&&g(2)===t){u+=3,f(e),f(e),f(e);break}}f(e)}else o&&d.isExpression&&y.unescapeErrors.push({offset:d.offset,length:u-d.offset,errorType:3}),f(e),u++,e=g(),f(e)}}}var T,v}},7093:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Tokenizer=t.defaultTabSize=void 0;const s=n(8494),i=n(4221),a=n(3420),r=n(6956),o=n(9671),l=n(6180),c=new Map([["and",0],["as",1],["assert",2],["async",3],["await",4],["break",5],["case",6],["class",7],["continue",8],["__debug__",9],["def",10],["del",11],["elif",12],["else",13],["except",14],["finally",16],["for",17],["from",18],["global",19],["if",20],["import",21],["in",22],["is",23],["lambda",24],["match",25],["nonlocal",27],["not",28],["or",29],["pass",30],["raise",31],["return",32],["try",34],["type",35],["while",36],["with",37],["yield",38],["False",15],["None",26],["True",33]]),p={0:3,1:4,2:4,3:2,4:4,5:1,6:2,7:4,8:2,9:4,10:2,11:4,12:10,13:2,14:4,15:10,16:10,17:2,18:4,19:26,20:10,21:10,22:2,23:4,24:2,25:4,26:2,27:4,28:10,29:2,30:4,31:2,32:4,33:2,34:4,36:2,37:2,38:1,39:2,40:2,41:2,42:2};t.defaultTabSize=8,t.Tokenizer=class{constructor(){this._cs=new o.CharacterStream(""),this._tokens=[],this._prevLineStart=0,this._parenDepth=0,this._lineRanges=[],this._indentAmounts=[],this._typeIgnoreLines=new Map,this._pyrightIgnoreLines=new Map,this._crCount=0,this._crLfCount=0,this._lfCount=0,this._indentCount=0,this._indentTabCount=0,this._indentSpacesTotal=0,this._singleQuoteCount=0,this._doubleQuoteCount=0,this._ipythonMode=i.IPythonMode.None}tokenize(e,n,s,r=0,c=i.IPythonMode.None){if(void 0===n)n=0;else if(n<0||n>e.length)throw new Error(`Invalid range start (start=${n}, text.length=${e.length})`);if(void 0===s)s=e.length;else{if(s<0||n+s>e.length)throw new Error(`Invalid range length (start=${n}, length=${s}, text.length=${e.length})`);n+s<e.length&&(e=e.substring(0,n+s))}this._cs=new o.CharacterStream(e),this._cs.position=n,this._tokens=[],this._prevLineStart=0,this._parenDepth=r,this._lineRanges=[],this._indentAmounts=[],this._ipythonMode=c;const p=n+s;for(0===n&&this._readIndentationAfterNewLine();!(this._cs.isEndOfStream()||(this._addNextToken(),this._cs.position>=p)););0!==this._tokens.length&&2===this._tokens[this._tokens.length-1].type||this._tokens.push(l.NewLineToken.create(this._cs.position,0,3,this._getComments())),this._setIndent(this._cs.position,0,0,!1,!1),this._tokens.push(l.Token.create(1,this._cs.position,0,this._getComments())),this._addLineRange();let d="\n";this._crCount>this._crLfCount&&this._crCount>this._lfCount?d="\r":this._crLfCount>this._crCount&&this._crLfCount>this._lfCount&&(d="\r\n");let u="    ";if(this._indentTabCount>this._indentCount/2)u="\t";else if(this._indentCount>0){let e=Math.round(this._indentSpacesTotal/this._indentCount);e<1?e=1:e>t.defaultTabSize&&(e=t.defaultTabSize),u="";for(let t=0;t<e;t++)u+=" "}return{tokens:new a.TextRangeCollection(this._tokens),lines:new a.TextRangeCollection(this._lineRanges),typeIgnoreLines:this._typeIgnoreLines,typeIgnoreAll:this._typeIgnoreAll,pyrightIgnoreLines:this._pyrightIgnoreLines,predominantEndOfLineSequence:d,predominantTabSequence:u,predominantSingleQuoteCharacter:this._singleQuoteCount>=this._doubleQuoteCount?"'":'"'}}static getOperatorInfo(e){return p[e]}static isOperatorAssignment(e){return void 0!==e&&void 0!==p[e]&&0!=(4&p[e])}static isOperatorComparison(e){return void 0!==e&&void 0!==p[e]&&0!=(8&p[e])}_addNextToken(){this._cs.skipWhitespace(),this._cs.isEndOfStream()||this._handleCharacter()||this._cs.moveNext()}_handleCharacter(){const e=this._getStringPrefixLength();if(e>=0){let t="";e>0&&(t=this._cs.getText().substring(this._cs.position,this._cs.position+e),this._cs.advance(e));const n=this._getQuoteTypeFlags(t);if(0!==n)return this._handleString(n,e),!0}if(35===this._cs.currentChar)return this._handleComment(),!0;if(this._ipythonMode){const e=this._getIPythonMagicsKind();if("line"===e)return this._handleIPythonMagics(37===this._cs.currentChar?1:2),!0;if("cell"===e)return this._handleIPythonMagics(37===this._cs.currentChar?3:4),!0}switch(this._cs.currentChar){case 65279:return 0!==this._cs.position&&this._handleInvalid();case 13:{const e=10===this._cs.nextChar?2:1,t=2===e?2:0;return this._handleNewLine(e,t),!0}case 10:return this._handleNewLine(1,1),!0;case 92:return 13===this._cs.nextChar?(10===this._cs.lookAhead(2)?this._cs.advance(3):this._cs.advance(2),this._addLineRange(),!0):10===this._cs.nextChar?(this._cs.advance(2),this._addLineRange(),!0):this._handleInvalid();case 40:this._parenDepth++,this._tokens.push(l.Token.create(13,this._cs.position,1,this._getComments()));break;case 41:this._parenDepth>0&&this._parenDepth--,this._tokens.push(l.Token.create(14,this._cs.position,1,this._getComments()));break;case 91:this._parenDepth++,this._tokens.push(l.Token.create(15,this._cs.position,1,this._getComments()));break;case 93:this._parenDepth>0&&this._parenDepth--,this._tokens.push(l.Token.create(16,this._cs.position,1,this._getComments()));break;case 123:this._parenDepth++,this._tokens.push(l.Token.create(17,this._cs.position,1,this._getComments()));break;case 125:this._parenDepth>0&&this._parenDepth--,this._tokens.push(l.Token.create(18,this._cs.position,1,this._getComments()));break;case 44:this._tokens.push(l.Token.create(12,this._cs.position,1,this._getComments()));break;case 96:this._tokens.push(l.Token.create(22,this._cs.position,1,this._getComments()));break;case 59:this._tokens.push(l.Token.create(11,this._cs.position,1,this._getComments()));break;case 58:if(61===this._cs.nextChar){this._tokens.push(l.OperatorToken.create(this._cs.position,2,35,this._getComments())),this._cs.advance(1);break}this._tokens.push(l.Token.create(10,this._cs.position,1,this._getComments()));break;default:if(this._isPossibleNumber()&&this._tryNumber())return!0;if(46===this._cs.currentChar){if(46===this._cs.nextChar&&46===this._cs.lookAhead(2))return this._tokens.push(l.Token.create(19,this._cs.position,3,this._getComments())),this._cs.advance(3),!0;this._tokens.push(l.Token.create(20,this._cs.position,1,this._getComments()));break}return!(!this._tryIdentifier()&&!this._tryOperator())||this._handleInvalid()}return!1}_addLineRange(){const e=this._cs.position-this._prevLineStart;e>0&&this._lineRanges.push({start:this._prevLineStart,length:e}),this._prevLineStart=this._cs.position}_handleNewLine(e,t){0===this._parenDepth&&3!==t&&(0!==this._tokens.length&&2===this._tokens[this._tokens.length-1].type||this._tokens.push(l.NewLineToken.create(this._cs.position,e,t,this._getComments()))),0===t?this._crCount++:2===t?this._crLfCount++:this._lfCount++,this._cs.advance(e),this._addLineRange(),this._readIndentationAfterNewLine()}_readIndentationAfterNewLine(){let e=0,n=0,s=!1,i=!1;const a=this._cs.position;for(;!this._cs.isEndOfStream();)switch(this._cs.currentChar){case 32:e++,n++,i=!0,this._cs.moveNext();break;case 9:e++,n+=t.defaultTabSize-n%t.defaultTabSize,s=!0,this._cs.moveNext();break;case 12:e=0,n=0,s=!1,i=!1,this._cs.moveNext();break;default:return void this._setIndent(a,e,n,i,s);case 35:case 10:case 13:return}}_setIndent(e,t,n,s,i){if(!(this._parenDepth>0))if(0===this._indentAmounts.length)n>0&&(this._indentCount++,i&&this._indentTabCount++,this._indentSpacesTotal+=n,this._indentAmounts.push({tab1Spaces:t,tab8Spaces:n,isSpacePresent:s,isTabPresent:i}),this._tokens.push(l.IndentToken.create(e,t,n,!1,this._getComments())));else{const a=this._indentAmounts[this._indentAmounts.length-1];if(a.tab8Spaces<n){const r=(a.isSpacePresent&&i||a.isTabPresent&&s)&&a.tab1Spaces>=t;this._indentCount++,i&&this._indentTabCount++,this._indentSpacesTotal+=n-this._indentAmounts[this._indentAmounts.length-1].tab8Spaces,this._indentAmounts.push({tab1Spaces:t,tab8Spaces:n,isSpacePresent:s,isTabPresent:i}),this._tokens.push(l.IndentToken.create(e,t,n,r,this._getComments()))}else if(a.tab8Spaces===n)(a.isSpacePresent&&i||a.isTabPresent&&s)&&this._tokens.push(l.IndentToken.create(e,t,n,!0,this._getComments()));else{let e=a.isSpacePresent&&i||a.isTabPresent&&s;const t=[];for(;this._indentAmounts.length>0&&this._indentAmounts[this._indentAmounts.length-1].tab8Spaces>n;)t.push(this._indentAmounts.length>1?this._indentAmounts[this._indentAmounts.length-2].tab8Spaces:0),this._indentAmounts.pop();t.forEach(((s,i)=>{const a=i<t.length-1||s===n,r=i<t.length-1?s:n;this._tokens.push(l.DedentToken.create(this._cs.position,0,r,a,e,this._getComments())),e=!1}))}}}_tryIdentifier(){const e=()=>{for(;;)if((0,r.isIdentifierChar)(this._cs.currentChar))this._cs.moveNext();else{if(!(0,r.isIdentifierChar)(this._cs.currentChar,this._cs.nextChar))break;this._cs.moveNext(),this._cs.moveNext()}},t=this._cs.position;if((0,r.isIdentifierStartChar)(this._cs.currentChar)?(this._cs.moveNext(),e()):(0,r.isIdentifierStartChar)(this._cs.currentChar,this._cs.nextChar)&&(this._cs.moveNext(),this._cs.moveNext(),e()),this._cs.position>t){const e=this._cs.getText().substring(t,this._cs.position);return c.has(e)?this._tokens.push(l.KeywordToken.create(t,this._cs.position-t,c.get(e),this._getComments())):this._tokens.push(l.IdentifierToken.create(t,this._cs.position-t,e,this._getComments())),!0}return!1}_isPossibleNumber(){return!!(0,r.isDecimal)(this._cs.currentChar)||!(46!==this._cs.currentChar||!(0,r.isDecimal)(this._cs.nextChar))}_tryNumber(){const e=this._cs.position;if(48===this._cs.currentChar){let t=0,n=0;if(120!==this._cs.nextChar&&88!==this._cs.nextChar||!(0,r.isHex)(this._cs.lookAhead(2)))if(98!==this._cs.nextChar&&66!==this._cs.nextChar||!(0,r.isBinary)(this._cs.lookAhead(2))){if((111===this._cs.nextChar||79===this._cs.nextChar)&&(0,r.isOctal)(this._cs.lookAhead(2))){for(this._cs.advance(2),n=2;(0,r.isOctal)(this._cs.currentChar);)this._cs.moveNext();t=8}}else{for(this._cs.advance(2),n=2;(0,r.isBinary)(this._cs.currentChar);)this._cs.moveNext();t=2}else{for(this._cs.advance(2),n=2;(0,r.isHex)(this._cs.currentChar);)this._cs.moveNext();t=16}if(t>0){const s=this._cs.getText().substring(e,this._cs.position),i=s.replace(/_/g,"");let a=parseInt(i.substring(n),t);if(!isNaN(a)){const t=BigInt(i);return(!isFinite(a)||a<Number.MIN_SAFE_INTEGER||a>Number.MAX_SAFE_INTEGER)&&(a=t),this._tokens.push(l.NumberToken.create(e,s.length,a,!0,!1,this._getComments())),!0}}}let t=!1,n=!1;if(this._cs.currentChar>=49&&this._cs.currentChar<=57){for(;(0,r.isDecimal)(this._cs.currentChar);)n=!0,this._cs.moveNext();t=46!==this._cs.currentChar&&101!==this._cs.currentChar&&69!==this._cs.currentChar}if(48===this._cs.currentChar){for(n=!0;48===this._cs.currentChar||95===this._cs.currentChar;)this._cs.moveNext();t=46!==this._cs.currentChar&&101!==this._cs.currentChar&&69!==this._cs.currentChar&&(this._cs.currentChar<49||this._cs.currentChar>57)}if(t){let t=this._cs.getText().substring(e,this._cs.position);const n=t.replace(/_/g,"");let s=parseInt(n,10);if(!isNaN(s)){let i=!1;const a=BigInt(n);return(!isFinite(s)||a<Number.MIN_SAFE_INTEGER||a>Number.MAX_SAFE_INTEGER)&&(s=a),106!==this._cs.currentChar&&74!==this._cs.currentChar||(i=!0,t+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext()),this._tokens.push(l.NumberToken.create(e,t.length,s,!0,i,this._getComments())),!0}}if(this._cs.position=e,(n||46===this._cs.currentChar&&this._cs.nextChar>=48&&this._cs.nextChar<=57)&&this._skipFloatingPointCandidate()){let t=this._cs.getText().substring(e,this._cs.position);const n=parseFloat(t);if(!isNaN(n)){let s=!1;return 106!==this._cs.currentChar&&74!==this._cs.currentChar||(s=!0,t+=String.fromCharCode(this._cs.currentChar),this._cs.moveNext()),this._tokens.push(l.NumberToken.create(e,this._cs.position-e,n,!1,s,this._getComments())),!0}}return this._cs.position=e,!1}_tryOperator(){let e=0;const t=this._cs.nextChar;let n;switch(this._cs.currentChar){case 43:e=61===t?2:1,n=2===e?1:0;break;case 38:e=61===t?2:1,n=2===e?4:3;break;case 124:e=61===t?2:1,n=2===e?7:6;break;case 94:e=61===t?2:1,n=2===e?9:8;break;case 61:e=61===t?2:1,n=2===e?12:2;break;case 33:if(61!==t)return!1;e=2,n=28;break;case 37:e=61===t?2:1,n=2===e?25:24;break;case 126:e=1,n=5;break;case 45:if(62===t)return this._tokens.push(l.Token.create(21,this._cs.position,2,this._getComments())),this._cs.advance(2),!0;e=61===t?2:1,n=2===e?34:33;break;case 42:42===t?(e=61===this._cs.lookAhead(2)?3:2,n=3===e?30:29):(e=61===t?2:1,n=2===e?27:26);break;case 47:47===t?(e=61===this._cs.lookAhead(2)?3:2,n=3===e?14:13):(e=61===t?2:1,n=2===e?11:10);break;case 60:60===t?(e=61===this._cs.lookAhead(2)?3:2,n=3===e?18:17):62===t?(e=2,n=19):(e=61===t?2:1,n=2===e?21:20);break;case 62:62===t?(e=61===this._cs.lookAhead(2)?3:2,n=3===e?32:31):(e=61===t?2:1,n=2===e?16:15);break;case 64:e=61===t?2:1,n=2===e?23:22;break;default:return!1}return this._tokens.push(l.OperatorToken.create(this._cs.position,e,n,this._getComments())),this._cs.advance(e),e>0}_handleInvalid(){const e=this._cs.position;for(;10!==this._cs.currentChar&&13!==this._cs.currentChar&&!this._cs.isAtWhiteSpace()&&!this._cs.isEndOfStream();)(0,r.isSurrogateChar)(this._cs.currentChar)?(this._cs.moveNext(),this._cs.moveNext()):this._cs.moveNext();const t=this._cs.position-e;return t>0&&(this._tokens.push(l.Token.create(0,e,t,this._getComments())),!0)}_getComments(){const e=this._comments;return this._comments=void 0,e}_getIPythonMagicsKind(){if(37!==(e=this._cs.currentChar)&&33!==e)return;var e;const t=this._tokens.length>0?this._tokens[this._tokens.length-1]:void 0;return void 0===t||(0,s.isWhitespace)(t)?this._cs.nextChar===this._cs.currentChar?(this._cs.moveNext(),"cell"):"line":void 0}_handleIPythonMagics(e){const t=this._cs.position+1;let n=t;do{if(this._cs.skipToEol(),1===e||2===e){const e=this._cs.position-n;if(!this._cs.getText().substring(n,n+e).match(/\\\s*$/))break}this._cs.moveNext(),n=this._cs.position+1}while(!this._cs.isEndOfStream());const s=this._cs.position-t,i=this._cs.getText().substring(t,t+s),a=l.Comment.create(t,s,i,e);this._addComments(a)}_handleComment(){var e,t;const n=this._cs.position+1;this._cs.skipToEol();const s=this._cs.position-n,i=this._cs.getText().substring(n,n+s),a=l.Comment.create(n,s,i),r=i.match(/((^|#)\s*)type:\s*ignore(\s*\[([\s*\w-,]*)\]|\s|$)/);if(r){const t=n+(null!==(e=r.index)&&void 0!==e?e:0),s={range:{start:t+r[1].length,length:r[0].length-r[1].length},rulesList:this._getIgnoreCommentRulesList(t,r)};this._tokens.findIndex((e=>2!==e.type&&e&&3!==e.type))<0?this._typeIgnoreAll=s:this._typeIgnoreLines.set(this._lineRanges.length,s)}const o=i.match(/((^|#)\s*)pyright:\s*ignore(\s*\[([\s*\w-,]*)\]|\s|$)/);if(o){const e=n+(null!==(t=o.index)&&void 0!==t?t:0),s={range:{start:e+o[1].length,length:o[0].length-o[1].length},rulesList:this._getIgnoreCommentRulesList(e,o)};this._pyrightIgnoreLines.set(this._lineRanges.length,s)}this._addComments(a)}_getIgnoreCommentRulesList(e,t){if(t.length<5||void 0===t[4])return;const n=t[4].split(","),s=[];let i=e+t[0].indexOf("[")+1;for(const e of n){const t=e.trimStart();i+=e.length-t.length;const n=t.trimEnd();n.length>0&&s.push({range:{start:i,length:n.length},text:n}),i+=t.length+1}return s}_addComments(e){this._comments?this._comments.push(e):this._comments=[e]}_getStringPrefixLength(){if(39===this._cs.currentChar||34===this._cs.currentChar)return 0;if(39===this._cs.nextChar||34===this._cs.nextChar)switch(this._cs.currentChar){case 102:case 70:case 114:case 82:case 98:case 66:case 117:case 85:return 1}if(39===this._cs.lookAhead(2)||34===this._cs.lookAhead(2))switch(this._cs.getText().substring(this._cs.position,this._cs.position+2).toLowerCase()){case"rf":case"fr":case"ur":case"ru":case"br":case"rb":return 2}return-1}_getQuoteTypeFlags(e){let t=0;e=e.toLowerCase();for(let n=0;n<e.length;n++)switch(e[n]){case"u":t|=16;break;case"b":t|=32;break;case"r":t|=8;break;case"f":t|=64}return 39===this._cs.currentChar?(t|=1,39===this._cs.nextChar&&39===this._cs.lookAhead(2)&&(t|=4)):34===this._cs.currentChar&&(t|=2,34===this._cs.nextChar&&34===this._cs.lookAhead(2)&&(t|=4)),t}_handleString(e,t){const n=this._cs.position-t;4&e?this._cs.advance(3):(this._cs.moveNext(),1&e?this._singleQuoteCount++:this._doubleQuoteCount++);const s=this._skipToEndOfStringLiteral(e),i=this._cs.position;this._tokens.push(l.StringToken.create(n,i-n,s.flags,s.escapedValue,t,this._getComments()))}_skipToEndOfStringLiteral(e){const t=1&e?39:34,n=0!=(4&e);let s=[];for(;;){if(this._cs.isEndOfStream())return e|=65536,{escapedValue:String.fromCharCode.apply(void 0,s),flags:e};if(92===this._cs.currentChar)s.push(this._cs.currentChar),this._cs.moveNext(),13===this._cs.getCurrentChar()||10===this._cs.getCurrentChar()?(13===this._cs.getCurrentChar()&&10===this._cs.nextChar&&(s.push(this._cs.currentChar),this._cs.moveNext()),s.push(this._cs.currentChar),this._cs.moveNext(),this._addLineRange()):(s.push(this._cs.currentChar),this._cs.moveNext());else if(10===this._cs.currentChar||13===this._cs.currentChar){if(!n)return e|=65536,{escapedValue:String.fromCharCode.apply(void 0,s),flags:e};13===this._cs.currentChar&&10===this._cs.nextChar&&(s.push(this._cs.currentChar),this._cs.moveNext()),s.push(this._cs.currentChar),this._cs.moveNext(),this._addLineRange()}else{if(!n&&this._cs.currentChar===t){this._cs.moveNext();break}if(n&&this._cs.currentChar===t&&this._cs.nextChar===t&&this._cs.lookAhead(2)===t){this._cs.advance(3);break}s.push(this._cs.currentChar),this._cs.moveNext()}}return s.length>32768&&(s=s.slice(0,32768),e|=131072),{escapedValue:String.fromCharCode.apply(void 0,s),flags:e}}_skipFloatingPointCandidate(){const e=this._cs.position;return this._skipFractionalNumber(),this._cs.position>e&&(101!==this._cs.currentChar&&69!==this._cs.currentChar||(this._cs.moveNext(),this._skipDecimalNumber(!0))),this._cs.position>e}_skipFractionalNumber(){this._skipDecimalNumber(!1),46===this._cs.currentChar&&this._cs.moveNext(),this._skipDecimalNumber(!1)}_skipDecimalNumber(e){for(!e||45!==this._cs.currentChar&&43!==this._cs.currentChar||this._cs.moveNext();(0,r.isDecimal)(this._cs.currentChar);)this._cs.moveNext()}}},6180:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IdentifierToken=t.OperatorToken=t.NumberToken=t.StringToken=t.KeywordToken=t.NewLineToken=t.DedentToken=t.IndentToken=t.Token=t.Comment=t.softKeywords=void 0,t.softKeywords=[9,25,6,35],(t.Comment||(t.Comment={})).create=function(e,t,n,s=0){return{type:s,start:e,length:t,value:n}},(t.Token||(t.Token={})).create=function(e,t,n,s){return{start:t,length:n,type:e,comments:s}},(t.IndentToken||(t.IndentToken={})).create=function(e,t,n,s,i){return{start:e,length:t,type:3,isIndentAmbiguous:s,comments:i,indentAmount:n}},(t.DedentToken||(t.DedentToken={})).create=function(e,t,n,s,i,a){return{start:e,length:t,type:4,comments:a,indentAmount:n,matchesIndent:s,isDedentAmbiguous:i}},(t.NewLineToken||(t.NewLineToken={})).create=function(e,t,n,s){return{start:e,length:t,type:2,comments:s,newLineType:n}},(t.KeywordToken||(t.KeywordToken={})).create=function(e,t,n,s){return{start:e,length:t,type:8,comments:s,keywordType:n}},(t.StringToken||(t.StringToken={})).create=function(e,t,n,s,i,a){return{start:e,length:t,type:5,flags:n,escapedValue:s,prefixLength:i,quoteMarkLength:4&n?3:1,comments:a}},(t.NumberToken||(t.NumberToken={})).create=function(e,t,n,s,i,a){return{start:e,length:t,type:6,isInteger:s,isImaginary:i,value:n,comments:a}},(t.OperatorToken||(t.OperatorToken={})).create=function(e,t,n,s){return{start:e,length:t,type:9,operatorType:n,comments:s}},(t.IdentifierToken||(t.IdentifierToken={})).create=function(e,t,n,s){return{start:e,length:t,type:7,value:n.normalize("NFKC"),comments:s}}},7770:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unicodePc=t.unicodeNdSurrogate=t.unicodeNd=t.unicodeMcSurrogate=t.unicodeMc=t.unicodeMnSurrogate=t.unicodeMn=t.unicodeNlSurrogate=t.unicodeNl=t.unicodeLmSurrogate=t.unicodeLm=t.unicodeLoSurrogate=t.unicodeLo=t.unicodeLt=t.unicodeLlSurrogate=t.unicodeLl=t.unicodeLuSurrogate=t.unicodeLu=void 0,t.unicodeLu=[[65,90],[192,214],[216,222],256,258,260,262,264,266,268,270,272,274,276,278,280,282,284,286,288,290,292,294,296,298,300,302,304,306,308,310,313,315,317,319,321,323,325,327,330,332,334,336,338,340,342,344,346,348,350,352,354,356,358,360,362,364,366,368,370,372,374,[376,377],379,381,[385,386],388,[390,391],[393,395],[398,401],[403,404],[406,408],[412,413],[415,416],418,420,[422,423],425,428,[430,431],[433,435],437,[439,440],444,452,455,458,461,463,465,467,469,471,473,475,478,480,482,484,486,488,490,492,494,497,500,[502,504],506,508,510,512,514,516,518,520,522,524,526,528,530,532,534,536,538,540,542,544,546,548,550,552,554,556,558,560,562,[570,571],[573,574],577,[579,582],584,586,588,590,880,882,886,895,902,[904,906],908,[910,911],[913,929],[931,939],975,[978,980],984,986,988,990,992,994,996,998,1e3,1002,1004,1006,1012,1015,[1017,1018],[1021,1071],1120,1122,1124,1126,1128,1130,1132,1134,1136,1138,1140,1142,1144,1146,1148,1150,1152,1162,1164,1166,1168,1170,1172,1174,1176,1178,1180,1182,1184,1186,1188,1190,1192,1194,1196,1198,1200,1202,1204,1206,1208,1210,1212,1214,[1216,1217],1219,1221,1223,1225,1227,1229,1232,1234,1236,1238,1240,1242,1244,1246,1248,1250,1252,1254,1256,1258,1260,1262,1264,1266,1268,1270,1272,1274,1276,1278,1280,1282,1284,1286,1288,1290,1292,1294,1296,1298,1300,1302,1304,1306,1308,1310,1312,1314,1316,1318,1320,1322,1324,1326,[1329,1366],[4256,4293],4295,4301,[5024,5109],7680,7682,7684,7686,7688,7690,7692,7694,7696,7698,7700,7702,7704,7706,7708,7710,7712,7714,7716,7718,7720,7722,7724,7726,7728,7730,7732,7734,7736,7738,7740,7742,7744,7746,7748,7750,7752,7754,7756,7758,7760,7762,7764,7766,7768,7770,7772,7774,7776,7778,7780,7782,7784,7786,7788,7790,7792,7794,7796,7798,7800,7802,7804,7806,7808,7810,7812,7814,7816,7818,7820,7822,7824,7826,7828,7838,7840,7842,7844,7846,7848,7850,7852,7854,7856,7858,7860,7862,7864,7866,7868,7870,7872,7874,7876,7878,7880,7882,7884,7886,7888,7890,7892,7894,7896,7898,7900,7902,7904,7906,7908,7910,7912,7914,7916,7918,7920,7922,7924,7926,7928,7930,7932,7934,[7944,7951],[7960,7965],[7976,7983],[7992,7999],[8008,8013],8025,8027,8029,8031,[8040,8047],[8120,8123],[8136,8139],[8152,8155],[8168,8172],[8184,8187],8450,8455,[8459,8461],[8464,8466],8469,[8473,8477],8484,8486,8488,[8490,8493],[8496,8499],[8510,8511],8517,8579,[11264,11310],11360,[11362,11364],11367,11369,11371,[11373,11376],11378,11381,[11390,11392],11394,11396,11398,11400,11402,11404,11406,11408,11410,11412,11414,11416,11418,11420,11422,11424,11426,11428,11430,11432,11434,11436,11438,11440,11442,11444,11446,11448,11450,11452,11454,11456,11458,11460,11462,11464,11466,11468,11470,11472,11474,11476,11478,11480,11482,11484,11486,11488,11490,11499,11501,11506,42560,42562,42564,42566,42568,42570,42572,42574,42576,42578,42580,42582,42584,42586,42588,42590,42592,42594,42596,42598,42600,42602,42604,42624,42626,42628,42630,42632,42634,42636,42638,42640,42642,42644,42646,42648,42650,42786,42788,42790,42792,42794,42796,42798,42802,42804,42806,42808,42810,42812,42814,42816,42818,42820,42822,42824,42826,42828,42830,42832,42834,42836,42838,42840,42842,42844,42846,42848,42850,42852,42854,42856,42858,42860,42862,42873,42875,[42877,42878],42880,42882,42884,42886,42891,42893,42896,42898,42902,42904,42906,42908,42910,42912,42914,42916,42918,42920,[42922,42926],[42928,42932],42934,[65313,65338],[66560,66599],[66736,66771],[68736,68786],[71840,71871],[119808,119833],[119860,119885],[119912,119937],119964,[119966,119967],119970,[119973,119974],[119977,119980],[119982,119989],[120016,120041],[120068,120069],[120071,120074],[120077,120084],[120086,120092],[120120,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120172,120197],[120224,120249],[120276,120301],[120328,120353],[120380,120405],[120432,120457],[120488,120512],[120546,120570],[120604,120628],[120662,120686],[120720,120744],120778,[125184,125217]],t.unicodeLuSurrogate={55297:[[56320,56359],[56496,56531]],55299:[[56448,56498]],55302:[[56480,56511]],55323:[[56896,56927]],55349:[[56320,56345],[56372,56397],[56424,56449],56476,[56478,56479],56482,[56485,56486],[56489,56492],[56494,56501],[56528,56553],[56580,56581],[56583,56586],[56589,56596],[56598,56604],[56632,56633],[56635,56638],[56640,56644],56646,[56650,56656],[56684,56709],[56736,56761],[56788,56813],[56840,56865],[56892,56917],[56944,56969],[57e3,57024],[57058,57082],[57116,57140],[57174,57198],[57232,57256],[57290,57290]],55354:[[56576,56609]]},t.unicodeLl=[[97,122],181,[223,246],[248,255],257,259,261,263,265,267,269,271,273,275,277,279,281,283,285,287,289,291,293,295,297,299,301,303,305,307,309,[311,312],314,316,318,320,322,324,326,[328,329],331,333,335,337,339,341,343,345,347,349,351,353,355,357,359,361,363,365,367,369,371,373,375,378,380,[382,384],387,389,392,[396,397],402,405,[409,411],414,417,419,421,424,[426,427],429,432,436,438,[441,442],[445,447],454,457,460,462,464,466,468,470,472,474,[476,477],479,481,483,485,487,489,491,493,[495,496],499,501,505,507,509,511,513,515,517,519,521,523,525,527,529,531,533,535,537,539,541,543,545,547,549,551,553,555,557,559,561,[563,569],572,[575,576],578,583,585,587,589,[591,659],[661,687],881,883,887,[891,893],912,[940,974],[976,977],[981,983],985,987,989,991,993,995,997,999,1001,1003,1005,[1007,1011],1013,1016,[1019,1020],[1072,1119],1121,1123,1125,1127,1129,1131,1133,1135,1137,1139,1141,1143,1145,1147,1149,1151,1153,1163,1165,1167,1169,1171,1173,1175,1177,1179,1181,1183,1185,1187,1189,1191,1193,1195,1197,1199,1201,1203,1205,1207,1209,1211,1213,1215,1218,1220,1222,1224,1226,1228,[1230,1231],1233,1235,1237,1239,1241,1243,1245,1247,1249,1251,1253,1255,1257,1259,1261,1263,1265,1267,1269,1271,1273,1275,1277,1279,1281,1283,1285,1287,1289,1291,1293,1295,1297,1299,1301,1303,1305,1307,1309,1311,1313,1315,1317,1319,1321,1323,1325,1327,[1377,1415],[5112,5117],[7296,7304],[7424,7467],[7531,7543],[7545,7578],7681,7683,7685,7687,7689,7691,7693,7695,7697,7699,7701,7703,7705,7707,7709,7711,7713,7715,7717,7719,7721,7723,7725,7727,7729,7731,7733,7735,7737,7739,7741,7743,7745,7747,7749,7751,7753,7755,7757,7759,7761,7763,7765,7767,7769,7771,7773,7775,7777,7779,7781,7783,7785,7787,7789,7791,7793,7795,7797,7799,7801,7803,7805,7807,7809,7811,7813,7815,7817,7819,7821,7823,7825,7827,[7829,7837],7839,7841,7843,7845,7847,7849,7851,7853,7855,7857,7859,7861,7863,7865,7867,7869,7871,7873,7875,7877,7879,7881,7883,7885,7887,7889,7891,7893,7895,7897,7899,7901,7903,7905,7907,7909,7911,7913,7915,7917,7919,7921,7923,7925,7927,7929,7931,7933,[7935,7943],[7952,7957],[7968,7975],[7984,7991],[8e3,8005],[8016,8023],[8032,8039],[8048,8061],[8064,8071],[8080,8087],[8096,8103],[8112,8116],[8118,8119],8126,[8130,8132],[8134,8135],[8144,8147],[8150,8151],[8160,8167],[8178,8180],[8182,8183],8458,[8462,8463],8467,8495,8500,8505,[8508,8509],[8518,8521],8526,8580,[11312,11358],11361,[11365,11366],11368,11370,11372,11377,[11379,11380],[11382,11387],11393,11395,11397,11399,11401,11403,11405,11407,11409,11411,11413,11415,11417,11419,11421,11423,11425,11427,11429,11431,11433,11435,11437,11439,11441,11443,11445,11447,11449,11451,11453,11455,11457,11459,11461,11463,11465,11467,11469,11471,11473,11475,11477,11479,11481,11483,11485,11487,11489,[11491,11492],11500,11502,11507,[11520,11557],11559,11565,42561,42563,42565,42567,42569,42571,42573,42575,42577,42579,2581,42583,42585,42587,42589,42591,42593,42595,42597,42599,42601,42603,42605,42625,42627,42629,42631,42633,42635,42637,42639,42641,42643,42645,42647,42649,42651,42787,42789,42791,42793,42795,42797,[42799,42801],42803,42805,42807,42809,42811,42813,42815,42817,42819,42821,42823,42825,42827,42829,42831,42833,42835,42837,42839,42841,42843,42845,42847,42849,42851,42853,42855,42857,42859,42861,42863,[42865,42872],42874,42876,42879,42881,42883,42885,42887,42892,42894,42897,[42899,42901],42903,42905,42907,42909,42911,42913,42915,42917,42919,42921,42933,42935,43002,[43824,43866],[43872,43877],[43888,43967],[64256,64262],[64275,64279],[65345,65370],[66600,66639],[66776,66811],[68800,68850],[71872,71903],[119834,119859],[119886,119892],[119894,119911],[119938,119963],[119990,119993],119995,[119997,120003],[120005,120015],[120042,120067],[120094,120119],[120146,120171],[120198,120223],[120250,120275],[120302,120327],[120354,120379],[120406,120431],[120458,120485],[120514,120538],[120540,120545],[120572,120596],[120598,120603],[120630,120654],[120656,120661],[120688,120712],[120714,120719],[120746,120770],[120772,120777],120779,[125218,125251]],t.unicodeLlSurrogate={55297:[[56360,56399],[56536,56571]],55299:[[56512,56562]],55302:[[56512,56543]],55323:[[56928,56959]],55349:[[56346,56371],[56398,56404],[56406,56423],[56450,56475],[56502,56505],56507,[56509,56515],[56517,56527],[56554,56579],[56606,56631],[56658,56683],[56710,56735],[56762,56787],[56814,56839],[56866,56891],[56918,56943],[56970,56997],[57026,57050],[57052,57057],[57084,57108],[57110,57115],[57142,57166],[57168,57173],[57200,57224],[57226,57231],[57258,57282],[57284,57289],[57291,57291]],55354:[[56610,56643]]},t.unicodeLt=[453,456,459,498,[8072,8079],[8088,8095],[8104,8111],8124,8140,8188],t.unicodeLo=[170,186,443,[448,451],660,[1488,1514],[1520,1522],[1568,1599],[1601,1610],[1646,1647],[1649,1747],1749,[1774,1775],[1786,1788],1791,1808,[1810,1839],[1869,1957],1969,[1994,2026],[2048,2069],[2112,2136],[2144,2154],[2208,2228],[2230,2237],[2308,2361],2365,2384,[2392,2401],[2418,2432],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],2493,2510,[2524,2525],[2527,2529],[2544,2545],2556,[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2649,2652],2654,[2674,2676],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],2749,2768,[2784,2785],2809,[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],2877,[2908,2909],[2911,2913],2929,2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3024,[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3160,3162],[3168,3169],3200,[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],3261,3294,[3296,3297],[3313,3314],[3333,3340],[3342,3344],[3346,3386],3389,3406,[3412,3414],[3423,3425],[3450,3455],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3585,3632],[3634,3635],[3648,3653],[3713,3714],3716,[3719,3720],3722,3725,[3732,3735],[3737,3743],[3745,3747],3749,3751,[3754,3755],[3757,3760],[3762,3763],3773,[3776,3780],[3804,3807],3840,[3904,3911],[3913,3948],[3976,3980],[4096,4138],4159,[4176,4181],[4186,4189],4193,[4197,4198],[4206,4208],[4213,4225],4238,[4304,4346],[4349,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4992,5007],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5873,5880],[5888,5900],[5902,5905],[5920,5937],[5952,5969],[5984,5996],[5998,6e3],[6016,6067],6108,[6176,6210],[6212,6263],[6272,6276],[6279,6312],6314,[6320,6389],[6400,6430],[6480,6509],[6512,6516],[6528,6571],[6576,6601],[6656,6678],[6688,6740],[6917,6963],[6981,6987],[7043,7072],[7086,7087],[7098,7141],[7168,7203],[7245,7247],[7258,7287],[7401,7404],[7406,7409],[7413,7414],[8501,8504],[11568,11623],[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],12294,12348,[12353,12438],12447,[12449,12538],12543,[12549,12590],[12593,12686],[12704,12730],[12784,12799],[13312,19893],[19968,40938],[40960,40980],[40982,42124],[42192,42231],[42240,42507],[42512,42527],[42538,42539],42606,[42656,42725],42895,42999,[43003,43009],[43011,43013],[43015,43018],[43020,43042],[43072,43123],[43138,43187],[43250,43255],43259,43261,[43274,43301],[43312,43334],[43360,43388],[43396,43442],[43488,43492],[43495,43503],[43514,43518],[43520,43560],[43584,43586],[43588,43595],[43616,43631],[43633,43638],43642,[43646,43695],43697,[43701,43702],[43705,43709],43712,43714,[43739,43740],[43744,43754],43762,[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43968,44002],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],64285,[64287,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65019],[65136,65140],[65142,65276],[65382,65391],[65393,65437],[65440,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[66176,66204],[66208,66256],[66304,66335],[66349,66368],[66370,66377],[66384,66421],[66432,66461],[66464,66499],[66504,66511],[66640,66717],[66816,66855],[66864,66915],[67072,67382],[67392,67413],[67424,67431],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],68096,[68112,68115],[68117,68119],[68121,68147],[68192,68220],[68224,68252],[68288,68295],[68297,68324],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[69635,69687],[69763,69807],[69840,69864],[69891,69926],[69968,70002],70006,[70019,70066],[70081,70084],70106,70108,[70144,70161],[70163,70187],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70366],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],70461,70480,[70493,70497],[70656,70708],[70727,70730],[70784,70831],[70852,70853],70855,[71040,71086],[71128,71131],[71168,71215],71236,[71296,71338],[71424,71449],71935,72192,[72203,72242],72250,72272,[72284,72323],[72326,72329],[72384,72440],[72704,72712],[72714,72750],72768,[72818,72847],[72960,72966],[72968,72969],[72971,73008],73030,[73728,74649],[74880,75075],[77824,78894],[82944,83526],[92160,92728],[92736,92766],[92880,92909],[92928,92975],[93027,93047],[93053,93071],[93952,94020],94032,[94208,100332],[100352,101106],[110592,110878],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],[124928,125124],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[131072,173782],[173824,177972],[177984,178205],[178208,183969],[183984,191456],[194560,195101]],t.unicodeLoSurrogate={55296:[[56320,56331],[56333,56358],[56360,56378],[56380,56381],[56383,56397],[56400,56413],[56448,56570],[56960,56988],[56992,57040],[57088,57119],[57133,57152],[57154,57161],[57168,57205],[57216,57245],[57248,57283],[57288,57295]],55297:[[56400,56477],[56576,56615],[56624,56675],[56832,57142],[57152,57173],[57184,57191]],55298:[[56320,56325],[56328,56328],[56330,56373],[56375,56376],[56380,56380],[56383,56405],[56416,56438],[56448,56478],[56544,56562],[56564,56565],[56576,56597],[56608,56633],[56704,56759],[56766,56767],[56832,56832],[56848,56851],[56853,56855],[56857,56885],[56928,56956],[56960,56988],[57024,57031],[57033,57060],[57088,57141],[57152,57173],[57184,57202],[57216,57233]],55299:[[56320,56392],[56576,56611],[56960,57001],[57008,57009],[57088,57116],57127,[57136,57157],[57264,57284],[57312,57334]],55300:[[56323,56375],[56451,56495],[56528,56552],[56579,56614],56644,56647,[56656,56690],56694,[56707,56754],[56769,56772],56794,56796,[56832,56849],[56851,56875],[56960,56966],56968,[56970,56973],[56975,56989],[56991,57e3],[57008,57054],[57093,57100],[57103,57104],[57107,57128],[57130,57136],[57138,57139],[57141,57145],57149,57168,[57181,57185]],55301:[[56320,56372],[56391,56394],[56415,56417],[56448,56495],[56516,56517],56519,[56704,56750],[56792,56795],[56832,56879],56900,[56960,57002],57016,[57088,57114]],55302:[[56320,56363],[56575,56582],56585,[56588,56595],[56597,56598],[56600,56623],56639,56641,[56736,56743],[56746,56784],56801,56803,56832,[56843,56882],56890,56912,[56924,56969],56989,[57024,57080]],55303:[[56320,56328],[56330,56366],56384,56434,[56576,56582],[56584,56585],[56587,56624],56646,[56672,56677],[56679,56680],[56682,56713],56728,[57056,57074],57264],55304:[[56320,57241]],55305:[[56448,56643]],55308:[[56320,57343]],55309:[[56320,56366]],55313:[[56320,56902]],55322:[[56320,56888],[56896,56926],[57040,57069],[57088,57135],[57187,57207],[57213,57231]],55323:[[57088,57162],57168],55324:[56320],55329:[57335],55330:[[56320,57343]],55331:[[56320,56533],[56576,56576],[56584,56584]],55340:[[56320,56606],[56656,56658],[56676,56679],[56688,57083]],55343:[[56320,56426],[56432,56444],[56448,56456],[56464,56473]],55352:[[56576,56620],56654,[57024,57067]],55354:[[56320,56516]],55355:[[56832,56835],[56837,56863],[56865,56866],56868,56871,[56873,56882],[56884,56887],56889,56891,56898,56903,56905,56907,[56909,56911],[56913,56914],56916,56919,56921,56923,56925,56927,[56929,56930],56932,[56935,56938],[56940,56946],[56948,56951],[56953,56956],56958,[56960,56969],[56971,56987],[56993,56995],[56997,57001],[57003,57019]],55360:[56320],55401:[57053,57088],55405:[57140,57152],55406:[56349,56352],55411:[56993,57008],55418:[57312],55422:[[56320,56861]],55424:[56320],55428:[57162]},t.unicodeLm=[[688,705],[710,721],[736,740],748,750,884,890,1369,1600,[1765,1766],[2036,2037],2042,2074,2084,2088,2417,3654,3782,4348,6103,6211,6823,[7288,7293],[7468,7530],7544,[7579,7615],8305,8319,[8336,8348],[11388,11389],11631,11823,12293,[12337,12341],12347,[12445,12446],[12540,12542],40981,[42232,42237],42508,42623,[42652,42653],[42775,42783],42864,42888,[43e3,43001],43471,43494,43632,43741,[43763,43764],[43868,43871],65392,[65438,65439],[92992,92995],[94099,94111],[94176,94177]],t.unicodeLmSurrogate={55322:[[57152,57155]],55323:[[57235,57247],[57312,57313],57315],55352:[[56631,56637]],55354:[56651]},t.unicodeNl=[[5870,5872],[8544,8578],[8581,8584],12295,[12321,12329],[12344,12346],[42726,42735],[65856,65908],66369,66378,[66513,66517],[74752,74862]],t.unicodeNlSurrogate={55296:[[56640,56692],57153,57162,[57297,57301]],55305:[[56320,56430]]},t.unicodeMn=[[768,879],[1155,1159],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1552,1562],[1611,1631],1648,[1750,1756],[1759,1764],[1767,1768],[1770,1773],1809,[1840,1866],[1958,1968],[2027,2035],[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2260,2273],[2275,2306],2362,2364,[2369,2376],2381,[2385,2391],[2402,2403],2433,2492,[2497,2500],2509,[2530,2531],[2561,2562],2620,[2625,2626],[2631,2632],[2635,2637],2641,[2672,2673],2677,[2689,2690],2748,[2753,2757],[2759,2760],2765,[2786,2787],[2810,2815],2817,2876,2879,[2881,2884],2893,2902,[2914,2915],2946,3008,3021,3072,[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3170,3171],3201,3260,3263,3270,[3276,3277],[3298,3299],[3328,3329],[3387,3388],[3393,3396],3405,[3426,3427],3530,[3538,3540],3542,3633,[3636,3642],[3655,3662],3761,[3764,3769],[3771,3772],[3784,3789],[3864,3865],3893,3895,3897,[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],4038,[4141,4144],[4146,4151],[4153,4154],[4157,4158],[4184,4185],[4190,4192],[4209,4212],4226,[4229,4230],4237,4253,[4957,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],6086,[6089,6099],6109,[6155,6157],[6277,6278],6313,[6432,6434],[6439,6440],6450,[6457,6459],[6679,6680],6683,6742,[6744,6750],6752,6754,[6757,6764],[6771,6780],6783,[6832,6845],[6912,6915],6964,[6966,6970],6972,6978,[7019,7027],[7040,7041],[7074,7077],[7080,7081],[7083,7085],7142,[7144,7145],7149,[7151,7153],[7212,7219],[7222,7223],[7376,7378],[7380,7392],[7394,7400],7405,7412,[7416,7417],[7616,7673],[7675,7679],[8400,8412],8417,[8421,8432],[11503,11505],11647,[11744,11775],[12330,12333],[12441,12442],42607,[42612,42621],[42654,42655],[42736,42737],43010,43014,43019,[43045,43046],[43204,43205],[43232,43249],[43302,43309],[43335,43345],[43392,43394],43443,[43446,43449],43452,43493,[43561,43566],[43569,43570],[43573,43574],43587,43596,43644,43696,[43698,43700],[43703,43704],[43710,43711],43713,[43756,43757],43766,44005,44008,44013,64286,[65024,65039],[65056,65071],66045,66272,[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],68159,[68325,68326],69633,[69688,69702],[69759,69761],[69811,69814],[69817,69818],[69888,69890],[69927,69931],[69933,69940],70003,[70016,70017],[70070,70078],[70090,70092],[70191,70193],70196,[70198,70199],70206,70367,[70371,70378],[70400,70401],70460,70464,[70502,70508],[70512,70516],[70712,70719],[70722,70724],70726,[70835,70840],70842,[70847,70848],[70850,70851],[71090,71093],[71100,71101],[71103,71104],[71132,71133],[71219,71226],71229,[71231,71232],71339,71341,[71344,71349],71351,[71453,71455],[71458,71461],[71463,71467],[72193,72198],[72201,72202],[72243,72248],[72251,72254],72263,[72273,72278],[72281,72283],[72330,72342],[72344,72345],[72752,72758],[72760,72765],72767,[72850,72871],[72874,72880],[72882,72883],[72885,72886],[73009,73014],73018,[73020,73021],[73023,73029],73031,[92912,92916],[92976,92982],[94095,94098],[113821,113822],[119143,119145],[119163,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[125136,125142],[125252,125258],[917760,917999]],t.unicodeMnSurrogate={55296:[56829,57056,[57206,57210]],55298:[[56833,56835],[56837,56838],[56844,56847],[56888,56890],56895,[57061,57062]],55299:[[56612,56615],[57003,57004],[57158,57168]],55300:[56321,[56376,56390],[56447,56449],[56499,56502],[56505,56506],[56576,56578],[56615,56619],[56621,56628],56691,[56704,56705],[56758,56766],[56777,56780],56783,[56879,56881],56884,[56886,56887],56894,57055,[57059,57066],[57088,57089],[57147,57148],57152,[57190,57196],[57200,57204]],55301:[[56376,56383],[56386,56388],56390,56414,[56499,56504],56506,[56511,56512],[56514,56515],[56754,56757],[56764,56765],[56767,56768],[56796,56797],[56883,56890],56893,[56895,56896],57003,57005,[57008,57013],57015,[57117,57119],[57122,57125],[57127,57131]],55302:[[56367,56375],[56377,56378],[56635,56636],56638,56643,[56788,56791],[56794,56795],56800,[56833,56842],[56883,56888],[56891,56894],56903,[56913,56918],[56921,56923],[56970,56982],[56984,56985]],55303:[[56368,56374],[56376,56381],56383,[56466,56487],[56490,56496],[56498,56499],[56501,56502],[56625,56630],56634,[56636,56637],[56639,56645],56647,[56720,56721],56725,56727,[57075,57076]],55322:[[57072,57076],[57136,57142]],55323:[57167,[57231,57234],57316],55343:[[56477,56478]],55348:[[56679,56681],[56699,56706],[56709,56715],[56746,56749],[56898,56900]],55350:[[56832,56886],[56891,56940],56949,56964,[56987,56991],[56993,57007]],55352:[[56320,56326],[56328,56344],[56347,56353],[56355,56356],[56358,56362],[56624,56630],[57068,57071]],55354:[[56528,56534],[56644,56650]],56128:[[56576,56815]]},t.unicodeMc=[2307,2363,[2366,2368],[2377,2380],[2382,2383],[2434,2435],[2494,2496],[2503,2504],[2507,2508],2519,2563,[2622,2624],2691,[2750,2752],2761,[2763,2764],[2818,2819],2878,2880,[2887,2888],[2891,2892],2903,[3006,3007],[3009,3010],[3014,3016],[3018,3020],3031,[3073,3075],[3137,3140],[3202,3203],3262,[3264,3268],[3271,3272],[3274,3275],[3285,3286],[3330,3331],[3390,3392],[3398,3400],[3402,3404],3415,[3458,3459],[3535,3537],[3544,3551],[3570,3571],[3902,3903],3967,[4139,4140],4145,4152,[4155,4156],[4182,4183],[4194,4196],[4199,4205],[4227,4228],[4231,4236],4239,[4250,4252],6070,[6078,6085],[6087,6088],[6435,6438],[6441,6443],[6448,6449],[6451,6456],[6681,6682],6741,6743,6753,[6755,6756],[6765,6770],6916,6965,6971,[6973,6977],[6979,6980],7042,7073,[7078,7079],7082,7143,[7146,7148],7150,[7154,7155],[7204,7211],[7220,7221],7393,[7410,7411],7415,[12334,12335],[43043,43044],43047,[43136,43137],[43188,43203],[43346,43347],43395,[43444,43445],[43450,43451],[43453,43456],[43567,43568],[43571,43572],43597,43643,43645,43755,[43758,43759],43765,[44003,44004],[44006,44007],[44009,44010],44012,69632,69634,69762,[69808,69810],[69815,69816],69932,70018,[70067,70069],[70079,70080],[70188,70190],[70194,70195],70197,[70368,70370],[70402,70403],[70462,70463],[70465,70468],[70471,70472],[70475,70477],70487,[70498,70499],[70709,70711],[70720,70721],70725,[70832,70834],70841,[70843,70846],70849,[71087,71089],[71096,71099],71102,[71216,71218],[71227,71228],71230,71340,[71342,71343],71350,[71456,71457],71462,[72199,72200],72249,[72279,72280],72343,72751,72766,72873,72881,72884,[94033,94078],[119141,119142],[119149,119154]],t.unicodeMcSurrogate={55300:[56320,56322,56450,[56496,56498],[56503,56504],56620,[56645,56646],56706,[56755,56757],[56767,56768],56782,[56876,56878],[56882,56883],56885,[57056,57058],[57090,57091],[57150,57151],[57153,57156],[57159,57160],[57163,57165],57175,[57186,57187]],55301:[[56373,56375],[56384,56385],56389,[56496,56498],56505,[56507,56510],56513,[56751,56753],[56760,56763],56766,[56880,56882],[56891,56892],56894,57004,[57006,57007],57014,[57120,57121],57126],55302:[[56364,56366],56376,[56624,56629],[56631,56632],56637,56640,56642,[56785,56787],[56796,56799],56804,56889,[56919,56920],56983],55303:[56367,56382,56489,56497,56500,[56714,56718],[56723,56724],56726,[57077,57078]],55323:[[57169,57223],[57328,57329]],55348:[[56677,56678],[56685,56690]]},t.unicodeNd=[[48,57],[1632,1641],[1776,1785],[1984,1993],[2406,2415],[2534,2543],[2662,2671],[2790,2799],[2918,2927],[3046,3055],[3174,3183],[3302,3311],[3430,3439],[3558,3567],[3664,3673],[3792,3801],[3872,3881],[4160,4169],[4240,4249],[6112,6121],[6160,6169],[6470,6479],[6608,6617],[6784,6793],[6800,6809],[6992,7001],[7088,7097],[7232,7241],[7248,7257],[42528,42537],[43216,43225],[43264,43273],[43472,43481],[43504,43513],[43600,43609],[44016,44025],[65296,65305],[66720,66729],[69734,69743],[69872,69881],[69942,69951],[70096,70105],[70384,70393],[70736,70745],[70864,70873],[71248,71257],[71360,71369],[71472,71481],[71904,71913],[72784,72793],[73040,73049],[92768,92777],[93008,93017],[120782,120831],[125264,125273]],t.unicodeNdSurrogate={55297:[[56480,56489]],55299:[[56624,56633]],55300:[[56422,56431],[56560,56569],[56630,56639],[56784,56793],[57072,57081]],55301:[[56400,56409],[56528,56537],[56912,56921],[57024,57033],[57136,57145]],55302:[[56544,56553],56656],55303:[[56400,56409],[56656,56665],[56736,56745]],55322:[[56928,56937],[57168,57177]],55349:[[57294,57343]],55352:[[56640,56649],[57072,57081]],55354:[[56656,56665]],55358:[[57328,57337]]},t.unicodePc=[95,[8255,8256],8276,[65075,65076],[65101,65103],65343]},1447:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PyrightFileSystem=t.SupportUriToPathMapping=t.SupportPartialStubs=void 0;const s=n(1277),i=n(3188),a=n(6657),r=n(9459);(t.SupportPartialStubs||(t.SupportPartialStubs={})).is=function(e){return e.isPartialStubPackagesScanned&&e.isPathScanned&&e.processPartialStubPackages&&e.clearPartialStubs},(t.SupportUriToPathMapping||(t.SupportUriToPathMapping={})).is=function(e){return e.hasUriMapEntry&&e.addUriMap&&e.removeUriMap&&e.pendingRequest};class o extends r.ReadOnlyAugmentedFileSystem{constructor(e){super(e),this._rootSearched=new Set,this._partialStubPackagePaths=new Set,this._customUriMap=new Map}mkdirSync(e,t){this._realFS.mkdirSync(e,t)}chdir(e){this._realFS.chdir(e)}writeFileSync(e,t,n){this._realFS.writeFileSync(this._getOriginalPath(e),t,n)}unlinkSync(e){this._realFS.unlinkSync(this._getOriginalPath(e))}createWriteStream(e){return this._realFS.createWriteStream(this._getOriginalPath(e))}copyFileSync(e,t){this._realFS.copyFileSync(this._getOriginalPath(e),this._getOriginalPath(t))}getUri(e){const t=this._customUriMap.get(this.getMappedFilePath(e));return t?t.uri:this._realFS.getUri(e)}hasUriMapEntry(e,t){const n=this._customUriMap.get(t);return!(!n||n.uri!==e)}addUriMap(e,t){const n=this._customUriMap.get(t);return n?n.uri===e&&(n.closed=!1,!0):(this._customUriMap.set(t,{uri:e,closed:!1,hasPendingRequest:!1}),!0)}removeUriMap(e,t){const n=this._customUriMap.get(t);return!(!n||n.uri!==e||(n.hasPendingRequest?(n.closed=!0,0):(this._customUriMap.delete(t),0)))}pendingRequest(e,t){const n=this._customUriMap.get(e);n&&(t||!n.closed?n.hasPendingRequest=t:this._customUriMap.delete(e))}isPartialStubPackagesScanned(e){var t;return this.isPathScanned(null!==(t=e.root)&&void 0!==t?t:"")}isPathScanned(e){return this._rootSearched.has(e)}processPartialStubPackages(e,t,n){var r;for(const o of e){if(this._rootSearched.add(o),!this._realFS.existsSync(o)||!(0,a.isDirectory)(this._realFS,o))continue;let e=[];try{e=this._realFS.readdirEntriesSync(o)}catch{}const l=o===n;for(const n of e){const e=(0,a.combinePaths)(o,n.name);if(!(n.isSymbolicLink()?null===(r=(0,a.tryStat)(this._realFS,e))||void 0===r?void 0:r.isDirectory():n.isDirectory())||!n.name.endsWith(i.stubsSuffix))continue;const c=(0,s.getPyTypedInfo)(this._realFS,e);if(!c||!c.isPartiallyTyped)continue;let p;this._partialStubPackagePaths.add(e);const d=n.name.substr(0,n.name.length-i.stubsSuffix.length);for(const n of t){const t=(0,a.combinePaths)(n,d);try{const n=(0,a.tryStat)(this._realFS,t);if(!(null==n?void 0:n.isDirectory()))continue;if(l){const e=(0,s.getPyTypedInfo)(this._realFS,t);if(e&&!e.isPartiallyTyped)continue}p=null!=p?p:this._getRelativePathPartialStubs(e);for(const n of p){const s=(0,a.combinePaths)(e,n),i=(0,a.combinePaths)(t,n);this._recordMovedEntry(i,s)}}catch{}}}}}dispose(){this._realFS.dispose()}clearPartialStubs(){super._clear(),this._rootSearched.clear(),this._partialStubPackagePaths.clear()}_getRelativePathPartialStubs(e){const t=[],n=(0,a.ensureTrailingDirectorySeparator)(e).length,s=e=>{for(const i of this._realFS.readdirEntriesSync(e)){const r=(0,a.combinePaths)(e,i.name);let o=i.isDirectory(),l=i.isFile();if(i.isSymbolicLink()){const e=(0,a.tryStat)(this._realFS,r);e&&(o=e.isDirectory(),l=e.isFile())}if(o&&s(r),l&&i.name.endsWith(".pyi")){const e=r.substring(n);e&&t.push(e)}}};return s(e),t}_isMovedEntry(e){return this._partialStubPackagePaths.has(e)||super._isMovedEntry(e)}}t.PyrightFileSystem=o},9459:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ReadOnlyAugmentedFileSystem=void 0;const s=n(9489),i=n(7830),a=n(6657);t.ReadOnlyAugmentedFileSystem=class{constructor(e){this._realFS=e,this._entryMap=new Map,this._reverseEntryMap=new Map,this._folderMap=new Map}existsSync(e){return!this._isMovedEntry(e)&&this._realFS.existsSync(this._getOriginalPath(e))}mkdirSync(e,t){throw new Error("Operation is not allowed.")}chdir(e){throw new Error("Operation is not allowed.")}readdirEntriesSync(e){const t=(0,a.ensureTrailingDirectorySeparator)(e),n=[],s=this._folderMap.get(t);return s&&!this._realFS.existsSync(e)||n.push(...this._realFS.readdirEntriesSync(e).filter((t=>!this._isMovedEntry((0,a.combinePaths)(e,t.name))&&!(null==s?void 0:s.some((e=>e.name===t.name)))))),s?n.concat(s.map((e=>new i.VirtualDirent(e.name,e.isFile)))):n}readdirSync(e){return this.readdirEntriesSync(e).map((e=>e.name))}readFileSync(e,t){return this._realFS.readFileSync(this._getOriginalPath(e),t)}writeFileSync(e,t,n){throw new Error("Operation is not allowed.")}statSync(e){return this._realFS.statSync(this._getOriginalPath(e))}unlinkSync(e){throw new Error("Operation is not allowed.")}realpathSync(e){return this._entryMap.has(e)?e:this._realFS.realpathSync(e)}getModulePath(){return this._realFS.getModulePath()}createFileSystemWatcher(e,t){return this._realFS.createFileSystemWatcher(e,t)}createReadStream(e){return this._realFS.createReadStream(this._getOriginalPath(e))}createWriteStream(e){throw new Error("Operation is not allowed.")}copyFileSync(e,t){throw new Error("Operation is not allowed.")}readFile(e){return this._realFS.readFile(this._getOriginalPath(e))}readFileText(e,t){return this._realFS.readFileText(this._getOriginalPath(e),t)}tmpdir(){return this._realFS.tmpdir()}tmpfile(e){return this._realFS.tmpfile(e)}realCasePath(e){return this._realFS.realCasePath(e)}getUri(e){return this._realFS.getUri(e)}isMappedFilePath(e){return this._entryMap.has(e)||this._realFS.isMappedFilePath(e)}getOriginalFilePath(e){return this._realFS.getOriginalFilePath(this._getOriginalPath(e))}getMappedFilePath(e){var t;const n=this._realFS.getMappedFilePath(e);return null!==(t=this._reverseEntryMap.get(n))&&void 0!==t?t:n}isInZipOrEgg(e){return this._realFS.isInZipOrEgg(e)}dispose(){this._realFS.dispose()}_recordMovedEntry(e,t,n=!0,i=!0){this._entryMap.set(e,t),n&&this._reverseEntryMap.set(t,e);const r=(0,a.ensureTrailingDirectorySeparator)((0,a.getDirectoryPath)(e)),o=(0,s.getOrAdd)(this._folderMap,r,(()=>[])),l=(0,a.getFileName)(e);o.some((e=>e.name===l))||o.push({name:l,isFile:i})}_getOriginalPath(e){var t;return null!==(t=this._entryMap.get(e))&&void 0!==t?t:e}_isMovedEntry(e){return this._reverseEntryMap.has(e)}_clear(){this._entryMap.clear(),this._reverseEntryMap.clear(),this._folderMap.clear()}}},1783:e=>{e.exports={}},603:e=>{e.exports=JSON.parse('{"Diagnostic":{"annotatedParamCountMismatch":"Parameter annotation count mismatch: expected {expected} but received {received}","annotatedTypeArgMissing":"Expected one type argument and one or more annotations for \\"Annotated\\"","annotationFormatString":"Type annotations cannot use format string literals (f-strings)","annotationNotSupported":"Type annotation not supported for this statement","annotationSpansStrings":"Type annotations cannot span multiple string literals","annotationStringEscape":"Type annotations cannot contain escape characters","argAssignment":"Argument of type \\"{argType}\\" cannot be assigned to parameter of type \\"{paramType}\\"","argAssignmentFunction":"Argument of type \\"{argType}\\" cannot be assigned to parameter of type \\"{paramType}\\" in function \\"{functionName}\\"","argAssignmentParam":"Argument of type \\"{argType}\\" cannot be assigned to parameter \\"{paramName}\\" of type \\"{paramType}\\"","argAssignmentParamFunction":"Argument of type \\"{argType}\\" cannot be assigned to parameter \\"{paramName}\\" of type \\"{paramType}\\" in function \\"{functionName}\\"","argMissingForParam":"Argument missing for parameter {name}","argMissingForParams":"Arguments missing for parameters {names}","argMorePositionalExpectedCount":"Expected {expected} more positional arguments","argMorePositionalExpectedOne":"Expected 1 more positional argument","argPositional":"Expected positional argument","argPositionalExpectedCount":"Expected {expected} positional arguments","argPositionalExpectedOne":"Expected 1 positional argument","argTypePartiallyUnknown":"Argument type is partially unknown","argTypeUnknown":"Argument type is unknown","assertAlwaysTrue":"Assert expression always evaluates to true","assertTypeArgs":"\\"assert_type\\" expects two positional arguments","assertTypeTypeMismatch":"\\"assert_type\\" mismatch: expected \\"{expected}\\" but received \\"{received}\\"","assignmentExprContext":"Assignment expression must be within module, function or lambda","assignmentExprComprehension":"Assignment expression target \\"{name}\\" cannot use same name as comprehension for target","assignmentInProtocol":"Instance or class variables within a Protocol class must be explicitly declared within the class body","assignmentExprInSubscript":"Assignment expressions within a subscript are supported only in Python 3.10 and newer","assignmentTargetExpr":"Expression cannot be assignment target","asyncNotInAsyncFunction":"Use of \\"async\\" not allowed outside of async function","awaitIllegal":"Use of \\"await\\" requires Python 3.5 or newer","awaitNotInAsync":"\\"await\\" allowed only within async function","backticksIllegal":"Expressions surrounded by backticks are not supported in Python 3.x; use repr instead","baseClassCircular":"Class cannot derive from itself","baseClassFinal":"Base class \\"{type}\\" is marked final and cannot be subclassed","baseClassInvalid":"Argument to class must be a base class","baseClassMethodTypeIncompatible":"Base classes for class \\"{classType}\\" define method \\"{name}\\" in incompatible way","baseClassVariableTypeIncompatible":"Base classes for class \\"{classType}\\" define variable \\"{name}\\" in incompatible way","baseClassUnknown":"Base class type is unknown, obscuring type of derived class","bindTypeMismatch":"Could not bind method \\"{methodName}\\" because \\"{type}\\" is not assignable to parameter \\"{paramName}\\"","breakOutsideLoop":"\\"break\\" can be used only within a loop","callableExtraArgs":"Expected only two type arguments to \\"Callable\\"","callableFirstArg":"Expected parameter type list or \\"...\\"","callableNotInstantiable":"Cannot instantiate type \\"{type}\\"","callableSecondArg":"Expected return type as second type argument for \\"Callable\\"","casePatternIsIrrefutable":"Irrefutable pattern is allowed only for the last case statement","classAlreadySpecialized":"Type \\"{type}\\" is already specialized","classDecoratorTypeUnknown":"Untyped class decorator obscures type of class; ignoring decorator","classDefinitionCycle":"Class definition for \\"{name}\\" depends on itself","classGetItemClsParam":"__class_getitem__ override should take a \\"cls\\" parameter","classMethodClsParam":"Class methods should take a \\"cls\\" parameter","classNotRuntimeSubscriptable":"Subscript for class \\"{name}\\" will generate runtime exception; enclose type annotation in quotes","classPatternBuiltInArgCount":"Class pattern accepts at most 1 positional sub-pattern","classPatternBuiltInArgPositional":"Class pattern accepts only positional sub-pattern","classPatternTypeAlias":"\\"{type}\\" cannot be used in a class pattern because it is a specialized type alias","classTypeParametersIllegal":"Class type parameter syntax requires Python 3.12 or newer","classVarNotAllowed":"\\"ClassVar\\" is not allowed in this context","classVarFirstArgMissing":"Expected a type argument after \\"ClassVar\\"","classVarOverridesInstanceVar":"Class variable \\"{name}\\" overrides instance variable of same name in class \\"{className}\\"","classVarTooManyArgs":"Expected only one type argument after \\"ClassVar\\"","classVarWithTypeVar":"\\"ClassVar\\" type cannot include type variables","clsSelfParamTypeMismatch":"Type of parameter \\"{name}\\" must be a supertype of its class \\"{classType}\\"","codeTooComplexToAnalyze":"Code is too complex to analyze; reduce complexity by refactoring into subroutines or reducing conditional code paths","collectionAliasInstantiation":"Type \\"{type}\\" cannot be instantiated, use \\"{alias}\\" instead","comparisonAlwaysFalse":"Condition will always evaluate to False since the types \\"{leftType}\\" and \\"{rightType}\\" have no overlap","comparisonAlwaysTrue":"Condition will always evaluate to True since the types \\"{leftType}\\" and \\"{rightType}\\" have no overlap","comprehensionInDict":"Comprehension cannot be used with other dictionary entries","comprehensionInSet":"Comprehension cannot be used with other set entries","concatenateParamSpecMissing":"Last type argument for \\"Concatenate\\" must be a ParamSpec","concatenateTypeArgsMissing":"\\"Concatenate\\" requires at least two type arguments","constantRedefinition":"\\"{name}\\" is constant (because it is uppercase) and cannot be redefined","constructorParametersMismatch":"Mismatch between signature of __new__ and __init__ in class \\"{classType}\\"","containmentAlwaysFalse":"Expression will always evaluate to False since the types \\"{leftType}\\" and \\"{rightType}\\" have no overlap","containmentAlwaysTrue":"Expression will always evaluate to True since the types \\"{leftType}\\" and \\"{rightType}\\" have no overlap","continueInFinally":"\\"continue\\" cannot be used within a finally clause","continueOutsideLoop":"\\"continue\\" can be used only within a loop","constructorNoArgs":"Expected no arguments to \\"{type}\\" constructor","dataClassBaseClassFrozen":"A non-frozen class cannot inherit from a class that is frozen","dataClassBaseClassNotFrozen":"A frozen class cannot inherit from a class that is not frozen","dataClassFieldWithDefault":"Fields without default values cannot appear after fields with default values","dataClassFieldWithoutAnnotation":"Dataclass field without type annotation will cause runtime exception","dataClassFieldWithPrivateName":"Dataclass field cannot use private name","dataClassPostInitParamCount":"Dataclass __post_init__ incorrect parameter count; number of InitVar fields is {expected}","dataClassPostInitType":"Dataclass __post_init__ method parameter type mismatch for field \\"{fieldName}\\"","dataClassSlotsOverwrite":"__slots__ is already defined in class","dataClassTransformExpectedBoolLiteral":"Expected expression that statically evaluates to True or False","dataClassTransformFieldSpecifier":"Expected tuple of classes or functions but received type \\"{type}\\"","dataClassTransformPositionalParam":"All arguments to \\"dataclass_transform\\" must be keyword arguments","dataClassTransformUnknownArgument":"Argument \\"{name}\\" is not supported by dataclass_transform","declaredReturnTypePartiallyUnknown":"Declared return type, \\"{returnType}\\", is partially unknown","declaredReturnTypeUnknown":"Declared return type is unknown","defaultValueContainsCall":"Function calls and mutable objects not allowed within parameter default value expression","defaultValueNotAllowed":"Parameter with \\"*\\" or \\"**\\" cannot have default value","deprecatedClass":"The class \\"{name}\\" is deprecated","deprecatedConstructor":"The constructor for class \\"{name}\\" is deprecated","deprecatedFunction":"This function \\"{name}\\" is deprecated","deprecatedType":"This type is deprecated as of Python {version}; use \\"{replacement}\\" instead","delTargetExpr":"Expression cannot be deleted","dictExpandIllegalInComprehension":"Dictionary expansion not allowed in comprehension","dictInAnnotation":"Dictionary expression not allowed in type annotation","dictKeyValuePairs":"Dictionary entries must contain key/value pairs","dictUnpackIsNotMapping":"Expected mapping for dictionary unpack operator","dunderAllSymbolNotPresent":"\\"{name}\\" is specified in __all__ but is not present in module","duplicateArgsParam":"Only one \\"*\\" parameter allowed","duplicateBaseClass":"Duplicate base class not allowed","duplicateCatchAll":"Only one catch-all except clause allowed","duplicateEnumMember":"Enum member \\"{name}\\" is already declared","duplicateGenericAndProtocolBase":"Only one Generic[...] or Protocol[...] base class allowed","duplicateImport":"\\"{importName}\\" is imported more than once","duplicateKwargsParam":"Only one \\"**\\" parameter allowed","duplicateKeywordOnly":"Only one \\"*\\" separator allowed","duplicateParam":"Duplicate parameter \\"{name}\\"","duplicateCapturePatternTarget":"Capture target \\"{name}\\" cannot appear more than once within the same pattern","duplicateStarPattern":"Only one \\"*\\" pattern allowed in a pattern sequence","duplicateStarStarPattern":"Only one \\"**\\" entry allowed","duplicatePositionOnly":"Only one \\"/\\" parameter allowed","duplicateUnpack":"Only one unpack operation allowed in list","ellipsisContext":"\\"...\\" not allowed in this context","ellipsisSecondArg":"\\"...\\" allowed only as the second of two arguments","enumClassOverride":"Enum class \\"{name}\\" is final and cannot be subclassed","exceptionGroupIncompatible":"Exception group syntax (\\"except*\\") requires Python 3.11 or newer","exceptionTypeIncorrect":"\\"{type}\\" does not derive from BaseException","exceptionTypeNotClass":"\\"{type}\\" is not a valid exception class","exceptionTypeNotInstantiable":"Constructor for exception type \\"{type}\\" requires one or more arguments","expectedAfterDecorator":"Expected function or class declaration after decorator","expectedArrow":"Expected \\"->\\" followed by return type annotation","expectedAsAfterException":"Expected \\"as\\" after exception type","expectedAssignRightHandExpr":"Expected expression to the right of \\"=\\"","expectedBinaryRightHandExpr":"Expected expression to the right of operator","expectedBoolLiteral":"Expected True or False","expectedCase":"Expected \\"case\\" statement","expectedClassName":"Expected class name","expectedCloseBrace":"\\"{\\" was not closed","expectedCloseBracket":"\\"[\\" was not closed","expectedCloseParen":"\\"(\\" was not closed","expectedColon":"Expected \\":\\"","expectedComplexNumberLiteral":"Expected complex number literal for pattern matching","expectedDecoratorExpr":"Expression form not supported for decorator prior to Python 3.9","expectedDecoratorName":"Expected decorator name","expectedDecoratorNewline":"Expected new line at end of decorator","expectedDelExpr":"Expected expression after \\"del\\"","expectedElse":"Expected \\"else\\"","expectedEquals":"Expected \\"=\\"","expectedExceptionClass":"Invalid exception class or object","expectedExceptionObj":"Expected exception object, exception class or None","expectedExpr":"Expected expression","expectedIdentifier":"Expected identifier","expectedImport":"Expected \\"import\\"","expectedImportAlias":"Expected symbol after \\"as\\"","expectedImportSymbols":"Expected one or more symbol names after import","expectedIndentedBlock":"Expected indented block","expectedInExpr":"Expected expression after \\"in\\"","expectedIn":"Expected \\"in\\"","expectedFunctionAfterAsync":"Expected function definition after \\"async\\"","expectedFunctionName":"Expected function name after \\"def\\"","expectedMemberName":"Expected member name after \\".\\"","expectedModuleName":"Expected module name","expectedNameAfterAs":"Expected symbol name after \\"as\\"","expectedNamedParameter":"Keyword parameter must follow \\"*\\"","expectedNewline":"Expected newline","expectedNewlineOrSemicolon":"Statements must be separated by newlines or semicolons","expectedOpenParen":"Expected \\"(\\"","expectedParamName":"Expected parameter name","expectedPatternExpr":"Expected pattern expression","expectedPatternSubjectExpr":"Expected pattern subject expression","expectedPatternValue":"Expected pattern value expression of the form \\"a.b\\"","expectedReturnExpr":"Expected expression after \\"return\\"","expectedSliceIndex":"Expected index or slice expression","expectedTypeNotString":"Expected type but received a string literal","expectedTypeParameterName":"Expected type parameter name","expectedYieldExpr":"Expected expression in yield statement","finalClassIsAbstract":"Class \\"{type}\\" is marked final and must implement all abstract methods","finalContext":"\\"Final\\" not allowed in this context","finalMethodOverride":"Method \\"{name}\\" cannot override final method defined in class \\"{className}\\"","finalReassigned":"\\"{name}\\" is declared as Final and cannot be reassigned","finalRedeclaration":"\\"{name}\\" was previously declared as Final","finalRedeclarationBySubclass":"\\"{name}\\" cannot be redeclared because parent class \\"{className}\\" declares it as Final","finalTooManyArgs":"Expected a single type argument after \\"Final\\"","finalUnassigned":"\\"{name}\\" is declared Final, but value is not assigned","formatStringBrace":"Single close brace not allowed within f-string literal; use double close brace","formatStringBytes":"Format string literals (f-strings) cannot be binary","formatStringEscape":"Escape sequence (backslash) not allowed in expression portion of f-string","formatStringInPattern":"Format string not allowed in pattern","formatStringUnicode":"Format string literals (f-strings) cannot be unicode","formatStringIllegal":"Format string literals (f-strings) require Python 3.6 or newer","formatStringUnterminated":"Unterminated expression in f-string; missing close brace","functionDecoratorTypeUnknown":"Untyped function decorator obscures type of function; ignoring decorator","functionInConditionalExpression":"Conditional expression references function which always evaluates to True","functionTypeParametersIllegal":"Function type parameter syntax requires Python 3.12 or newer","futureImportLocationNotAllowed":"Imports from __future__ must be at the beginning of the file","generatorAsyncReturnType":"Return type of async generator function must be \\"AsyncGenerator\\" or \\"AsyncIterable\\"","generatorNotParenthesized":"Generator expressions must be parenthesized if not sole argument","generatorSyncReturnType":"Return type of generator function must be \\"Generator\\" or \\"Iterable\\"","genericBaseClassNotAllowed":"\\"Generic\\" base class cannot be used with type parameter syntax","genericClassAssigned":"Generic class type cannot be assigned","genericClassDeleted":"Generic class type cannot be deleted","genericNotAllowed":"\\"Generic\\" is not valid in this context","genericTypeAliasBoundTypeVar":"Generic type alias within class cannot use bound type variables {names}","genericTypeArgMissing":"\\"Generic\\" requires at least one type argument","genericTypeArgTypeVar":"Type argument for \\"Generic\\" must be a type variable","genericTypeArgUnique":"Type arguments for \\"Generic\\" must be unique","globalReassignment":"\\"{name}\\" is assigned before global declaration","globalRedefinition":"\\"{name}\\" was already declared global","implicitStringConcat":"Implicit string concatenation not allowed","importCycleDetected":"Cycle detected in import chain","importDepthExceeded":"Import chain depth exceeded {depth}","importResolveFailure":"Import \\"{importName}\\" could not be resolved","importSourceResolveFailure":"Import \\"{importName}\\" could not be resolved from source","importSymbolUnknown":"\\"{name}\\" is unknown import symbol","incompatibleMethodOverride":"Method \\"{name}\\" overrides class \\"{className}\\" in an incompatible manner","inconsistentIndent":"Unindent amount does not match previous indent","initMustReturnNone":"Return type of \\"__init__\\" must be None","inconsistentTabs":"Inconsistent use of tabs and spaces in indentation","initSubclassClsParam":"__init_subclass__ override should take a \\"cls\\" parameter","instanceMethodSelfParam":"Instance methods should take a \\"self\\" parameter","instanceVarOverridesClassVar":"Instance variable \\"{name}\\" overrides class variable of same name in class \\"{className}\\"","instantiateAbstract":"Cannot instantiate abstract class \\"{type}\\"","instantiateProtocol":"Cannot instantiate protocol class \\"{type}\\"","internalBindError":"An internal error occurred while binding file \\"{file}\\": {message}","internalParseError":"An internal error occurred while parsing file \\"{file}\\": {message}","internalTypeCheckingError":"An internal error occurred while type checking file \\"{file}\\": {message}","invalidIdentifierChar":"Invalid character in identifier","invalidStubStatement":"Statement is meaningless within a type stub file","invalidTokenChars":"Invalid character \\"{text}\\" in token","isInstanceInvalidType":"Second argument to \\"isinstance\\" must be a class or tuple of classes","isSubclassInvalidType":"Second argument to \\"issubclass\\" must be a class or tuple of classes","keyValueInSet":"Key/value pairs are not allowed within a set","keywordArgInTypeArgument":"Keyword arguments cannot be used in type argument lists","keywordOnlyAfterArgs":"Keyword-only argument separator not allowed after \\"*\\" parameter","keywordParameterMissing":"One or more keyword parameters must follow \\"*\\" parameter","keywordSubscriptIllegal":"Keyword arguments within subscripts are not supported","lambdaReturnTypeUnknown":"Return type of lambda is unknown","lambdaReturnTypePartiallyUnknown":"Return type of lambda, \\"{returnType}\\", is partially unknown","listAssignmentMismatch":"Expression with type \\"{type}\\" cannot be assigned to target list","listInAnnotation":"List expression not allowed in type annotation","literalUnsupportedType":"Type arguments for \\"Literal\\" must be None, a literal value (int, bool, str, or bytes), or an enum value","literalEmptyArgs":"Expected one or more type arguments after \\"Literal\\"","literalNotCallable":"Literal type cannot be instantiated","matchIncompatible":"Match statements require Python 3.10 or newer","matchIsNotExhaustive":"Cases within match statement do not exhaustively handle all values","maxParseDepthExceeded":"Maximum parse depth exceeded; break expression into smaller sub-expressions","memberAccess":"Cannot access member \\"{name}\\" for type \\"{type}\\"","memberDelete":"Cannot delete member \\"{name}\\" for type \\"{type}\\"","memberSet":"Cannot assign member \\"{name}\\" for type \\"{type}\\"","metaclassConflict":"The metaclass of a derived class must be a subclass of the metaclasses of all its base classes","metaclassDuplicate":"Only one metaclass can be provided","metaclassIsGeneric":"Metaclass cannot be generic","methodNotDefined":"\\"{name}\\" method not defined","methodNotDefinedOnType":"\\"{name}\\" method not defined on type \\"{type}\\"","methodOrdering":"Cannot create consistent method ordering","methodOverridden":"\\"{name}\\" overrides method of same name in class \\"{className}\\" with incompatible type \\"{type}\\"","methodReturnsNonObject":"\\"{name}\\" method does not return an object","missingProtocolMembers":"Class derives from one or more protocol classes but does not implement all required members","missingSuperCall":"Method \\"{methodName}\\" does not call the method of the same name in parent class","moduleAsType":"Module cannot be used as a type","moduleNotCallable":"Module is not callable","moduleUnknownMember":"\\"{memberName}\\" is not a known member of module \\"{moduleName}\\"","namedExceptAfterCatchAll":"A named except clause cannot appear after catch-all except clause","namedParamAfterParamSpecArgs":"Keyword parameter \\"{name}\\" cannot appear in signature after ParamSpec args parameter","namedTupleEmptyName":"Names within a named tuple cannot be empty","namedTupleMultipleInheritance":"Multiple inheritance with NamedTuple is not supported","namedTupleFirstArg":"Expected named tuple class name as first argument","namedTupleNameType":"Expected two-entry tuple specifying entry name and type","namedTupleNameUnique":"Names within a named tuple must be unique","namedTupleNoTypes":"\\"namedtuple\\" provides no types for tuple entries; use \\"NamedTuple\\" instead","namedTupleSecondArg":"Expected named tuple entry list as second argument","newClsParam":"__new__ override should take a \\"cls\\" parameter","newTypeBadName":"The first argument to NewType must be a string literal","newTypeLiteral":"NewType cannot be used with Literal type","newTypeNotAClass":"Expected class as second argument to NewType","newTypeParamCount":"NewType requires two positional arguments","newTypeProtocolClass":"NewType cannot be used with protocol class","nonDefaultAfterDefault":"Non-default argument follows default argument","noneNotCallable":"Object of type \\"None\\" cannot be called","noneNotIterable":"Object of type \\"None\\" cannot be used as iterable value","noneOperator":"Operator \\"{operator}\\" not supported for \\"None\\"","noneNotSubscriptable":"Object of type \\"None\\" is not subscriptable","noneNotUsableWith":"Object of type \\"None\\" cannot be used with \\"with\\"","noneUnknownMember":"\\"{name}\\" is not a known member of \\"None\\"","nonLocalNoBinding":"No binding for nonlocal \\"{name}\\" found","nonLocalReassignment":"\\"{name}\\" is assigned before nonlocal declaration","nonLocalRedefinition":"\\"{name}\\" was already declared nonlocal","nonLocalInModule":"Nonlocal declaration not allowed at module level","noOverload":"No overloads for \\"{name}\\" match the provided arguments","noReturnContainsReturn":"Function with declared return type \\"NoReturn\\" cannot include a return statement","noReturnContainsYield":"Function with declared return type \\"NoReturn\\" cannot include a yield statement","noReturnReturnsNone":"Function with declared type of \\"NoReturn\\" cannot return \\"None\\"","notRequiredArgCount":"Expected a single type argument after \\"NotRequired\\"","notRequiredNotInTypedDict":"\\"NotRequired\\" is not allowed in this context","objectNotCallable":"Object of type \\"{type}\\" is not callable","obscuredClassDeclaration":"Class declaration \\"{name}\\" is obscured by a declaration of the same name","obscuredFunctionDeclaration":"Function declaration \\"{name}\\" is obscured by a declaration of the same name","obscuredMethodDeclaration":"Method declaration \\"{name}\\" is obscured by a declaration of the same name","obscuredParameterDeclaration":"Parameter declaration \\"{name}\\" is obscured by a declaration of the same name","obscuredTypeAliasDeclaration":"Type alias declaration \\"{name}\\" is obscured by a declaration of the same name","obscuredVariableDeclaration":"Declaration \\"{name}\\" is obscured by a declaration of the same name","operatorLessOrGreaterDeprecated":"Operator \\"<>\\" is not supported in Python 3; use \\"!=\\" instead","optionalExtraArgs":"Expected one type argument after \\"Optional\\"","orPatternIrrefutable":"Irrefutable pattern allowed only as the last subpattern in an \\"or\\" pattern","orPatternMissingName":"All subpatterns within an \\"or\\" pattern must target the same names","overlappingOverload":"Overload {obscured} for \\"{name}\\" will never be used because its parameters overlap overload {obscuredBy}","overloadAbstractMismatch":"Overloaded methods must all be abstract or not","overloadImplementationMismatch":"Overloaded implementation is not consistent with signature of overload {index}","overloadReturnTypeMismatch":"Overload {prevIndex} for \\"{name}\\" overlaps overload {newIndex} and returns an incompatible type","overloadWithImplementation":"\\"{name}\\" is marked as overload, but it includes an implementation","overloadWithoutImplementation":"\\"{name}\\" is marked as overload, but no implementation is provided","overriddenMethodNotFound":"Method \\"{name}\\" is marked as override, but no base method of same name is present","overrideDecoratorMissing":"Method \\"{name}\\" is not marked as override but is overriding a method in class \\"{className}\\"","paramAfterKwargsParam":"Parameter cannot follow \\"**\\" parameter","paramAlreadyAssigned":"Parameter \\"{name}\\" is already assigned","paramAnnotationMissing":"Type annotation is missing for parameter \\"{name}\\"","paramNameMissing":"No parameter named \\"{name}\\"","paramSpecArgsKwargsUsage":"\\"args\\" and \\"kwargs\\" members of ParamSpec must both appear within a function signature","paramSpecArgsMissing":"Arguments for ParamSpec \\"{type}\\" are missing","paramSpecArgsUsage":"\\"args\\" member of ParamSpec is valid only when used with *args parameter","paramSpecAssignedName":"ParamSpec must be assigned to a variable named \\"{name}\\"","paramSpecContext":"ParamSpec not allowed in this context","paramSpecDefaultNotTuple":"Expected ellipsis, a tuple expression, or ParamSpec for default value of ParamSpec","paramSpecFirstArg":"Expected name of ParamSpec as first argument","paramSpecKwargsUsage":"\\"kwargs\\" member of ParamSpec is valid only when used with **kwargs parameter","paramSpecNotBound":"Param spec \\"{type}\\" has no bound value","paramSpecNotUsedByOuterScope":"ParamSpec \\"{name}\\" has no meaning in this context","paramSpecScopedToReturnType":"ParamSpec \\"{name}\\" is scoped to a callable within the return type and cannot be referenced in the function body","paramSpecUnknownArg":"ParamSpec does not support more than one argument","paramSpecUnknownMember":"\\"{name}\\" is not a known member of ParamSpec","paramSpecUnknownParam":"\\"{name}\\" is unknown parameter to ParamSpec","paramAssignmentMismatch":"Expression of type \\"{sourceType}\\" cannot be assigned to parameter of type \\"{paramType}\\"","paramTypeCovariant":"Covariant type variable cannot be used in parameter type","paramTypeUnknown":"Type of parameter \\"{paramName}\\" is unknown","paramTypePartiallyUnknown":"Type of parameter \\"{paramName}\\" is partially unknown","parenthesizedContextManagerIllegal":"Parentheses within \\"with\\" statement requires Python 3.9 or newer","patternNeverMatches":"Pattern will never be matched for subject type \\"{type}\\"","positionArgAfterNamedArg":"Positional argument cannot appear after keyword arguments","privateImportFromPyTypedModule":"\\"{name}\\" is not exported from module \\"{module}\\"","positionOnlyAfterArgs":"Position-only argument separator not allowed after \\"*\\" parameter","positionOnlyAfterKeywordOnly":"\\"/\\" parameter must appear before \\"*\\" parameter","positionOnlyIncompatible":"Position-only argument separator requires Python 3.8 or newer","positionOnlyFirstParam":"Position-only argument separator not allowed as first parameter","privateUsedOutsideOfClass":"\\"{name}\\" is private and used outside of the class in which it is declared","privateUsedOutsideOfModule":"\\"{name}\\" is private and used outside of the module in which it is declared","propertyOverridden":"\\"{name}\\" incorrectly overrides property of same name in class \\"{className}\\"","propertyStaticMethod":"Static methods not allowed for property getter, setter or deleter","protectedUsedOutsideOfClass":"\\"{name}\\" is protected and used outside of the class in which it is declared","protocolBaseClass":"Protocol class \\"{classType}\\" cannot derive from non-protocol class \\"{baseType}\\"","protocolBaseClassWithTypeArgs":"Type arguments are not allowed with Protocol class when using type parameter syntax","protocolIllegal":"Use of \\"Protocol\\" requires Python 3.7 or newer","protocolMemberNotClassVar":"Protocol class \\"{className}\\" does not define \\"{memberName}\\" as a ClassVar","protocolNotAllowedInTypeArgument":"\\"Protocol\\" cannot be used as a type argument","protocolUsedInCall":"Protocol class cannot be used in \\"{name}\\" call","protocolVarianceContravariant":"Type variable \\"{variable}\\" used in generic protocol \\"{class}\\" should be contravariant","protocolVarianceCovariant":"Type variable \\"{variable}\\" used in generic protocol \\"{class}\\" should be covariant","protocolVarianceInvariant":"Type variable \\"{variable}\\" used in generic protocol \\"{class}\\" should be invariant","pyrightCommentInvalidDiagnosticBoolValue":"Pyright comment directive must be followed by \\"=\\" and a value of true or false","pyrightCommentInvalidDiagnosticSeverityValue":"Pyright comment directive must be followed by \\"=\\" and a value of true, false, error, warning, information, or none","pyrightCommentMissingDirective":"Pyright comment must be followed by a directive (basic or strict) or a diagnostic rule","pyrightCommentUnknownDirective":"\\"{directive}\\" is an unknown directive for pyright comment; expected \\"strict\\" or \\"basic\\"","pyrightCommentUnknownDiagnosticRule":"\\"{rule}\\" is an unknown diagnostic rule for pyright comment","pyrightCommentUnknownDiagnosticSeverityValue":"\\"{value}\\" is invalid value for pyright comment; expected true, false, error, warning, information, or none","relativeImportNotAllowed":"Relative imports cannot be used with \\"import .a\\" form; use \\"from . import a\\" instead","recursiveDefinition":"Type of \\"{name}\\" could not be determined because it refers to itself","requiredArgCount":"Expected a single type argument after \\"Required\\"","requiredNotInTypedDict":"\\"Required\\" is not allowed in this context","returnInAsyncGenerator":"Return statement with value is not allowed in async generator","returnOutsideFunction":"\\"return\\" can be used only within a function","returnMissing":"Function with declared type of \\"{returnType}\\" must return value on all code paths","returnTypeContravariant":"Contravariant type variable cannot be used in return type","returnTypeMismatch":"Expression of type \\"{exprType}\\" cannot be assigned to return type \\"{returnType}\\"","returnTypeUnknown":"Return type is unknown","returnTypePartiallyUnknown":"Return type, \\"{returnType}\\", is partially unknown","revealLocalsArgs":"Expected no arguments for \\"reveal_locals\\" call","revealLocalsNone":"No locals in this scope","revealTypeArgs":"Expected a single positional argument for \\"reveal_type\\" call","revealTypeExpectedTextArg":"The \\"expected_text\\" argument for function \\"reveal_type\\" must be a str literal value","revealTypeExpectedTextMismatch":"Type text mismatch; expected \\"{expected}\\" but received \\"{received}\\"","revealTypeExpectedTypeMismatch":"Type mismatch; expected \\"{expected}\\" but received \\"{received}\\"","selfTypeContext":"\\"Self\\" is not valid in this context","selfTypeWithTypedSelfOrCls":"\\"Self\\" cannot be used in a function with a `self` or `cls` parameter that has a type annotation other than \\"Self\\"","setterGetterTypeMismatch":"Property setter value type is not assignable to the getter return type","singleOverload":"\\"{name}\\" is marked as overload, but additional overloads are missing","slotsAttributeError":"\\"{name}\\" is not specified in __slots__","slotsClassVarConflict":"\\"{name}\\" conflicts with instance variable declared in __slots__","starPatternInAsPattern":"Star pattern cannot be used with \\"as\\" target","starPatternInOrPattern":"Star pattern cannot be ORed within other patterns","starStarWildcardNotAllowed":"** cannot be used with wildcard \\"_\\"","staticClsSelfParam":"Static methods should not take a \\"self\\" or \\"cls\\" parameter","stdlibModuleOverridden":"\\"{path}\\" is overriding the stdlib module \\"{name}\\"","strictTypeGuardReturnType":"Return type of StrictTypeGuard (\\"{returnType}\\") is not assignable to value parameter type (\\"{type}\\")","stringNonAsciiBytes":"Non-ASCII character not allowed in bytes string literal","stringNotSubscriptable":"String expression cannot be subscripted in type annotation; enclose entire annotation in quotes","stringUnsupportedEscape":"Unsupported escape sequence in string literal","stringUnterminated":"String literal is unterminated","stubFileMissing":"Stub file not found for \\"{importName}\\"","stubUsesGetAttr":"Type stub file is incomplete; \\"__getattr__\\" obscures type errors for module","sublistParamsIncompatible":"Sublist parameters are not supported in Python 3.x","superCallArgCount":"Expected no more than two arguments to \\"super\\" call","superCallFirstArg":"Expected class type as first argument to \\"super\\" call but received \\"{type}\\"","superCallSecondArg":"Second argument to \\"super\\" call must be object or class that derives from \\"{type}\\"","superCallZeroArgForm":"Zero-argument form of \\"super\\" call is valid only within a class","symbolIsUnbound":"\\"{name}\\" is unbound","symbolIsUndefined":"\\"{name}\\" is not defined","symbolIsPossiblyUnbound":"\\"{name}\\" is possibly unbound","symbolOverridden":"\\"{name}\\" overrides symbol of same name in class \\"{className}\\"","totalOrderingMissingMethod":"Class must define one of \\"__lt__\\", \\"__le__\\", \\"__gt__\\", or \\"__ge__\\" to use total_ordering","trailingCommaInFromImport":"Trailing comma not allowed without surrounding parentheses","tryWithoutExcept":"Try statement must have at least one except or finally clause","tupleAssignmentMismatch":"Expression with type \\"{type}\\" cannot be assigned to target tuple","tupleInAnnotation":"Tuple expression not allowed in type annotation","tupleIndexOutOfRange":"Index {index} is out of range for type {type}","typeAliasIllegalExpressionForm":"Invalid expression form for type alias definition","typeAliasIsRecursiveDirect":"Type alias \\"{name}\\" cannot use itself in its definition","typeAliasNotInModuleOrClass":"A TypeAlias can be defined only within a module or class scope","typeAliasRedeclared":"\\"{name}\\" is declared as a TypeAlias and can be assigned only once","typeAliasStatementIllegal":"Type alias statement requires Python 3.12 or newer","typeArgListExpected":"Expected ParamSpec, ellipsis, or list of types","typeAnnotationCall":"Illegal type annotation: call expression not allowed","typeAnnotationVariable":"Illegal type annotation: variable not allowed unless it is a type alias","typeArgListNotAllowed":"List expression not allowed for this type argument","typeArgsExpectingNone":"Expected no type arguments for class \\"{name}\\"","typeArgsMismatchOne":"Expected one type argument but received {received}","typeArgsMissingForAlias":"Expected type arguments for generic type alias \\"{name}\\"","typeArgsMissingForClass":"Expected type arguments for generic class \\"{name}\\"","typeArgsTooFew":"Too few type arguments provided for \\"{name}\\"; expected {expected} but received {received}","typeArgsTooMany":"Too many type arguments provided for \\"{name}\\"; expected {expected} but received {received}","typeAssignmentMismatch":"Expression of type \\"{sourceType}\\" cannot be assigned to declared type \\"{destType}\\"","typeCallNotAllowed":"type() call should not be used in type annotation","typeCommentDeprecated":"Use of type comments is deprecated; use type annotation instead","typedDictAccess":"Could not access item in TypedDict","typedDictBadVar":"TypedDict classes can contain only type annotations","typedDictBaseClass":"All base classes for TypedDict classes must also be TypedDict classes","typedDictDelete":"Could not delete item in TypedDict","typedDictEmptyName":"Names within a TypedDict cannot be empty","typedDictEntryName":"Expected string literal for dictionary entry name","typedDictEntryUnique":"Names within a dictionary must be unique","typedDictExtraArgs":"Extra TypedDict arguments not supported","typedDictFieldRedefinition":"Type of TypedDict field \\"{name}\\" cannot be redefined","typedDictFirstArg":"Expected TypedDict class name as first argument","typedDictSecondArgDict":"Expected dict or keyword parameter as second parameter","typedDictSecondArgDictEntry":"Expected simple dictionary entry","typedDictSet":"Could not assign item in TypedDict","typedDictTotalParam":"Expected \\"total\\" parameter to have a value of True or False","typeExpectedClass":"Expected type expression but received \\"{type}\\"","typeGuardArgCount":"Expected a single type argument after \\"TypeGuard\\"","typeGuardParamCount":"User-defined type guard functions and methods must have at least one input parameter","typeNotAwaitable":"\\"{type}\\" is not awaitable","typeNotCallable":"\\"{expression}\\" has type \\"{type}\\" and is not callable","typeNotIntantiable":"\\"{type}\\" cannot be instantiated","typeNotIterable":"\\"{type}\\" is not iterable","typeNotSpecializable":"Could not specialize type \\"{type}\\"","typeNotSubscriptable":"Object of type \\"{type}\\" is not subscriptable","typeNotUsableWith":"Object of type \\"{type}\\" cannot be used with \\"with\\" because it does not implement {method}","typeNotSupportBinaryOperator":"Operator \\"{operator}\\" not supported for types \\"{leftType}\\" and \\"{rightType}\\"","typeNotSupportBinaryOperatorBidirectional":"Operator \\"{operator}\\" not supported for types \\"{leftType}\\" and \\"{rightType}\\" when expected type is \\"{expectedType}\\"","typeNotSupportUnaryOperator":"Operator \\"{operator}\\" not supported for type \\"{type}\\"","typeNotSupportUnaryOperatorBidirectional":"Operator \\"{operator}\\" not supported for type \\"{type}\\" when expected type is \\"{expectedType}\\"","typeParameterBoundNotAllowed":"Bound or constraint cannot be used with a variadic type parameter or ParamSpec","typeParameterConstraintTuple":"Type parameter constraint must be a tuple of two or more types","typeParameterExistingTypeParameter":"Type parameter \\"{name}\\" is already in use","typeParametersMissing":"At least one type parameter must be specified","typeParameterNotDeclared":"Type parameter \\"{name}\\" is not included in the type parameter list for \\"{container}\\"","typePartiallyUnknown":"Type of \\"{name}\\" is partially unknown","typeUnknown":"Type of \\"{name}\\" is unknown","typeVarAssignedName":"TypeVar must be assigned to a variable named \\"{name}\\"","typeVarAssignmentMismatch":"Type \\"{type}\\" cannot be assigned to type variable \\"{name}\\"","typeVarBoundAndConstrained":"TypeVar cannot be both bound and constrained","typeVarBoundGeneric":"TypeVar bound type cannot be generic","typeVarConstraintGeneric":"TypeVar constraint type cannot be generic","typeVarDefaultBoundMismatch":"TypeVar default type must be a subtype of the bound type","typeVarDefaultConstraintMismatch":"TypeVar default type must be one of the constrained types","typeVarFirstArg":"Expected name of TypeVar as first argument","typeVarDefaultInvalidTypeVar":"Type parameter \\"{name}\\" has a default type that refers to one or more type variables that are out of scope","typeVarNoMember":"TypeVar \\"{type}\\" has no member \\"{name}\\"","typeVarNotSubscriptable":"TypeVar \\"{type}\\" is not subscriptable","typeVarNotUsedByOuterScope":"Type variable \\"{name}\\" has no meaning in this context","typeVarPossiblyUnsolvable":"Type variable \\"{name}\\" may go unsolved if caller supplies no argument for parameter \\"{param}\\"","typeVarScopedToReturnType":"Type variable \\"{name}\\" is scoped to a callable within the return type and cannot be referenced in the function body","typeVarSingleConstraint":"TypeVar must have at least two constrained types","typeVarsNotInGenericOrProtocol":"Generic[] or Protocol[] must include all type variables","typeVarTupleContext":"TypeVarTuple not allowed in this context","typeVarTupleDefaultNotUnpacked":"TypeVarTuple default type must be an unpacked tuple or TypeVarTuple","typeVarTupleMustBeUnpacked":"Unpack operator is required for TypeVarTuple value","typeVarTupleUnknownParam":"\\"{name}\\" is unknown parameter to TypeVarTuple","typeVarUnknownParam":"\\"{name}\\" is unknown parameter to TypeVar","typeVarUsedByOuterScope":"TypeVar \\"{name}\\" is already in use by an outer scope","typeVarUsedOnlyOnce":"TypeVar \\"{name}\\" appears only once in generic function signature","typeVarVariance":"TypeVar cannot be both covariant and contravariant","typeVarWithoutDefault":"\\"{name}\\" cannot appear after \\"{other}\\" in type parameter list because it has no default type","unaccessedClass":"Class \\"{name}\\" is not accessed","unaccessedFunction":"Function \\"{name}\\" is not accessed","unaccessedImport":"Import \\"{name}\\" is not accessed","unaccessedSymbol":"\\"{name}\\" is not accessed","unaccessedVariable":"Variable \\"{name}\\" is not accessed","unannotatedFunctionSkipped":"Analysis of function \\"{name}\\" is skipped because it is unannotated","unexpectedAsyncToken":"Expected \\"def\\", \\"with\\" or \\"for\\" to follow \\"async\\"","unexpectedExprToken":"Unexpected token at end of expression","unexpectedIndent":"Unexpected indentation","unexpectedUnindent":"Unindent not expected","unhashableDictKey":"Dictionary key must be hashable","unhashableSetEntry":"Set entry must be hashable","unionForwardReferenceNotAllowed":"Union syntax cannot be used with string operand; use quotes around entire expression","unionSyntaxIllegal":"Alternative syntax for unions requires Python 3.10 or newer","unionTypeArgCount":"Union requires two or more type arguments","uninitializedInstanceVariable":"Instance variable \\"{name}\\" is not initialized in the class body or __init__ method","unmatchedEndregionComment":"#endregion is missing corresponding #region","unmatchedRegionComment":"#region is missing corresponding #endregion","unnecessaryCast":"Unnecessary \\"cast\\" call; type is already \\"{type}\\"","unnecessaryIsInstanceAlways":"Unnecessary isinstance call; \\"{testType}\\" is always an instance of \\"{classType}\\"","unnecessaryIsSubclassAlways":"Unnecessary issubclass call; \\"{testType}\\" is always a subclass of \\"{classType}\\"","unnecessaryPyrightIgnore":"Unnecessary \\"# pyright: ignore\\" comment","unnecessaryPyrightIgnoreRule":"Unnecessary \\"# pyright: ignore\\" rule: \\"{name}\\"","unnecessaryTypeIgnore":"Unnecessary \\"# type: ignore\\" comment","unpackArgCount":"Expected a single type argument after \\"Unpack\\"","unpackedArgInTypeArgument":"Unpacked arguments cannot be used in type argument lists","unpackedArgWithVariadicParam":"Unpacked argument cannot be used for TupleTypeVar parameter","unpackedDictArgumentNotMapping":"Argument expression after ** must be a mapping with a \\"str\\" key type","unpackedSubscriptIllegal":"Unpack operator in subscript requires Python 3.11 or newer","unpackedTypedDictArgument":"Unable to match unpacked TypedDict argument to parameters","unpackedTypeVarTupleExpected":"Expected unpacked TypeVarTuple; use Unpack[{name1}] or *{name2}","unpackExpectedTypedDict":"Expected TypedDict type argument for Unpack","unpackExpectedTypeVarTuple":"Expected TypeVarTuple or Tuple as type argument for Unpack","unpackIllegalInComprehension":"Unpack operation not allowed in comprehension","unpackInAnnotation":"Unpack operator not allowed in type annotation","unpackInDict":"Unpack operation not allowed in dictionaries","unpackInSet":"Unpack operator not allowed within a set","unpackNotAllowed":"Unpack not allowed in this context","unpackOperatorNotAllowed":"Unpack operation not allowed in this context","unpackTuplesIllegal":"Unpack operation not allowed in tuples prior to Python 3.8","unreachableCode":"Code is unreachable","unreachableExcept":"Except clause is unreachable because exception is already handled","unsupportedDunderAllOperation":"Operation on \\"__all__\\" is not supported, so exported symbol list may be incorrect","unusedCallResult":"Result of call expression is of type \\"{type}\\" and is not used; assign to variable \\"_\\" if this is intentional","unusedCoroutine":"Result of async function call is not used; use \\"await\\" or assign result to variable","unusedExpression":"Expression value is unused","varAnnotationIllegal":"Type annotations for variables requires Python 3.6 or newer; use type comment for compatibility with previous versions","variableFinalOverride":"Variable \\"{name}\\" is marked Final and overrides non-Final variable of same name in class \\"{className}\\"","variadicTypeArgsTooMany":"Type argument list can have at most one unpacked TypeVarTuple or Tuple","variadicTypeParamTooManyAlias":"Type alias can have at most one TypeVarTuple type parameter but received multiple ({names})","variadicTypeParamTooManyClass":"Generic class can have at most one TypeVarTuple type parameter but received multiple ({names})","walrusIllegal":"Operator \\":=\\" requires Python 3.8 or newer","walrusNotAllowed":"Operator \\":=\\" not allowed in this context without surrounding parentheses","wildcardInFunction":"Wildcard import not allowed within a class or function","wildcardPatternTypeUnknown":"Type captured by wildcard pattern is unknown","wildcardPatternTypePartiallyUnknown":"Type captured by wildcard pattern is partially unknown","wildcardLibraryImport":"Wildcard import from a library not allowed","yieldFromIllegal":"Use of \\"yield from\\" requires Python 3.3 or newer","yieldFromOutsideAsync":"\\"yield from\\" not allowed in an async function","yieldOutsideFunction":"\\"yield\\" not allowed outside of a function or lambda","yieldTypeMismatch":"Expression of type \\"{exprType}\\" cannot be assigned to yield type \\"{yieldType}\\"","yieldWithinListCompr":"\\"yield\\" not allowed inside a list comprehension","zeroCaseStatementsFound":"Match statement must include at least one case statement","zeroLengthTupleNotAllowed":"Zero-length tuple not allowed in this context"},"DiagnosticAddendum":{"argParam":"Argument corresponds to parameter \\"{paramName}\\"","argParamFunction":"Argument corresponds to parameter \\"{paramName}\\" in function \\"{functionName}\\"","argsParamMissing":"Parameter \\"*{paramName}\\" has no corresponding parameter","argsPositionOnly":"Position-only parameter mismatch; expected {expected} but received {received}","argumentType":"Argument type is \\"{type}\\"","argumentTypes":"Argument types: ({types})","assignToNone":"Type cannot be assigned to type \\"None\\"","asyncHelp":"Did you mean \\"async with\\"?","baseClassOverriddenType":"Base class \\"{baseClass}\\" provides type \\"{type}\\", which is overridden","baseClassOverridesType":"Base class \\"{baseClass}\\" overrides with type \\"{type}\\"","dataClassFieldLocation":"Field declaration","dataClassFrozen":"\\"{name}\\" is frozen","finalMethod":"Final method","keyNotRequired":"\\"{name}\\" is not a required key in \\"{type}\\", so access may result in runtime exception","keyRequiredDeleted":"\\"{name}\\" is a required key and cannot be deleted","keyUndefined":"\\"{name}\\" is not a defined key in \\"{type}\\"","functionParamDefaultMissing":"Parameter \\"{name}\\" is missing default argument","functionParamName":"Parameter name mismatch: \\"{destName}\\" versus \\"{srcName}\\"","functionReturnTypeMismatch":"Function return type \\"{sourceType}\\" is incompatible with type \\"{destType}\\"","functionTooFewParams":"Function accepts too few positional parameters; expected {expected} but received {received}","functionTooManyParams":"Function accepts too many positional parameters; expected {expected} but received {received}","incompatibleGetter":"Property getter method is incompatible","incompatibleSetter":"Property setter method is incompatible","initMethodLocation":"The __init__ method is defined in class \\"{type}\\"","incompatibleDeleter":"Property deleter method is incompatible","initMethodSignature":"Signature of __init__ is \\"{type}\\"","kwargsParamMissing":"Parameter \\"**{paramName}\\" has no corresponding parameter","listAssignmentMismatch":"Type \\"{type}\\" is incompatible with target list","literalAssignmentMismatch":"\\"{sourceType}\\" cannot be assigned to type \\"{destType}\\"","matchIsNotExhaustiveType":"Unhandled type: \\"{type}\\"","matchIsNotExhaustiveHint":"If exhaustive handling is not intended, add \\"case _: pass\\"","memberSetClassVar":"Member \\"{name}\\" cannot be assigned through a class instance because it is a ClassVar","memberAssignment":"Expression of type \\"{type}\\" cannot be assigned to member \\"{name}\\" of class \\"{classType}\\"","memberIsAbstract":"\\"{type}.{name}\\" is abstract","memberIsAbstractMore":"and {count} more...","memberIsFinalInProtocol":"\\"{name}\\" is marked Final in protocol","memberIsInitVar":"Member \\"{name}\\" is an init-only field","memberIsInvariant":"\\"{name}\\" is invariant because it is mutable","memberIsNotFinalInProtocol":"\\"{name}\\" is not marked Final in protocol","memberTypeMismatch":"\\"{name}\\" is an incompatible type","memberUnknown":"Member \\"{name}\\" is unknown","missingProtocolMember":"Member \\"{name}\\" is declared in protocol class \\"{classType}\\"","missingGetter":"Property getter method is missing","missingSetter":"Property setter method is missing","missingDeleter":"Property deleter method is missing","namedParamMissingInDest":"Keyword parameter \\"{name}\\" is missing in destination","namedParamMissingInSource":"Keyword parameter \\"{name}\\" is missing in source","namedParamTypeMismatch":"Keyword parameter \\"{name}\\" of type \\"{sourceType}\\" cannot be assigned to type \\"{destType}\\"","newMethodLocation":"The __new__ method is defined in class \\"{type}\\"","newMethodSignature":"Signature of __new__ is \\"{type}\\"","noOverloadAssignable":"No overloaded function matches type \\"{type}\\"","orPatternMissingName":"Missing names: {name}","overloadSignature":"Overload signature is defined here","overloadNotAssignable":"One or more overloads of \\"{name}\\" is not assignable","overloadWithImplementation":"The body of a function overload should be \\"...\\"","overriddenMethod":"Overridden method","overriddenSymbol":"Overridden symbol","overrideNoOverloadMatches":"No overload signature in override is compatible with base method","overrideNotClassMethod":"Base method is declared as a classmethod but override is not","overrideNotInstanceMethod":"Base method is declared as an instance method but override is not","overrideNotStaticMethod":"Base method is declared as a staticmethod but override is not","overrideParamKeywordNoDefault":"Keyword parameter \\"{name}\\" mismatch: base parameter has default argument value, override parameter does not","overrideParamKeywordType":"Keyword parameter \\"{name}\\" type mismatch: base parameter is type \\"{baseType}\\", override parameter is type \\"{overrideType}\\"","overrideParamName":"Parameter {index} name mismatch: base parameter is named \\"{baseName}\\", override parameter is named \\"{overrideName}\\"","overrideParamNameExtra":"Parameter \\"{name}\\" is missing in base","overrideParamNameMissing":"Parameter \\"{name}\\" is missing in override","overrideParamNamePositionOnly":"Parameter {index} name mismatch: base parameter is named \\"{baseName}\\", override parameter is position-only\\"","overrideParamNoDefault":"Parameter {index} mismatch: base parameter has default argument value, override parameter does not","overrideParamType":"Parameter {index} type mismatch: base parameter is type \\"{baseType}\\", override parameter is type \\"{overrideType}\\"","overridePositionalParamCount":"Positional parameter count mismatch; base method has {baseCount}, but override has {overrideCount}","overrideReturnType":"Return type mismatch: base method returns type \\"{baseType}\\", override returns type \\"{overrideType}\\"","overrideType":"Base class defines type as \\"{type}\\"","paramAssignment":"Parameter {index}: type \\"{sourceType}\\" cannot be assigned to type \\"{destType}\\"","paramType":"Parameter type is \\"{paramType}\\"","privateImportFromPyTypedSource":"Import from \\"{module}\\" instead","propertyAccessFromProtocolClass":"A property defined within a protocol class cannot be accessed as a class variable","propertyMethodIncompatible":"Property method \\"{name}\\" is incompatible","propertyMethodMissing":"Property method \\"{name}\\" is missing in override","propertyMissingDeleter":"Property \\"{name}\\" has no defined deleter","propertyMissingSetter":"Property \\"{name}\\" has no defined setter","protocolIncompatible":"\\"{sourceType}\\" is incompatible with protocol \\"{destType}\\"","protocolMemberClassVar":"\\"{name}\\" is not a class variable","protocolMemberMissing":"\\"{name}\\" is not present","protocolSourceIsNotConcrete":"\\"{sourceType}\\" is not a concrete class type and cannot be assigned to type \\"{destType}\\"","readOnlyAttribute":"Attribute \\"{name}\\" is read-only","seeDeclaration":"See declaration","seeClassDeclaration":"See class declaration","seeFunctionDeclaration":"See function declaration","seeMethodDeclaration":"See method declaration","seeParameterDeclaration":"See parameter declaration","seeTypeAliasDeclaration":"See type alias declaration","seeVariableDeclaration":"See variable declaration","tupleEntryTypeMismatch":"Tuple entry {entry} is incorrect type","tupleAssignmentMismatch":"Type \\"{type}\\" is incompatible with target tuple","tupleSizeMismatch":"Element size mismatch; expected {expected} but received {received}","typeAssignmentMismatch":"Type \\"{sourceType}\\" cannot be assigned to type \\"{destType}\\"","typeBound":"Type \\"{sourceType}\\" is incompatible with bound type \\"{destType}\\" for type variable \\"{name}\\"","typeConstrainedTypeVar":"Type \\"{type}\\" is incompatible with constrained type variable \\"{name}\\"","typedDictFieldMissing":"\\"{name}\\" is missing from \\"{type}\\"","typedDictFieldNotRequired":"\\"{name}\\" is not required in \\"{type}\\"","typedDictFieldRequired":"\\"{name}\\" is required in \\"{type}\\"","typedDictFieldTypeMismatch":"Type \\"{type}\\" is not assignable to field \\"{name}\\"","typedDictFieldRedefinition":"Type in parent class is \\"{parentType}\\" and type in child class is \\"{childType}\\"","typedDictFieldUndefined":"\\"{name}\\" is an undefined field in type \\"{type}\\"","typedDictFinalMismatch":"\\"{sourceType}\\" is incompatible with \\"{destType}\\" because of a @final mismatch","typeIncompatible":"\\"{sourceType}\\" is incompatible with \\"{destType}\\"","typeNotCallable":"Type \\"{type}\\" is not callable","typeNotClass":"\\"{type}\\" is not a class","typeParamSpec":"Type \\"{type}\\" is incompatible with ParamSpec \\"{name}\\"","typeNotStringLiteral":"\\"{type}\\" is not a string literal","typeOfSymbol":"Type of \\"{name}\\" is \\"{type}\\"","typeUnsupported":"Type \\"{type}\\" is unsupported","typeVarDefaultOutOfScope":"Type variable \\"{name}\\" is not in scope","typeVarIsContravariant":"TypeVar \\"{name}\\" is contravariant","typeVarIsCovariant":"TypeVar \\"{name}\\" is covariant","typeVarIsInvariant":"TypeVar \\"{name}\\" is invariant","typeVarNotAllowed":"TypeVar or generic type with type arguments not allowed","typeVarUnsolvableRemedy":"Provide an overload that specifies the return type when the argument is not supplied","typeVarsMissing":"Missing type variables: {names}","typeVarTupleRequiresKnownLength":"TypeVarTuple cannot be bound to a tuple of unknown length","unhashableType":"Type \\"{type}\\" is not hashable","unreachableExcept":"\\"{exceptionType}\\" is a subclass of \\"{parentType}\\"","useDictInstead":"Use Dict[T1, T2] to indicate a dictionary type","useListInstead":"Use List[T] to indicate a list type or Union[T1, T2] to indicate a union type","useTupleInstead":"Use Tuple[T1, ..., Tn] to indicate a tuple type or Union[T1, T2] to indicate a union type","useTypeInstead":"Use Type[T] instead","varianceMismatchForClass":"Variance of type argument \\"{typeVarName}\\" is incompatible with base class \\"{className}\\"","varianceMismatchForTypeAlias":"Variance of type argument \\"{typeVarName}\\" is incompatible with \\"{typeAliasParam}\\""},"CodeAction":{"addOptionalToAnnotation":"Add \\"Optional\\" to Type Annotation","createTypeStub":"Create Type Stub","createTypeStubFor":"Create Type Stub For \\"{moduleName}\\"","executingCommand":"Executing command","filesToAnalyzeOne":"1 file to analyze","filesToAnalyzeCount":"{count} files to analyze","findingReferences":"Finding references","organizeImports":"Organize Imports","renameShadowedFile":"Rename \\"{oldFile}\\" to \\"{newFile}\\""},"Refactoring":{"moveFile":"Do you want to update all import references for \\"{oldModuleName}\\" to \\"{newModuleName}\\"?","moveFileLabel":"Update all import references for \\"{oldModuleName}\\" to \\"{newModuleName}\\"?","moveFileDescription":"Update all import references for \\"{oldModuleName}\\" to \\"{newModuleName}\\"?"}}')},1859:e=>{e.exports={}},3409:e=>{e.exports={}},6687:e=>{e.exports={}},5491:e=>{e.exports={}},3559:e=>{e.exports={}},1308:e=>{e.exports={}}};
//# sourceMappingURL=pyright-internal.js.map